var timeOn=null;var menuActive=0;var g_sActiveUniqueId="";var g_sMenuOver=String("menuOver();");var g_sMenuOut=String("menuOut(");var g_nActiveCrumbMenuId;var g_bBlockCrumb=false;var g_bIsFavDeleteHover=false;var g_bIsPageLoaded=false;var g_bContextActive=false;var g_bSubNavContainerLoaded=false;function menuOver(){clearTimeout(timeOn);menuActive=1;}function menuOut(nav){menuActive=0;timeOn=setTimeout("TimeOutMenus("+nav+")",400);}function TimeOutMenus(nav){if(nav==0)HideSubNavMenu();else{HideSubNavMenu();HideNavMenu();}}function raiseMenuEvent(e,bGridNoRows,Obj){if(bGridNoRows&&!g_bContextActive)Obj.raiseEvent("onRowContextMenu",e,this.$0);else if(!bGridNoRows){g_bContextActive=true;this.raiseEvent("onRowContextMenu",e,this.$0);}}function raiseMenuKeyPressEvent(e){var EventKeyCode=(window.event)?event.keyCode:e.keyCode;var EventCharCode=(window.event)?event.charCode:e.charCode;var EventCtrlKey=(window.event)?event.ctrlKey:e.ctrlKey;var MenuKey=(window.event)?93:e.DOM_VK_CONTEXT_MENU;if((EventKeyCode==MenuKey))this.raiseEvent("onRowContextMenu",e,this.$0);else{var key=String.fromCharCode(EventKeyCode||EventCharCode);if(key.toUpperCase()=="A"&&EventCtrlKey&&this.getSelectionMode()=="multi-row"){this.setRowSelected(true);this.setRowState("selected");var i,rows=[],max=this.getRowCount();var bDoWebClientSelect=false;try{if(this==FilesList){bDoWebClientSelect=true;anRowIndex=FilesList.getRowIndices();max=anRowIndex.length;for(i=0;i<max;i++){if(FilesList.getCellValue(9,parseInt(anRowIndex[i]))!=1)rows.push(parseInt(anRowIndex[i]));}}}catch(e){bDoWebClientSelect=false;}if(!bDoWebClientSelect){for(i=0;i<max;i++){rows.push(i);}}this.setSelectedRows(rows);}}}function initMenu(sId){g_bIsPageLoaded=true;var sMenuStyleFix="";var sLangCookieChk=readCookie("SULang")+"";if(sLangCookieChk.indexOf("ru")!=-1||sLangCookieChk.indexOf("es")!=-1||sLangCookieChk.indexOf("fr")!=-1||sLangCookieChk.indexOf("jp")!=-1||sLangCookieChk.indexOf("se")!=-1)sMenuStyleFix="-wide";else if(sLangCookieChk.indexOf("it")!=-1)sMenuStyleFix="-it";var MenuElement=document.createElement("div");MenuElement.id=sId;MenuElement.className='contextmenu'+sMenuStyleFix;MenuElement.style.cursor="pointer";if(sId=="navSubMenu")MenuElement.style.zIndex="160001";document.getElementsByTagName("body")[0].appendChild(MenuElement);}function writeContextMenu(content,sId){var contextMenu=document.getElementById(sId);if(contextMenu)contextMenu.innerHTML='<table cellpadding="0" cellspacing="0" border="0" style="cursor:pointer;width:100%;">'+content+'</table>';}function showContextMenu(e,sId,objId,bNoGridContext,EventClientX,EventClientY){var contextMenu=document.getElementById(sId);var frameWidth,frameHeight,pageOffsetX,pageOffsetY,aTopLeft;if(navigator.userAgent.match("Linux"))g_sActiveUniqueId=sId;if(self.clientWidth){frameWidth=self.innerWidth;frameHeight=self.innerHeight;}else if(document.documentElement&&document.documentElement.clientWidth){frameWidth=document.documentElement.clientWidth;frameHeight=document.documentElement.clientHeight;}else if(document.body){frameWidth=document.body.clientWidth;frameHeight=document.body.clientHeight;}if(self.pageXOffset){pageOffsetX=self.pageXOffset;pageOffsetY=self.pageYOffset;}else if(document.documentElement&&document.documentElement.scrollLeft){pageOffsetX=document.documentElement.scrollLeft;pageOffsetY=document.documentElement.scrollTop;}else if(document.body){pageOffsetX=document.body.scrollLeft;pageOffsetY=document.body.scrollTop;}if(EventClientX==undefined){if(!bNoGridContext||bNoGridContext==undefined){var nFileListRowIndices=objId.getRowIndices();var SelectedRowsContext=objId.getSelectedRows().toString().split(",");aTopLeft=findPos(objId.getRowTemplate(SelectedRowsContext[SelectedRowsContext.length-1]).element());contextMenu.style.left=aTopLeft[0];}}else{if((frameWidth-EventClientX)<contextMenu.offsetWidth){contextMenu.style.left=((pageOffsetX+EventClientX-contextMenu.offsetWidth)+2)+"px";}else{contextMenu.style.left=EventClientX+"px";}}if(navigator.userAgent.match("Linux")){setTimeout(function(){if(document.attachEvent)document.attachEvent("onclick",hideContextMenu);else document.addEventListener("click",hideContextMenu,false);},0);}else{if(document.attachEvent)document.attachEvent("onclick",hideContextMenu);else document.addEventListener("click",hideContextMenu,false);}if(EventClientY==undefined){contextMenu.style.top=(aTopLeft[1]+21);}else{yClickMousePos=EventClientY;if((yClickMousePos+contextMenu.offsetHeight)>frameHeight)yClickMousePos=yClickMousePos-((yClickMousePos+contextMenu.offsetHeight)-frameHeight);if(pageOffsetY>0){contextMenu.style.top=((pageOffsetY+yClickMousePos)-2)+"px";}else{contextMenu.style.top=(yClickMousePos-2)+"px";}}HideApplet();contextMenu.style.visibility="visible";if(navigator.userAgent.match("Linux"))contextMenu.style.display="block";g_bContextMenuActive=true;}function showMenu(e,sId,sPositionImg,bCrumb,bHistory){var Menu=document.getElementById(sId);var aTopLeft,nPosImgWidth;aTopLeft=findPos(document.getElementById(sPositionImg));nPosImgWidth=document.getElementById(sPositionImg).offsetWidth;nPosImgHeight=document.getElementById(sPositionImg).offsetHeight;if(Menu){if(sId=="navSubMenu"){Menu.style.left=(aTopLeft[0]+nPosImgWidth+5)+"px";Menu.style.top=((aTopLeft[1]+(nPosImgHeight))-(Menu.offsetHeight/2))+"px";}else if(bCrumb!=undefined&&bCrumb==true){Menu.style.left=(aTopLeft[0]+5)+"px";Menu.style.top=((aTopLeft[1])+10)+"px";}else if(bHistory!=undefined&&bHistory==true){Menu.style.left=(aTopLeft[0]+5)+"px";Menu.style.top=((aTopLeft[1])+15)+"px";}else{Menu.style.left=(aTopLeft[0]+nPosImgWidth)+"px";Menu.style.top=((aTopLeft[1])-(Menu.offsetHeight))+"px";}HideApplet();Menu.style.visibility="visible";}}function hideContextMenu(){if(document.getElementById(g_sActiveUniqueId)){document.getElementById(g_sActiveUniqueId).style.visibility="hidden";ShowApplet();if(document.detachEvent){document.detachEvent("onclick",hideContextMenu);}else{document.removeEventListener("click",hideContextMenu,false);}}g_bContextActive=false;g_bContextMenuActive=false;}function hideCrumbMenu(nId){if(document.getElementById("crumb-container"+nId)&&document.getElementById("crumb-container"+nId).style.visibility!="hidden"){document.getElementById("crumb-container"+nId).style.visibility="hidden";g_nActiveCrumbMenuId=undefined;ShowApplet();if(document.detachEvent){document.detachEvent("onclick",function(){hideCrumbMenu(nId);});}else{document.removeEventListener("click",function(){hideCrumbMenu(nId);},false);}var el=document;if(el.detachEvent){el.detachEvent("onkeydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}});}else if(el.removeEventListener){el.removeEventListener("keydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}},true);}else{el["onkeydown"]=null;}}}function hideCrumbMenuSetUp(nId){if(document.getElementById("crumb-container"+nId)){if(document.detachEvent){document.attachEvent("onclick",function(){hideCrumbMenu(nId);});}else{document.addEventListener("click",function(){hideCrumbMenu(nId);},false);}}}function hideHistoryMenu(){if(document.getElementById("crumb-containerHistory-Menu").style.visibility=="visible"){document.getElementById("crumb-containerHistory-Menu").style.visibility="hidden";g_nActiveCrumbMenuId=undefined;ShowApplet();if(document.detachEvent){document.detachEvent("onclick",hideHistoryMenu);}else{document.removeEventListener("click",hideHistoryMenu,false);}}}function hideHistoryMenuFav(){if(document.getElementById("crumb-containerHistory-Menu").style.visibility=="visible"&&!g_bIsFavDeleteHover){document.getElementById("crumb-containerHistory-Menu").style.visibility="hidden";g_nActiveCrumbMenuId=undefined;ShowApplet();if(document.detachEvent){document.detachEvent("onclick",hideHistoryMenuFav);}else{document.removeEventListener("click",hideHistoryMenuFav,false);}}}function hideHistoryMenuSetUp(){if(document.getElementById("crumb-containerHistory-Menu")){if(document.attachEvent){document.attachEvent("onclick",hideHistoryMenu);}else{document.addEventListener("click",hideHistoryMenu,false);}}}function hideHistoryMenuSetUpFavs(){if(document.getElementById("crumb-containerHistory-Menu")){if(document.attachEvent){document.attachEvent("onclick",hideHistoryMenuFav);}else{document.addEventListener("click",hideHistoryMenuFav,false);}}}function HideNavMenu(){if(document.getElementById("navMenu")){if(document.getElementById("navMenu").style.visibility=="visible"){document.getElementById("navMenu").style.visibility="hidden";if(document.detachEvent){document.detachEvent("onclick",HideNavMenu);}else{document.removeEventListener("click",HideNavMenu,false);}}}}function HideSubNavMenu(){if(document.getElementById("navSubMenu")){if(document.getElementById("navSubMenu").style.visibility=="visible"){document.getElementById("navSubMenu").style.visibility="hidden";if(document.detachEvent){document.detachEvent("onclick",HideSubNavMenu);}else{document.removeEventListener("click",HideSubNavMenu,false);}}}}function HideMenu(){if(document.attachEvent){document.attachEvent("onclick",HideNavMenu);}else{document.addEventListener("click",HideNavMenu,false);}}function CreateContextMenu(asFunctions,asNames,asImages,obj,sUniqueId,bCoverGridMenu){if(sUniqueId==null||sUniqueId==""||sUniqueId==undefined)sUniqueId="ContextMenu";if(bCoverGridMenu){obj.setEvent("oncontextmenu",function(e){raiseMenuEvent(e,true,this);});}else obj.setEvent("oncontextmenu","return false");obj.getRowTemplate().setEvent("oncontextmenu",function(e){raiseMenuEvent.call(this,e);});obj.setController("copypaste",{});if(!g_bFireFox3Browser)obj.setEvent("onkeydown",raiseMenuKeyPressEvent);obj.onRowContextMenu=function(e,row){var EventClientX=e.clientX;var EventClientY=e.clientY;var nRow=row;var nDelay=100;setTimeout(function(){obj.setSelectedRows(obj.getSelectedRows());var contextMenuContent='';var sMenuItemName;for(nIndex=0;(nIndex<asFunctions.length);nIndex++){if(typeof asNames[nIndex]=="function")sMenuItemName=asNames[nIndex]();else sMenuItemName=asNames[nIndex];if((asNames[nIndex]==g_sMenuDividers)||(sMenuItemName==g_sMenuDividers)){contextMenuContent+='<tr><td class="iconcolumn"><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td><td class="menuItemSep"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td></tr>';}else{if(asImages[nIndex]!=""){sImage='<img src="'+g_sImagePath+'spacer.gif" width="1" height="1">';if(typeof asImages[nIndex]=="function")sImageClass="-"+asImages[nIndex]();else sImageClass="-"+asImages[nIndex];}else{sImage='&nbsp;';sImageClass="";}if(sMenuItemName!="")contextMenuContent+='<tr id="contextrow'+sUniqueId+nIndex+'" onclick="javascript:'+asFunctions[nIndex]+row+');"  onmouseover="javascript:document.getElementById(\'contextitem'+sUniqueId+nIndex+'\').className=\'onnavlinkrow\'" onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\'contextitem'+sUniqueId+nIndex+'\').className=\'offnavlinkrow\'"><td class="iconcolumn"><div class="iconcell'+sImageClass+'">'+sImage+'</div></td><td class="offnavlinkrow" style="" id="contextitem'+sUniqueId+nIndex+'">'+sMenuItemName+'</td></tr>';}}writeContextMenu(contextMenuContent,sUniqueId);showContextMenu(e,sUniqueId,obj,undefined,EventClientX,EventClientY);g_sActiveUniqueId=sUniqueId;},nDelay);};if(g_bIsPageLoaded)initMenu(sUniqueId);else{AddOnloadEvent(function(){initMenu(sUniqueId);});}}function CreateCrumbMenu(aCrumb,sElement,nContainerSize,sSearchText,bHistory,nFavLength){var Navigation=document.getElementById("crumb"+sElement);var sImageClass="";var UserAgent=navigator.userAgent||"";var bFavShorcut=false;var nFavStart=-1;var sFavCell="";if(nFavLength>0)nFavStart=(aCrumb.length-nFavLength);if(nFavStart!=-1)sFavCell="<td style='width:15px;'>&nbsp;</td>";if(nContainerSize==0)nContainerSize=1;var navMenuContent='';if(document.detachEvent){document.detachEvent("onclick",HideNavMenu);}else{document.removeEventListener("click",HideNavMenu,false);}if(aCrumb.length>0){for(nIndex=0;(nIndex<aCrumb.length);nIndex++){var sOnGoToPath;if(nIndex>=nFavStart&&nFavStart!=-1)bFavShorcut=true;if(bHistory)sOnGoToPath=String('OnOpenCrumb(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\','+nIndex+',true);');else sOnGoToPath=String('OnOpenCrumb(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\','+nIndex+',false);');sOnGoToFavPath=String('OnOpenCrumb(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\','+nIndex+',true);');sOnDeleteFavCookie=String('OnDeleteFavCookie(\''+CleanPathByEscape(aCrumb[nIndex][0])+'\',\''+sElement+nIndex+'FavRow\');');sMenuFileMove=String('OnCrumbDropFile(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\');');sOnFavDeleteHover=String('OnIsFavDeleteHover();');sOnFavDeleteBlur=String('OnIsFavDeleteBlur();');if(aCrumb[nIndex][0]==g_sMenuDividers){if(aCrumb[nIndex][1]=="*favs_list*"){navMenuContent+='<tr onmouseover="javascript:'+g_sMenuOver+'" onmouseout="javascript:'+g_sMenuOut+');">';navMenuContent+='<td class="iconcolumn"><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td>';navMenuContent+='<td class="menuItemSep" colspan="2"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td></tr>';}else{navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'" onmouseover="javascript:'+g_sMenuOver+'" onmouseout="javascript:'+g_sMenuOut+');">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td>';navMenuContent+='<td class="menuItemSep" style=""><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td>'+sFavCell+'</tr>';}}else{sMouseOverFunction="";sAltName="";sImage='<img src="'+g_sImagePath+'spacer.gif" width="1" height="1">';if(aCrumb[nIndex][3]==1&&bHistory)sImageClass="-pointer-arrow";else sImageClass="-"+aCrumb[nIndex][2];if(sSearchText==aCrumb[nIndex][0]){if(bFavShorcut){navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"  id="'+sElement+nIndex+'FavRow"';navMenuContent+=' onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'fav-onnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'fav-offnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div  class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td  class="fav-offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>';navMenuContent+='<td class="delete-offnavlinkrow" onclick="javascript:'+sOnDeleteFavCookie+'" style="width:15px;" id="delete-'+sElement+nIndex+'">';navMenuContent+='<img onmouseover="javascript:this.src=\''+g_sImagePath+'DeleteFav-On.png\'"';navMenuContent+=' onmouseout="javascript:this.src=\''+g_sImagePath+'DeleteFav-Off.png\';'+sOnFavDeleteBlur+'" src="'+g_sImagePath+'DeleteFav-Off.png" width="16" height="16"></td></tr>';}else{navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"';navMenuContent+=' onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td class="offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>'+sFavCell+'</tr>';}}else{if(bFavShorcut){navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"  id="'+sElement+nIndex+'FavRow"';navMenuContent+=' onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'fav-onnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'fav-offnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-offnavlinkrow\'">';navMenuContent+='<td onclick="javascript:'+sOnGoToFavPath+'" class="iconcolumn" style=""><div class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td onclick="javascript:'+sOnGoToFavPath+'" class="fav-offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>';navMenuContent+='<td onclick="javascript:'+sOnDeleteFavCookie+'" class="delete-offnavlinkrow" style="width:15px;" id="delete-'+sElement+nIndex+'"><img onmouseover="javascript:this.src=\''+g_sImagePath+'DeleteFav-On.png\';'+sOnFavDeleteHover+'"';navMenuContent+=' onmouseout="javascript:this.src=\''+g_sImagePath+'DeleteFav-Off.png\';'+sOnFavDeleteBlur+'" src="'+g_sImagePath+'DeleteFav-Off.png" width="16" height="16"></td></tr>';}else{navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"';navMenuContent+=' onclick="javascript:'+sOnGoToPath+'"  onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td class="offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>'+sFavCell+'</tr>';}}}}}else{navMenuContent+='<tr onmouseover="javascript:'+g_sMenuOver+'document.getElementById(\''+sElement+'0\').className=\'onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+'0\').className=\'offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell">&nbsp;</div></td><td class="offnavlinkrow" style="padding-right:5px;" id="'+sElement+'0">'+g_sNoSubDirs+'</td></tr>';}writeContextMenu(navMenuContent,"crumb-container"+sElement);var nHeightVal=22;var nAdjustHeightVal=0;if((UserAgent.match("Windows NT 6")||UserAgent.match("Windows NT 6.1"))&&!g_bSafariBrowser){if(!g_bFireFox3Browser&&!(navigator.userAgent.indexOf("Opera")>=0))nAdjustHeightVal=2;if(AW.opera)nHeightVal=22;else nHeightVal=23;}else if(AW.ie)nAdjustHeightVal=4;else if(g_bFireFox3Browser){if(nContainerSize<=5)nAdjustHeightVal=1;else if(nContainerSize<=10)nAdjustHeightVal=4;else if(nContainerSize<15)nAdjustHeightVal=6;}else if(AW.safari){nAdjustHeightVal=2;nHeightVal=23;}else if(AW.chrome){nHeightVal=23;nAdjustHeightVal=2;}else nAdjustHeightVal=6;if(nContainerSize<15){document.getElementById("crumb-container"+sElement).style.height=((nHeightVal*nContainerSize)+nAdjustHeightVal)+"px";document.getElementById("crumb-container"+sElement).style.overflowY="hidden";document.getElementById("crumb-container"+sElement).style.overflowX="hidden";}else{document.getElementById("crumb-container"+sElement).style.height="300px";document.getElementById("crumb-container"+sElement).style.overflowY="auto";document.getElementById("crumb-container"+sElement).style.overflowX="hidden";}sInnerImage='&nbsp;';var el=document;if(el.addEventListener){el.addEventListener("keydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}},true);}else if(el.attachEvent){el.attachEvent("onkeydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}});}else{el["onkeydown"]=function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}};}}function CreateRightClickMenu(asFunctions,asNames,asImages,asElement,sCookie,fLabelFunction,sUniqueID){var sImageClass="";ShowTextLabelOptions=function(e){var bRightClick;var ActionEvent=(window.event)?event:e;if(ActionEvent.which)bRightClick=(ActionEvent.which==3);else if(ActionEvent.button)bRightClick=(ActionEvent.button==2);if(bRightClick){var righClickMenuContent='';for(nIndex=0;(nIndex<asFunctions.length);nIndex++){if(asNames[nIndex]==g_sMenuDividers){righClickMenuContent+='<tr><td class="iconcolumn"><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td><td class="menuItemSep"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td></tr>';}else{if(asImages[nIndex]!=""){sImage='<img src="'+g_sImagePath+'spacer.gif" width="1" height="1">';if(typeof asImages[nIndex]=="function")sImageClass="-"+asImages[nIndex]();else sImageClass="-"+asImages[nIndex];}else{sImage='&nbsp;';sImageClass="";}if(typeof asNames[nIndex]=="function")sMenuItemName=asNames[nIndex]();else sMenuItemName=asNames[nIndex];if(sMenuItemName!="")righClickMenuContent+='<tr onclick="javascript:'+asFunctions[nIndex]+',\''+sCookie+'\','+fLabelFunction+');"  onmouseover="javascript:document.getElementById(\'contextitem'+asElement[0]+nIndex+'\').className=\'onnavlinkrow\'" onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\'contextitem'+asElement[0]+nIndex+'\').className=\'offnavlinkrow\'"><td class="iconcolumn"><div class="iconcell'+sImageClass+'">'+sImage+'</div></td><td class="offnavlinkrow" style="" id="contextitem'+asElement[0]+nIndex+'">'+sMenuItemName+'</td></tr>';}}writeContextMenu(righClickMenuContent,"RightClickMenu-"+sUniqueID);showContextMenu(ActionEvent,"RightClickMenu-"+sUniqueID,document.getElementById(asElement[0]),true,ActionEvent.clientX,ActionEvent.clientY);g_sActiveUniqueId="RightClickMenu-"+sUniqueID;}};for(nIndex=0;(nIndex<asElement.length);nIndex++){if(document.attachEvent){document.getElementById(asElement[nIndex]).attachEvent("onmousedown",ShowTextLabelOptions);}else{document.getElementById(asElement[nIndex]).addEventListener("mousedown",ShowTextLabelOptions,false);}}if(g_bIsPageLoaded)initMenu("RightClickMenu-"+sUniqueID);else{AddOnloadEvent(function(){initMenu("RightClickMenu-"+sUniqueID);});}}