AW.XML.SUObjectTable=AW.XML.Table.subclass();AW.XML.SUObjectTable.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(sXMLFile,nID,anColumns){_super.init.call(this);this.setURL(g_sAdminXMLPath+sXMLFile+SyncRequestParameter()+((nID>0)?"&ID="+nID:""));this.initTable(anColumns);};obj.initTable=function(anColumns){this.setRequestHeader("User-Agent","Serv-U");if((typeof g_sEncXsrfToken!=='undefined')&&(g_sEncXsrfToken!==null)&&(g_sEncXsrfToken!==""))this.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);if(anColumns)this.setColumns(anColumns);else this.setColumns(["@name","@val","@inherited","@type"]);};obj.GetCollectionByAttrib=function(sElement,sName,sValue){var sXPath="//"+sElement+"[@"+sName+"='"+sValue+"']";return(this.GetCollection(sXPath));};obj.GetCollection=function(sXPath){var aNodes;var XMLDoc=this.getXML();if(XMLDoc){if(typeof(document.createNSResolver)!='undefined')aNodes=this.SelectNodesFF(XMLDoc,sXPath);else aNodes=XMLDoc.selectNodes(sXPath);}return(aNodes);};obj.SelectNodesFF=function(oNode,sXPath){var aNodes=new Array();var XMLDoc=this.getXML();var oNSResolver=XMLDoc.createNSResolver(XMLDoc.documentElement);var aItems=XMLDoc.evaluate(sXPath,oNode,oNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0;i<aItems.snapshotLength;i++)aNodes[i]=aItems.snapshotItem(i);return(aNodes);};obj.GetNodeValue=function(oNode,sName){var sXPath="./@"+sName,sValue="";if(typeof(document.createNSResolver)!='undefined'){var aNodes=this.SelectNodesFF(oNode,sXPath);if(aNodes.length)sValue=aNodes[0].textContent;else sValue=undefined;}else{var SelectedNode=oNode.selectSingleNode(sXPath);if(SelectedNode)sValue=SelectedNode.text;else sValue=undefined;}return(sValue);};obj.FillForm=function(Form,sDialog,FocusElement,bHideLoadingDialog){if(Form!=undefined){if(bHideLoadingDialog!=true)LoadingDialog(true);Form.reset();this.setAsync(true);this.request();obj.fnResponse=this.response;this.response=function(sText){this.fnResponse(sText);for(var nIndex=0;(nIndex<Form.length);nIndex++){var Element=Form.elements[nIndex];if(Element!=undefined){var aNodes=this.GetCollectionByAttrib("var","name",this.FormatElementName(Element.name,true));if((aNodes!=undefined)&&(aNodes.length>0)){var sValue=this.GetNodeValue(aNodes[0],"val");var sDefaultValue=this.GetNodeValue(aNodes[0],"defaultval");var sIsDefault=this.GetNodeValue(aNodes[0],"default");var sType=this.GetNodeValue(aNodes[0],"type");if(sValue!=undefined){if(sDefaultValue!=undefined)Element.defaultValue=DecodeString(sDefaultValue);if((sType=="3")&&(sIsDefault=="1"))Element.value="";else Element.value=DecodeString(sValue);if(Element.onchange!=undefined)Element.onchange();}}}}if(sDialog!=undefined)ReplaceDialog(g_sBusyDialog,sDialog,this.m_fnDialogDismissal);if(FocusElement!=undefined){setTimeout(function(){FocusElement.getContent("box/text").element().focus();});}if(this.m_fnOnFillForm!=undefined)this.m_fnOnFillForm(this.m_OnFillFormObj,this);this.response=this.fnResponse;};}};obj.SubmitForm=function(Form,sDialog,fnCompleteCallback,bForceSavingDialog,fnSaveFailCallback){if(Form!=undefined){var bShowSaving=((sDialog!=undefined)&&(sDialog.length!=0));if(bShowSaving||bForceSavingDialog)SavingDialog(true);this.setRequestMethod("POST");for(var nIndex=0;(nIndex<Form.length);nIndex++){var Element=Form.elements[nIndex];if(Element!=undefined){this.setParameter(this.FormatElementName(Element.name),Element.value);}}this.request();if(bShowSaving||bForceSavingDialog){this.response=function(XMLDoc){var nResult=parseInt(XMLDoc.getElementsByTagName("result")[0].childNodes[0].nodeValue);var sResultText=XMLDoc.getElementsByTagName("ResultText")[0].childNodes[0].nodeValue;SavingDialog(false);if(nResult!=g_nSessionOkay){AlertDialog(GetResultText(0,"",sResultText),true);if(fnSaveFailCallback!=undefined){var nObjectID="";if(XMLDoc.getElementsByTagName("ObjectID")[0].childNodes[0]!=undefined)nObjectID=parseInt(XMLDoc.getElementsByTagName("ObjectID")[0].childNodes[0].nodeValue);fnSaveFailCallback(nObjectID);}}else{if(sDialog!=undefined)HideDialog(sDialog);if(fnCompleteCallback!=undefined){var nObjectID=parseInt(XMLDoc.getElementsByTagName("ObjectID")[0].childNodes[0].nodeValue);fnCompleteCallback(nObjectID);}}};}}};obj.FormatElementName=function(sName,bFillForm){var sRet=sName;if(bFillForm){if((sRet!=undefined)&&(sRet.lastIndexOf('_')>=0))sRet=sName.substr(sName.lastIndexOf('_')+1);}else{if((sRet!=undefined)&&(sRet.indexOf('_')>=0))sRet=sName.substr(sName.indexOf('_')+1);}return(sRet);};};