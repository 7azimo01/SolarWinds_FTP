var g_nTotalDirs=0;var g_nTotalFiles=0;var g_nTotalSize=0;var g_nTotalImages=0;var g_nTotalMedia=0;var g_nTotalAudio=0;var g_bAddingRow=false;var MaxScrollTop;var RowTarget;var CellTarget;var TopRowTG;var rightScroll;var bottomScroll;var g_sMovingfile=false;var g_sFileToMove;var g_bContextMenuActive=false;AW.Formats.Filesize=AW.System.Format.subclass();AW.Formats.Filesize.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);this.m_sShortcutSize1="18446744073709551615";this.m_sShortcutSize2="18446744073709552000";};obj.dataToText=function(data){if((data.toString()==this.m_sShortcutSize1)||(data.toString()==this.m_sShortcutSize2))return(FormatFileSize(0,false));else return(FormatFileSize(data,false));};obj.dataToValue=function(data){var nVal=parseInt(data);if((isNaN(nVal))||(data==this.m_sShortcutSize1)||(data==this.m_sShortcutSize2))return(0);else return(nVal);};obj.comparator=DefaultClientCompareDir;};AW.Formats.LocaleDate=AW.System.Format.subclass();AW.Formats.LocaleDate.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if((typeof(data)=="undefined")||(data==""))return("");else{if((AW.ie)&&(parseInt(navigator.appVersion)>=4))return(VBDateFormat(data,nTimeZoneOffset));else{return(FormatFileDate(data));}}};obj.dataToValue=function(data){var nVal=parseInt(data);if(isNaN(nVal))return(0);else return(nVal);};obj.comparator=DefaultClientCompareDir;};AW.Formats.BWCFileString=AW.Formats.XMLString.subclass();AW.Formats.BWCFileString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sLabel="";data=DecodeString(data);if((Grid!=undefined)&&(Grid.getCellValue(7,nRow))&&((sLabel=decodeURIComponent(Grid.getCellData(6,nRow)))!=""))return(FormatClientString(data,true)+" ("+sLabel+")");else return(FormatClientString(data,true));};obj.comparator=CompareDir;};AW.Formats.BWCSearchFileString=AW.Formats.XMLString.subclass();AW.Formats.BWCSearchFileString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sLabel="";data=DecodeString(data);if((Grid!=undefined)&&(Grid.getCellValue(7,nRow))&&((sLabel=decodeURIComponent(Grid.getCellData(6,nRow)))!=""))return(FormatClientString(data,true)+" ("+sLabel+")");else return(FormatClientString(data,true));};obj.dataToValue=function(data){return(data);};obj.comparator=CompareDir;};function CompareDir(values,greater,less,equal,error){return(function(i,j){try{var a=values[i];var b=values[j];var bIsNum=false;var nCompareResult;if(isNaN(a)&&isNaN(b)){a=a.toLocaleLowerCase();b=b.toLocaleLowerCase();nCompareResult=a.localeCompare(b);}else bIsNum=true;var nCompareType1=FilesList.getCellValue(4,i);var nCompareType2=FilesList.getCellValue(4,j);if(nCompareType1==nCompareType2){var ndir=NaturalSort(true,a,b,true);if(ndir>0){return greater}if(ndir<0){return less}return equal(i,j);}else{if(nCompareType1==1){return less}else{return greater}}}catch(e){return error(i,j,e);}});}function DefaultClientCompareDir(values,greater,less,equal,error){return(function(i,j){try{var a=values[i];var b=values[j];var bIsNum=false;var nCompareResult;if(isNaN(a)&&isNaN(b)){a=a.toLocaleLowerCase();b=b.toLocaleLowerCase();nCompareResult=a.localeCompare(b);}else bIsNum=true;var nCompareType1=FilesList.getCellValue(4,i);var nCompareType2=FilesList.getCellValue(4,j);if(!bIsNum){if(nCompareType1==nCompareType2){if(nCompareResult>0){return greater}if(nCompareResult<0){return less}return equal(i,j);}else{if(nCompareType1==1){return less}else{return greater}}}else{if(nCompareType1==nCompareType2){if(a>b){return greater}if(a<b){return less}return equal(i,j);}else{if(nCompareType1==1){return less}else{return greater}}}}catch(e){return error(i,j,e);}});}function GetDecodedDirPath(sDir){var sDecodedDir="";if(sDir!=undefined){sDecodedDir=sDir.replace(eval("/%2F/g"),"/");sDecodedDir=sDecodedDir.replace(eval("/%3A/g"),":");sDecodedDir=sDecodedDir.replace(eval("/%26/g"),"&");sDecodedDir=sDecodedDir.replace(eval("/%24/g"),"$");sDecodedDir=sDecodedDir.replace(eval("/%2C/g"),",");sDecodedDir=sDecodedDir.replace(eval("/%40/g"),"@");sDecodedDir=sDecodedDir.replace(eval("/%23/g"),"#");sDecodedDir=sDecodedDir.replace(eval("/%2B/g"),"+");sDecodedDir=sDecodedDir.replace(eval("/%3D/g"),"=");sDecodedDir=sDecodedDir.replace(eval("/%3B/g"),";");sDecodedDir=sDecodedDir.replace(eval("/&apos;/g"),"'");sDecodedDir=sDecodedDir.replace(eval("/&#x29;/g"),")");sDecodedDir=sDecodedDir.replace(eval("/&#x28;/g"),"(");sDecodedDir=sDecodedDir.replace(eval("/&#x22;/g"),"\"");sDecodedDir=sDecodedDir.replace(eval("/&lt;/g"),"\<");sDecodedDir=sDecodedDir.replace(eval("/&gt;/g"),"\>");try{sDecodedDir=decodeURI(sDecodedDir);}catch(e){try{sDecodedDir=sDecodedDir.replace(eval("/%/g"),"&#37;");sDecodedDir=decodeURI(sDecodedDir);sDecodedDir=sDecodedDir.replace(eval("/&#37;/g"),"%");}catch(e){console.error('e',e);AlertDialog('Operation was not completed.',undefined,undefined,bWebClientIcon);}}}return(sDecodedDir);}function GetFileImage(sFilename,nColumn,nRowIndex){var bIsDir=(parseInt(this.getCellValue(4,nRowIndex))==1||parseInt(this.getCellText(4,nRowIndex))==1)?true:false;var bIsDrive=(parseInt(this.getCellValue(7,nRowIndex))==1||parseInt(this.getCellText(7,nRowIndex))==1)?true:false;var bLowercase=false;if((bIsDir)||(bIsDrive)){if(g_bAddingRow==undefined||!g_bAddingRow)this.UpdateText("",1,nRowIndex);else this.setCellText("",1,nRowIndex);if(bIsDrive){var nDriveType=parseInt(this.getCellValue(8,nRowIndex));if(nDriveType==2){if((sFilename.toUpperCase()=="A:")||(sFilename.toUpperCase()=="B:"))return(GetDriveIcon(2));else return(GetDriveIcon(7));}else return(GetDriveIcon(nDriveType));}else return("DirExt");}else{try{if(g_bIsWebClient){bLowercase=true;}}catch(e){bLowercase=false;}return(GetFileIcon(sFilename.substr(sFilename.lastIndexOf(".")+1),bLowercase));}}function OnResetTotals(){g_nTotalFiles=0;g_nTotalDirs=0;g_nTotalSize=0;g_nTotalImages=0;g_nTotalMedia=0;g_nTotalAudio=0;document.getElementById("TotalFiles").innerHTML="0";document.getElementById("TotalDirs").innerHTML="0";document.getElementById("TotalSize").innerHTML="0";}function ScrollEvent(){FilesList.raiseEvent("adjustScrollBars");FilesList.raiseEvent("adjustScrollHeight");FilesList.setScrollTop(0);}function OnBrowseFileListContextMenu(){if(FilesList.getCellText(4,FilesList.getSelectedRows())==1)sMenuItemName="<strong>"+g_sOpen+"</strong>";else sMenuItemName="";return(sMenuItemName);}function OnBrowseFileListContextImages(){if(FilesList.getCellText(4,FilesList.getSelectedRows())==1)sImageClass="FileOpen";else sImageClass="";return(sImageClass);}function FormatFileDate(nDateinSeconds){var FileDate=new Date(parseInt(nDateinSeconds)*1000);return(FileDate.toLocaleString());}function BuildCrumbBar(sPath){var a_sPaths,sStartVal;sPath=decodeURIComponent(sPath);if(sPath.toUpperCase()=="/")a_sPaths=[""];else{if(sPath.substr(0,2)=="//"){sStartVal=sPath.substr(0,sPath.indexOf("/",2));sPath=sPath.substr(sPath.indexOf("/",2)+1);a_sPaths=sPath.split("/");a_sPaths.unshift(sStartVal);}else a_sPaths=sPath.split("/");}var sPathVal="";var sCrumbString="<div style='width:100%;'><table cellpadding='0' cellspacing='0' border='0' style='white-space:nowrap;'><tr>";var sCrumbContainer="";for(var i=0;i<a_sPaths.length;i++){sPathVal+=a_sPaths[i]+"/";var sOnGoToPath=String('OnOpenCrumb(\''+CleanPathByEscapeWithEncoding(sPathVal)+'\');');var sOnBuildCrumbListing=String('BuildCrumbListing(\''+CleanPathByEscapeWithEncoding(sPathVal)+'\', '+i+');');var sOnHideMenu=String('hideCrumbMenuSetUp('+i+')');sMenuFileMove=String('OnCrumbDropFile(\''+CleanPathByEscape(sPathVal)+'\');');var DialogElement;var bDivContainerExists=false;if(document.getElementById("crumb-container"+i)){bDivContainerExists=true;DialogElement=document.getElementById("crumb-container"+i);}else{DialogElement=document.createElement("div");DialogElement.id=("crumb-container"+i);}DialogElement.className="CrumbBarMenu";DialogElement.style.zIndex="9999";DialogElement.style.cursor="pointer";DialogElement.style.height="60px";if(a_sPaths[i]==""){a_sPaths[i]=g_sHomeStr;sFolderIco='';}else sFolderIco='<div class="crumbico foldercrumb"></div>';if(i<(a_sPaths.length-1)||(a_sPaths.length==1)){sCrumbString+='<td style="white-space:nowrap;" onmouseup="javascript:'+sMenuFileMove+'">'+sFolderIco+'<a  href="javascript:'+sOnGoToPath+'">'+SanitizeString(a_sPaths[i])+'</a><span id="crumb'+i+'" class=""><span class="crumbarrowico" onmouseup="javascript:'+sOnBuildCrumbListing+'"></span></span></td>';}else{sCrumbString+='<td style="white-space:nowrap;" onmouseup="javascript:'+sMenuFileMove+'">'+sFolderIco+'<a href="javascript:'+sOnGoToPath+'">'+SanitizeString(a_sPaths[i])+'</a><span id="crumb'+i+'" class=""><span class="crumbarrowico" onmouseup="javascript:'+sOnBuildCrumbListing+'"></span></span></td>';}sCrumbContainer='<div style="text-align:center;"><img src="'+g_sCommonPath+'Images/BusyGrid.gif" style="margin:0 auto 0 auto;"></div>';DialogElement.innerHTML=sCrumbContainer;if(!bDivContainerExists)document.getElementsByTagName("body")[0].appendChild(DialogElement);}sCrumbString+='</tr></table></div>';return(sCrumbString);}function BuildCrumbListing(sGoToPath,nID){if(parseInt(g_nActiveCrumbMenuId)!=parseInt(nID)){var sBuildCrumbListCmd="/?Command=List&DirsOnly=1&FilesOnly=0&Dir="+sGoToPath;var BuildCrumbListTable=new AW.XML.Table;var asDirNames=[],asDirPath=[],asIcons=[];var nContainerSize=0;g_bBlockCrumb=true;if(g_nActiveCrumbMenuId!=undefined)document.getElementById("crumb-container"+g_nActiveCrumbMenuId).style.visibility="hidden";document.getElementById("crumb-container"+nID).style.height="60px";document.getElementById("crumb-container"+nID).innerHTML='<div style="text-align:center;"><img src="'+g_sCommonPath+'Images/BusyGrid.gif" style="margin:0 auto 0 auto;"></div>';g_nActiveCrumbMenuId=nID;$("#crumb-container"+nID).bind('mouseenter',function(){$("body").unbind("mouseup");$(this).unbind("mouseup");});$("#crumb-container"+nID).bind("mouseleave",function(){$(this).unbind("mouseup");$("body").mouseup(function(){hideCrumbMenu(nID);$("body").unbind("mouseup");$("#crumb-container"+nID).unbind("mouseup");});});setTimeout(function(){$("body").mouseup(function(){hideCrumbMenu(nID);$("body").unbind("mouseup");$("#crumb-container"+nID).unbind("mouseup");});},0);showMenu(undefined,"crumb-container"+nID,"crumb"+nID,true);BuildCrumbListTable.setURL(sBuildCrumbListCmd);BuildCrumbListTable.setRows("//file");BuildCrumbListTable.setColumns(["FileName","FilePath","FileIsDir","FileIsDrive","FileDriveType"]);BuildCrumbListTable.response1=BuildCrumbListTable.response;BuildCrumbListTable.response=function(data){this.response1(data);var aCrumbArray=new Array();for(var nIndex=0;nIndex<this.getCount();nIndex++){var sFileName="";var sIcon="";if(parseInt(this.getData(2,nIndex))==1){sFileName=FormatClientString(this.getData(0,nIndex));asDirNames.push(sFileName);asDirPath.push(decodeURIComponent(this.getData(1,nIndex)));if(parseInt(this.getData(3,nIndex))==1){var nDriveType=parseInt(this.getData(4,nIndex));if(nDriveType==2){if((sFileName.toUpperCase()=="A:")||(sFileName.toUpperCase()=="B:")){sIcon=GetDriveIcon(2);}else{sIcon=GetDriveIcon(7);}}else{sIcon=GetDriveIcon(nDriveType);}}else{sIcon="DirShortcut";}aCrumbArray.push([sFileName,decodeURIComponent(this.getData(1,nIndex)),sIcon]);nContainerSize++}}aCrumbArray.sort(function(value1,value2){return(NaturalSort(true,value1[0],value2[0],(!g_bCaseSensitiveOS)));});setTimeout(function(){CreateCrumbMenu(aCrumbArray,nID,nContainerSize);},500);g_bBlockCrumb=false;};BuildCrumbListTable.request();}}function OnOpenCrumb(sPath,nHistory,bByPassHistory){if(g_nActiveCrumbMenuId!=undefined){$("body").unbind("mouseup");$("#crumb-container"+g_nActiveCrumbMenuId).unbind("mouseup");$("#crumb-container"+g_nActiveCrumbMenuId).unbind("mouseleave");hideCrumbMenu(g_nActiveCrumbMenuId);}if(bByPassHistory)g_bHistoryButtonUsed=true;if(nHistory!=undefined){g_HistoryPointer=nHistory;g_sLastIcon=g_aHistoryIcon[g_HistoryPointer];}OnFileOpen(true,SanitizeString(sPath),true);}function EncodeCharForXML(sPath){sRawFilePath=sPath;sRawFilePath=sRawFilePath.replace(new RegExp("'","g"),"%27");sRawFilePath=sRawFilePath.replace(new RegExp("[\(]","g"),"%28");sRawFilePath=sRawFilePath.replace(new RegExp("[\)]","g"),"%29");return(sRawFilePath);}function CreateDragandDrop(objGrid){objGrid.m_mouseCelldown=false;objGrid.m_DragStartRow=-1;objGrid.m_DropRow=-1;objGrid.m_DragCancelled=false;var g_nScrollZoneSize=0;objGrid.onControlMouseOut=function(event){this.m_mouseGridBlur=true;document.onmouseup=function(){objGrid.dragstop();};};objGrid.onControlMouseOver=function(event){this.m_mouseGridBlur=false;document.onmouseup=function(){return(false);};};objGrid.dragCancel=function(e){this.m_DragCancelled=true;objGrid.dragstop();};objGrid.onCellMouseDown=function(e,column,row){var bRightClick;var ActionEvent=(window.event)?event:e;var el=document;this.m_DragCancelled=false;if(ActionEvent.which)bRightClick=(ActionEvent.which==3);else if(ActionEvent.button)bRightClick=(ActionEvent.button==2);if(el.attachEvent){el.attachEvent("onkeydown",this.dragCancel);}else if(el.addEventListener){el.addEventListener("keydown",this.dragCancel,true);}else{el["onkeydown"]=this.dragCancel;}if(!bRightClick&&!g_bContextMenuActive){var FeedbackRow=document.getElementById('FeedbackRow');if(FeedbackRow&&(objGrid.m_DragStartRow==objGrid.getSelectedRows()))FeedbackRow.parentNode.removeChild(FeedbackRow);this.m_DragStartRow=-1;this.m_DropRow=-1;dragRowStart(row);this.dragstart(e,column,row);}else objGrid.dragstop();};objGrid.onCellMouseUp=function(event,column,row){this.dragstop(column,row);};objGrid.defineRowProperty("background",function(nRow){if(parseInt(this.getCellData(4,nRow)))return("#ebf3fd url(%COMMON_FILE%/Images/FileList-Hover.png");else return("#fff");});objGrid.onCellMouseOver=function(event,column,row){if(parseInt(this.getCellData(4,row))&&this.m_mouseCelldown)this.getRowTemplate(row).setClass("highlightit","ON");else if(!this.m_mouseCelldown)this.getRowTemplate(row).setClass("highlightit","ON");objGrid.onControlMouseUp=function(event){this.m_mouseGridBlur=false;return(false);};};objGrid.onCellMouseOut=function(event,column,row){this.getRowTemplate(row).setClass("highlightit","OFF");objGrid.onControlMouseUp=function(event){this.m_mouseGridBlur=false;objGrid.dragstop();};};objGrid.dragstart=function(e,column,row){this.m_DragStartRow=row;g_sMovingfile=true;g_sFileToMove=this.getCellText(0,row);MaxScrollTop=this.getScrollHeight()-document.getElementById(this.getId()).offsetHeight+18;};objGrid.dragstop=function(column,row,sCrumbFilePath){this.m_mouseCelldown=false;this.m_DropRow=row;if(!this.m_DragCancelled){if(sCrumbFilePath)ConfirmMoveFile(sCrumbFilePath,this.m_DragStartRow,undefined,true);else if(this.m_DragStartRow>-1&&this.m_DropRow>-1&&(this.m_DragStartRow!=this.m_DropRow))ConfirmMoveFile(this.getCellText(3,row),this.m_DragStartRow,this.m_DropRow,true);}g_sMovingfile=false;g_sFileToMove=undefined;var FeedbackRow=document.getElementById('FeedbackRow');if(FeedbackRow)FeedbackRow.parentNode.removeChild(FeedbackRow);CellTarget=undefined;this.m_DragStartRow=-1;this.m_DropRow=-1;var el=document;if(el.detachEvent){el.detachEvent("onkeydown",this.dragCancel);}else if(el.removeEventListener){el.removeEventListener("keydown",this.dragCancel,true);}else{el["onkeydown"]=null;}g_nScrollZoneSize=0;};var dragRowStart=function(row){CellTarget=document.getElementById("ListFiles-cell-0-"+row+"-box-text");if(CellTarget){var sECId=CellTarget.id;if(sECId.indexOf("-box-text")>0)RowTarget=CellTarget.parentNode.parentNode;else RowTarget=CellTarget.parentNode;rightScroll=objGrid.getScrollLeft();bottomScroll=objGrid.getScrollTop();TopRowTG=RowTarget.parentNode.firstChild;RowTarget.width=parseInt(RowTarget.offsetWidth)+"px";RowTarget.height=parseInt(RowTarget.offsetHeight)+"px";objGrid.m_mouseCelldown=true;}};var dragRowMouseMove=function(e){var NewFeedbackRowTop=0;var NewFeedbackRowLeft=0;var Event=((AW.ie)?event:e);bottomScroll=objGrid.getScrollTop();var nScrollTop=document.body.scrollTop;if(nScrollTop==0){if(window.pageYOffset)nScrollTop=window.pageYOffset;else nScrollTop=(document.body.parentElement)?document.body.parentElement.scrollTop:0;}if(!AW.ie){var x=Event.pageX;var y=Event.pageY;}else{var x=Event.clientX;var y=Event.clientY;}var FeedbackRow=document.getElementById('FeedbackRow');if(FeedbackRow&&objGrid.m_mouseCelldown){if(AW.ie){if(nScrollTop>0)y+=nScrollTop;NewFeedbackRowLeft=x+8;NewFeedbackRowTop=y-3;}if(!AW.ie){if(rightScroll==0)NewFeedbackRowLeft=x+15;else NewFeedbackRowLeft=x+15;if(bottomScroll==0)NewFeedbackRowTop=y;else NewFeedbackRowTop=y;}FeedbackRow.style.top=parseInt(NewFeedbackRowTop)+"px";FeedbackRow.style.left=parseInt(NewFeedbackRowLeft)+"px";FeedbackRow.style.display="";}else if(objGrid.m_mouseCelldown){var FeedbackRow=RowTarget.cloneNode(true);FeedbackRow.id="FeedbackRow";FeedbackRow.style.position="absolute";FeedbackRow.style.width=RowTarget.width;FeedbackRow.style.height=RowTarget.height;FeedbackRow.style.zIndex=1000000;FeedbackRow.style.MozOpacity=0.7;FeedbackRow.style.filter="alpha(opacity=70)";FeedbackRow.style.whiteSpace="nowrap";FeedbackRow.style.textOverflow="ellipsis";FeedbackRow.style.overflow="visible";FeedbackRow.style.display="none";FeedbackRow.firstChild.style.overflow="visible";document.getElementsByTagName("body")[0].appendChild(FeedbackRow);}if(objGrid.m_mouseCelldown){var GridHeight=parseInt(document.getElementById(objGrid.getId()).style.height)<=200?200:parseInt(document.getElementById(objGrid.getId()).style.height);var ScrollZoneSize=g_nScrollZoneSize;var NewScrollTop;var nHeadHeight=$("#ListFilesContainer").offset().top;if((NewFeedbackRowTop)<(nHeadHeight+((ScrollZoneSize*2)))&&(objGrid.getScrollTop()>0)){NewScrollTop=(objGrid.getScrollTop()-ScrollZoneSize);if(NewScrollTop<0)NewScrollTop=0;objGrid.setScrollTop(NewScrollTop);}if(NewFeedbackRowTop>((GridHeight+nHeadHeight)-ScrollZoneSize)){NewScrollTop=objGrid.getScrollTop()+ScrollZoneSize;if(objGrid.getScrollTop()<(MaxScrollTop-18)){objGrid.raiseEvent("adjustScrollBars");objGrid.raiseEvent("adjustScrollHeight");objGrid.setScrollTop(NewScrollTop);objGrid.element().focus();}}g_nScrollZoneSize=18;}};document.onmousemove=dragRowMouseMove;}function OnCrumbDropFile(sToFilePath){if(g_sMovingfile)FilesList.dragstop(undefined,undefined,sToFilePath);}function ConfirmMoveFile(sToFilePath,nMoveRow,nDropRow,bWebClientIcon){var bIsDir=true;var bIsDrive=false;var sNewPath=sToFilePath+"/"+g_sFileToMove;var sOriginalPath=decodeURIComponent(g_sCurrentDir)+"/"+g_sFileToMove;var bMoveFile=(sNewPath!=sOriginalPath)?true:false;if(nDropRow!=undefined)bIsDir=parseInt(FilesList.getCellValue(4,nDropRow))?true:false;if(nMoveRow!=undefined)bIsDrive=parseInt(FilesList.getCellValue(7,nMoveRow))?true:false;if(bIsDir&&!bIsDrive&&bMoveFile)ConfirmDialog(g_sConfirmMoveFileFrom+"\""+g_sFileToMove+"\""+g_sTo+"\""+sToFilePath+"\""+"?",MoveFile,undefined,[sToFilePath,g_sFileToMove,nMoveRow,nDropRow],500,undefined,undefined,bWebClientIcon);else if(!bMoveFile)AlertDialog(g_sCannotMoveFile,undefined,undefined,bWebClientIcon);}function MoveFile(asFileMovePaths){var sMoveCmd="/?Command=Rename&Dir="+g_sCurrentDir;var sToFilePath=asFileMovePaths[0];var sFileMoving=asFileMovePaths[1];var nDragRow=asFileMovePaths[2];var nDropRow=asFileMovePaths[3];var MoveRequest=CreatePostRequest(sMoveCmd);var sNewPath=GetDecodedDirPath(sToFilePath)+"/"+GetDecodedDirPath(sFileMoving);var sOriginalPath=GetDecodedDirPath(g_sCurrentDir)+"/"+GetDecodedDirPath(sFileMoving);sNewPath=sNewPath.replace(new RegExp("&amp;","g"),"&");sOriginalPath=sOriginalPath.replace(new RegExp("&amp;","g"),"&");MoveRequest.setParameter("new_path",sNewPath);MoveRequest.setParameter("original_path",sOriginalPath);MoveRequest.setAsync(true);MoveRequest.request();MoveRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay){AlertDialog(GetResultText(nResult,"",sResultText));}else{if(nDropRow!=undefined)FilesList.setSelectedRows([nDropRow]);if(nDragRow!=undefined)FilesList.deleteRow(nDragRow);}};}function OnHistoryDelay(){HistoryDelayId=setTimeout(function(){OnShowHistory();},1500);}function OnHistoryDelayCancel(){clearTimeout(HistoryDelayId);}