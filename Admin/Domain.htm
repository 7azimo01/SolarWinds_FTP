<!--#include "Strings\Strings.strings"-->
<!--#include "..\Common\Strings\Strings.strings"-->
%PRIV_DOMAIN_ADMIN%<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"/><script type="text/javascript" language="javascript">if(%IS_LOCAL_ADMIN%)sTitleText="$DOMAIN_DETAILS$";else sTitleText="%PRODUCT% - $DOMAIN_DETAILS$";document.write("<title>"+sTitleText+"</title>");</script>%PAGE_CHANGE%<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script type="text/javascript" language="javascript">var g_bSecurityAlertTriggered=%SECURITY_ALERT_TRIGGERED%;var g_bServerIdentityAlertTriggered=%SERVER_IDENTITY_ALERT_TRIGGERED%;var g_bIsWebClient=false;var g_nShowList;var g_bLinkRequested=false;var g_sFontOverride="$FONT_OVERRIDE$";var g_bTreeNavVisible=false;var bTreeLoaded=false;var NavigationTree;var g_nServerSection="";var g_sTreeURL;var g_nTreeHeight=350;var g_bTreeRoot=false;var tree=new Array();var g_aHistory=new Array();var g_aHistoryNames=new Array();var g_aHistoryIcon=new Array();var g_aHistoryActive=new Array();var g_HistoryPointer=0;var g_sLastIcon="";var g_bHistoryButtonUsed=false;var g_bIslocalAdminBrowser=false;var g_sCannotMoveFile="$DRAG_DROP_CANNOT_MOVE_FILE$";var g_sConfirmMoveFileFrom="$CONFIRM_MOVE_FILE_FROM$ ";var g_sTo=" $TO$ ";var g_bCaseSensitiveOS=(%CASE_SENSITIVE_OS%==1);var g_bIsiPad=false;var sUserAgentCheck=navigator.userAgent.toLowerCase();var g_bSupportsMSMQ=("%SUPPORTS_MSMQ%"!="0");var g_bMSMQLicense=("%CServer.%SERVER_ID%.MSMQLicense%"!="0");var g_bSupportWinEventLog=("%SUPPORTS_WINDOWS_EVENT_LOG%"!="0");var g_bIsDemo=(%IS_DEMO%==1);var g_bLoginUser=false;var g_nDaysRemaining=parseInt("%CServer.%SERVER_ID%.LicenseDaysRemaining%");var g_bLicenseIsTemp=(%CServer.%SERVER_ID%.LicenseIsTemp%==1);var g_bLicenseIsPastTrial=(%CServer.%SERVER_ID%.LicenseIsPastTrial%==1);var g_bIsModEvalExp=(%IS_MODIFIED_EVAL_EXP%==1);var g_sTrialExpiredTxt="$TRIAL_IS_EXPIRED$";var g_sTrialExpiresInTxt="$TRIAL_EXPIRES_IN$";var g_sTrialExpiresDaysTxt="$DAYS$";var g_sBuyNow="$BUY_NOW$";var g_bIsAdminAllowedToAddUsers=(parseInt("%IS_ADMIN_ALLOWED_TO_ADD_USERS%")!=0);var g_sDomainName="%CDomain.%ID%.DomainName%";var g_JumpToPage=0;if(%IS_LOCAL_ADMIN%){g_bIslocalAdminBrowser=true;}if(sUserAgentCheck.indexOf('ipad')!=-1)g_bIsiPad=true;var g_sEncXsrfToken="%ENC_CSRF_TOKEN%";</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BrowserCheckAW.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-ui.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-contextMenu.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mousewheel.min.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mCustomScrollbar.min.js"></script><link type="text/css" href="%COMMON_FILE%Style/Fonts.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Dialog.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Common.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/global.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery.mCustomScrollbar.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-ui.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-contextMenu.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/nav.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonHeader.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonUI.css" rel="stylesheet" /><script type="text/javascript" language="javascript">if(AW.ff3){AW.getLeft=function(element){return element.getBoundingClientRect().left-document.documentElement.getBoundingClientRect().left;};AW.getTop=function(element){return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(g_bSafariBrowser){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top-4;};}if(AW.chrome){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top+4;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1){document.write('<style type="text/css">');document.write('body,table{');document.write(' font-size:11px;font-family: Helvetica Arial sans-serif;');document.write('}');document.write('</style>');}var g_sMenuDividers="--***--";var g_sImagePath="%COMMON_FILE%Images/";var g_sCommonPath="%COMMON_FILE%";var g_sFilePath="%ADMIN_FILE%";var g_sHelpPath="%HELP_BASE_URL%";var g_sConsoleInclude="0";var g_bDomainNav=true;var g_sAdminXMLPath="%ADMIN_FILE%XML/";var g_sUseInherited="$USE_INHERITED$";var g_bIE7=true;var g_bIEDomainCheck=true;var g_sLoading="$LOADING_DIALOG_TITLE$";var g_sSelectDomainMsg='$SELECT_DOMAIN_MSG$';var g_nDomainID;var g_sHelpPage="Help-Overview.htm";var g_sHelpNode="none";var g_sCurrentURLFileName="%INTERNAL_FILE%";var g_nSessionOkay=0;var g_nPermissionDenied=3;var g_nULLMax=18446744073709551615;var g_sGB="$FS_ABBREV_GIGABYTE$";var g_sMB="$FS_ABBREV_MEGABYTE$";var g_sKB="$FS_ABBREV_KILOBYTE$";var g_sBytes="$FS_BYTES$";var g_bFVJVLaunchPage=false;var g_sUnknownError="$UNKNOWN_ERROR$";var g_sHomeStr="$HOME$";var g_ActiveTab;var g_ActivePage;var g_bODBC64BitWarn=(%CServer.%SERVER_ID%.WarnODBC64BitUpgrade%==1);var g_bAllowChangePassword=%CAN_CHANGE_PASSWORD%;var g_bAllowChangeEmail=%USER_CAN_SET_EMAIL_ADDRESS%;var g_sUserEmail=HTMLDecode("%USER_EMAIL_ADDRESS%");var g_bSysAdmin=(%CUser.%USER_ID%.AdminType%==2||%CUser.%USER_ID%.AdminType%==4);var g_bGroupAdmin=(%CUser.%USER_ID%.AdminType%==5||%CUser.%USER_ID%.AdminType%==6);var g_bDomainAdmin=((%CUser.%USER_ID%.AdminType%==1)||(%CUser.%USER_ID%.AdminType%==3));var g_bReadOnlyAccess=(%CUser.%USER_ID%.AdminType%==3||%CUser.%USER_ID%.AdminType%==4||%CUser.%USER_ID%.AdminType%==6);var g_bAllowWebClient=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bFVJVLicense=(%CServer.%SERVER_ID%.AllowFVJV%==1);var g_bAllowFVJV=(%ALLOW_FTP_VOYAGER_JV%==1);var g_bWebClientLicense=(%CServer.%SERVER_ID%.WebClientLicense%==1);var g_sFVJVLicenseInfo="$FVJV_LICENSE_INFO$";var g_sWebClienLicenseInfo="$WEB_CLIENT_LICENSE_INFO$";var g_sLicenseEmail="%CServer.%SERVER_ID%.LicenseEMail%";var g_bUsingFIPS=(%CServer.%SERVER_ID%.UsingFIPS%==1);var g_sWebFilePath=%FILE%;var g_bAllowAdhocFileSharing=(%ALLOW_ADHOC_FILE_SHARING%==1);var g_bFileSharingLicense=(%CServer.%SERVER_ID%.FileSharingLicense%==1);var g_sAdhocFileShareLicenseInfo="$ADHOC_LICENSE_INFO$";if(!g_bSysAdmin)g_nDomainID=%DOMAIN_ID%;setTimeout("OnSendNOOP()",55000);</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Menus.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/InitialScript.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/utility.js"></script><script type="text/javascript" language="javascript">function RecommendAdminIEUpgrade(){if(g_bIslocalAdminBrowser){var bRecommendIEUpgrade=false;var nVersion=0;if(navigator.appVersion.indexOf("MSIE")!=-1){aTemp=navigator.appVersion.split("MSIE");nVersion=parseFloat(aTemp[1]);}if(nVersion>5.5&&nVersion<8)bRecommendIEUpgrade=(%WARN_OLD_BROWSER%!=0);if(navigator.userAgent.indexOf("MSIE")!=-1){var nVersionIndex=(navigator.userAgent.indexOf("MSIE")+5);var nVersionIE=parseInt(navigator.userAgent.charAt(nVersionIndex));if(nVersionIE>=8)bRecommendIEUpgrade=false;else if((navigator.userAgent.indexOf("compatible")!=-1)&&(nVersionIE>=8))bRecommendIEUpgrade=false;}if(bRecommendIEUpgrade)window.location.href="%FILE%AdminIEWarning.htm";}}</script><div id="ChangePasswordDialoginner" style="display:none;"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;"><div>$OLD_PASSWORD$:<div style="overflow:auto"><span id="OldPasswordChange"></span></div></div><div>$NEW_PASSWORD$:<br /><div style="overflow:auto"><span id="NewPasswordChange"></span></div></div><div>$VERIFY_PASSWORD$:<div style="overflow:auto"><span id="VerifyNewPasswordChange"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"></span><br /><span id="CancelChangePasswordButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var sWebClientChangePWord=undefined;var sChangePWordImg=undefined;try{if(g_bIsWebClient){sWebClientChangePWord="WC-Icon-ChangePassword";}else{sChangePWordImg="Change_Password16.png";}}catch(e){sChangePWordImg="Change_Password16.png";}BuildDialog("$CHANGE_PASSWORD_TITLE$","ChangePasswordDialog","300","155","","$CLOSE_CANCEL$",sChangePWordImg,undefined,sWebClientChangePWord);function OnChangePasswordSubmit(){var sChangePasswordCmd="%FILE%Login.xml?Command=LoginChangePassword";var ChangePasswordRequest=CreatePostRequest(sChangePasswordCmd);var sOldPassWord,sNewPassWord,sVerifyPassWord;sOldPassWord=OldPasswordInput.getControlText();sNewPassWord=NewPasswordInput.getControlText();sVerifyPassWord=VerifyNewPasswordInput.getControlText();if(sNewPassWord==sVerifyPassWord){ChangePasswordRequest.setParameter("old_password",sOldPassWord);ChangePasswordRequest.setParameter("new_password",sNewPassWord);ChangePasswordRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);ChangePasswordRequest.setAsync(true);ChangePasswordRequest.request();ChangePasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sWelcomeMsg=GetXMLValue(XMLDoc,"welcomemsg");if(nResult!=0){if(nResult==1)sResultText="$ERROR_PASSWORD_CHANGE_FAIL$";AlertDialog(GetResultText(0,"",sResultText));}else if(g_bLoginUser){ReplaceDialog("ChangePasswordDialog","LoggingInDialog");OnLoginOK(false,nResult,XMLDoc);}else{HideDialog('ChangePasswordDialog');AlertDialog("$PASSWORD_CHANGED$");}};}else{AlertDialog("$PASSWORDS_DONT_MATCH$",true);}}function OnCancelChangePassword(){HideDialog('ChangePasswordDialog');location.href="%LOGOUT%";}function ClearPasswordDialog(){OldPasswordInput.setControlText("");NewPasswordInput.setControlText("");VerifyNewPasswordInput.setControlText("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");OldPasswordInput.getContent("box/text").element().focus();if(bLogin){CancelPasswordButton.setControlText("$LOGOUT$");document.getElementById("ChangePasswordDialogCloseIcon").onmousedown=OnCancelChangePassword;}}CreateDialogPushButton("$OK_BUTTON$","ChangePasswordButton",OnChangePasswordSubmit);var CancelPasswordButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelChangePasswordButton",OnCancelChangePassword);var OldPasswordInput=CreatePasswordField("","OldPasswordChange","OldPasswordChange",undefined,200);var NewPasswordInput=CreatePasswordField("","NewPasswordChange","NewPasswordChange",undefined,200);var VerifyNewPasswordInput=CreatePasswordField("","VerifyNewPasswordChange","VerifyNewPasswordChange",undefined,200);</script><div id="UserEmailDialoginner" style="display:none;"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;">$EMAIL_DESCR$ <br /><div style="margin-top:5px;">$EMAIL$:<br /><div style="overflow:auto"><span id="CurrentUserEmail"></span></div></div><div>$VERIFY_EMAIL$:<br /><div style="overflow:auto"><span id="UserEmail"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"></span><br /><span id="LogoutUserEmailButton"></span><span id="CancelUserEmailButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sWebClientChangeEmail=undefined;var sChangeEmailImg=undefined;try{if(g_bIsWebClient){sWebClientChangeEmail="WC-Icon-ChangeEmail";}else{sChangeEmailImg="ChangeEmail.png";}}catch(e){sChangeEmailImg="ChangeEmail.png";}BuildDialog("$USER_EMAIL_TITLE$","UserEmailDialog","300","160","","$CLOSE_CANCEL$",sChangeEmailImg,undefined,sWebClientChangeEmail);function OnSetEmailAddressSubmit(){var sSetEmailCmd="%FILE%Result.xml?Command=SetEmailAddress";var SetEmailRequest=CreatePostRequest(sSetEmailCmd);var sEmailAddrs,CurrentEmailAddr;sEmailAddr=UserEmailInput.getControlText();sCurrentEmailAddr=CurrentUserEmail.getControlText();SetEmailRequest.setParameter("emailaddress",sEmailAddr);SetEmailRequest.setAsync(true);if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.request();else AlertDialog("$EMAIL_VALS_NO_MATCH$");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{HideDialog('UserEmailDialog');if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnCancelSetEmail(){HideDialog('UserEmailDialog');}function ClearSetEmailDialog(){UserEmailInput.setControlText("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(bNoCloseButton){var DialogCloseContainer=document.getElementById("UserEmailDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("UserEmailDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";CancelEmailButton.setStyle("display","none");LogoutUserEmailButton.setStyle("display","");}else{LogoutUserEmailButton.setStyle("display","none");}if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)CurrentUserEmail.setControlText(sEmail);else ClearSetEmailDialog();ShowDialog("UserEmailDialog");CurrentUserEmail.getContent("box/text").element().focus();}function OnLogoutEmailSet(){location.href="%LOGOUT%";}CreateDialogPushButton("$OK_BUTTON$","SaveUserEmailButton",OnSetEmailAddressSubmit);var CancelEmailButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelUserEmailButton",OnCancelSetEmail);var LogoutUserEmailButton=CreateDialogPushButton("$LOGOUT$","LogoutUserEmailButton",OnLogoutEmailSet);var UserEmailInput=CreateInputField("","UserEmail","UserEmail",undefined,200,undefined,undefined,OnSetEmailAddressSubmit);var CurrentUserEmail=CreateInputField("","CurrentUserEmail","CurrentUserEmail",undefined,200,undefined,undefined);</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_sBusyDialog="BusyDialog";function BusyDialog(bShow,sTitle,bWebClientIcon,bFromApplet){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top!="-5000px")bSkip=true;if(!bSkip){if(bShow)ShowDialog(g_sBusyDialog,undefined,undefined,bFromApplet);else{HideDialog(g_sBusyDialog,undefined,bFromApplet);sTitle="$BUSY_DIALOG_TITLE$";}SetupBusyDialog(sTitle,bWebClientIcon);}}function SetupBusyDialog(sTitle,bWebClientIcon){var TitleText=document.getElementById("BusyDialogTitleText");var sBusyDialogImage="su16x16.png";MCBusyDialogImage=new Image();MCBusyDialogImage.src="%COMMON_FILE%Images/su16x16.png";WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bWebClientIcon)document.getElementById("BusyDialogTitleIcon").src=WCBusyDialogImage.src;else document.getElementById("BusyDialogTitleIcon").src=MCBusyDialogImage.src;if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML="<strong>"+sTitle+"</strong>";var DialogCloseContainer=document.getElementById("BusyDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("BusyDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";}function SavingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$SAVING_DIALOG_TITLE$",bWebClientIcon);}function LoadingDialog(bShow,bWebClientIcon){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top=="-5000px")bSkip=true;if(!bSkip)BusyDialog(bShow,"$LOADING_DIALOG_TITLE$",bWebClientIcon);}function DeletingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$DELETING_DIALOG_TITLE$",bWebClientIcon);}</script><div id="BusyDialoginner" style="display:none;text-align:center;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" style="margin:0px auto 0px auto;"></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("$BUSY_DIALOG_TITLE$","BusyDialog","200","50","text-align:center","$CLOSE_CANCEL$");</script><div id="AlertDialoginner" style="display:none;"><table border="0"><tr><td style="vertical-align:top;"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px"></td><td style="text-align:left; padding-right: 10px"><span id="AlertDialogText" style="word-break: break-word; -ms-word-break: break-word; display: inline-block"></span><div id="AlertNoShowContainer" style="display:none;padding-top:10px;"><span id="AlertNoShowDialogCheckBox"></span></div></td></tr></table><div style="width:100%;text-align:center;"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></div><!--tr><td colspan="2" style="text-align:center"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></td></tr></table--></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var ExtraButton,g_bAlertNoShow,g_sAlertNoShowCookie;InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";BuildDialog("%PRODUCT%","AlertDialog","250","115","text-align:center","$CLOSE_CANCEL$");function AlertDialog(sText,bWarn,fn_OKCallback,bWebClientIcon,sExtraButtonText,fn_ExtraCallback,nWidth,nHeight,bAlertNoShow,sAlertNoShowCookie){WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";g_bAlertNoShow=false;g_sAlertNoShowCookie="";document.getElementById("AlertNoShowContainer").style.display="none";if(bWebClientIcon){document.getElementById("AlertDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("AlertDialogTitleIcon").height="16";document.getElementById("AlertDialogTitleIcon").width="16";}if((sExtraButtonText!=undefined)&&(fn_ExtraCallback!=undefined)){ExtraButton=CreatePushButton(sExtraButtonText,"ExtraButton",function(){HideDialog("AlertDialog");fn_ExtraCallback();});document.getElementById("ExtraButton").style.display="";}else{document.getElementById("ExtraButton").style.display="none";ExtraButton=undefined;fn_ExtraCallback=undefined;}if(nWidth!=undefined){document.getElementById("AlertDialog").style.width=nWidth+"px";}else document.getElementById("AlertDialog").style.width="250px";if(bAlertNoShow&&sAlertNoShowCookie!=undefined){g_bAlertNoShow=true;g_sAlertNoShowCookie=sAlertNoShowCookie;document.getElementById("AlertNoShowContainer").style.display="block";}g_fnAlertOKCallback=fn_OKCallback;if(document.getElementById("AlertImage")!=undefined){if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;document.getElementById("AlertImage").src=sImage;}if((document.getElementById("AlertDialogText")!=undefined)&&(sText!=undefined))document.getElementById("AlertDialogText").innerHTML=sText;ShowDialog("AlertDialog");OKAlertButton.focus();}function WarnDialog(sText,bWebClientIcon){AlertDialog(sText,true,undefined,bWebClientIcon);}function OnAlertDialogOkay(){HideDialog("AlertDialog");if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();document.getElementById("AlertImage").src=BlankImg.src;g_fnAlertOKCallback=undefined;if(g_bAlertNoShow){if(AlertNoShowCheckBox.getControlValue())createCookie(g_sAlertNoShowCookie,"1",60);}}var OKAlertButton=CreatePushButton("$OK_BUTTON$","AlertDialogOkButton",OnAlertDialogOkay);var AlertNoShowCheckBox=CreateCheckBox("$DONT_SHOW_AGAIN$","AlertNoShowDialogCheckBox","AlertNoShowCheckBox");</script><div id="ConfirmDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"><table border="0" id="ConfirmDialogtable"><tr><td><img src="%COMMON_FILE%Images/QuestionMark.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div id="ConfirmDialogText" style="width:200px;overflow-y:visible;overflow-x:auto;text-align:left;padding-left:2px;"></div></td></tr><tr><td colspan="2" style="text-align:center" id="ConfirmDialogbuttons"><span id="ConfirmDialogYesButton"></span><span id="ConfirmDialogNoButton"></span></td></tr></table></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("%PRODUCT%","ConfirmDialog","250","115","text-align:center","$CLOSE_CANCEL$");var g_sDeletingDialogTitle="$DELETING_DIALOG_TITLE$";var g_sConfirmDialog="ConfirmDialog";var g_fnYes=undefined,g_fnNo=undefined;var g_YesNoData=undefined;var g_bNoCloseDialog=false;var DEFAULT_CONFIRM_DIALOG_SIZE={WIDTH:"250px",HEIGHT:"115px"};function ConfirmDialog(sText,fnYes,fnNo,YesNoData,nWidth,nHeight,bDelete,bWebClientIcon,bNoCloseDialog,fnClose){var confirmDialog=document.getElementById("ConfirmDialog");var confirmDialogText=document.getElementById("ConfirmDialogText");var confirmDialogIcon=document.getElementById("ConfirmDialogTitleIcon");var dialogSize=getDialogSize(nWidth,nHeight);g_fnYes=g_fnNo=undefined;WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bNoCloseDialog)g_bNoCloseDialog=true;else g_bNoCloseDialog=false;if(bWebClientIcon){confirmDialogIcon.src=WCBusyDialogImage.src;confirmDialogIcon.height="16";confirmDialogIcon.width="16";}if((confirmDialogText!=undefined)&&(sText!=undefined)){confirmDialogText.innerHTML=sText;}g_fnYes=fnYes;g_fnNo=fnNo;g_YesNoData=YesNoData;confirmDialog.style.width=dialogSize.width;confirmDialogText.style.width=(parseInt(dialogSize.width)-50)+"px";document.getElementById("ConfirmDialogBody").style.overflow="hidden";document.getElementById("ConfirmDialogBody").style.textOverflow="ellipsis";ShowDialog("ConfirmDialog",undefined,fnClose);if(bDelete)ConfirmDialogNoButton.focus();else ConfirmDialogYesButton.focus();}function getDialogSize(customWidth,customHeight){var dialogWidth=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;var dialogHeight=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;if(!!customWidth){dialogWidth=isWithUnits(customWidth)?customWidth:customWidth+"px";}if(!!customHeight){dialogHeight=isWithUnits(customHeight)?customHeight:customHeight+"px";}return{width:dialogWidth,height:dialogHeight};}function isWithUnits(size){return size.toString().match(/px|%|vh|vw|em|rem/);}function CloseConfirmDialog(){HideDialog("ConfirmDialog");}function OnConfirmDialogYes(){if(g_fnYes!=undefined){setTimeout(function(){g_fnYes(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}if(!g_bNoCloseDialog)CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined){setTimeout(function(){g_fnNo(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}CloseConfirmDialog();}var ConfirmDialogYesButton=CreatePushButton("$YES_BUTTON$","ConfirmDialogYesButton",OnConfirmDialogYes);ConfirmDialogYesButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogYesButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogNoButton.focus();}});var ConfirmDialogNoButton=CreatePushButton("$NO_BUTTON$","ConfirmDialogNoButton",OnConfirmDialogNo);ConfirmDialogNoButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogNoButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogYesButton.focus();}});</script><div id="TopPntToolTipDialog" style="width:220px;height:180px;" class="DialogLayer"><table id="TopPntToolTipDialogTitleBar" class="ToolTipDialogTitle" cellpadding="0" cellspacing="0"><tr><td colspan="3" class="TopPointer">&nbsp;</td></tr><tr><td class="ToolTipLeftCorner"><img src="%COMMON_FILE%Images/tooltip-left-top.png" width="27" height="23" border="0"></td><td class="TopPntToolTipHeadContainer"><div id="TopPntToolTipDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:5px;"><span id="TopPntToolTipDialogTitleText" style="font-weight:bold;">&nbsp;</span></div></td><td class="ToolTipRightCorner"><a href="javascript:HideDialog('TopPntToolTipDialog', true);"><img src="%COMMON_FILE%Images/tooltip-right-top.png" width="27" height="23" alt="$CLOSE_CANCEL$" border="0" onmouseover="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top-over.png'" onmouseout="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top.png'"></a></td></tr></table><div id="TopPntToolTipDialogBody" style="width:2px;" class="ToolTipDialogBody"><div style="padding:0 5px 0 5px;"><span id="TopPntToolTipDialogText"></span></div></div><table class="ToolTipFooter" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCornerBottom">&nbsp;</td><td class="ToolTipFooterFill">&nbsp;</td><td class="ToolTipRightCornerBottom">&nbsp;</td></tr></table></div><script type="text/javascript" language="JavaScript">var g_fnToolTipCallback=undefined;TPBubbleLoadingImg1=new Image();TPBubbleLoadingImg1.src="%COMMON_FILE%Images/tooltip-left-top.png";TPBubbleLoadingImg2=new Image();TPBubbleLoadingImg2.src="%COMMON_FILE%Images/tooltip-right-top.png";TPBubbleLoadingImg3=new Image();TPBubbleLoadingImg3.src="%COMMON_FILE%Images/tooltip-right-top-over.png";TPBubbleLoadingImg4=new Image();TPBubbleLoadingImg4.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";TPBubbleLoadingImg5=new Image();TPBubbleLoadingImg5.src="%COMMON_FILE%Images/Tooltip-fill.png";function TopToolTipDialog(sTitle,sText,fn_CloseCallback,ToolTipPosObj,nWidth,nHeight,sCheckboxFunc,sResetId,xPointOffSet,yPointOffSet){if(fn_CloseCallback!=undefined)g_fnToolTipCallback=fn_CloseCallback;if((document.getElementById("TopPntToolTipDialogText")!=undefined)&&(sText!=undefined))document.getElementById("TopPntToolTipDialogText").innerHTML=sText;if((document.getElementById("TopPntToolTipDialogTitleText")!=undefined)&&(sTitle!=undefined))document.getElementById("TopPntToolTipDialogTitleText").innerHTML=sTitle;if(sCheckboxFunc!=undefined){sHideDialogFunction=String("HideDialog(");document.getElementById("TopPntToolTipDialogText").innerHTML+="<div style='padding-top:5px;'><input type='checkbox' value='noshow' onclick='"+sCheckboxFunc+sHideDialogFunction+"\"TopPntToolTipDialog\", true);'/> $DONT_SHOW_AGAIN$</div>";}ShowToolTipDialog('TopPntToolTipDialog',false,g_fnToolTipCallback,ToolTipPosObj,nWidth,nHeight,true,50,30,sResetId,xPointOffSet,yPointOffSet);var nWidthAdjust;nWidthAdjust=parseInt(document.getElementById("TopPntToolTipDialogBody").style.width);if(bIsOpera)document.getElementById("TopPntToolTipDialogBody").style.width=(nWidthAdjust).toString()+"px";}</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/ObjectTable.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BasicGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/AdminGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Dialog.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/NaturalSort.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/FileList.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/IPAccess.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/Events.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/XMLHTTPRequest.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/commonlogscripts.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/DomainAttrLogScripts.js"></script><style type="text/css">/*.aw-ie #UserTableMapObj .aw-combo-box .aw-item-text, .aw-ie #GroupTableMapObj .aw-combo-box .aw-item-text {position:relative;top:0px;left:0px;width:100%;margin:-3px -1px;}*/.aw-ie #UserTableMapObj .aw-combo-box .aw-item-image, .aw-ie #GroupTableMapObj .aw-combo-box .aw-item-image {margin-top:-7px;}</style><script type="text/javascript" language="JavaScript">var g_EditObjectID=%ID%;var g_ActiveRezizeGrid;var g_nGridOffSet=380;g_ActivePage=1;var g_bIsODBC=false;</script><div id="GroupEmailDialogs" style="display:none;"></div><div id="BrowseDialogDiv" style="display:none;"></div><div id="FilterDialogDiv" style="display:none;"></div><div id="ListenerDialoginner" style="display:none;"><form name="ListenerForm" onsubmit="return (false);"><table border="0" class="DialogTable"><tr><td style="width:300px;">$LISTENER_TYPE$:<br/><span id="Type"></span><br />$LISTENER_IP$:<br/>
<span id="IP"></span><br/>$LISTENER_PORT$:<div style="overflow:auto"><span id="PortInputField"></span></div><span id="ListenerDisabled"></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;" ><span id="SaveListenerButton"></span><br /><span id="CancelListenerButton"></span><br /><br /><span id="ListenerHelpButton"></span></td></tr><tr><td colspan="2"><div id="PASVIPInfo"><div id="PasvIPGroup">$LISTENER_PASV_DOMAIN$:<div style="overflow:auto"><span id="PASVIP"></span> ($OPTIONAL$)</div><span id="PasvIPSSLOnlyCheck"></span><br /><span id="PasvIPOnPrivateIPCheck"></span></div></div></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$LISTENER_DIALOG_TITLE$","ListenerDialog","420","222","","$CLOSE_CANCEL$","Listener-16.png");function OnSaveListener(){var nType=ListenerComboBox.getSelectedItems();var bEnabled=ListenerEnabledCheck.getControlValue();if(ListenerIPInput.getControlText()=="$LISTENER_IPV4_ALL$")document.getElementById(ListenerIPInput.getContent("hidden").getId()).value="";else if(ListenerIPInput.getControlText()=="$LISTENER_IPV6_ALL$")document.getElementById(ListenerIPInput.getContent("hidden").getId()).value="::";if((nType==2)&&("%CServer.%SERVER_ID%.SSHLicense%"!="1"&&bEnabled))AlertDialog("$LISTENER_SFTP_UNAVAILABLE$");else if(((nType==1)&&("%CServer.%SERVER_ID%.FTPSLicense%"!="1"&&bEnabled))||((nType==4)&&("%CServer.%SERVER_ID%.HTTPSLicense%"!="1"&&bEnabled)))AlertDialog("$LISTENER_SSL_UNAVAILABLE$");else ListenersList.OnSaveObject();return(false);}function OnCancelListener(){HideDialog("ListenerDialog");}function OnListenerHelp(){LaunchHelp("Help-Domain-Listeners.htm","Item10_4");}function OnListenerTypeLoad(sValue){ListenerComboBox.initValue(sValue);ShowHidePASVIP(parseInt(sValue)<=1);}function OnListenerTypeChange(sValue){var bIsFTP=false;switch(parseInt(sValue)){case 0:ListenerPortInput.setControlText(21);bIsFTP=true;break;case 1:ListenerPortInput.setControlText(990);bIsFTP=true;break;case 2:ListenerPortInput.setControlText(22);break;case 3:ListenerPortInput.setControlText(80);break;case 4:ListenerPortInput.setControlText(443);break;}ShowHidePASVIP(bIsFTP);}function ShowHidePASVIP(bShow){document.getElementById("PASVIPInfo").style.display=(bShow)?"block":"none";}function OnLoadListenerDisabled(sValue){ListenerEnabledCheck.setChecked(sValue=="1");}function OnLoadPasvIPSSLOnly(sValue){PasvIPSSLOnlyCheckBox.setChecked(sValue=="1");}function OnLoadPasvIPOnPrivateIP(sValue){PasvIPOnPrivateIPCheckBox.setChecked(sValue=="1");}</script><div id="VirtualHostDialoginner" style="display:none;"><form name="VirtualHostForm" onsubmit="return (false);"><table border="0" class="DialogTable"><tr><td style="width:200px;vertical-align:top;">$VIRTUAL_HOST_NAME$:<div style="overflow:auto"><span id="HostName"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" ><span id="SaveVirtualHostButton"></span><br /><span id="CancelVirtualHostButton"></span><br /><br /><span id="VirtualHostHelpButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$VIRTUAL_HOST_DIALOG_TITLE$","VirtualHostDialog","350","140","","$CLOSE_CANCEL$","VirtualHosts16.png");HostNameInput=CreateInputField("","HostName","HostName","",180,undefined,undefined,OnSaveVirtualHost);CreateDialogPushButton("$SAVE_BUTTON$","SaveVirtualHostButton",OnSaveVirtualHost);CreateDialogPushButton("$CANCEL_BUTTON$","CancelVirtualHostButton",OnCancelVirtualHost);CreateDialogPushButton("$HELP_BUTTON$","VirtualHostHelpButton",OnVirtualHostHelp);function OnSaveVirtualHost(){var regExpHost=/^(((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|((([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)+([A-Za-z|[A-Za-z][A-Za-z0-9\‌​-]*[A-Za-z0-9])))$/;var error="";var text=HostNameInput.getControlText();if(!regExpHost.test(text)){error="$VIRTUAL_HOST_NAME_INVALID$";}if(text==""){error="$VIRTUAL_HOST_NAME_EMPTY$";}if(error){AlertDialog(error);}else{VirtualHostsList.OnSaveObject();}return(false);}function OnCancelVirtualHost(){HideDialog("VirtualHostDialog");}function OnVirtualHostHelp(){LaunchHelp("Help-Virtual-Hosts.htm","Item10_4");}</script><div id="IPAccessDialoginner" style="display:none;"><form name="IPAccessForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div style="width:225px;float:left;">$IP_ACCESS_RULE_LABEL$:<div style="overflow:auto"><span id="IPAccessRule"></span></div></div><div style="width:135px;float:left;padding-left:5px;height:40px;overflow:hidden;"><span id="Allow"></span></div><div style="clear:left;">$DESCRIPTION$:<br /><span id="IPRuleDescription"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveIPAccessButton"></span><span id="CancelIPAccessButton"></span><br /><br /><span id="HelpIPAccessButton"></span></td></tr><tr><td><div id="IPAccessTipsGroup"><div style="width:145px;float:left;margin-bottom:5px;padding-left:3px;">xxx = $IP_RULE_MATCH$<br />* = $IP_RULE_ANY$<br />/ = $IP_RULE_CIDR$<br /></div><div style="width:250px;float:left;padding-left:5px;margin-bottom:5px;">| &nbsp; xxx-xxx = $IP_RULE_RANGE$<br />| &nbsp; ? = $IP_RULE_ANY_CHAR$<br />|</div></div></td></tr></table></form></div><script type="text/javascript" language="javascript">var g_sRuleAddressColumn="$RULE_ADDRESS$";var g_sAccessColumn="$ACCESS$";var g_sExpiresInColumn="$EXPIRES_IN$";var g_sIPDescriptionColumn="$DESCRIPTION$";var g_sRuleAllow="$RULE_ALLOW$";var g_sRuleDeny="$RULE_DENY$";var g_sRuleExpired="$RULE_EXPIRED$";BuildDialog("$IP_ACCESS_DIALOG_TITLE$","IPAccessDialog","530","220","","$CLOSE_CANCEL$","IpAccess16.png");function OnIPAccessLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("IPAccessDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}IPAccessRadio.initValue(parseInt(IPAccessList.getCellValue(1,IPAccessList.getSelectedRows())));IPRule.setControlText(document.getElementById(IPRule.getContent("box/text").getId()).value);IPRule.getContent("box/text").element().focus();}function OnSaveIPAccess(){if(IPRule.getControlText()!="")IPAccessList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_RULE$",true,(function(){IPRule.getContent("box/text").element().focus()}));return(false);}function OnCancelIPAccess(){HideDialog('IPAccessDialog');}function OnIPAccessHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-IP-ACL.htm",sExpandNode);}var IPAccessRadio=CreateRadioButtons(1,["$RULE_ALLOW_LABEL$","$RULE_DENY_LABEL$"],"Allow","Allow","130px",undefined,[1,0]);if(g_bFireFox3Browser)document.getElementById("Allow-box").style.height="40px";var IPRule=CreateInputField("","IPAccessRule","IPAccess_IP",undefined,225,undefined,undefined,OnSaveIPAccess);var IPRuleDescription=CreateInputField("","IPRuleDescription","IPAccess_Description",undefined,410,undefined,undefined,OnSaveIPAccess);CreateGroupBox("$IP_ACCESS_TIPS$","IPAccessTipsGroup","415px","75px",true);CreateDialogPushButton("$SAVE_BUTTON$","SaveIPAccessButton",OnSaveIPAccess);CreateDialogPushButton("$CANCEL_BUTTON$","CancelIPAccessButton",OnCancelIPAccess);CreateDialogPushButton("$HELP_BUTTON$","HelpIPAccessButton",OnIPAccessHelp);</script><div id="DatabaseDialoginner" style="display:none;"><div id="DatabaseContent" style="width:525px"><div class="layercontent"><div style="display:inline;"><img alt="$DATABASE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32" class="header-icon" />$DATABASE_MAPPING_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="clear:both;padding-bottom:5px;">$TABLE_MAPPING_OBJ$:<div style="margin-bottom:5px;"><div id="UserTableobjDiv" style="float:left;width:260px;"><span id="UserTableMapObj"></span></div><div id="UserTableCheckDiv" style="float:left;width:150px;clear:both;"><span id="UserEnableTableCheckBox"></span></div><div id="GroupTableobjDiv" style="float:left;width:260px;"><span id="GroupTableMapObj"></span></div><div id="GroupTableCheckDiv" style="float:left;width:150px;clear:both;"><span id="GroupEnableTableCheckBox"></span></div><div style="clear:both;height:1px;line-height:1px;">&nbsp;</div></div></div><span id="TableMapList"></span><table style="padding-top:5px;width:100%"><tr><td><span id="EditMappingButton"></span><span id="UseDefaultMappingButton"></span></td><td style="text-align:right;"><span id="CloseMappingButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">var g_bUserTables;BuildDialog("$DATABASE_DIALOG_TITLE$","DatabaseDialog","540","375","","$CLOSE_CANCEL$","Database16.png");var g_asUserTables=["$DB_USER_INFO$","$DB_USER_GROUP$","$DB_USER_DIRACCESS$","$DB_USER_VIRPATH$","$DB_USER_IPACCESS$","$DB_USER_EVENTS$","$DB_USER_FREEFILES$","$DB_USER_USERFILES$","$DB_USER_USERBYTES$","$DB_USER_SESSFILES$","$DB_USER_SESSBYTES$","$DB_USER_AVAILABILITY$","$DB_USER_SSH_KEY_PATH$"];var g_anUserTableIDs=[%CDomain.%ID%.ODBCUserTable.ID%,%CDomain.%ID%.ODBCUserGroupMembershipTable.ID%,%CDomain.%ID%.ODBCUserDirAccessTable.ID%,%CDomain.%ID%.ODBCUserVirtualPathTable.ID%,%CDomain.%ID%.ODBCUserIPAccessTable.ID%,%CDomain.%ID%.ODBCUserSUEventTable.ID%,%CDomain.%ID%.ODBCUserUlDlRatioFreeFileTable.ID%,%CDomain.%ID%.ODBCUserUserFilesUlDlRatioTable.ID%,%CDomain.%ID%.ODBCUserUserBytesUlDlRatioTable.ID%,%CDomain.%ID%.ODBCUserSessionFilesUlDlRatioTable.ID%,%CDomain.%ID%.ODBCUserSessionBytesUlDlRatioTable.ID%,%CDomain.%ID%.ODBCUserAttrAvailabilityTable.ID%,%CDomain.%ID%.ODBCUserSSHPublicKeyFileTable.ID%];var g_anUserTableEnabled=["2",%CODBCTableMap.%CDomain.%ID%.ODBCUserGroupMembershipTable.ID%.Enabled%,"2",%CODBCTableMap.%CDomain.%ID%.ODBCUserVirtualPathTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserIPAccessTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserSUEventTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserUlDlRatioFreeFileTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserUserFilesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserUserBytesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserSessionFilesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserSessionBytesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserAttrAvailabilityTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCUserSSHPublicKeyFileTable.ID%.Enabled%];var g_anUserTableEnabledIcon=["table-enabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserGroupMembershipTable.ID%.Enabled%)?"table-enabled":"table-disabled","table-enabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserVirtualPathTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserIPAccessTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserSUEventTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserUlDlRatioFreeFileTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserUserFilesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserUserBytesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserSessionFilesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserSessionBytesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserAttrAvailabilityTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCUserSSHPublicKeyFileTable.ID%.Enabled%)?"table-enabled":"table-disabled"];var g_asGroupTables=["$DB_GROUP_INFO$","$DB_GROUP_DIRACCESS$","$DB_GROUP_VIRPATH$","$DB_GROUP_IPACCESS$","$DB_GROUP_EVENTS$","$DB_GROUP_FREEFILES$","$DB_GROUP_AVAILABILITY$","$DB_GROUP_SSH_KEY_PATH$"];var g_anGroupTableIDs=[%CDomain.%ID%.ODBCGroupTable.ID%,%CDomain.%ID%.ODBCGroupDirAccessTable.ID%,%CDomain.%ID%.ODBCGroupVirtualPathTable.ID%,%CDomain.%ID%.ODBCGroupIPAccessTable.ID%,%CDomain.%ID%.ODBCGroupSUEventTable.ID%,%CDomain.%ID%.ODBCGroupUlDlRatioFreeFileTable.ID%,%CDomain.%ID%.ODBCGroupAttrAvailabilityTable.ID%,%CDomain.%ID%.ODBCGroupSSHPublicKeyFileTable.ID%];var g_anGroupTableEnabled=["2","2",%CODBCTableMap.%CDomain.%ID%.ODBCGroupVirtualPathTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCGroupIPAccessTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCGroupSUEventTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCGroupUlDlRatioFreeFileTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCGroupAttrAvailabilityTable.ID%.Enabled%,%CODBCTableMap.%CDomain.%ID%.ODBCGroupSSHPublicKeyFileTable.ID%.Enabled%];var g_anGroupTableEnabledIcon=["table-enabled","table-enabled",(%CODBCTableMap.%CDomain.%ID%.ODBCGroupVirtualPathTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCGroupIPAccessTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCGroupSUEventTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCGroupUlDlRatioFreeFileTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCGroupAttrAvailabilityTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CDomain.%ID%.ODBCGroupSSHPublicKeyFileTable.ID%.Enabled%)?"table-enabled":"table-disabled"];var g_nSelTableID=0,g_nEditCol=1,g_nEditRow=0;var g_sColumnEditVal="";var g_bInitialLoad=true;var UserObjCombo=CreateComboBox(g_asUserTables[0],g_anUserTableIDs[0],g_asUserTables,g_anUserTableIDs,"UserTableMapObj","Info_UserTableMapObj",OnChangeTableObj,"",false,$USER_TABLE_MAPPING_WIDTH$,24);document.getElementById("UserTableobjDiv").width=($USER_TABLE_MAPPING_WIDTH$+10);var GroupObjCombo=CreateComboBox(g_asGroupTables[0],g_anGroupTableIDs[0],g_asGroupTables,g_anGroupTableIDs,"GroupTableMapObj","Info_GroupTableMapObj",OnChangeTableObj,"",false,$GROUP_TABLE_MAPPING_WIDTH$,24);document.getElementById("GroupTableobjDiv").width=($GROUP_TABLE_MAPPING_WIDTH$+10);UserObjCombo.getPopupTemplate().setStyle("height",(g_anUserTableEnabledIcon.length<=10)?((16*g_anUserTableEnabledIcon.length)+((AW.ie)?3:0))+"px":"163px");GroupObjCombo.getPopupTemplate().setStyle("height",(g_anGroupTableEnabledIcon.length<=10)?((16*g_anGroupTableEnabledIcon.length)+((AW.ie)?3:0))+"px":"163px");UserObjCombo.setItemImage(g_anUserTableEnabledIcon);GroupObjCombo.setItemImage(g_anGroupTableEnabledIcon);var UserEnableTableCheckBox=CreateCheckBox("$ENABLE_TABLE$","UserEnableTableCheckBox","UserEnableTable",(g_anUserTableEnabled[0]!="0")?true:false,OnSaveUserTableEnabled,true);var GroupEnableTableCheckBox=CreateCheckBox("$ENABLE_TABLE$","GroupEnableTableCheckBox","GroupEnableTable",(g_anGroupTableEnabled[0]!="0")?true:false,OnSaveGroupTableEnabled,true);if(g_bFireFox3Browser){UserObjCombo.getPopupTemplate().setStyle("margin-top","-5px");UserObjCombo.getPopupTemplate().setStyle("background-color","#fff");GroupObjCombo.getPopupTemplate().setStyle("margin-top","-5px");GroupObjCombo.getPopupTemplate().setStyle("background-color","#fff");}if(g_bSafariBrowser){UserObjCombo.getPopupTemplate().setStyle("margin-top","0px");UserObjCombo.getPopupTemplate().setStyle("background-color","#fff");GroupObjCombo.getPopupTemplate().setStyle("margin-top","0px");GroupObjCombo.getPopupTemplate().setStyle("background-color","#fff");}var TableMapList=CreateAdminGrid("TableMapList",["$DB_ATTRIBUTE$","$DB_COLUMN_NAME$"],[200,225],"ODBCTableMap.xml?ID=%OBJECT_EDIT_ID%","columnmaps","columnmap",4,OnEditTableMap);TableMapList.setCellFormat([new AW.Formats.String,new AW.Formats.XMLString,]);TableMapList.setStyle("height","200px");TableMapList.setSelectionMode("single-row");TableMapList.setSelectionMultiple(false);TableMapList.DisableSorting();TableMapList.defaultPostUpdate=TableMapList.PostUpdate;TableMapList.PostUpdate=function(){this.defaultPostUpdate();if(this.getCellText(1,1)=="")this.deleteRow(1);if(g_bInitialLoad){this.refresh();g_bInitialLoad=false;}this.setSelectedRows([-1]);BoldNonDefaultVals(TableMapList,1,2);};function OnEditTableMap(){if((TableMapList.getSelectedRows()!="")&&(TableMapList.getSelectedRows()!=-1)){g_sColumnEditVal=TableMapList.getCellText(1,TableMapList.getSelectedRows());g_nEditRow=TableMapList.getSelectedRows()[0];OnShowMappingRenameDialog(g_sColumnEditVal);}else AlertDialog("$SELECT_DB_COLUMN_EDIT$");}var sOnEditMapping=String("OnEditTableMap(");var sOnDefaultMapping=String("OnDefaultMapping(");CreateContextMenu([sOnEditMapping,sOnDefaultMapping],["$EDIT_BUTTON$...","$DEFAULT_BUTTON$..."],["FileRename","Edit"],TableMapList,"TableMapListContext",true);CreatePushButton("$EDIT_BUTTON$...","EditMappingButton",OnEditTableMap);CreatePushButton("$DEFAULT_BUTTON$","UseDefaultMappingButton",OnDefaultMapping);CreateDialogPushButton("$CLOSE_BUTTON$","CloseMappingButton",OnCloseMappingDialog);function OnSaveUserTableEnabled(){var SetUserTableEnabledRequest;SetUserTableEnabledRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.ODBCTableMap."+g_nSelTableID);SetUserTableEnabledRequest.setParameter("Enabled",(UserEnableTableCheckBox.getControlValue()?"1":"0"));SavingDialog(true);SetUserTableEnabledRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult==g_nSessionOkay){g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]=UserEnableTableCheckBox.getControlValue()?"1":"0";g_anUserTableEnabledIcon[parseInt(UserObjCombo.getSelectedItems())]=UserEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled";if(!AW.opera)UserObjCombo.setControlImage(UserEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled");UserObjCombo.setItemImage(g_anUserTableEnabledIcon);}else{UserEnableTableCheckBox.setChecked((g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]!="0")?true:false,true);}};SetUserTableEnabledRequest.request(null);}function OnSaveGroupTableEnabled(){var SetGroupTableEnabledRequest;SetGroupTableEnabledRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.ODBCTableMap."+g_nSelTableID);SetGroupTableEnabledRequest.setParameter("Enabled",(GroupEnableTableCheckBox.getControlValue()?"1":"0"));SavingDialog(true);SetGroupTableEnabledRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult==g_nSessionOkay){g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]=GroupEnableTableCheckBox.getControlValue()?"1":"0";g_anGroupTableEnabledIcon[parseInt(GroupObjCombo.getSelectedItems())]=GroupEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled";if(!AW.opera)GroupObjCombo.setControlImage(GroupEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled");GroupObjCombo.setItemImage(g_anGroupTableEnabledIcon);}else{GroupEnableTableCheckBox.setChecked((g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]!="0")?true:false,true);}};SetGroupTableEnabledRequest.request(null);}function InitDatabaseDialog(bUser){g_nSelTableID=0;if(bUser){g_bUserTables=true;UserObjCombo.setStyle("display","block");document.getElementById("UserTableobjDiv").style.display="block";GroupObjCombo.setStyle("display","none");document.getElementById("GroupTableobjDiv").style.display="none";document.getElementById("UserTableCheckDiv").style.display="block";document.getElementById("GroupTableCheckDiv").style.display="none";UserEnableTableCheckBox.setStyle("display","none");GroupEnableTableCheckBox.setStyle("display","none");UserEnableTableCheckBox.setChecked((g_anUserTableEnabled[0]!="0")?true:false,true);UserObjCombo.setSelectedItems([0]);UserObjCombo.setControlText(g_asUserTables[0]);LoadingDialog(false);OnChangeTableObj(g_anUserTableIDs[0],true);}else{g_bUserTables=false;UserObjCombo.setStyle("display","none");document.getElementById("UserTableobjDiv").style.display="none";GroupObjCombo.setStyle("display","block");document.getElementById("GroupTableobjDiv").style.display="block";document.getElementById("UserTableCheckDiv").style.display="none";document.getElementById("GroupTableCheckDiv").style.display="block";UserEnableTableCheckBox.setStyle("display","none");GroupEnableTableCheckBox.setStyle("display","none");GroupEnableTableCheckBox.setChecked((g_anGroupTableEnabled[0]!="0")?true:false,true);GroupObjCombo.setSelectedItems([0]);GroupObjCombo.setControlText(g_asGroupTables[0]);LoadingDialog(false);OnChangeTableObj(g_anGroupTableIDs[0],true);}}function OnChangeTableObj(sValue,bSkipLoading,bForce){var nSelTableID=parseInt(sValue);if((bForce)||(nSelTableID!=g_nSelTableID)){if(!bSkipLoading)LoadingDialog(true);TableMapList.setSelectedRows([-1]);TableMapList.Reset(true);if(!bSkipLoading)TableMapList.m_bSaving=true;TableMapList.ForceUpdate("%OBJECT_EDIT_ID%",nSelTableID);g_nSelTableID=nSelTableID;if(g_bUserTables==true){if(g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]=="2")UserEnableTableCheckBox.setStyle("display","none");else UserEnableTableCheckBox.setStyle("display","block");}else{if(g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]=="2")GroupEnableTableCheckBox.setStyle("display","none");else GroupEnableTableCheckBox.setStyle("display","block");}if(!AW.opera)UserObjCombo.setControlImage(UserObjCombo.getItemImage(UserObjCombo.getSelectedItems()));if(!AW.opera)GroupObjCombo.setControlImage(GroupObjCombo.getItemImage(GroupObjCombo.getSelectedItems()));UserEnableTableCheckBox.setChecked((g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]!="0")?true:false,true);GroupEnableTableCheckBox.setChecked((g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]!="0")?true:false,true);setTimeout(function(){TableMapList.refresh();},500);}}function OnEditMapping(){if(TableMapList.getSelectedColumns().length)TableMapList.raiseEvent("editCurrentCell");else AlertDialog("$SELECT_DB_COLUMN_EDIT$");}function OnDefaultMapping(){if((TableMapList.getSelectedRows()!="")&&(TableMapList.getSelectedRows()!=-1)){g_nEditRow=TableMapList.getSelectedRows()[0];g_sColumnEditVal=TableMapList.getCellData(g_nEditCol,g_nEditRow);OnColumnValChanged.call(TableMapList,TableMapList.getCellValue(2,g_nEditRow),g_nEditCol,g_nEditRow);}else AlertDialog("$SELECT_DB_COLUMN_EDIT$");}function OnCloseMappingDialog(){HideDialog("DatabaseDialog");}function OnColumnValChanged(sText,nCol,nRow){var nCol=g_nEditCol;var nRow=g_nEditRow;if(sText==""){var asNoEmptyCols=["TableName","LoginID","GroupName","SortIndex"];var sEditCol=TableMapList.getCellText(0,nRow);for(var nIndex in asNoEmptyCols){if(asNoEmptyCols[nIndex]==sEditCol){TableMapList.UpdateText(g_sColumnEditVal,nCol,nRow);AlertDialog("$DB_NO_EMPTY_COLUMN$");return;}}}if(sText!=g_sColumnEditVal){var UpdateColRequest;if(nRow==0){UpdateColRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.ODBCTableMap."+g_nSelTableID);UpdateColRequest.setParameter("TableName",sText);}else{UpdateColRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CODBCTableMap."+g_nSelTableID+".ODBCColumnMap."+TableMapList.GetSelectedObjectID());UpdateColRequest.setParameter("ColumnName",sText);}SavingDialog(true);UpdateColRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult)TableMapList.UpdateText(g_sColumnEditVal,nCol,nRow);else TableMapList.UpdateText(sText,nCol,nRow);BoldNonDefaultVals(TableMapList,1,2);OnCloseMappingRenameDialog();};UpdateColRequest.request(null);}else OnCloseMappingRenameDialog();return(false);}function BoldNonDefaultVals(Grid,nValCol,nDefCol){for(var nIndex=0;nIndex<Grid.getRowCount();nIndex++){var element=document.getElementById(Grid.getCellTemplate(nValCol,nIndex).getContent("box/text").getId());if(element)element.style.fontWeight=(Grid.getCellValue(nValCol,nIndex).toLowerCase()!=Grid.getCellValue(nDefCol,nIndex).toLowerCase())?"bold":"normal";}}</script><div id="DatabaseRenameDialoginner" style="display:none;"><form name="rename" onsubmit="return (false);"><table class="DialogTable"><tr><td>$DATABASE_RENAME_DIALOG_DESC$:<br><div style="overflow:auto"><span id="MappingInput"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="RenameMappingButton"></span><br /><span id="CancelRenameMappingButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$DATABASE_RENAME_DIALOG_TITLE$","DatabaseRenameDialog","400","120","","$CLOSE_CANCEL$");function OnShowMappingRenameDialog(sText){MappingRenameInput.setControlText(sText);ShowDialog("DatabaseRenameDialog");MappingRenameInput.getContent("box/text").element().focus();}function OnCloseMappingRenameDialog(){HideDialog("DatabaseRenameDialog");}function OnRenameMappingSubmit(){OnColumnValChanged(MappingRenameInput.getControlText(),g_nEditCol,g_nEditRow);}CreateDialogPushButton("$OK_BUTTON$","RenameMappingButton",OnRenameMappingSubmit);CreateDialogPushButton("$CANCEL_BUTTON$","CancelRenameMappingButton",OnCloseMappingRenameDialog);var MappingRenameInput=CreateInputField("","MappingInput","new_mapping",undefined,200,undefined,undefined,OnRenameMappingSubmit);</script><div id="SQLTemplateDialoginner" style="display:none;"><div id="SQLTemplateContent" style="width:$SQL_TEMPLATE_DIALOG_WIDTH$px"><div class="layercontent"><div style="display:inline;"><img alt="$SQL_TEMPLATE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32" class="header-icon" />$SQL_TEMPLATE_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><span id="SQLTemplateList"></span><table style="padding-top:5px;width:100%"><tr><td><span id="EditTemplateButton"></span><span id="UseDefaultTemplateButton"></span></td><td style="text-align:right;"><span id="CloseTemplateButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$SQL_TEMPLATE_DIALOG_TITLE$","SQLTemplateDialog",($SQL_TEMPLATE_DIALOG_WIDTH$+15),"275","","$CLOSE_CANCEL$","Database16.png");var g_sSQLTemplateEditVal="";var aasGridData=[["$SQLT_SELECT_ALL$",DecodeString("%CDomain.%ID%.SQLSelectAllRows%"),DecodeString("%CDomain.%ID%.SQLSelectAllRows.Default%"),"SQLSelectAllRows"],["$SQLT_SELECT_ROW$",DecodeString("%CDomain.%ID%.SQLSelectSpecificRow%"),DecodeString("%CDomain.%ID%.SQLSelectSpecificRow.Default%"),"SQLSelectSpecificRow"],["$SQLT_SELECT_ROW_SORT$",DecodeString("%CDomain.%ID%.SQLSelectSpecificRowSort%"),DecodeString("%CDomain.%ID%.SQLSelectSpecificRowSort.Default%"),"SQLSelectSpecificRowSort"],["$SQLT_DELETE_ROW$",DecodeString("%CDomain.%ID%.SQLDeleteRow%"),DecodeString("%CDomain.%ID%.SQLDeleteRow.Default%"),"SQLDeleteRow"],["$SQLT_INSERT_ROW$",DecodeString("%CDomain.%ID%.SQLInsertRow%"),DecodeString("%CDomain.%ID%.SQLInsertRow.Default%"),"SQLInsertRow"],["$SQLT_UPDATE_ROW$",DecodeString("%CDomain.%ID%.SQLUpdateRow%"),DecodeString("%CDomain.%ID%.SQLUpdateRow.Default%"),"SQLUpdateRow"]];var SQLTemplateList=CreateAdminGrid("SQLTemplateList",["$SQLT_TEMPLATE$","$VALUE$"],[$SQL_TEMPLATE_LIST_COL_SIZES$],"","","",4);var sOnEditTemplate=String("OnEditTemplate(");var sOnDefaultTemplate=String("OnDefaultTemplate(");CreateContextMenu([sOnEditTemplate,sOnDefaultTemplate],["$EDIT_BUTTON$...","$DEFAULT_BUTTON$..."],["FileRename","Edit"],SQLTemplateList,"SQLTemplateListContext",true);SQLTemplateList.setCellFormat([new AW.Formats.String,new AW.Formats.XMLString,]);SQLTemplateList.setCellText(aasGridData);SQLTemplateList.setCellValue(aasGridData);SQLTemplateList.setRowCount(aasGridData.length);SQLTemplateList.refresh();SQLTemplateList.setStyle("height","200px");SQLTemplateList.setSelectionMode("single-cell");SQLTemplateList.setSelectionMultiple(false);SQLTemplateList.setCellEditable(true,1);SQLTemplateList.DisableSorting();SQLTemplateList.onCellMouseDown=function(event,nCol,nRow){return(nCol==0);};SQLTemplateList.onCellEditStarted=function(sText){g_sSQLTemplateEditVal=sText;g_nEditCol=SQLTemplateList.getSelectedColumns()[0];g_nEditRow=SQLTemplateList.getSelectedRows()[0];};SQLTemplateList.onCellEditEnded=OnSQLTemplateValChanged;BoldNonDefaultVals(SQLTemplateList,1,2);CreatePushButton("$EDIT_BUTTON$...","EditTemplateButton",OnEditTemplate);CreatePushButton("$DEFAULT_BUTTON$","UseDefaultTemplateButton",OnDefaultTemplate);CreateDialogPushButton("$CLOSE_BUTTON$","CloseTemplateButton",OnCloseTemplateDialog);function OnEditTemplate(){if(parseInt(SQLTemplateList.getSelectedColumns())==0||parseInt(SQLTemplateList.getSelectedColumns())==1){SQLTemplateList.setCurrentColumn(1);SQLTemplateList.setCurrentRow(SQLTemplateList.getSelectedRows());SQLTemplateList.raiseEvent("editCurrentCell");}else AlertDialog("$SELECT_SQL_TEMPLATE_EDIT$");}function OnDefaultTemplate(){if(SQLTemplateList.getSelectedColumns().length&&(parseInt(SQLTemplateList.getSelectedColumns())==0||parseInt(SQLTemplateList.getSelectedColumns())==1)){g_nEditCol=1;g_nEditRow=SQLTemplateList.getSelectedRows()[0];g_sSQLTemplateEditVal=SQLTemplateList.getCellText(g_nEditCol,g_nEditRow);OnSQLTemplateValChanged.call(SQLTemplateList,"",g_nEditCol,g_nEditRow);}else AlertDialog("$SELECT_SQL_TEMPLATE_EDIT$");}function OnCloseTemplateDialog(){HideDialog("SQLTemplateDialog");}function OnSQLTemplateValChanged(sText,nCol,nRow){var bUpdateCell=false;nCol=g_nEditCol;nRow=g_nEditRow;if(sText==""){sText=this.getCellText(2,nRow);bUpdateCell=true;}if(sText!=g_sSQLTemplateEditVal){var UpdateRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");if(UpdateRequest!=undefined){UpdateRequest.setParameter(this.getCellText(3,nRow),sText);SavingDialog(true);UpdateRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult){SQLTemplateList.setCellText(g_sSQLTemplateEditVal,nCol,nRow);SQLTemplateList.setCellValue(g_sSQLTemplateEditVal,nCol,nRow);}else if(bUpdateCell){SQLTemplateList.setCellText(sText,nCol,nRow);SQLTemplateList.setCellValue(sText,nCol,nRow);}BoldNonDefaultVals(SQLTemplateList,1,2);};UpdateRequest.request(null);}}else if(bUpdateCell)this.setCellText(g_sSQLTemplateEditVal,nCol,nRow);}</script><div id="EventsDialoginner" style="display:none;"><div style="padding:0 10px 0 10px;"><form method="post" name="EventsForm" onsubmit="return (false);"><span id="EventDialogTabs" style="-moz-user-select:-moz-none;"></span><div id="EventInfoTabsContent" class="tabs-content"><div id="EventInformation" style="display:none;"><span id="EventInfoGroup">
<div style="padding:0 0 5px 5px;">$EVENT_TYPE$:<br /><span id="EventID"></span><br />$EVENTS_NAME_LABEL$:<br /><span id="EventNameInput"></span><br /><div style="margin-top:5px;"><span id="EventDisabled"></span></div><br />$DESCRIPTION$:<br /><div style="overflow:auto;"><textarea id="event_Description" name="event_Description" class="aw-border" style="width:370px;height:75px;"></textarea></div></div></span><div style="margin-top:10px;"><span id="EventActionGroup" ><div style="padding:0 0 5px 5px;">$EVENTS_ACTION_LABEL$:<br /><span id="Action"></span><div id="email-event" style="display:none;">$EVENTS_EMAIL_TO_LABEL$:<div style="overflow:auto"><span id="EmailToAddressInput" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"></span><span id="AddGroupsEmailToButton" alt="$GROUP_EMAIL_TO_NOTE$" title="$GROUP_EMAIL_TO_NOTE$"></span></div>$EVENTS_EMAIL_BCC_LABEL$ ($OPTIONAL$):<div style="overflow:auto"><span id="EmailToAddressBCCInput" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"></span><span id="AddGroupsEmailBCCButton" alt="$GROUP_EMAIL_BCC_NOTE$" title="$GROUP_EMAIL_BCC_NOTE$"></span></div></div><div id="exec-event" style="display:none;">$EVENTS_EXEC_PATH_LABEL$:<div style="overflow:auto"><span id="ExeFilePathInput"></span><span id="BrowseButtonExecPath"></span></div></div><div id="data1-event" style="display:none;"><span id="data1-text"></span>:<div style="overflow:auto"><span id="Data1Input"></span></div></div><div id="data2-event" style="display:none;"><span id="data2-text"></span>:<div style="overflow:auto;"><textarea id="event_Data2" name="event_Data2" class="aw-border" style="width:370px;height:75px;"></textarea></div></div><div id="exec-event-wait" style="display:none;">$EVENTS_EXEC_WAIT_LABEL$:<div style="overflow:auto"><span id="ExecWaitSecs"></span>($EVENTS_EXEC_WAIT_SEC$)</div></div></div></span></div></div><div id="EventFilters" style="display:none;height:410px;"><div id="EventRulesContent"><div class="layercontent"><div style="display:inline;"><img alt="$FILTER_RULE_EVENTS$" src="%ADMIN_FILE%Images/Filter32.png" width="32" height="32" class="header-icon" />$FILTER_EVENT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="width:440px;"><span id="EventFilterList"></span></div><div style="padding-top:5px;"><span id="AddEventFilterButton"></span><span id="EditEventFilterButton"></span><span id="DeleteEventFilterButton"></span></div></div></div></div></div><input type="hidden" id="ObjectID" name="ObjectID"/></form><div style="text-align:right;padding:10px 20px 0 0;"><span id="SaveEventButton"></span><span id="CancelEventButton"></span> &nbsp;&nbsp;&nbsp;<span id="HelpEventButton"></span></div></div></div><script type="text/javascript" language="javascript">var g_EventObjID;var g_sEventFilterRuleName="$NAME$";var g_sEventFilterDescr="$DESCRIPTION$";var g_sEventFilterLogic="$EVENT_RULE_LOGIC$";var g_EventRuleObjID;var nEventDialogWidth="510";BuildDialog("$EVENTS$","EventsDialog",nEventDialogWidth,"575","","$CLOSE_CANCEL$","cmd-16.png");var EventDialogTabs=CreateTabs(["$EVENTS$","$EVENTS_FILTERS$"],["EventInformation","EventFilters"],"EventDialogTabs","EventInfoTabsContent",1,OnChangeEventsTab,true);var EventFilterList=CreateEventFiltersGrid("EventFilterList","EventFilters.xml?ID=%OBJECT_EDIT_ID%",OnDelayLoadEditFilterDialog);var sOnDelayLoadAddFilterDialog=String("OnDelayLoadAddFilterDialog(");var sOnDelayLoadEditFilterDialog=String("OnDelayLoadEditFilterDialog(");var sOnRemoveEventFilter=String("OnRemoveEventFilter(");var sOnEnableFilter=String("OnEnableDisableFilter(1,");var sOnDisableFilter=String("OnEnableDisableFilter(0,");CreateContextMenu([sOnDelayLoadAddFilterDialog,sOnDelayLoadEditFilterDialog,sOnRemoveEventFilter,sOnEnableFilter,sOnDisableFilter],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(EventFilterList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(EventFilterList,"$DELETE_BUTTON$"))},OnEnableFilterContextMenu,OnDisableFilterContextMenu],["New","Edit","FileDelete",OnEnableFilterContextImage,OnDisableFilterContextImage],EventFilterList,"EventFilterListContext",true);EventFilterList.setStyle("height","330px");function OnChangeEventsTab(nOldTab,nNewTab){switch(nNewTab){case(0):break;case(1):EventFilterList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventObjID);break;}switch(nOldTab){case(0):break;case(1):EventFilterList.EnableUpdates(false);break;}}function OnEventLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("EventsDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}var nTotalEvents=parseInt(EventsList.getRowCount()+1);var sEventText="";if(g_bIsODBC){EventDialogTabs.setSelectedItems([0]);document.getElementById("AddGroupsEmailBCCButton").style.display="none";document.getElementById("AddGroupsEmailToButton").style.display="none";document.getElementById("EventDialogTabs-item-1").style.display="none";}else{document.getElementById("AddGroupsEmailBCCButton").style.display="";document.getElementById("AddGroupsEmailToButton").style.display="";document.getElementById("EventDialogTabs-item-1").style.display="";}EventsList.EnableUpdates(false);if(document.getElementById(EventNameInput.getContent("box/text").getId()).value==""){if(nTotalEvents<10){sEventText="$EVENT$ 0"+nTotalEvents;}else{sEventText="$EVENT$ "+nTotalEvents;}}else sEventText=document.getElementById(EventNameInput.getContent("box/text").getId()).value;EventNameInput.setControlText(sEventText);g_EventObjID=document.getElementById("ObjectID").value;if(EventDialogTabs.getSelectedItems()[0]==1)EventFilterList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventObjID);}function OnEventTypeLoad(sValue){EventIDComboBox.initValue(sValue);}function OnEventActionLoad(sValue){EventActionComboBox.initValue(sValue);OnEventActionChange(sValue);}function OnSetEventInputFocus(){EventNameInput.getContent("box/text").element().focus();}function OnYesSaveExec(){setTimeout(function(){SaveEvent();});}function OnNoSaveExec(){EventExecWaitMsec.setControlText("0");setTimeout(function(){SaveEvent();});}function IsUnderMaxCharsForColumn(sControlName,sTestStr,nMaxChars){var bIsUnderLimit=true;var sRCharLimitExceed="$WARN_MAX_CHAR_LIMIT$";if(sTestStr.length>nMaxChars){bIsUnderLimit=false;sRCharLimitExceed=sRCharLimitExceed.replace("$Limit",nMaxChars.toString());sRCharLimitExceed=sRCharLimitExceed.replace("$Field",sControlName);AlertDialog(sRCharLimitExceed,true);}return(bIsUnderLimit);}function PassesValidation(){var DB_COLUMN_LEN=255;var bPassed=true;var nCharBodyLimit=16384;if(g_bIsODBC){nCharBodyLimit=DB_COLUMN_LEN;}var nCharLimit=DB_COLUMN_LEN;var sText=EventNameInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventNameInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_NAME_LABEL$",sText,nCharLimit);if(bPassed){sText=document.getElementById("event_Description").value;bPassed=IsUnderMaxCharsForColumn("$DESCRIPTION$",sText,nCharBodyLimit);}if(bPassed){sText=Data1Input.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(Data1Input.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_SUBJECT_LABEL$",sText,nCharLimit);}if(bPassed){sText=document.getElementById("event_Data2").value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_BODY_LABEL$",sText,nCharBodyLimit);}if(bPassed){sText=EventEmailToInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventEmailToInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_TO_LABEL$",sText,nCharLimit);}if(bPassed){sText=EventEmailBCCInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventEmailBCCInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_BCC_LABEL$",sText,nCharLimit);}if(bPassed){sText=EventExecPathInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventExecPathInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EXEC_PATH_LABEL$",sText,nCharLimit);}return(bPassed);}function OnSaveEvent(){var nSelectedAction=EventActionComboBox.getItemValue(EventActionComboBox.getSelectedItems());if(EventNameInput.getControlText()!=""){if((nSelectedAction==2)&&parseInt(EventExecWaitMsec.getControlText())>0){ConfirmDialog("$CONFIRM_WAIT_DELAY_EXEC$",OnYesSaveExec,OnNoSaveExec);}else if((nSelectedAction==4)&&!g_bMSMQLicense){AlertDialog("$WARN_MSMQ_EVENT_NO_LICENSE$");}else if(PassesValidation()){if(g_bSysAdmin)SaveEvent();else if((nSelectedAction==1)||(nSelectedAction==2)||(nSelectedAction==4)||(nSelectedAction==3))AlertDialog("$WARN_DOMAIN_ADMIN_EVENTS$",true);else SaveEvent();}}else AlertDialog("$PLEASE_ENTER_EVENT_NAME$",true,OnSetEventInputFocus);return(false);}function SaveEvent(){g_bEventSavingObj=true;EventsList.OnSaveObject();}function OnHideEventsDialog(){document.getElementById("event_Description").scrollTop="0";document.getElementById("event_Data2").scrollTop="0";EventFilterList.EnableUpdates(false);ClearGrid(EventFilterList,true);EventsList.EnableUpdates(true);if(!g_bEventSavingObj){var objRequest=undefined;objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%CDomain."+g_EditObjectID+".SUEvent");if(objRequest){objRequest.setParameter("IDs",g_EditObjectID);objRequest.request(null);}}}function OnCancelEvent(){HideDialog('EventsDialog');}function OnEventHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-Events.htm",sExpandNode);}function OnEventActionChange(sValue){var sEventActionGroupHeight="135px",sEvent_Data2Height="75px";switch(parseInt(sValue)){case 0:document.getElementById("data1-text").innerHTML="$EVENTS_EMAIL_SUBJECT_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_EMAIL_BODY_LABEL$";document.getElementById("email-event").style.display="block";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="265px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 1:document.getElementById("data1-text").innerHTML="$EVENTS_BALLOON_TITLE_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_BALLOON_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 2:document.getElementById("data1-text").innerHTML="$EVENTS_COMMAND_LINE_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="none";document.getElementById("exec-event").style.display="block";document.getElementById("exec-event-wait").style.display="block";sEventActionGroupHeight="170px";document.getElementById("EventActionGroupFS").style.height=sEventActionGroupHeight;document.getElementById("EventActionGroupFS").style.width="400px";break;case 4:document.getElementById("data1-text").innerHTML="$EVENTS_MSMQ_WRITE_TITLE_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_MSMQ_WRITE_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 3:document.getElementById("data2-text").innerHTML="$SUEVENT_ACTION_WRITE_EVENT_LOG_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="none";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";sEvent_Data2Height="109px";break;default:document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="none";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="155px";break;}document.getElementById("event_Data2").style.height=sEvent_Data2Height;}CreateGroupBox("$EVENT_INFO_GROUP$","EventInfoGroup","400px","215px",true);CreateGroupBox("$EVENT_ACTION_GROUP$","EventActionGroup","400px","135px",true);var g_aServerEventIDs=[1,2,3];var g_aDomainServerEventIDs=[100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121];var g_aEventIDs=[200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,300,301,302,303,304,305,306,400,401,402,403,406,407,404,405,500,501,502,503,600,601];var g_aServerEventText=["$SUEVENT_ID_SERVER_START_TEXT$","$SUEVENT_ID_SERVER_STOP_TEXT$","$SUEVENT_ID_SECURITY_ALERT_TEXT$"];var g_aDomainServerEventText=["$SUEVENT_ID_DOMAIN_START_TEXT$","$SUEVENT_ID_DOMAIN_STOP_TEXT$","$SUEVENT_ID_SESSION_CONNECT_TEXT$","$SUEVENT_ID_SESSION_DISCONNECT_TEXT$","$SUEVENT_ID_SESSION_CONNECT_FAILURE_TEXT$","$SUEVENT_ID_LOG_DELETED_TEXT$","$SUEVENT_ID_LOG_ROTATED_TEXT$","$SUEVENT_ID_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_LISTENER_STOP_TEXT$","$SUEVENT_ID_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_STOP_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_STOP_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_STOP_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_SUCCESS_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_ERROR_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_MOVE_FILE_TEXT$"];var g_aEventIDText=["$SUEVENT_ID_USER_LOGIN_TEXT$","$SUEVENT_ID_USER_LOGOUT_TEXT$","$SUEVENT_ID_USER_LOGIN_FAILURE_TEXT$","$SUEVENT_ID_USER_PASSWORD_CHANGE_TEXT$","$SUEVENT_ID_USER_PASSWORD_CHANGE_FAILURE_TEXT$","$SUEVENT_ID_USER_ENABLED_TEXT$","$SUEVENT_ID_USER_DISABLED_TEXT$","$SUEVENT_ID_USER_DELETED_TEXT$","$SUEVENT_ID_USER_ADDED_TEXT$","$SUEVENT_ID_USER_PASSWORD_RECOVERY_SENT_TEXT$","$SUEVENT_ID_USER_PASSWORD_RECOVERY_FAILED_TEXT$","$SUEVENT_ID_USER_PASSWORD_STALE_TEXT$","$SUEVENT_ID_USER_AUTOMATICALLY_DISABLED_TEXT$","$SUEVENT_ID_USER_AUTOMATICALLY_DELETED_TEXT$","$SUEVENT_ID_USER_PREDISABLE_TEXT$","$SUEVENT_ID_USER_PREDELETE_TEXT$","$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_TEXT$","$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_FAILURE_TEXT$","$SUEVENT_ID_IP_BLOCKED_TEXT$","$SUEVENT_ID_IP_BLOCKED_TIME_TEXT$","$SUEVENT_ID_TOO_MANY_SESSIONS_TEXT$","$SUEVENT_ID_TOO_MANY_SESSIONS_ON_IP_TEXT$","$SUEVENT_ID_IP_ADDR_AUTO_BLOCKED_TIME_TEXT$","$SUEVENT_ID_SESSION_IDLE_TIMEOUT_TEXT$","$SUEVENT_ID_SESSION_TIMEOUT_TEXT$","$SUEVENT_ID_FILE_UPLOAD_TEXT$","$SUEVENT_ID_FILE_UPLOAD_FAIL_TEXT$","$SUEVENT_ID_FILE_DOWNLOAD_TEXT$","$SUEVENT_ID_FILE_DOWNLOAD_FAIL_TEXT$","$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_TEXT$","$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_FAIL_TEXT$","$SUEVENT_ID_FILE_DELETE_TEXT$","$SUEVENT_ID_FILE_MOVE_TEXT$","$SUEVENT_ID_DIR_CREATE_TEXT$","$SUEVENT_ID_DIR_DELETE_TEXT$","$SUEVENT_ID_DIR_CHANGE_TEXT$","$SUEVENT_ID_DIR_MOVE_TEXT$","$SUEVENT_ID_QUOTA_OVERAGE_TEXT$","$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$"];var aEventActions=[0,1,2];var aEventActionText=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$","$SUEVENT_ACTION_EXEC_TEXT$"];if(g_bSupportWinEventLog){aEventActionText.push("$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$");aEventActions.push(3);}if(g_bSupportsMSMQ){aEventActionText.push("$SUEVENT_ACTION_MSMQ_WRITE_TEXT$");aEventActions.push(4);}var sEventObjectType="Domain";var aJoinedEventIDs;var aJoinedEventText;switch(sEventObjectType.toLowerCase()){case"server":aJoinedEventIDs=g_aServerEventIDs.concat(g_aDomainServerEventIDs,g_aEventIDs);aJoinedEventText=g_aServerEventText.concat(g_aDomainServerEventText,g_aEventIDText);break;case"domain":aJoinedEventIDs=g_aDomainServerEventIDs.concat(g_aEventIDs);aJoinedEventText=g_aDomainServerEventText.concat(g_aEventIDText);break;default:aJoinedEventIDs=g_aEventIDs;aJoinedEventText=g_aEventIDText;break;}var EventIDComboBox=CreateComboBox(aJoinedEventText[0],aJoinedEventIDs[0],aJoinedEventText,aJoinedEventIDs,"EventID","EventID",undefined,"OnEventTypeLoad()",false,370,20,OnSaveEvent);EventIDComboBox.onCurrentItemChangedEvent=EventIDComboBox.onCurrentItemChangedDef;EventIDComboBox.onCurrentItemChanged=function(nNewIndex){var nNewValue;nNewValue=this.getItemValue(nNewIndex);document.getElementById(this.getContent("hidden").getId()).value=nNewValue;this.onCurrentItemChangedEvent(nNewIndex);};EventIDComboBox.initValue=function(value,defaultvalue){if(value!=0){this.setControlText(GetEventIDText(value));this.setControlValue(value);}else this.onCurrentItemChanged(0);};function OnLoadEventDisabled(sValue){EventEnabledCheck.setChecked(sValue=="1");}var EventActionComboBox=CreateComboBox(aEventActionText[0],aEventActions[0],aEventActionText,aEventActions,"Action","Action",OnEventActionChange,"OnEventActionLoad()",false,370,20,OnSaveEvent);var EventNameInput=CreateInputField("","EventNameInput","EventName",undefined,370,undefined,undefined,OnSaveEvent);var EventEmailToInput=CreateInputField("","EmailToAddressInput","EmailToAddress",undefined,337,undefined,undefined,OnSaveEvent);document.getElementById("EmailToAddress").title="$EVENTS_EMAIL_TO_NOTE$";var EventEmailBCCInput=CreateInputField("","EmailToAddressBCCInput","EmailToAddressBCC",undefined,337,undefined,undefined,OnSaveEvent);document.getElementById("EmailToAddressBCC").title="$EVENTS_EMAIL_TO_NOTE$";var AddGroupsEmailToButton=CreatePushButton("","AddGroupsEmailToButton",OnCreateGroupEmailDialog,undefined,undefined,["To"],"GroupEmail");document.getElementById("AddGroupsEmailToButton").firstChild.title="$GROUP_EMAIL_TO_NOTE$";var AddGroupsEmailBCCButton=CreatePushButton("","AddGroupsEmailBCCButton",OnCreateGroupEmailDialog,undefined,undefined,["BCC"],"GroupEmail");document.getElementById("AddGroupsEmailBCCButton").firstChild.title="$GROUP_EMAIL_BCC_NOTE$";var Data1Input=CreateInputField("","Data1Input","Data1",undefined,370,undefined,undefined,OnSaveEvent);var EventExecPathInput=CreateInputField("","ExeFilePathInput","ExeFilePath",undefined,338,undefined,undefined,OnSaveEvent);var EventEnabledCheck=CreateCheckBox("$ENABLE_EVENT$","EventDisabled","Enabled",false,undefined,true,"OnLoadEventDisabled()",false);var EventExecWaitMsec=CreateInputField("","ExecWaitSecs","ExecWaitSecs",undefined,50,undefined,undefined,OnSaveEvent);CreateDialogPushButton("$SAVE_BUTTON$","SaveEventButton",OnSaveEvent);CreateDialogPushButton("$CANCEL_BUTTON$","CancelEventButton",OnCancelEvent);var ExecPathBrowse=CreatePushButton("","BrowseButtonExecPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[EventExecPathInput,true,"0","0"]]);ExecPathBrowse.setControlImage("Browse");CreateDialogPushButton("$HELP_BUTTON$","HelpEventButton",OnEventHelp);function OnCreateGroupEmailDialog(aEmailType){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/GroupEmailDialogs.htm?ID=%ID%","GroupEmailDialogs",String("OnShowGroupEmailDialog("),aEmailType]);}CreatePushButton("$ADD_BUTTON$...","AddEventFilterButton",OnDelayLoadAddFilterDialog);CreatePushButton("$EDIT_BUTTON$...","EditEventFilterButton",OnDelayLoadEditFilterDialog);CreatePushButton("$DELETE_BUTTON$","DeleteEventFilterButton",OnRemoveEventFilter);function OnDelayLoadAddFilterDialog(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/EventRulesDialog.htm?ID=%ID%","FilterDialogDiv",OnAddEventFilter]);}function OnDelayLoadEditFilterDialog(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/EventRulesDialog.htm?ID=%ID%","FilterDialogDiv",OnEditEventFilter]);}function OnAddEventFilter(){EventFilterList.OnAddObject("EventFilter.xml%ADD_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule&Temp=1","Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule.",document.EventsFilterForm,"EventRulesDialog",[OnLoadFilterComp,OnHideFilterComp],g_bReadOnlyAccess,undefined,true);}function OnEditEventFilter(){EventFilterList.OnEditObject("EventFilter.xml","Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule.",document.EventsFilterForm,"EventRulesDialog","$SELECT_ONLY_ONE_EVENT_FILTER_EDIT$","$SELECT_ONLY_ONE_EVENT_FILTER_EDIT$",[OnLoadFilterComp,OnHideFilterComp],undefined,undefined,undefined,undefined,true);}function OnRemoveEventFilter(){EventFilterList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule&ID=%ID%","$ASK_DELETE_EVENT_FILTER$","$SELECT_ONE_EVENT_FILTER_DELETE$");}function OnLoadFilterComp(){var nLogicDefault;EventFilterList.EnableUpdates(false);g_EventRuleObjID=document.getElementById("RuleObjectID").value;EventFilterCompList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventRuleObjID);nLogicDefault=(isNaN(parseInt(EventFilterList.getCellValue(2,EventFilterList.getSelectedRows())))?0:(parseInt(EventFilterList.getCellValue(2,EventFilterList.getSelectedRows()))));EventRuleLogic.initValue(nLogicDefault);}function OnHideFilterComp(){EventFilterCompList.EnableUpdates(false);ClearGrid(EventFilterCompList,true);EventFilterList.EnableUpdates(true);}function OnEnableDisableFilter(bEnable){var EditCells=new Array();EditCells=EventFilterList.getSelectedRows().toString().split(",");var EventEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(EventFilterList.getCellData((EventFilterList.m_nNumColumns-1),EditCells[nIndex]));EventEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule."+nObjectID+"&StaticOnly=1");EventEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;EventEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;EventEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);EventEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};EventEnabledDisabledRequest[nIndex].request(null);}}function OnEnableFilterContextMenu(){if(FilterEnableOrDisable()[1]&&EventFilterList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_FILTER$";else sMenuItemName="";return(sMenuItemName);}function OnDisableFilterContextMenu(){if(FilterEnableOrDisable()[0]&&EventFilterList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_FILTER$";else sMenuItemName="";return(sMenuItemName);}function OnEnableFilterContextImage(){if(FilterEnableOrDisable()[1])sImageClass="FilterEnabled";else sImageClass="";return(sImageClass);}function OnDisableFilterContextImage(){if(FilterEnableOrDisable()[0])sImageClass="FilterDisabled";else sImageClass="";return(sImageClass);}function FilterEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=EventFilterList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(EventFilterList.getCellText(3,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}</script><div id="CommonEventsDialoginner" style="display:none;"><div style="display:inline;"><img alt="$COMMON_EVENTS$" src="%ADMIN_FILE%Images/Command32.png" width="32" height="32" class="header-icon" />$COMMON_EVENT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="CommonEventsForm" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="CommonEventGroup"><div id="CommonEventsRadioDiv" style="padding:0 0 5px 5px;"><span id="CommonEventActionRadio"></span></div><div style="padding:0 0 5px 5px;display:none;"id="CommonEventsEmailDiv">$SUEVENT_ACTION_EMAIL_TEXT$</div><div id="emailto-commonevent" style="display:none;padding:0 0 5px 5px;">$EVENTS_EMAIL_TO_LABEL$:<div style="overflow:auto" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"><span id="CommonEventEmailToInput"></span></div></div><div id="MSMQPath-commonevent" style="display:none;padding:0 0 5px 5px;">$EVENTS_MSMQ_WRITE_TITLE_LABEL$:<div style="overflow:auto" ><span id="CommonEventMSMQPathInput"></span></div></div></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveCommonEventButton"></span><br /><span id="CancelCommonEventButton"></span><br /><br /><span id="HelpCommonEventButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$COMMON_EVENTS$","CommonEventsDialog","390","290","","$CLOSE_CANCEL$","cmd-16.png");function OnCreateCommonEvents(){ShowDialog("CommonEventsDialog");}function OnCancelCommonEvent(){HideDialog('CommonEventsDialog');}function OnCommonEventChange(nCommonEvent){if(parseInt(nCommonEvent)==0){document.getElementById("MSMQPath-commonevent").style.display="none";document.getElementById("emailto-commonevent").style.display="block";document.getElementById("CommonEventGroupFS").style.height="120px";}else if(parseInt(nCommonEvent)==3){if(!g_bMSMQLicense){AlertDialog("$WARN_MSMQ_EVENT_NO_LICENSE$");setTimeout(function(){CommonEventActionRadio.setSelectedItems([0]);},0);}else{document.getElementById("emailto-commonevent").style.display="none";document.getElementById("MSMQPath-commonevent").style.display="block";document.getElementById("CommonEventGroupFS").style.height="120px";}}else{document.getElementById("MSMQPath-commonevent").style.display="none";document.getElementById("emailto-commonevent").style.display="none";document.getElementById("CommonEventGroupFS").style.height="80px";}}function OnSaveCommonEvent(){var nActionValue=parseInt(document.getElementById(CommonEventActionRadio.getContent("hidden").getId()).value);var sActionEmailTo=CommonEventEmailToInput.getControlText();var sActionMSMQPath=CommonEventMSMQPathInput.getControlText();if(nActionValue==0)sCmd="CreateCommonEmailEvents&EmailAddress="+sActionEmailTo;else if(nActionValue==2)sCmd="CreateCommonWriteEventLogEvents";else if(nActionValue==3)sCmd="CreateCommonMSMQWriteEvents&MSMQPath="+sActionMSMQPath;else sCmd="CreateCommonBalloonTipEvents";var sCommonEventsCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CDomain."+g_EditObjectID+"."+sCmd;var CommonEventsRequest=CreatePostRequest(sCommonEventsCmd);CommonEventsRequest.setAsync(true);CommonEventsRequest.request();CommonEventsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else HideDialog("CommonEventsDialog");};}CreateGroupBox("$COMMON_EVENT_ACTION_GROUP$","CommonEventGroup","280px","125px",true);var asCommonEventRadioText=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$"];var anCommonEventRadioVals=[0,1];if(g_bSupportWinEventLog){asCommonEventRadioText.push("$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$");anCommonEventRadioVals.push(2);}if(g_bSupportsMSMQ){asCommonEventRadioText.push("$SUEVENT_ACTION_MSMQ_WRITE_TEXT$");anCommonEventRadioVals.push(3);}var CommonEventActionRadio=CreateRadioButtons(0,asCommonEventRadioText,"CommonEventActionRadio","CommonEventActionRadio","265px",OnCommonEventChange,anCommonEventRadioVals);if(g_bSafariBrowser)document.getElementById("CommonEventActionRadio-box").style.height="45px";var CommonEventEmailToInput=CreateInputField("","CommonEventEmailToInput","CommonEventEmailTo",undefined,250,undefined,undefined,OnSaveCommonEvent);var CommonEventMSMQPathInput=CreateInputField("","CommonEventMSMQPathInput","CommonEventMSMQPath",undefined,250,undefined,undefined,OnSaveCommonEvent);CreateDialogPushButton("$OK_BUTTON$","SaveCommonEventButton",OnSaveCommonEvent);CreateDialogPushButton("$CANCEL_BUTTON$","CancelCommonEventButton",OnCancelCommonEvent);CreateDialogPushButton("$HELP_BUTTON$","HelpCommonEventButton",OnEventHelp);</script><form id="myform"><div id="SMTPTestingDialoginner" style="display:none;"><div id="SMTPTestingContent" class="tabs-content"><div id="SMTPTestingSendData"><div style="padding: 0 0 5px 5px;"><span id="SMTPToAddrsError" class="Hidden"><label id='ErrorAddrLabel' class="Error" style="font-size: 12px;"> $SMTP_PARAMETER_ERROR$</label> <br /></span>$EVENTS_EMAIL_SUBJECT_LABEL$: <br /><span id="SMTPTestSubjectInput"></span> <br /><div style="padding-top:5px;clear:both;">$EVENTS_EMAIL_BODY_LABEL$:</div><div style="overflow:auto;clear:both;"><textarea name="SMTPTestMessageInput" id="SMTPTestMessageInput" class="aw-border" style="width:395px;height:75px;"></textarea></div><div style="padding-top:5px;clear:both;"><label id="SMTPToAddressLabel">$SMTP_TO_ADDRESS_LABEL$:</label><br /></div><div style="overflow:auto"><span id="SMTPTestToAddressInput"></span><br /></div></div></div></div><div style="text-align:right;padding:10px 20px 0 0;"><span id="SendSMTPTestDataButton"></span><span id="CancelSMTPTestingButton"></span></div></div></form><script type="text/javascript" language="javascript">BuildDialog("$SMTP_TESTING_TITLE$","SMTPTestingDialog","430","675","","$CLOSE_CANCEL$","Email16.png");function OnSMTPTesting(){
ShowDialog("SMTPTestingDialog");}function OnCancelSMTPTesting(){HideDialog("SMTPTestingDialog");}function ShowAlertSMTPParametersDialog(sLabel){var sRequiredField="$SMTP_REQUIRED_FIELD$";sRequiredField=sRequiredField.replace("$Label",sLabel);AlertDialog(sRequiredField,true);return false;}function IsSMTPToAddressValid(sToAddress){var SMTPToAddr=document.getElementById('SMTPToAddressLabel');var errorLbl=document.getElementById('SMTPToAddrsError');var nRet=false;if(!IsValidEmailAddressString(sToAddress)){SMTPToAddr.setAttribute("class","Error");errorLbl.removeAttribute("class","Hidden");nRet=false;}else{SMTPToAddr.removeAttribute("class","Error");errorLbl.setAttribute("class","Hidden");nRet=true;}return nRet;}function OnNoResponse(){BusyDialog(false);AlertDialog("$SESS_SMTP_NO_RESPONSE$",true,undefined,undefined,"$CANCEL_BUTTON$",OnCancelSMTPTesting);}function OnRecieveResponse(XMLDoc,bSsl){var SESS_SMTP_TIMEOUT=55;var SESS_INVALID_PARAMETER=4;var SESS_SMTP_CONNECTION_ERROR=50;var SMTP_COMMUNICATION_FAILED=54;BusyDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sSMTPResultText=GetXMLValue(XMLDoc,"SMTPServerResponse");if(nResult==0){AlertDialog("$SMTP_CONFIGURATION_SUCCESS$",undefined,OnSaveSMTPConfig,undefined,"$NO_BUTTON$",OnCancelSMTPTesting);}else if(nResult==SMTP_COMMUNICATION_FAILED){var sResultDetails="$SESS_SMTP_UNSPECIFIED_ERROR$";OnSMTPShowLogs(sResultText,sResultDetails);}else if(nResult==SESS_SMTP_TIMEOUT&&bSsl==0){var sResultDetails="$SMTP_TIMEOUT_SSL_ERROR$";OnSMTPShowLogs(sResultText,sResultDetails);}else if((typeof sSMTPResultText!='undefined')&&(sSMTPResultText!="%SMTP_RESULT_TEXT%")){var sResultHint;if(nResult==SESS_SMTP_CONNECTION_ERROR&&bSsl==1&&(sSMTPResultText.indexOf("SSL Error:")>-1)){sResultHint="$SMTP_CONNECTION_SSL_ERROR$";}var sFinalResult;sFinalResult=sSMTPResultText+"\n\n";if(typeof sResultHint!='undefined'){sFinalResult+=sResultHint+"\n";}OnSMTPShowLogs(sResultText,sFinalResult);}else{AlertDialog(sResultText,true,undefined,undefined);}}function SendTestSMTPMail(sSMTPServerIP,sSMTPServerPort,sSMTPFromAddress,sSMTPFromName,sSMTPToAddress,bSMTPRequiredLogin,sSMTPAccountName,sSMTPPassword,bSMTPSsl,bSMTPUseSslCertificate,bSMTPUseExplicitSSL,sSMTPSubject,sSMTPMessage){var WAITING_RESPONSE_TIME_MS=100000;var sTestSMTPCmd="%ADMIN_FILE%XML/SMTPResult.xml%OBJECT_COMMAND_REF%CDomain.%ID%.CheckingSMTPConfiguration";var TestSMTPRequest=CreatePostRequest(sTestSMTPCmd);var SMTPNoResponseTimeOut;TestSMTPRequest.setParameter("SMTPServer",sSMTPServerIP);TestSMTPRequest.setParameter("SMTPServerPort",sSMTPServerPort);TestSMTPRequest.setParameter("SMTPFromAddress",sSMTPFromAddress);TestSMTPRequest.setParameter("SMTPFromName",sSMTPFromName);TestSMTPRequest.setParameter("SMTPSSL",bSMTPSsl);TestSMTPRequest.setParameter("SMTPUseSSLCertificate",bSMTPUseSslCertificate);TestSMTPRequest.setParameter("SMTPUseExplicitSSL",bSMTPUseExplicitSSL);TestSMTPRequest.setParameter("SMTPToAddress",sSMTPToAddress);TestSMTPRequest.setParameter("SMTPSubject",sSMTPSubject);TestSMTPRequest.setParameter("SMTPMessage",sSMTPMessage);TestSMTPRequest.setParameter("SMTPRequiresLogin",bSMTPRequiredLogin);if(bSMTPRequiredLogin==1){TestSMTPRequest.setParameter("SMTPAccountName",sSMTPAccountName);TestSMTPRequest.setParameter("SMTPPassword",sSMTPPassword);}TestSMTPRequest.request();BusyDialog(true,"$SENDING_EMAIL_BUSY_DIALOG$");SMTPNoResponseTimeOut=setTimeout(OnNoResponse,WAITING_RESPONSE_TIME_MS);TestSMTPRequest.response=function(XMLDoc){clearTimeout(SMTPNoResponseTimeOut);OnRecieveResponse(XMLDoc,bSMTPSsl);};}function OnGetSMTPTestingData(){var requiresLogin,server,port,accountName,password,fromAddress,fromName,ssl,useSslCert,useExplicitSSL,toAddress;var smtpTestSubject,smtpTestMessage,smtpTestToAddress;smtpTestSubject=SMTPTestSubjectInput.getControlText();smtpTestMessage=SMTPTestMessageInput.value;smtpTestToAddress=SMTPTestToAddressInput.getControlText();requiresLogin=((SMTPRequireLoginCheckbox.getControlValue())?"1":"0");server=Trim(SMTPServerCombo.getControlText());port=SMTPPortCombo.getControlText();accountName=SMTPAccountNameCombo.getControlText();password=SMTPPasswordCombo.getControlText();fromAddress=SMTPFromAddressCombo.getControlText();fromName=SMTPFromNameCombo.getControlText();ssl=((SMTPRequiresSSLCheckbox.getControlValue())?"1":"0");useSslCert=((SMTPUseSSLCertCheckbox.getControlValue())?"1":"0");useExplicitSSL=((SMTPUseExplicitSSLCheckbox.getControlValue())?"1":"0");if(IsSMTPToAddressValid(smtpTestToAddress)){SendTestSMTPMail(server,port,fromAddress,fromName,smtpTestToAddress,requiresLogin,accountName,password,ssl,useSslCert,useExplicitSSL,smtpTestSubject,smtpTestMessage);OnCancelSMTPTesting();}}function OnAdressChanged(){var SMTPToAddr=document.getElementById('SMTPToAddressLabel');IsSMTPToAddressValid(this.getControlText());}var SMTPTestSubjectInput=CreateInputField("$SMTP_TEST_EMAIL_SUBJECT$","SMTPTestSubjectInput","SMTPTestSubject",undefined,400);var SMTPTestToAddressInput=CreateInputField("","SMTPTestToAddressInput","SMTPTestToAddress",OnAdressChanged,400);var SMTPMsgBody=document.getElementById('SMTPTestMessageInput');SMTPMsgBody.value="$SMTP_TEST_EMAIL_BODY$";CreateDialogPushButton("$SEND_BUTTON$","SendSMTPTestDataButton",OnGetSMTPTestingData);CreateDialogPushButton("$CANCEL_BUTTON$","CancelSMTPTestingButton",OnCancelSMTPTesting);</script><div id="LogDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div id="logwindow" class="SpyLogScroll"><div id="log" style="width:100%;"></div></div><span id="CloseLog"></span></div></div><script type="text/javascript" language="javascript">var g_sAttrLogObjectType="Domain";var g_nAttrLogObjectId=%ID%;var g_sFilterLogText="";var g_GridToReload;BuildDialog("$LOG_DIALOG_TITLE$","LogDialog","775","300","","$CLOSE_CANCEL$");function OnShowLogDialog(){g_GridToReload=undefined;try{if(awActiveGrid!=undefined&&awActiveGrid.m_bUpdates)g_GridToReload=awActiveGrid;}catch(e){try{if(g_ActiveRezizeGrid!=undefined&&g_ActiveRezizeGrid.m_bUpdates)g_GridToReload=g_ActiveRezizeGrid;}catch(e){try{if(awSecondaryActiveGrid!=undefined&&awSecondaryActiveGrid.m_bUpdates)g_GridToReload=awSecondaryActiveGrid;}catch(e){g_GridToReload=undefined;}}}if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(false);InitDomainAttrLog();FreezeDomainAttrLog(false);ShowDialog("LogDialog",undefined,ResetLogDialog);}function ResetLogDialog(){if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(true);FreezeDomainAttrLog(true);document.getElementById("log").innerHTML="";}function OnOkViewLog(){HideDialog('LogDialog');}CreateDialogPushButton("$CLOSE_BUTTON$","CloseLog",OnOkViewLog);InitLog("log","",0);</script><div id="SMTPErrorDialoginner" style="display:none;"><div id="SMTPTErrorContent" class="tabs-content"><div id="SMTPErrors"><div style="padding: 0 0 5px 5px;"><label id="ErrorLabel"></label><div style="padding-top:5px;clear:both;">$SMTP_ERROR_DETAILS$:</div><div style="overflow:auto;clear:both;"><textarea name="SMTPLogsInput" id="SMTPLogsInput" class="aw-border" style="width:395px;height:95px;"></textarea></div></div></div></div><div style="text-align:right;padding:10px 20px 0 0;"><span id="SMTPViewLogsButton"></span><span id="CloseSMTPLogsButton"></span></div></div><script type="text/javascript" language="javascript">BuildDialog("$SMTP_ERROR_DIALOG_TITLE$","SMTPErrorDialog","430","675","","$CLOSE_CANCEL$","Email16.png");function OnSMTPShowLogs(sError,sErrorDetails){var SMTPErrorLabel=document.getElementById('ErrorLabel');SMTPErrorLabel.innerText=sError;var SMTPLogTextArea=document.getElementById('SMTPLogsInput');SMTPLogTextArea.value=sErrorDetails;SMTPLogTextArea.disabled=true;ShowDialog("SMTPErrorDialog");}function OnCancelSMTPLogs(){HideDialog("SMTPErrorDialog");OnCancelSMTPTesting();}CreateDialogPushButton("$VIEW_LOG$","SMTPViewLogsButton",OnShowLogDialog);CreateDialogPushButton("$CLOSE_BUTTON$","CloseSMTPLogsButton",OnCancelSMTPLogs);</script><div id="SMTPConfigDialoginner" style="display:none;"><div style="display:inline;"><img alt="$SMTP_CONFIG$" src="%ADMIN_FILE%Images/Email32.png" width="32" height="32" class="header-icon" />$SMTP_CONFIG_INFO_DOMAIN$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="SMTPConfigForm" id="SMTPConfigForm" onsubmit="return (false);"><div style="padding:0 0 5px 5px;"><span id="SMTPParametersError" class="Hidden"><label id='ErrorLabel' class="Error" style="font-size: 12px;"> $SMTP_PARAMETER_ERROR$</label><br /></span></div><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="SMPTServerGroup"><div style="padding:0 0 5px 5px;"><label id='smtpServerLbl'>$SMTP_SERVER_LABEL$:</label><div style="overflow:auto"><span id="SMTPServer"></span></div><label id='smtpPortLbl'>$SMTP_PORT_LABEL$:</label><div style="overflow:auto"><span id="SMTPServerPort"></span></div><div><span id="SMTPSSL"></span></div><div id="SMPTCertDiv" style="display:none;"><span id="SMTPUseSSLCertificate"></span></div><div id="SMTPExplicitDiv" style="display:none;"><span id="SMTPUseExplicitSSL"></span></div><label id='fromAddressLbl'>$SMTP_FROM_ADDRESS_LABEL$:</label><div style="overflow:auto"><span id="SMTPFromAddress"></span></div>$SMTP_FROM_NAME_LABEL$ ($OPTIONAL$):<div style="overflow:auto"><span id="SMTPFromName"></span></div><div><span id="SMTPRequiresLogin"></span></div></div></span><span id="SMPTAuthGroup" style="display:none;"><div style="padding:0 0 5px 5px;"><label id="accountNameLbl">$SMTP_ACCOUNT_NAME_LABEL$:</label><div style="overflow:auto"><span id="SMTPAccountName"></span></div>$SMTP_ACCOUNT_PASSWORD_LABEL$:<div style="overflow:auto"><span id="SMTPPassword"></span></div></div></span><div style="padding:5px 0 5px 10px;"><span id="TestSMTPConfigButton"></span><br /></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveSMTPConfigButton"></span><br /><span id="CancelSMTPConfigButton"></span><br /><br /><span id="HelpSMTPConfigButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var sPortValue,sDefaultPortValue;BuildDialog("$SMTP_CONFIG_TITLE$","SMTPConfigDialog","450","390","","$CLOSE_CANCEL$","Email16.png");function OnSMTPConfig(){CleanupErrors();ShowHideSMTPAuth();ShowDialog("SMTPConfigDialog");}function ShowHideSMTPAuth(){var bValue=SMTPRequireLoginCheckbox.getControlValue();if(bValue)document.getElementById("SMPTAuthGroup").style.display="block";else document.getElementById("SMPTAuthGroup").style.display="none";}function ShowHideSMTPSSLCert(){var bValue=SMTPRequiresSSLCheckbox.getControlValue();var bExplicitSSL=SMTPUseExplicitSSLCheckbox.getControlValue();if(bValue){document.getElementById("SMPTCertDiv").style.display="block";document.getElementById("SMTPExplicitDiv").style.display="block";if(!bExplicitSSL){SMTPPortCombo.initValue("465",sDefaultPortValue);SMTPPortCombo.setControlText("465");}else{if(sPortValue.length)SMTPPortCombo.setControlText(sPortValue);else SMTPPortCombo.setControlText(sDefaultPortValue);}}else{document.getElementById("SMPTCertDiv").style.display="none";document.getElementById("SMTPExplicitDiv").style.display="none";SMTPPortCombo.initValue(sPortValue,sDefaultPortValue);if(sPortValue.length)SMTPPortCombo.setControlText(sPortValue);else SMTPPortCombo.setControlText(sDefaultPortValue);}}function OnToggleExplicitSSL(){var bValue=SMTPUseExplicitSSLCheckbox.getControlValue();if(bValue){if(sPortValue.length)SMTPPortCombo.setControlText(sPortValue);else SMTPPortCombo.setControlText(sDefaultPortValue);}else{SMTPPortCombo.initValue("465",sDefaultPortValue);SMTPPortCombo.setControlText("465");}}function OnCancelSMTPConfig(){HideDialog('SMTPConfigDialog');}function OnSaveSMTPConfigEx(){var requiresLogin,server,port,accountName,password,fromAddress,fromName,ssl,useSslCert,useExplicitSSL;if(bSMTPTriState){requiresLogin=document.getElementById(SMTPRequireLoginCheckbox.getContent("hidden").getId()).value;server=Trim(document.getElementById(SMTPServerCombo.getContent("hidden").getId()).value);port=document.getElementById(SMTPPortCombo.getContent("hidden").getId()).value;accountName=document.getElementById(SMTPAccountNameCombo.getContent("hidden").getId()).value;password=document.getElementById(SMTPPasswordCombo.getContent("hidden").getId()).value;fromAddress=document.getElementById(SMTPFromAddressCombo.getContent("hidden").getId()).value;fromName=document.getElementById(SMTPFromNameCombo.getContent("hidden").getId()).value;ssl=document.getElementById(SMTPRequiresSSLCheckbox.getContent("hidden").getId()).value;useSslCert=document.getElementById(SMTPUseSSLCertCheckbox.getContent("hidden").getId()).value;useExplicitSSL=document.getElementById(SMTPUseExplicitSSLCheckbox.getContent("hidden").getId()).value;}else{requiresLogin=((SMTPRequireLoginCheckbox.getControlValue())?"1":"0");server=Trim(SMTPServerCombo.getControlText());port=SMTPPortCombo.getControlText();accountName=SMTPAccountNameCombo.getControlText();password=SMTPPasswordCombo.getControlText();fromAddress=SMTPFromAddressCombo.getControlText();fromName=SMTPFromNameCombo.getControlText();ssl=((SMTPRequiresSSLCheckbox.getControlValue())?"1":"0");useSslCert=((SMTPUseSSLCertCheckbox.getControlValue())?"1":"0");useExplicitSSL=((SMTPUseExplicitSSLCheckbox.getControlValue())?"1":"0");}SavingDialog(true);var sSMTPConfigCmd="%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain."+g_EditObjectID+"&StaticOnly=1";var SMTPConfigRequest=CreatePostRequest(sSMTPConfigCmd);SMTPConfigRequest.setParameter("SMTPRequiresLogin",requiresLogin);SMTPConfigRequest.setParameter("SMTPServer",server);SMTPConfigRequest.setParameter("SMTPServerPort",port);SMTPConfigRequest.setParameter("SMTPAccountName",accountName);SMTPConfigRequest.setParameter("SMTPPassword",password);SMTPConfigRequest.setParameter("SMTPFromAddress",fromAddress);SMTPConfigRequest.setParameter("SMTPFromName",fromName);SMTPConfigRequest.setParameter("SMTPSSL",ssl);SMTPConfigRequest.setParameter("SMTPUseSSLCertificate",useSslCert);SMTPConfigRequest.setParameter("SMTPUseExplicitSSL",useExplicitSSL);SMTPConfigRequest.request();SMTPConfigRequest.response=function(XMLDoc){BusyDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else HideDialog("SMTPConfigDialog");};}function OnSaveSMTPConfig(){var sRequiredField="$SMTP_REQUIRED_FIELD$";var server=String(SMTPServerCombo.getControlText());var fromAddress=String(SMTPFromAddressCombo.getControlText());if(server.length>0||fromAddress.length>0){if(server.length<1){sRequiredField=sRequiredField.replace("$Label","$SMTP_SERVER_LABEL$");AlertDialog(sRequiredField);}else if((fromAddress.length<1)||(!IsValidEmailAddressString(fromAddress))){sRequiredField=sRequiredField.replace("$Label","$SMTP_FROM_ADDRESS_LABEL$");AlertDialog(sRequiredField);}else OnSaveSMTPConfigEx();}else OnSaveSMTPConfigEx();}function OnSMTPConfigHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-SMTP.htm",sExpandNode);}function CleanupErrors(){var serverLbl=document.getElementById('smtpServerLbl');var portLbl=document.getElementById('smtpPortLbl');var accountNameLbl=document.getElementById('accountNameLbl');var fromAddressLbl=document.getElementById('fromAddressLbl');var errorLbl=document.getElementById('SMTPParametersError');var labelsArray=[serverLbl,portLbl,fromAddressLbl,accountNameLbl];var i;for(i=0;i<labelsArray.length;i++){labelsArray[i].removeAttribute("class","Error");}errorLbl.setAttribute("class","Hidden");}function OnParameterValid(server,port,fromAddress,loginRequired,accountName){var bRet=true;var nPort=parseInt(port);var errorLbl=document.getElementById('SMTPParametersError');CleanupErrors();if(server.length<1){document.getElementById('smtpServerLbl').setAttribute("class","Error");bRet=false;}if(isNaN(nPort)||nPort<0||nPort>parseInt(65535)){document.getElementById('smtpPortLbl').setAttribute("class","Error");bRet=false;}if(!IsValidEmailAddressString(fromAddress)){document.getElementById('fromAddressLbl').setAttribute("class","Error");bRet=false;}if(loginRequired){if((!IsValidEmailAddressString(accountName))){document.getElementById('accountNameLbl').setAttribute("class","Error");bRet=false;}}if(bRet==false){errorLbl.setAttribute("class","Hidden");}else{errorLbl.removeAttribute("class","Hidden");}return bRet;}function OnSMTPConfigCheck(){var server=SMTPServerCombo.getControlText();var port=SMTPPortCombo.getControlText();var requiresLogin=SMTPRequireLoginCheckbox.getControlValue();var accountName=SMTPAccountNameCombo.getControlText();var fromAddress=SMTPFromAddressCombo.getControlText();var errorLbl=document.getElementById('SMTPParametersError');if(OnParameterValid(server,port,fromAddress,requiresLogin,accountName)){errorLbl.setAttribute("class","Hidden");OnSMTPTesting();}else{errorLbl.removeAttribute("class","Hidden");}}function OnSMTPServerLoad(){var sServerValue=GetDecodedDirPath("%CDomain.%ID%.SMTPServer%");var sDefaultServerValue=GetDecodedDirPath("%CDomain.%ID%.SMTPServer.Default%");SMTPServerCombo.initValue(sServerValue,sDefaultServerValue);if(sServerValue.length){SMTPServerCombo.setControlText(sServerValue);}else SMTPServerCombo.setControlText(sDefaultServerValue);sPortValue="%CDomain.%ID%.SMTPServerPort%";sDefaultPortValue="%CDomain.%ID%.SMTPServerPort.Default%";SMTPPortCombo.initValue(sPortValue,sDefaultPortValue);if(sPortValue.length){SMTPPortCombo.setControlText(sPortValue);}else SMTPPortCombo.setControlText(sDefaultPortValue);var sSMTPFromValue=GetDecodedDirPath("%CDomain.%ID%.SMTPFromAddress%");var sDefaultSMTPFromValue=GetDecodedDirPath("%CDomain.%ID%.SMTPFromAddress.Default%");var sSMTPFromNameValue=GetDecodedDirPath("%CDomain.%ID%.SMTPFromName%");var sDefaultSMTPFromNameValue=GetDecodedDirPath("%CDomain.%ID%.SMTPFromName.Default%");SMTPFromNameCombo.initValue(sSMTPFromNameValue,sDefaultSMTPFromNameValue);if(sSMTPFromNameValue.length)SMTPFromNameCombo.setControlText(sSMTPFromNameValue);else SMTPFromNameCombo.setControlText(sDefaultSMTPFromNameValue);SMTPFromAddressCombo.initValue(sSMTPFromValue,sDefaultSMTPFromValue);if(sSMTPFromValue.length)SMTPFromAddressCombo.setControlText(sSMTPFromValue);else SMTPFromAddressCombo.setControlText(sDefaultSMTPFromValue);var sSMTPAccountNameValue=GetDecodedDirPath("%CDomain.%ID%.SMTPAccountName%");var sDefaultSMTPAccountNameValue=GetDecodedDirPath("%CDomain.%ID%.SMTPAccountName.Default%");var nDefaultSMTPAccountNameValue=parseInt("%CDomain.%ID%.SMTPAccountName.IsDefault%");SMTPAccountNameCombo.initValue(sSMTPAccountNameValue,sDefaultSMTPAccountNameValue);if(sSMTPAccountNameValue.length){SMTPAccountNameCombo.setControlText(sSMTPAccountNameValue);}else SMTPAccountNameCombo.setControlText(sDefaultSMTPAccountNameValue);if((bSMTPTriState)&&(nDefaultSMTPAccountNameValue)){setTimeout(function(){document.getElementById(SMTPAccountNameCombo.getContent("hidden").getId()).value="";},500);}var sSMTPPasswordValue=DecodeString("%CDomain.%ID%.SMTPPassword%");var sDefaultSMTPPasswordValue=DecodeString("%CDomain.%ID%.SMTPPassword.Default%");SMTPPasswordCombo.initValue(sSMTPPasswordValue,sDefaultSMTPPasswordValue);SMTPPasswordCombo.setControlText(sSMTPPasswordValue);document.getElementById(SMTPPasswordCombo.getContent("hidden").getId()).value=sSMTPPasswordValue;if(sSMTPPasswordValue.length)SMTPPasswordCombo.setControlText(sSMTPPasswordValue);else SMTPPasswordCombo.setControlText(sDefaultSMTPPasswordValue);}function BuildIEInput(){var SMTPForm=document.getElementById("SMTPPassword-box");var ElemId=SMTPPasswordCombo.getContent("box/text").getId();var InputElement=document.getElementById(ElemId);var sInputVal=InputElement.value;var NextSibling=InputElement.nextSibling;var sStyle=InputElement.getAttribute("style");var sClass=InputElement.className;var sName=InputElement.name;SMTPForm.removeChild(InputElement);var Passwd_field=document.createElement("INPUT");Passwd_field.setAttribute("type","password");Passwd_field.setAttribute("value",sInputVal);Passwd_field.setAttribute("style",sStyle);Passwd_field.setAttribute("name",sName);Passwd_field.setAttribute("id",ElemId);SMTPForm.insertBefore(Passwd_field,NextSibling);document.getElementById(ElemId).className=sClass;}CreateGroupBox("$SMTP_SERVER_GROUP$","SMPTServerGroup","320px","245px",true);CreateGroupBox("$SMTP_AUTH_GROUP$","SMPTAuthGroup","280px","100px",true);var bSMTPTriState=true;if(sEventObjectType.toLowerCase()=="server")bSMTPTriState=false;var SMTPServerCombo=CreateComboBox("","",[],[],"SMTPServer","SMTPServer",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPPortCombo=CreateComboBox("","",[],[],"SMTPServerPort","SMTPServerPort",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPAccountNameCombo=CreateComboBox("","",[],[],"SMTPAccountName","SMTPAccountName",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPPasswordCombo=CreateComboBox("","",[],[],"SMTPPassword","SMTPPassword",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);if(AW.ie)BuildIEInput();else SMTPPasswordCombo.getContent("box/text").setAttribute("type","password");var SMTPFromAddressCombo=CreateComboBox("","",[],[],"SMTPFromAddress","SMTPFromAddress",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPFromNameCombo=CreateComboBox("","",[],[],"SMTPFromName","SMTPFromName",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPRequiresSSLCheckbox,SMTPUseSSLCertCheckbox,SMTPUseExplicitSSLCheckbox;if(bSMTPTriState){SMTPRequiresSSLCheckbox=CreateTriStateCheckBox("$SMTP_REQUIRE_SSL$","SMTPSSL","SMTPSSL","%CDomain.%ID%.SMTPSSL%","%CDomain.%ID%.SMTPSSL.Default%","%CDomain.%ID%.SMTPSSL.IsDefault%",ShowHideSMTPSSLCert);SMTPUseSSLCertCheckbox=CreateTriStateCheckBox("$SMTP_USE_SSL_CERT$","SMTPUseSSLCertificate","SMTPUseSSLCertificate","%CDomain.%ID%.SMTPUseSSLCertificate%","%CDomain.%ID%.SMTPUseSSLCertificate.Default%","%CDomain.%ID%.SMTPUseSSLCertificate.IsDefault%");SMTPUseExplicitSSLCheckbox=CreateTriStateCheckBox("$SMTP_USE_EXPLICIT_SSL$","SMTPUseExplicitSSL","SMTPUseExplicitSSL","%CDomain.%ID%.SMTPUseExplicitSSL%","%CDomain.%ID%.SMTPUseExplicitSSL.Default%","%CDomain.%ID%.SMTPUseExplicitSSL.IsDefault%",OnToggleExplicitSSL);}else{SMTPRequiresSSLCheckbox=CreateCheckBox("$SMTP_REQUIRE_SSL$","SMTPSSL","SMTPSSL","%CDomain.%ID%.SMTPSSL%",ShowHideSMTPSSLCert);SMTPUseSSLCertCheckbox=CreateCheckBox("$SMTP_USE_SSL_CERT$","SMTPUseSSLCertificate","SMTPUseSSLCertificate","%CDomain.%ID%.SMTPUseSSLCertificate%");SMTPUseExplicitSSLCheckbox=CreateCheckBox("$SMTP_USE_EXPLICIT_SSL$","SMTPUseExplicitSSL","SMTPUseExplicitSSL","%CDomain.%ID%.SMTPUseExplicitSSL%",OnToggleExplicitSSL);}var SMTPRequireLoginCheckbox;if(bSMTPTriState)SMTPRequireLoginCheckbox=CreateTriStateCheckBox("$SMTP_REQUIRE_LOGIN$","SMTPRequiresLogin","SMTPRequiresLogin","%CDomain.%ID%.SMTPRequiresLogin%","%CDomain.%ID%.SMTPRequiresLogin.Default%","%CDomain.%ID%.SMTPRequiresLogin.IsDefault%",ShowHideSMTPAuth);else SMTPRequireLoginCheckbox=CreateCheckBox("$SMTP_REQUIRE_LOGIN$","SMTPRequiresLogin","SMTPRequiresLogin","%CDomain.%ID%.SMTPRequiresLogin%",ShowHideSMTPAuth);OnSMTPServerLoad();CreateDialogPushButton("$SAVE_BUTTON$","SaveSMTPConfigButton",OnSaveSMTPConfig);CreateDialogPushButton("$CANCEL_BUTTON$","CancelSMTPConfigButton",OnCancelSMTPConfig);CreateDialogPushButton("$HELP_BUTTON$","HelpSMTPConfigButton",OnSMTPConfigHelp);CreatePushButton("$TEST_SMTP_BUTTON$","TestSMTPConfigButton",OnSMTPConfigCheck,110,25);</script><div id="LogDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div id="logwindow" class="SpyLogScroll"><div id="log" style="width:100%;"></div></div><span id="CloseLog"></span></div></div><script type="text/javascript" language="javascript">var g_sAttrLogObjectType="Domain";var g_nAttrLogObjectId=%ID%;var g_sFilterLogText="";var g_GridToReload;BuildDialog("$LOG_DIALOG_TITLE$","LogDialog","775","300","","$CLOSE_CANCEL$");function OnShowLogDialog(){g_GridToReload=undefined;try{if(awActiveGrid!=undefined&&awActiveGrid.m_bUpdates)g_GridToReload=awActiveGrid;}catch(e){try{if(g_ActiveRezizeGrid!=undefined&&g_ActiveRezizeGrid.m_bUpdates)g_GridToReload=g_ActiveRezizeGrid;}catch(e){try{if(awSecondaryActiveGrid!=undefined&&awSecondaryActiveGrid.m_bUpdates)g_GridToReload=awSecondaryActiveGrid;}catch(e){g_GridToReload=undefined;}}}if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(false);InitDomainAttrLog();FreezeDomainAttrLog(false);ShowDialog("LogDialog",undefined,ResetLogDialog);}function ResetLogDialog(){if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(true);FreezeDomainAttrLog(true);document.getElementById("log").innerHTML="";}function OnOkViewLog(){HideDialog('LogDialog');}CreateDialogPushButton("$CLOSE_BUTTON$","CloseLog",OnOkViewLog);InitLog("log","",0);</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--></head><body><script type="text/javascript" language="JavaScript">document.addEventListener('DOMContentLoaded',function(){var createServerIdentityContainer=document.getElementById("CreateServerIdentity");if(g_bSysAdmin&&g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY_FOR_READONLY_SYSADMIN$</a></div>';}if(g_bSysAdmin&&!g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a onclick="javascript:navigateToServerIdentityTab(); return false;" target="_blank" id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY$</a></div>';}});</script><div id="container"><div id="MC-logo" style="overflow:visible;"><div id="sulogo-div"><div class="header-logo-container"><a href="javascript:LoadConsolePage('%ADMIN_FILE%', true)"><img src="%COMMON_FILE%Images/swlogo.png" id="SWLOGO" style="border:none;" alt="$CONSOLE_TITLE$"/></a></div><div class="sulogo-prodname"><strong style="font-size:12pt; margin-right: 8px;">%PRODUCT%</strong><span style="font-size:10pt;">$MANAGEMENT_CONSOLE$</span></div></div><div id="TrialExpire" style="display:none;"><div><a href="https://ecomm.solarwinds.com/onepagecheckout/Servu?sku=7205&CMPSource=SERVUSITE#/" target="_blank" id="TrialExpireTxt" class="DaysExpireTxt"><span id="TrialExpireDays"></span>$DAYS$ $TRIAL_EXPIRES_IN$. $BUY_NOW$</a></div></div><div id="CreateServerIdentity" style="display:none;"></div><div class="header-user-block"><span class="head-item head-user"><span id="UserOptBtn" class="menu-toggle"><span class="head-icon"></span><span id="CurrentlyLoggedIn" style="font-weight:bold;"></span></span></span><span class="head-item head-help"><a href="javascript:MainHelp();"><span class="head-icon"></span></a></span><span class="head-item head-menu"><span id="ManConNavBarJumpToList" class="menu-toggle"><span class="head-icon"></span></span></span></div></div><noscript><center><p>$NO_SCRIPT_TEXT$</p></center></noscript><div class="maincontent" ><div id="leftCol-Contain"><div id="leftCol-Nav"><div class="menu-nav" id="MenuListNav"><ul id="nav"><li id="navmenuserver-global" style="display:none;"><a id="navmenuserver-global-href" href="#"><div><span class="navDomain icon"></span><span class="navDomain text">$GLOBAL$</span></div></a><ul><li data-active='6' class='activetab'><a id="navmenuserver-global-dashboard-href" href="javascript:LoadConsolePage('%ADMIN_FILE%')"><span></span>$DASHBOARD$</a></li><li data-active='0' class='activetab'><a id="navmenuserver-global-details-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%Server.htm', 1,0,true);">$SERVERDETAILS$</a></li><li data-active='1' class='activetab'><a id="navmenuserver-global-users-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerUsers.htm', 1,1,true);">$USERS$</a></li><li data-active='2' class='activetab'><a id="navmenuserver-global-groups-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerGroups.htm', 1,2,true);">$GROUPS$</a></li><li data-active='3' class='activetab'><a id="navmenuserver-global-dirs-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerDir.htm', 1,3,true);">$DIRECTORIES$</a></li><li data-active='4' class='activetab'><a id="navmenuserver-global-limits-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerLimits.htm', 1,4,true);">$LIMITS$</a></li><li data-active='5' class='activetab'><a id="navmenuserver-global-activity-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerActivity.htm', 1,5,true);">$SERVERACTIVITY$</a></li></ul></li><li id="navmenuserver-DomainStart" class="NavDomainStart"><span class="navHeadTxtWhite">$DOMAINS$ <span id="DomainStart-Count"></span></span></li><div class="nav-add-domain"><a id="AddDomain-btn" href="javascript:OnShowDomainWizard();" style="align-items: center;"><img src="%COMMON_FILE%Images/add_domain_icon.png" width="20px" height="20px" alt="$NEW_DOMAIN_BUTTON$" title="$NEW_DOMAIN_BUTTON$" border="0" /><span id="brdcrumb-main" class="navHeadTxtWhite">$NEW_DOMAIN$</span></a></div></ul><div id="nav-loading" style="width:230px;text-align:center;"><img src='%COMMON_FILE%Images/domain-load.gif' alt='$LOADING_DOMAINS$' border='0' style="margin:0 auto;"/></div></div><div class="TreeInfoBox"><div style="min-height:400px; display: flex; flex-direction: column; flex-grow: 1; justify-content: flex-end"><div id="MaintContainUpdate" class="MaintInfoBox"><span class="TreeInfoBox__text-panel">$LATEST_UPDATE$</span><div id="SU-UpdateInfo" style="margin-top:10px;color:#333333;">$NO_UPDATE$</div></div><div id="MaintContain" class="MaintInfoBox"><div class="TreeInfoBox__text-secondary">$MAINTENANCE_ENDS$:</div><div class="TreeInfoBox__text-default" id="MaintDaybox"><span id="MaintDays"></span> $DAYS$, <span id="MaintDate"></span></div></div></div></div></div><div class="content-container"><div class="breadcrumb-container"><div style="display:inline-block;padding-left:15px"><span id="breadcrumb"></span></div></div><div id="TreeCol"><div class="MainHeaderInfo" style="vertical-align:top"><img src="%ADMIN_FILE%Images/domain32.png" width="32" height="32" class="tab-header" alt="$DOMAIN_PAGE_INFO$" /><strong>$DOMAIN_DETAILS$</strong> - $DOMAIN_PAGE_INFO$</div><br style="clear:both" /><span id="PageTabs"></span>
<div id="TabsContent" class="tabs-content"><div id="Domain" style="display:none"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32"/></td><td style="vertical-align:top;">$DOMAIN_INFO_TAB$</td></tr></table><form name="Domain" onsubmit="return (false);"><div class="ie6positionfix"><div style="width:360px; float:left;padding-bottom:10px;margin-right:10px;"><div id="DomainInfoGroup"><div>$NAME$:<br/><div style="overflow:auto"><span id="DomainName"></span></div>$DESCRIPTION$:<br/><div style="overflow:auto"><textarea id="Info_Description" name="Info_Description" class="aw-border" style="width:300px;height:85px;"></textarea></div><span id="EnableDomain"></span></div><div><span id="SaveButton"></span></div></div></div><div id="DomainHomeDirContainer" style="width:370px; float:left; display:none;padding-bottom:10px;"><div id="DomainHomeDirGroup"><div style="width:355px;">$DOMAIN_HOME_DIR$:<div style="overflow:auto"><span id="DomainHomeDir"></span> <span id="BrowseButtonDomainHomeDir"></span></div>$MAXIMUM_SIZE$:<div style="overflow:auto"><span id="DomainHomeDirMaxSize"></span> &nbsp;$MAX_SIZE_LABEL$ ($BLANK_FOR_NO_LIMIT$)</div><div style="padding:5px 5px 0 0;width:310px;">$MAXIMUM_SIZE_MB_NOTE$</div></div><div id="SaveDomainHomeDirButtonContain" style="margin-top:28px;"><span id="SaveDomainHomeDirButton"></span></div></div></div><div style="clear:left;">&nbsp;</div><div><span id="DeleteDomainBtn"></span></div></div></form><div style="clear:left;">&nbsp;</div></div></div><div id="Listeners" style="display:none"><div class="layercontent"><div style="display:inline;"><img alt="" src="%ADMIN_FILE%Images/NIC.png" width="32" height="32" class="header-icon" />$LISTENERS_INFO_TAB$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div><span id="ListenersList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="AddListenerButton"></span><span id="EditListenerButton"></span><span id="DeleteListenerButton"></span></div></div></div></div><div id="VirtualHosts" style="display:none;"><div class="layercontent"><div style="display:inline;"><img alt="" src="%ADMIN_FILE%Images/VirtualHosts32.png" width="32" height="32" class="header-icon" />$VIRTUAL_HOSTS_INFO_TAB$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="VirtualHostsTabContent"><span id="VirtualHostsList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="AddVirtualHostsButton"></span><span id="EditVirtualHostsButton"></span><span id="DeleteVirtualHostsButton"></span>&nbsp;&nbsp;&nbsp;<span id="RequireMatchingHOSTHeader"></span></div></div><div style="text-align:center;" id="VirtualHostsTabContentContainer"><div id="VirtualHostsTabContentNone" class="UpgradeLicenseMsg"><img id="VirtualHostsTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="VirtualHostsTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><div id="IPAccess" style="display:none;"><div class="layercontent"><div class="ie6positionfix"><div style="display:inline;"><img alt="" src="%ADMIN_FILE%Images/IpAccess32.png" width="32" height="32" class="header-icon" />$DOMAIN_IP_ACCESS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><table border="0" cellpadding="0" cellspacing="0"><tr><td style="width:100%;padding-right:8px;"><span id="IPAccessList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span></td><td style="width:40px;text-align:center;"><span id="IPAccessTopArrow"></span><br /><span id="IPAccessUpArrow"></span><br /><br /><span id="IPAccessDownArrow"></span><br /><span id="IPAccessBottomArrow"></span></td></tr></table><div style="padding:5px 28px 0 0;"><span id="ExportIPButton" style="float:right;"></span><span id="ImportIPButton" style="float:right;"></span><span id="AddIPButton"></span><span id="EditIPButton"></span><span id="RemoveIPButton"></span>&nbsp;&nbsp;&nbsp;<span id="IPSort"></span></div><script type="text/javascript" language="JavaScript">var sConfirmSortIpMsg="$CONFIRM_SORT_IP$";function OnAddIPAccess(){IPAccessList.OnAddObject("IPAccess.xml%DEFAULT_OBJECT_REF%CDomain.%ID%.IPAccess","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.IPAccess",document.IPAccessForm,"IPAccessDialog",[OnIPAccessLoad],g_bReadOnlyAccess);}function OnEditIPAccess(){IPAccessList.OnEditObject("IPAccess.xml","Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.IPAccess.",document.IPAccessForm,"IPAccessDialog","$SELECT_ONLY_ONE_IPACCESS_EDIT$","$SELECT_ONE_IPACCESS_EDIT$",[OnIPAccessLoad]);}function OnRemoveIPAccess(){IPAccessList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CDomain.%ID%.IPAccess&ID=%ID%","$ASK_DELETE_IPACCESS$","$SELECT_ONE_IPACCESS_DELETE$");}function OnExportIPDone(sFilePath){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();nLen=nCountFormatted.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));AlertDialog(nCountFormatted+" $IP_EXPORT_MSG$<br><br>"+this.FilePathName);}else{AlertDialog(GetResultText(nResult,"",sResultText));}}function OnImportIPDone(){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){var nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();var nLen=nCountFormatted.length;var nTotalUsersInFile=new Number(parseInt(nCountFormatted)).toLocaleString();var nTotalUsersInFileLen=nTotalUsersInFile.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));if(nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==".00"||nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==",00")nTotalUsersInFile=nTotalUsersInFile.substr(0,(nTotalUsersInFileLen-3));sImportStr=nCountFormatted+" $OF$ "+nTotalUsersInFile+" $IP_IMPORT_MSG$<br><br>"+this.FilePathName;AlertDialog(sImportStr);}else AlertDialog(GetResultText(0,"",sResultText));}function OnImportIPAccess(sFilePath){var ImportIPObj=undefined;var sImportFile=sFilePath;if(Trim(sImportFile)!=""){if(ImportIPObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CDomain.%ID%.ImportIPAccess"),OnImportIPDone)){ImportIPObj.setParameter("File",sImportFile);ImportIPObj.FilePathName=sImportFile;SavingDialog(true);ImportIPObj.request();}}}function OnExportIPAccess(sFilePath){CloseConfirmDialog();var ExportUsersObj=undefined;var sExportFile=sFilePath;sExportType=g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CDomain.%ID%.ExportIPAccess";if(Trim(sExportFile)!=""){if(ExportUsersObj=createAWHttpRequest("POST",(sExportType),OnExportIPDone)){ExportUsersObj.setParameter("File",sExportFile);ExportUsersObj.FilePathName=sExportFile;SavingDialog(true);ExportUsersObj.request();}}}var IPAccessList=CreateIPAccessGrid("IPAccessList","DomainIPAccess.xml?ID=%ID%",OnEditIPAccess);IPAccessList.onKeyDelete=OnRemoveIPAccess;IPAccessList.NoResizeColumns([1,1,1,0]);var SortCheckbox=CreateCheckBox("$ENABLE_SORT_VIEW$","IPSort","IPSort",false,OnSortCheckBoxValueChanged);CreatePushButton("$ADD_BUTTON$...","AddIPButton",OnAddIPAccess);CreatePushButton("$EDIT_BUTTON$...","EditIPButton",OnEditIPAccess);CreatePushButton("$DELETE_BUTTON$","RemoveIPButton",OnRemoveIPAccess);var ImportIPButton=CreatePushButton("$IMPORT_BUTTON$...","ImportIPButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnImportIPAccess]],"ImportDB");var ExportIPButton=CreatePushButton("$EXPORT_BUTTON$...","ExportIPButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnExportIPAccess]],"ExportDB");IPAccessList.InitObjectMove(["IPAccessTopArrow","IPAccessUpArrow","IPAccessDownArrow","IPAccessBottomArrow"],"CDomain.%ID%.IPAccess");var sOnEditIPAccess=String("OnEditIPAccess(");var sOnAddIPAccess=String("OnAddIPAccess(");var sOnRemoveIPAccess=String("OnRemoveIPAccess(");CreateContextMenu([sOnEditIPAccess,"",sOnAddIPAccess,sOnRemoveIPAccess],[function(){return(OnEqualOneContextMenu(IPAccessList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(IPAccessList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(IPAccessList,"$DELETE_BUTTON$"))}],["Edit","","New","FileDelete"],IPAccessList,"IPAccessListContext",true);</script></div></div></div><div id="Database" style="display:none;"><div class="layercontent"><div class="ie6positionfix"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32"/></td><td style="vertical-align:top;">$DATABASE_INFO$</td></tr></table><div style="height:250px"><form name="ODBC" onsubmit="return (false);"><div id="DatabaseTabContent"><div id="DataSourceGroup"><div style="float:left;width:225px;">$ODBC_SOURCE$:<br/><div style="overflow:auto"><span id="ODBCSource"></span></div>$ODBC_ACCOUNT$:<br/><div style="overflow:auto"><span id="ODBCAccount"></span></div>$ODBC_PASSWORD$:<br/><div style="overflow:auto"><span id="ODBCPassword"></span></div><br /></div><div style="float:left;width:225px;padding-top:5px;"><span id="ODBCAutoCreateTables"></span><br /><span id="ODBCAutoCreateColumns"></span><br /><span id="ODBCEditSQLTemplates" style="position:relative;top:5px;"></span><br /><span id="ODBCSaveButton" style="position:relative;top:10px;"></span> <span id="ODBCHelpButton" style="position:relative;top:10px;margin-left:5px;"></span></div></div><div style="padding-top:15px;clear:both;">$ODBC_COLUMN_MAPPING_INFO$<br /><br /><span id="ODBCMapUserColumns"></span><span id="ODBCMapGroupColumns"></span></div></div><div style="text-align:center;" id="DatabaseTabContentContainer"><div id="DatabaseTabContentNone" class="UpgradeLicenseMsg"><img id="DatabaseTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="DatabaseTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></form><script type="text/javascript" language="JavaScript">CreateGroupBox("$DATA_SOURCE_GROUP$","DataSourceGroup","550px","150px");var ODBCSourceInput=CreateInputField("%CDomain.%ID%.ODBCSource%","ODBCSource","ODBCSource","",180,undefined,undefined,OnSaveODBCSettings);CreateInputField("%CDomain.%ID%.ODBCAccount%","ODBCAccount","ODBCAccount","",180,undefined,undefined,OnSaveODBCSettings);var databasePasswordField=CreatePasswordField("%CDomain.%ID%.ODBCPassword%","ODBCPassword","ODBCPassword","",180,undefined,undefined,OnSaveODBCSettings);setTimeout(function(){initPasswordTypeToggler(databasePasswordField,"ODBCPassword");});CreateCheckBox("$ODBC_AUTO_CREATE_TABLES$","ODBCAutoCreateTables","ODBCAutoCreateTables",%CDomain.%ID%.ODBCAutoCreateTables%,OnCheckBoxValueChanged);CreateCheckBox("$ODBC_AUTO_CREATE_COLUMNS$","ODBCAutoCreateColumns","ODBCAutoCreateColumns",%CDomain.%ID%.ODBCAutoCreateColumns%,OnCheckBoxValueChanged);CreatePushButton("$SAVE_BUTTON$","ODBCSaveButton",OnSaveODBCSettings);CreatePushButton("$ODBC_EDIT_SQL_TEMPLATES$...","ODBCEditSQLTemplates",OnEditSQLTemplates);CreatePushButton("$HELP_BUTTON$","ODBCHelpButton",OnODBCHelp);CreatePushButton("$ODBC_MAP_USER_COLUMNS$...","ODBCMapUserColumns",OnMapUserColumns);CreatePushButton("$ODBC_MAP_GROUP_COLUMNS$...","ODBCMapGroupColumns",OnMapGroupColumns);if("%CServer.%SERVER_ID%.ODBCLicense%"!="1")DisableTab("DatabaseTabContent");function OnSaveODBCSettings(){var SaveODBCRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");SavingDialog(true);SaveODBCRequest.setParameter("ODBCSource",document.ODBC.ODBCSource.value);SaveODBCRequest.setParameter("ODBCAccount",document.ODBC.ODBCAccount.value);SaveODBCRequest.setParameter("ODBCPassword",document.ODBC.ODBCPassword.value);SaveODBCRequest.response=function(){var nResult=OnSaveComplete(this);if((nResult==0)&&(ODBCSourceInput.getControlText()!="")&&("Domain"=="Domain"))createCookie("domainodbc",1,1);else createCookie("domainodbc",0,1);};SaveODBCRequest.request(null);return(false);}function OnEditSQLTemplates(){ShowDialog("SQLTemplateDialog");}function OnCheckBoxValueChanged(CheckBox){CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");}function OnMapUserColumns(){InitDatabaseDialog(true);ShowDialog("DatabaseDialog");}function OnMapGroupColumns(){InitDatabaseDialog(false);ShowDialog("DatabaseDialog");}function OnODBCHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-Database-Access.htm",sExpandNode);}</script></div></div></div></div><div id="Events" style="display:none"><div class="ie6positionfix"><div id="EventsLayer" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$EVENTS$" src="%ADMIN_FILE%Images/Command32.png" width="32" height="32" class="header-icon" />$EVENTS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="EventsTabContent"><span id="EventsList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="ConfigSMTPButton" style="float:right;"></span><span id="AddEventButton"></span><span id="EditEventButton"></span><span id="RemoveEventButton"></span>&nbsp;&nbsp;&nbsp;<span id="CommonEventButton"></span><span id="TestEventButton"></span></div></div><div style="text-align:center;" id="EventsTabContentContainer"><div id="EventsTabContentNone" class="UpgradeLicenseMsg"><img id="EventsTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="EventsTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><script type="text/javascript" language="JavaScript">var g_sEventNameColumn="$NAME$";var g_sEventDescriptionColumn="$DESCRIPTION$";var g_sEventTypeColumn="$EVENT_TYPE$";var g_sEventActionColumn="$EVENTS_ACTION_LABEL$";var g_asEventColWidth=[180,180,180,180];var g_bEventSavingObj=false;var g_sEventRuleVar="$EVENTS_RULE_VAR$";var g_sEventRuleConstant="$EVENTS_RULE_CONSTANT$";var g_sEventRuleComp="$EVENTS_RULE_COMP$";var g_sEventRuleDataType="$EVENTS_RULE_DATA_TYPE$";var g_sRuleIf="$IF$";var g_sAND="$AND$";var g_sOR="$OR$";function GetEventIDText(nEventType){var asEvents={1:"$SUEVENT_ID_SERVER_START_TEXT$",2:"$SUEVENT_ID_SERVER_STOP_TEXT$",3:"$SUEVENT_ID_SECURITY_ALERT_TEXT$",100:"$SUEVENT_ID_DOMAIN_START_TEXT$",101:"$SUEVENT_ID_DOMAIN_STOP_TEXT$",102:"$SUEVENT_ID_SESSION_CONNECT_TEXT$",103:"$SUEVENT_ID_SESSION_DISCONNECT_TEXT$",104:"$SUEVENT_ID_SESSION_CONNECT_FAILURE_TEXT$",200:"$SUEVENT_ID_USER_LOGIN_TEXT$",201:"$SUEVENT_ID_USER_LOGOUT_TEXT$",202:"$SUEVENT_ID_USER_LOGIN_FAILURE_TEXT$",203:"$SUEVENT_ID_USER_PASSWORD_CHANGE_TEXT$",204:"$SUEVENT_ID_USER_PASSWORD_CHANGE_FAILURE_TEXT$",304:"$SUEVENT_ID_IP_ADDR_AUTO_BLOCKED_TIME_TEXT$",305:"$SUEVENT_ID_SESSION_IDLE_TIMEOUT_TEXT$",306:"$SUEVENT_ID_SESSION_TIMEOUT_TEXT$",205:"$SUEVENT_ID_USER_ENABLED_TEXT$",206:"$SUEVENT_ID_USER_DISABLED_TEXT$",207:"$SUEVENT_ID_USER_DELETED_TEXT$",208:"$SUEVENT_ID_USER_ADDED_TEXT$",209:"$SUEVENT_ID_USER_PASSWORD_RECOVERY_SENT_TEXT$",210:"$SUEVENT_ID_USER_PASSWORD_RECOVERY_FAILED_TEXT$",211:"$SUEVENT_ID_USER_PASSWORD_STALE_TEXT$",212:"$SUEVENT_ID_USER_AUTOMATICALLY_DISABLED_TEXT$",213:"$SUEVENT_ID_USER_AUTOMATICALLY_DELETED_TEXT$",214:"$SUEVENT_ID_USER_PREDISABLE_TEXT$",215:"$SUEVENT_ID_USER_PREDELETE_TEXT$",216:"$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_TEXT$",217:"$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_FAILURE_TEXT$",105:"$SUEVENT_ID_LOG_DELETED_TEXT$",106:"$SUEVENT_ID_LOG_ROTATED_TEXT$",107:"$SUEVENT_ID_LISTENER_SUCCESS_TEXT$",109:"$SUEVENT_ID_LISTENER_FAILURE_TEXT$",108:"$SUEVENT_ID_LISTENER_STOP_TEXT$",110:"$SUEVENT_ID_GATEWAY_LISTENER_SUCCESS_TEXT$",112:"$SUEVENT_ID_GATEWAY_LISTENER_FAILURE_TEXT$",111:"$SUEVENT_ID_GATEWAY_LISTENER_STOP_TEXT$",113:"$SUEVENT_ID_PERM_DATA_LISTENER_SUCCESS_TEXT$",115:"$SUEVENT_ID_PERM_DATA_LISTENER_FAILURE_TEXT$",114:"$SUEVENT_ID_PERM_DATA_LISTENER_STOP_TEXT$",116:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_SUCCESS_TEXT$",118:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_FAILURE_TEXT$",117:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_STOP_TEXT$",300:"$SUEVENT_ID_IP_BLOCKED_TEXT$",301:"$SUEVENT_ID_IP_BLOCKED_TIME_TEXT$",302:"$SUEVENT_ID_TOO_MANY_SESSIONS_TEXT$",303:"$SUEVENT_ID_TOO_MANY_SESSIONS_ON_IP_TEXT$",400:"$SUEVENT_ID_FILE_UPLOAD_TEXT$",401:"$SUEVENT_ID_FILE_UPLOAD_FAIL_TEXT$",402:"$SUEVENT_ID_FILE_DOWNLOAD_TEXT$",403:"$SUEVENT_ID_FILE_DOWNLOAD_FAIL_TEXT$",406:"$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_TEXT$",407:"$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_FAIL_TEXT$",404:"$SUEVENT_ID_FILE_DELETE_TEXT$",405:"$SUEVENT_ID_FILE_MOVE_TEXT$",500:"$SUEVENT_ID_DIR_CREATE_TEXT$",501:"$SUEVENT_ID_DIR_DELETE_TEXT$",502:"$SUEVENT_ID_DIR_CHANGE_TEXT$",503:"$SUEVENT_ID_DIR_MOVE_TEXT$",600:"$SUEVENT_ID_QUOTA_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",119:"$SUEVENT_ID_FILE_MGMT_RULE_SUCCESS_TEXT$",120:"$SUEVENT_ID_FILE_MGMT_RULE_ERROR_TEXT$",121:"$SUEVENT_ID_FILE_MGMT_RULE_MOVE_FILE_TEXT$"};if(asEvents[nEventType])return(asEvents[nEventType]);else return(nEventType);}function GetEventActionText(nActionType){var asActions=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$","$SUEVENT_ACTION_EXEC_TEXT$","$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$","$SUEVENT_ACTION_MSMQ_WRITE_TEXT$"];if(asActions[nActionType])return(asActions[nActionType]);else return(nActionType);}function OnSMTPConfigAlert(){AlertDialog("$SMTP_CONFIG_WARN$");}var bSetEventGridHeight=true;var g_bServerDomain=false;switch(sEventObjectType.toLowerCase()){case"server":case"domain":g_asEventColWidth=[180,180,180,180];bSetEventGridHeight=false;g_bServerDomain=true;break;default:g_asEventColWidth=[120,170,120,130];bSetEventGridHeight=true;break;}var EventsList=CreateEventsGrid("EventsList","DomainEvents.xml?ID=%ID%",OnEditEvent,g_asEventColWidth);var sOnEditEvent=String("OnEditEvent(");var sOnAddEvent=String("OnAddEvent(");var sOnDeleteEvent=String("OnRemoveEvent(");var sOnEnableEvent=String("OnEnableDisableEvent(1,");var sOnDisableEvent=String("OnEnableDisableEvent(0,");CreateContextMenu([sOnAddEvent,sOnEditEvent,sOnDeleteEvent,sOnEnableEvent,sOnDisableEvent],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(EventsList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(EventsList,"$DELETE_BUTTON$"))},OnEnableEventContextMenu,OnDisableEventContextMenu],["New","Edit","FileDelete",OnEnableEventContextImage,OnDisableEventContextImage],EventsList,"EventsListContext",true);EventsList.onKeyDelete=OnRemoveEvent;if(bSetEventGridHeight){var nEventsListHeight=$EVENTS_LIST_HEIGHT$;if(AW.unix)nEventsListHeight=(nEventsListHeight-5);EventsList.setStyle("height",nEventsListHeight+"px");}CreatePushButton("$ADD_BUTTON$...","AddEventButton",OnAddEvent);CreatePushButton("$EDIT_BUTTON$...","EditEventButton",OnEditEvent);CreatePushButton("$DELETE_BUTTON$","RemoveEventButton",OnRemoveEvent);CreatePushButton("$CREATE_COMMON_EVENTS_BUTTON$...","CommonEventButton",OnCreateCommonEvents);CreatePushButton("$TEST_EVENTS_BUTTON$","TestEventButton",OnTestEvent);var fnSMTPConfig=(g_bServerDomain)?OnSMTPConfig:OnSMTPConfigAlert;var SMTPButton=CreatePushButton("$CONFIG_SMTP_BUTTON$...","ConfigSMTPButton",fnSMTPConfig);SMTPButton.setControlImage("SMTP_Icon");if(!g_bServerDomain)SMTPButton.setStyle("display","none");if((parseInt("%CServer.%SERVER_ID%.EventLicense%")!=1)&&(sEventObjectType.toLowerCase()!="server"))DisableTab("EventsTabContent",EventsList);function OnEnableDisableEvent(bEnable){var EditCells=new Array();EditCells=EventsList.getSelectedRows().toString().split(",");var EventEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(EventsList.getCellData((EventsList.m_nNumColumns-1),EditCells[nIndex]));EventEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain."+g_EditObjectID+".SUEvent."+nObjectID+"&StaticOnly=1");EventEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;EventEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;EventEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);EventEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};EventEnabledDisabledRequest[nIndex].request(null);}}function OnEnableEventContextMenu(){if(EventEnableOrDisable()[1]&&EventsList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_EVENT$";else sMenuItemName="";return(sMenuItemName);}function OnDisableEventContextMenu(){if(EventEnableOrDisable()[0]&&EventsList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_EVENT$";else sMenuItemName="";return(sMenuItemName);}function OnEnableEventContextImage(){if(EventEnableOrDisable()[1])sImageClass="LSTNEnabled";else sImageClass="";return(sImageClass);}function OnDisableEventContextImage(){if(EventEnableOrDisable()[0])sImageClass="LSTNDisabled";else sImageClass="";return(sImageClass);}function EventEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=EventsList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(EventsList.getCellText(9,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}function OnAddEvent(){g_bEventSavingObj=false;EventsList.OnAddObject("Event.xml%ADD_OBJECT_REF%CDomain."+g_EditObjectID+".SUEvent&Temp=1","Result.xml%UPDATE_OBJECT_REF%CDomain."+g_EditObjectID+".SUEvent.",document.EventsForm,"EventsDialog",[OnEventLoad,OnHideEventsDialog],g_bReadOnlyAccess);}function OnEditEvent(){g_bEventSavingObj=false;EventsList.OnEditObject("Event.xml?Command=CreateTempObject&Object=CDomain."+g_EditObjectID+".SUEvent.","Result.xml%UPDATE_OBJECT_REF%CDomain."+g_EditObjectID+".SUEvent.",document.EventsForm,"EventsDialog","$SELECT_ONLY_ONE_EVENT_EDIT$","$SELECT_ONE_EVENT_EDIT$",[OnEventLoad,OnHideEventsDialog],true);}function OnRemoveEvent(){EventsList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CDomain."+g_EditObjectID+".SUEvent&ID=%ID%","$ASK_DELETE_EVENT$","$SELECT_ONE_EVENT_DELETE$");}function OnViewLog(){OnShowLogDialog();}function OnTestEvent(){if((EventsList.getSelectedRows()!="")&&(EventsList.getSelectedRows()!=-1)){var TestCells=new Array();TestCells=EventsList.getSelectedRows().toString().split(",");if(TestCells.length==1){nTestObjectID=parseInt(EventsList.getCellData((EventsList.m_nNumColumns-1),TestCells[0]));var sTestEventsCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CSUEvent."+nTestObjectID+".Test";var TestEventsRequest=CreatePostRequest(sTestEventsCmd);TestEventsRequest.setAsync(true);TestEventsRequest.request();TestEventsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else{AlertDialog("$EVENT_DISPATCHED_SUCCESS$",undefined,undefined,undefined,"$VIEW_LOG$",OnViewLog);}};}else WarnDialog("$SELECT_ONLY_ONE_EVENT_TEST$");}else WarnDialog("$SELECT_ONE_EVENT_TEST$");}</script></div></div></div><script type="text/javascript" language="JavaScript">AW.Formats.ListenIP=AW.Formats.XMLString.subclass();AW.Formats.ListenIP.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if(data==""||data=="0.0.0.0")return("$LISTENER_IPV4_ALL$");else if(decodeURIComponent(data)=="::")return("$LISTENER_IPV6_ALL$");else return(_super.dataToText(data));};obj.dataToValue=function(data){return(this.dataToText(data));};};AW.Formats.ListenType=AW.System.Format.subclass();AW.Formats.ListenType.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){var sText="";switch(parseInt(data)){case 1:sText="$LISTENER_TYPE_IMPLICIT_SSL_DESC$";break;case 2:sText="$LISTENER_TYPE_SSH_DESC$";break;case 3:sText="$LISTENER_TYPE_HTTP_DESC$";break;case 4:sText="$LISTENER_TYPE_HTTPS_DESC$";break;default:sText="$LISTENER_TYPE_FTP_DESC$";break;}return(sText);};obj.dataToValue=function(data){return(this.dataToText(data));};};g_sHelpNode="Item10_4";var aDomainMainHelpPages;if(g_bSysAdmin){g_sHelpPage="Help-Domain-Name-Description.htm";aDomainMainHelpPages=["Help-Domain-Name-Description.htm","Help-Domain-Listeners.htm","Help-Virtual-Hosts.htm","Help-IP-ACL.htm","Help-Database-Access.htm","Help-Events.htm"];}else{g_sHelpPage="Help-IP-ACL.htm";aDomainMainHelpPages=["Help-IP-ACL.htm","Help-Events.htm"];}function OnChangeTab(nOldTab,nNewTab){if((!isNaN(nOldTab))&&(g_aGrids[nOldTab]!=undefined))g_aGrids[nOldTab].EnableUpdates(false);if((!isNaN(nNewTab))&&(g_aGrids[nNewTab]!=undefined))g_aGrids[nNewTab].EnableUpdates(true);g_ActiveRezizeGrid=g_aGrids[nNewTab];ResizeGrids(true);g_sHelpPage=aDomainMainHelpPages[nNewTab];}function OnCheckBoxValueChanged(CheckBox){CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");}function OnSetHomeDirFocus(){document.Domain.Info_DomainHomeDir.focus();}function OnSaveDomain(){var SaveDomainRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");var nHomeDirMaxSize=document.Domain.Info_DomainHomeDirMaxSize.value;if(Trim(nHomeDirMaxSize)=="")nHomeDirMaxSize=0;nHomeDirMaxSizeBytes=(isNaN(nHomeDirMaxSize)?nHomeDirMaxSize:(parseInt(nHomeDirMaxSize)*1048576));if(g_bSysAdmin&&(nHomeDirMaxSizeBytes>0&&document.Domain.Info_DomainHomeDir.value=="")){AlertDialog("$PLEASE_ENTER_DOMAIN_HOME_DIR$",true,OnSetHomeDirFocus);return(false);}SavingDialog(true);SaveDomainRequest.setParameter("DomainName",Trim(document.Domain.Info_DomainName.value));SaveDomainRequest.setParameter("Description",document.Domain.Info_Description.value);SaveDomainRequest.setParameter("DomainHomeDir",document.Domain.Info_DomainHomeDir.value);SaveDomainRequest.setParameter("DomainHomeDirMaxSize",nHomeDirMaxSizeBytes);SaveDomainRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult==0){createCookie("domainname",document.Domain.Info_DomainName.value,60);}};SaveDomainRequest.request(null);return(false);}function ListenersFormat(nColumn,nRow){if(this.getCellData(6,nRow)=="0")return("ListenerDisabled");else if(this.getCellData(5,nRow)=="0")return("ListenerDenied");else return("Listener");}function OnListenerLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("ListenerDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);}}function OnAddListener(){var AvailableRequest=CreatePostRequest("%ADMIN_FILE%XML/AvailableIPs.xml?ID=%ID%");AvailableRequest.response=function(XMLDoc){var sIPV4Vals=GetXMLValue(XMLDoc,"IPV4",true);var sIPV6Vals=GetXMLValue(XMLDoc,"IPV6",true);if(sIPV4Vals==undefined)sIPV4Vals="";if(sIPV6Vals==undefined)sIPV6Vals="";SetAvailableIPs(sIPV4Vals,sIPV6Vals);ListenersList.OnAddObject("Listener.xml%DEFAULT_OBJECT_REF%CDomain.%ID%.ListenSocketConf","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.ListenSocketConf",document.ListenerForm,"ListenerDialog",[OnListenerLoad],g_bReadOnlyAccess);};AvailableRequest.request();}function OnEditListener(){var AvailableRequest=CreatePostRequest("%ADMIN_FILE%XML/AvailableIPs.xml?ID=%ID%");AvailableRequest.response=function(XMLDoc){var sIPV4Vals=GetXMLValue(XMLDoc,"IPV4",true);var sIPV6Vals=GetXMLValue(XMLDoc,"IPV6",true);if(sIPV4Vals==undefined)sIPV4Vals="";if(sIPV6Vals==undefined)sIPV6Vals="";SetAvailableIPs(sIPV4Vals,sIPV6Vals);ListenersList.OnEditObject("Listener.xml","Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.ListenSocketConf.",document.ListenerForm,"ListenerDialog","$SELECT_ONLY_ONE_LISTENER_EDIT$","$SELECT_ONE_LISTENER_EDIT$");};AvailableRequest.request();}function SetAvailableIPs(sIPV4,sIPV6){var sRawIPv4Listerners=sIPV4;var sRawIPv6Listerners=sIPV6;var aIPListener=new Array();var aIPListenerText=new Array();var aIPRaw=new Array();aIPListenerText[0]="$LISTENER_IPV4_ALL$";aIPListener[0]="";aIPRaw=sRawIPv4Listerners.split(',');aIPListenerText=aIPListenerText.concat(aIPRaw);aIPListener=aIPListener.concat(aIPRaw);if(sRawIPv6Listerners!=""){aIPListenerText.push("$LISTENER_IPV6_ALL$");aIPListener.push("::");aIPListenerText=aIPListenerText.concat(sRawIPv6Listerners.split(','));aIPListener=aIPListener.concat(sRawIPv6Listerners.split(','));}ListenerIPInput.setItemText(aIPListenerText);ListenerIPInput.setItemValue(aIPListener);ListenerIPInput.setItemCount(aIPListener.length);if(aIPListener.length>1)ListenerIPInput.getPopupTemplate().setStyle("height",(aIPListener.length<=10)?((16*aIPListener.length)+((AW.ie)?3:0))+"px":"163px");else if(aIPListener.length==1)ListenerIPInput.getPopupTemplate().setStyle("height",((g_bFireFox4Browser)?"24px":"20px"));}function OnDeleteListener(){ListenersList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CDomain.%ID%.ListenSocketConf&ID=%ID%","$ASK_DELETE_LISTENER$","$SELECT_ONE_LISTENER_DELETE$");}function OnLoadListenerIP(sValue){if(sValue=="::"){ListenerIPInput.setControlText("$LISTENER_IPV6_ALL$");
ListenerIPInput.setControlValue("::");}else if(sValue==""){ListenerIPInput.setControlText("$LISTENER_IPV4_ALL$");ListenerIPInput.setControlValue("");}else if(sValue!=""&&sValue!="0.0.0.0")ListenerIPInput.setControlText(sValue);ListenerIPInput.setSelectedItems([-1]);}function OnEnableDisableListener(bEnable){var EditCells=new Array();EditCells=ListenersList.getSelectedRows().toString().split(",");var ListenerEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(ListenersList.getCellData((ListenersList.m_nNumColumns-1),EditCells[nIndex]));ListenerEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.ListenSocketConf."+nObjectID+"&StaticOnly=1");ListenerEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;ListenerEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;ListenerEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);ListenerEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};ListenerEnabledDisabledRequest[nIndex].request(null);}}function OnEnableListenerContextMenu(){if(ListenerEnableOrDisable()[1]&&ListenersList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_LISTENER$";else sMenuItemName="";return(sMenuItemName);}function OnDisableListenerContextMenu(){if(ListenerEnableOrDisable()[0]&&ListenersList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_LISTENER$";else sMenuItemName="";return(sMenuItemName);}function OnEnableListenerContextImage(){if(ListenerEnableOrDisable()[1])sImageClass="LSTNEnabled";else sImageClass="";return(sImageClass);}function OnDisableListenerContextImage(){if(ListenerEnableOrDisable()[0])sImageClass="LSTNDisabled";else sImageClass="";return(sImageClass);}function ListenerEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=ListenersList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(ListenersList.getCellText(6,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}CreateDialogPushButton("$SAVE_BUTTON$","SaveListenerButton",OnSaveListener);CreateDialogPushButton("$CANCEL_BUTTON$","CancelListenerButton",OnCancelListener);CreateDialogPushButton("$HELP_BUTTON$","ListenerHelpButton",OnListenerHelp);var ListenerPortInput=CreateInputField("","PortInputField","Port","",180,undefined,undefined,OnSaveListener);var ListenerIPInput=CreateComboBox("$LISTENER_IPV4_ALL$","",[],[],"IP","IP",undefined,"OnLoadListenerIP()",false,250,20,OnSaveListener,true,true);CreateInputField("","PASVIP","PASVIP","",180,undefined,undefined,OnSaveListener);var ListenerComboBox=CreateComboBox("$LISTENER_TYPE_FTP_DESC$","0",["$LISTENER_TYPE_FTP_DESC$","$LISTENER_TYPE_IMPLICIT_SSL_DESC$","$LISTENER_TYPE_SSH_DESC$","$LISTENER_TYPE_HTTP_DESC$","$LISTENER_TYPE_HTTPS_DESC$"],["0","1","2","3","4"],"Type","Type",OnListenerTypeChange,"OnListenerTypeLoad()",false,250,20,OnSaveListener);var nListenerComboCnt=parseInt(ListenerComboBox.getItemCount());if(nListenerComboCnt>1)ListenerComboBox.getPopupTemplate().setStyle("height",(nListenerComboCnt<=10)?((16*nListenerComboCnt)+((AW.ie)?3:0))+"px":"163px");else if(aIPListener.length==1)ListenerComboBox.getPopupTemplate().setStyle("height",((g_bFireFox4Browser)?"24px":"20px"));var ListenerEnabledCheck=CreateCheckBox("$ENABLE_LISTENER$","ListenerDisabled","Enabled",false,undefined,true,"OnLoadListenerDisabled()",false);CreateGroupBox("$PASV_IP_ADDRESS$","PasvIPGroup","390px","100px");var PasvIPSSLOnlyCheckBox=CreateCheckBox("$USE_PASV_IP_SSL_ONLY$","PasvIPSSLOnlyCheck","PasvIPSSLOnly",false,undefined,true,"OnLoadPasvIPSSLOnly()",false);var PasvIPOnPrivateIPCheckBox=CreateCheckBox("$USE_PASV_IP_LAN_ONLY$","PasvIPOnPrivateIPCheck","PasvIPOnPrivateIP",false,undefined,true,"OnLoadPasvIPOnPrivateIP()",false);var DomainHomePathInput,DomainHomeMaxSizeInput;if(g_bSysAdmin){CreateGroupBox("$DOMAIN_HOME_DIR$","DomainHomeDirGroup","370px","$DOMAIN_INFO_GROUP_HEIGHT$px");CreatePushButton("$ADD_BUTTON$...","AddListenerButton",OnAddListener);CreatePushButton("$EDIT_BUTTON$...","EditListenerButton",OnEditListener);CreatePushButton("$DELETE_BUTTON$","DeleteListenerButton",OnDeleteListener);var ListenersList=CreateAdminGrid("ListenersList",["$LISTENER_IP$","$LISTENER_PORT$","$LISTENER_TYPE$"],[275,$LISTENER_PORT_COL_WIDTH$,190],"Listeners.xml?ID=%ID%","listeners","listener",10,OnEditListener);ListenersList.onKeyDelete=OnDeleteListener;ListenersList.onKeyEnter=OnEditListener;ListenersList.NoResizeColumns([0,1,0]);var fmtXMLString=new AW.Formats.XMLString;ListenersList.setCellFormat([new AW.Formats.ListenIP,new AW.Formats.Number,new AW.Formats.ListenType,fmtXMLString,fmtXMLString]);ListenersList.RightAlignColumn(1,true);ListenersList.getCellImage=function(nColumn,nRow){return(ListenersFormat.call(this,nColumn,nRow));};var sOnEditListener=String("OnEditListener(");var sOnAddListener=String("OnAddListener(");var sOnDeleteListener=String("OnDeleteListener(");var sOnEnableListener=String("OnEnableDisableListener(1,");var sOnDisableListener=String("OnEnableDisableListener(0,");CreateContextMenu([sOnEditListener,"",sOnAddListener,sOnDeleteListener,sOnEnableListener,sOnDisableListener],[function(){return(OnEqualOneContextMenu(ListenersList,"$EDIT_BUTTON$..."))},function(){return(OnEqualOneContextMenu(ListenersList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(ListenersList,"$DELETE_BUTTON$..."))},OnEnableListenerContextMenu,OnDisableListenerContextMenu],["Edit","","New","FileDelete",OnEnableListenerContextImage,OnDisableListenerContextImage],ListenersList,"ListenersListContext",true);document.getElementById("DomainHomeDirContainer").style.display="block";DomainHomePathInput=CreateInputField("%CDomain.%ID%.DomainHomeDir%","DomainHomeDir","Info_DomainHomeDir",undefined,315,undefined,undefined,OnSaveDomain);nInitialHomeDirMaxSizeBytes=%CDomain.%ID%.DomainHomeDirMaxSize%;sHomeDirMaxSizeBytes=(isNaN(nInitialHomeDirMaxSizeBytes)?0:(nInitialHomeDirMaxSizeBytes/1048576));if(parseInt(sHomeDirMaxSizeBytes)==0)sHomeDirMaxSizeBytes="";DomainHomeMaxSizeInput=CreateInputField(String(sHomeDirMaxSizeBytes),"DomainHomeDirMaxSize","Info_DomainHomeDirMaxSize",undefined,75,undefined,undefined,OnSaveDomain);var DomainHomeDirBrowse=CreatePushButton("","BrowseButtonDomainHomeDir",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[DomainHomePathInput,false,"0","1"]]);DomainHomeDirBrowse.setControlImage("Browse");CreatePushButton("$SAVE_BUTTON$","SaveDomainHomeDirButton",OnSaveDomain);var sBrowserLanguageCheck=readCookie("SULang");sBrowserLanguageCheck=sBrowserLanguageCheck.replace("-",",");if((sBrowserLanguageCheck.toLowerCase()=="jp,jp")&&AW.ie)document.getElementById("SaveDomainHomeDirButtonContain").style.marginTop="10px";CreatePushButton("$DELETE_DOMAIN_BUTTON$","DeleteDomainBtn",DeleteDomain,undefined,undefined,undefined,undefined,"button_red");}function DeleteDomain(){ConfirmDialog("$DELETE_DOMAIN_CONFIRM$",OnConfirmDomainDelete,undefined,undefined);}function OnConfirmDomainDelete(){var DomainDeleteRequest=createAWHttpRequest("POST",("%ADMIN_FILE%XML/Result.xml%DELETE_OBJECT_REF%CServer.%SERVER_ID%.Domain"),DomainDeleteDone);if(DomainDeleteRequest){DomainDeleteRequest.setParameter("IDs","%ID%");ReplaceDialog(g_sConfirmDialog,g_sBusyDialog);DomainDeleteRequest.request();}}function DomainDeleteDone(){var xmlDoc=this.getResponseXML();var nResult=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");if((nResult=GetXMLValueInt(xmlDoc,"result"))!=0){BusyDialog(false);AlertDialog(GetResultText(0,"",sResultText));}else{createCookie("domainname","",1);createCookie("domainid","",1);window.location="%ADMIN_FILE%console.htm&bRedirect=0";}}function OnVirtualHostLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("VirtualHostDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);}}function OnAddVirtualHost(){VirtualHostsList.OnAddObject("VirtualHost.xml%DEFAULT_OBJECT_REF%CDomain.%ID%.HostName","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.HostName",document.VirtualHostForm,"VirtualHostDialog",[OnVirtualHostLoad],g_bReadOnlyAccess,HostNameInput);}function OnEditVirtualHost(){VirtualHostsList.OnEditObject("VirtualHost.xml","Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.HostName.",document.VirtualHostForm,"VirtualHostDialog","$SELECT_ONLY_ONE_VIRTUAL_HOST_EDIT$","$SELECT_ONE_VIRTUAL_HOST_EDIT$",undefined,undefined,undefined,HostNameInput);}function OnDeleteVirtualHost(){VirtualHostsList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CDomain.%ID%.HostName&ID=%ID%","$ASK_DELETE_VIRTUAL_HOST$","$SELECT_ONE_VIRTUAL_HOST_DELETE$");}CreateGroupBox("$DOMAIN_INFO_GROUP$","DomainInfoGroup","350px","$DOMAIN_INFO_GROUP_HEIGHT$px");CreateInputField("%CDomain.%ID%.DomainName%","DomainName","Info_DomainName","",180,undefined,undefined,OnSaveDomain);document.getElementById("Info_Description").innerHTML=DecodeString("%CDomain.%ID%.Description%");CreateCheckBox("$ENABLE_DOMAIN$","EnableDomain","Enabled",%CDomain.%ID%.Enabled%,OnCheckBoxValueChanged);CreatePushButton("$SAVE_BUTTON$","SaveButton",OnSaveDomain);CreatePushButton("$ADD_BUTTON$...","AddVirtualHostsButton",OnAddVirtualHost);CreatePushButton("$EDIT_BUTTON$...","EditVirtualHostsButton",OnEditVirtualHost);CreatePushButton("$DELETE_BUTTON$","DeleteVirtualHostsButton",OnDeleteVirtualHost);CreateCheckBox("$REQUIRE_MATCHING_HOST_HEADER$","RequireMatchingHOSTHeader","RequireMatchingHOSTHeader",parseInt("%CDomain.%ID%.RequireMatchingHOSTHeader%"),OnCheckBoxValueChanged);var VirtualHostsList=CreateAdminGrid("VirtualHostsList",["$VIRTUAL_HOST_NAME$"],[300],"VirtualHosts.xml?ID=%ID%","VirtualHosts","VirtualHost",2,OnEditVirtualHost);VirtualHostsList.onKeyDelete=OnDeleteVirtualHost;VirtualHostsList.onKeyEnter=OnEditVirtualHost;var sOnEditVirtualHost=String("OnEditVirtualHost(");var sOnAddVirtualHost=String("OnAddVirtualHost(");var sOnDeleteVirtualHost=String("OnDeleteVirtualHost(");CreateContextMenu([sOnEditVirtualHost,"",sOnAddVirtualHost,sOnDeleteVirtualHost],[function(){return(OnEqualOneContextMenu(VirtualHostsList,"$EDIT_BUTTON$..."))},function(){return(OnEqualOneContextMenu(VirtualHostsList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(VirtualHostsList,"$DELETE_BUTTON$..."))}],["Edit","","New","FileDelete"],VirtualHostsList,"VirtualHostsListContext",true);var g_aGrids=(g_bSysAdmin)?[undefined,ListenersList,VirtualHostsList,IPAccessList,undefined,EventsList]:[IPAccessList,EventsList];if(parseInt("%CServer.%SERVER_ID%.VirtualHostsLicense%")!=1)DisableTab("VirtualHostsTabContent");if(g_bSysAdmin)g_ActiveTab=CreateTabs(["$SETTINGS_TAB$","$LISTENERS_TAB$","$VIRTUAL_HOSTS_TAB$","$IPACCESS$","$DATABASE$","$EVENTS$"],["Domain","Listeners","VirtualHosts","IPAccess","Database","Events"],"PageTabs","TabsContent",1,OnChangeTab);else g_ActiveTab=CreateTabs(["$IPACCESS$","$EVENTS$"],["IPAccess","Events"],"PageTabs","TabsContent",1,OnChangeTab);if((parseInt(GetURLParameter("Page"))-1)>1)g_ActiveTab.setSelectedItems([(parseInt(GetURLParameter("Page"))-1)]);if(window.location.search.indexOf("EditSMTP=1")>0)OnSMTPConfig();</script></div></div><div style='clear:both;'>&nbsp;</div></div></div><div class="footerDiv"><a href="%PRODUCT_HOME%" target="_blank" rel="noopener noreferrer">%PRODUCT%</a> <span id="SUVersionNumber">%VERSION%</span> &copy; 1995 - %COPYRIGHT_END_YEAR% <a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer">%COMPANY_NAME_FORMAL%</a>&nbsp;$ALL_RIGHTS_RESERVED$</div><ul id="UserOptList" style="display: none; width: auto;min-width: 100px;"><li id="UserOptList-password" style="display: none;"><a href="#" data-handler="javascript:ChangePasswordDialog();" >$CHANGE_PASSWORD_BUTTON$</a></li><li id="UserOptList-changeemail" style="display: none;"><a href="#" data-handler="javascript:OnShowChangeEmailDialog();" >$CHANGE_EMAIL_BUTTON$</a></li><li id="UserOptList-logout"><a href="#" data-handler="javascript:OnLogOut();">$LOGOUT$</a></li></ul><ul id="HelpOptList" class="menu-toggle" style="display: none; width: auto;min-width: 100px;"><li id="HelpOptList-whatsnew"><a href="#" data-handler="javascript:WhatsNewShow();" class="ActionOption" style="white-space:nowrap;"><span class="Action-ico"><img src="%COMMON_FILE%Images/FolderSize.png" class="SUWCActionico" alt="$WHATS_NEW$" border="0"/></span>$WHATS_NEW$</a></li></ul></div><div id="FooterDelayContent" style="display:none;"></div><ul id="AdhocNavBarJumpToMenu" style="display: none; width: auto;min-width: 160px;"><li id="MCNavOption"><a href="#AdhocHeadJumpto" id="MCNavOption-href" data-handler="javascript:OnJumpTo(0);">$MANAGEMENT_CONSOLE$</a></li><li id="WCNavOption"><a href="#AdhocHeadJumpto" id="WCNavOption-href" data-handler="javascript:OnJumpTo(1);">$BASIC_WEB_CLIENT$</a></li><li id="WCNewNavOption"><a href="#AdhocHeadJumpto" id="WCNewNavOption-href" data-handler="javascript:OnJumpTo(4);">$WEB_CLIENT_NEW$</a></li><li id="FSNewNavOption"><a href="#AdhocHeadJumpto" id="FSNewNavOption-href" data-handler="javascript:OnJumpTo(5);">$WEB_CLIENT_SHARE_NEW$</a></li><li id="FJNavOption"><a href="#AdhocHeadJumpto" id="FJNavOption-href" data-handler="javascript:OnJumpTo(2);">$FVJV$</a></li><li id="FSNavOption"><a href="#AdhocHeadJumpto" id="FSNavOption-href" data-handler="javascript:OnJumpTo(3);">$FILE_SHARING$</a></li></ul><script type="text/javascript">$(document).ready(function(){var g_bShowMC=(%IS_ADMIN%=="1")?true:false;var g_bShowWC=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bShowFVJV=(%ALLOW_FTP_VOYAGER_JV%=="1")?true:false;var g_bShowFileSharing=(%ALLOW_ADHOC_FILE_SHARING%=="1")?true:false;$("#ManConNavBarJumpToList").contextMenu({"menu":"AdhocNavBarJumpToMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#AdhocNavBarJumpToMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocNavBarJumpToMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});var nTotalHidden=0;if(!g_bShowMC||g_JumpToPage==0){$("#MCNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==1){$("#WCNavOption").hide();nTotalHidden+=1;}if(!g_bShowFVJV||g_JumpToPage==2){$("#FJNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==3){$("#FSNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==4){$("#WCNewNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==5){$("#FSNewNavOption").hide();nTotalHidden+=1;}if(nTotalHidden==6)$(".AdhocNavBarJumpTo").hide();else $(".AdhocNavBarJumpTo").show();});function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href="%FILE%ListDir.htm";break;case(2):location.href="%COMMON_FILE%FVJVLoggedIn.htm";break;case(3):location.href="%FILE%Share/Console.htm";break;case(4):location.href="/WebClientNew/Browser/~";break;case(5):location.href="/WebClientNew/Requested";break;}}</script><script type="text/javascript" language="javascript">var g_bFooterDelayLoaded=false;var g_bIsFileNameSelected=true;var g_bFooterIsWindowAuth=(%WINDOWS_AUTH_SUPPORT%==1);function IsFooterDelayLoaded(){return(g_bFooterDelayLoaded);}function OnFooterDelayLoaded(){g_bFooterDelayLoaded=true;}function OnLogOut(){g_bLinkRequested=true;clearSessionCookies('domainid');clearSessionCookies('domainodbc');location.href='%LOGOUT%';}function OnMoreWebClientInfo(){window.open("https://customerportal.solarwinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank","noopener");}function LaunchBasicWebClient(){if(g_bWebClientLicense){LoadingDialog(true);location.href="%FILE%ListDir.htm?Dir=%CURRENT_DIR%";}else ConfirmDialog(g_sWebClienLicenseInfo,OnMoreWebClientInfo);}function MainHelp(){LaunchHelp(g_sHelpPage,g_sHelpNode);}function OnShowChangeEmailDialog(){OnShowSetEmailDialog(g_sUserEmail);g_sUserEmail="";}if(%IS_LOCAL_ADMIN%){sLoggedInUser="($LOCAL_ADMIN$)";sLoggedInUserAlt="$LOCAL_ADMIN$";}else{sLoggedInUser=FormatClientString("%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)");sLoggedInUserAlt="%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)";}document.getElementById("CurrentlyLoggedIn").innerHTML=sLoggedInUser;setTimeout(function(){LoadDynamicContent("%ADMIN_FILE%Include/footerInclude.htm?ID=%ID%","FooterDelayContent",OnFooterDelayLoaded);});if(g_bOperaBrowser)document.body.onmousedown=function(){return false;};$(document).ready(function(){$('.menu-toggle').on('click',function(e){$('.menu-toggle').removeClass('active');$(this).addClass('active');});$(document).on('mouseup',function(e){var container=$(".menu-toggle");if(!container.is(e.target)&&container.has(e.target).length===0){$('.menu-toggle').removeClass('active');}});$("#UserOptBtn").contextMenu({"menu":"UserOptList","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#UserOptList").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#UserOptList").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});if(!(%IS_LOCAL_ADMIN%)){if(g_bAllowChangePassword)$("#UserOptList-password").show();if(g_bAllowChangeEmail)$("#UserOptList-changeemail").show();}});</script></body></html>