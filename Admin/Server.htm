<!--#include "Strings\Strings.strings"-->
<!--#include "..\Common\Strings\Strings.strings"-->
%PRIV_SYSTEM_ADMIN%<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"/><script type="text/javascript" language="javascript">if(%IS_LOCAL_ADMIN%)sTitleText="$SERVERDETAILS$";else sTitleText="%PRODUCT% - $SERVERDETAILS$";document.write("<title>"+sTitleText+"</title>");</script>%PAGE_CHANGE%<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script type="text/javascript" language="javascript">var g_bSecurityAlertTriggered=%SECURITY_ALERT_TRIGGERED%;var g_bServerIdentityAlertTriggered=%SERVER_IDENTITY_ALERT_TRIGGERED%;var g_bIsWebClient=false;var g_nShowList;var g_bLinkRequested=false;var g_sFontOverride="$FONT_OVERRIDE$";var g_bTreeNavVisible=false;var bTreeLoaded=false;var NavigationTree;var g_nServerSection="";var g_sTreeURL;var g_nTreeHeight=350;var g_bTreeRoot=false;var tree=new Array();var g_aHistory=new Array();var g_aHistoryNames=new Array();var g_aHistoryIcon=new Array();var g_aHistoryActive=new Array();var g_HistoryPointer=0;var g_sLastIcon="";var g_bHistoryButtonUsed=false;var g_bIslocalAdminBrowser=false;var g_sCannotMoveFile="$DRAG_DROP_CANNOT_MOVE_FILE$";var g_sConfirmMoveFileFrom="$CONFIRM_MOVE_FILE_FROM$ ";var g_sTo=" $TO$ ";var g_bCaseSensitiveOS=(%CASE_SENSITIVE_OS%==1);var g_bIsiPad=false;var sUserAgentCheck=navigator.userAgent.toLowerCase();var g_bSupportsMSMQ=("%SUPPORTS_MSMQ%"!="0");var g_bMSMQLicense=("%CServer.%SERVER_ID%.MSMQLicense%"!="0");var g_bSupportWinEventLog=("%SUPPORTS_WINDOWS_EVENT_LOG%"!="0");var g_bIsDemo=(%IS_DEMO%==1);var g_bLoginUser=false;var g_nDaysRemaining=parseInt("%CServer.%SERVER_ID%.LicenseDaysRemaining%");var g_bLicenseIsTemp=(%CServer.%SERVER_ID%.LicenseIsTemp%==1);var g_bLicenseIsPastTrial=(%CServer.%SERVER_ID%.LicenseIsPastTrial%==1);var g_bIsModEvalExp=(%IS_MODIFIED_EVAL_EXP%==1);var g_sTrialExpiredTxt="$TRIAL_IS_EXPIRED$";var g_sTrialExpiresInTxt="$TRIAL_EXPIRES_IN$";var g_sTrialExpiresDaysTxt="$DAYS$";var g_sBuyNow="$BUY_NOW$";var g_bIsAdminAllowedToAddUsers=(parseInt("%IS_ADMIN_ALLOWED_TO_ADD_USERS%")!=0);var g_sDomainName="%CDomain.%ID%.DomainName%";var g_JumpToPage=0;if(%IS_LOCAL_ADMIN%){g_bIslocalAdminBrowser=true;}if(sUserAgentCheck.indexOf('ipad')!=-1)g_bIsiPad=true;var g_sEncXsrfToken="%ENC_CSRF_TOKEN%";</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BrowserCheckAW.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-ui.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-contextMenu.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mousewheel.min.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mCustomScrollbar.min.js"></script><link type="text/css" href="%COMMON_FILE%Style/Fonts.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Dialog.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Common.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/global.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery.mCustomScrollbar.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-ui.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-contextMenu.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/nav.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonHeader.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonUI.css" rel="stylesheet" /><script type="text/javascript" language="javascript">if(AW.ff3){AW.getLeft=function(element){return element.getBoundingClientRect().left-document.documentElement.getBoundingClientRect().left;};AW.getTop=function(element){return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(g_bSafariBrowser){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top-4;};}if(AW.chrome){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top+4;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1){document.write('<style type="text/css">');document.write('body,table{');document.write(' font-size:11px;font-family: Helvetica Arial sans-serif;');document.write('}');document.write('</style>');}var g_sMenuDividers="--***--";var g_sImagePath="%COMMON_FILE%Images/";var g_sCommonPath="%COMMON_FILE%";var g_sFilePath="%ADMIN_FILE%";var g_sHelpPath="%HELP_BASE_URL%";var g_sConsoleInclude="0";var g_bDomainNav=false;var g_sAdminXMLPath="%ADMIN_FILE%XML/";var g_sUseInherited="$USE_INHERITED$";var g_bIE7=true;var g_bIEDomainCheck=true;var g_sLoading="$LOADING_DIALOG_TITLE$";var g_sSelectDomainMsg='$SELECT_DOMAIN_MSG$';var g_nDomainID;var g_sHelpPage="Help-Overview.htm";var g_sHelpNode="none";var g_sCurrentURLFileName="%INTERNAL_FILE%";var g_nSessionOkay=0;var g_nPermissionDenied=3;var g_nULLMax=18446744073709551615;var g_sGB="$FS_ABBREV_GIGABYTE$";var g_sMB="$FS_ABBREV_MEGABYTE$";var g_sKB="$FS_ABBREV_KILOBYTE$";var g_sBytes="$FS_BYTES$";var g_bFVJVLaunchPage=false;var g_sUnknownError="$UNKNOWN_ERROR$";var g_sHomeStr="$HOME$";var g_ActiveTab;var g_ActivePage;var g_bODBC64BitWarn=(%CServer.%SERVER_ID%.WarnODBC64BitUpgrade%==1);var g_bAllowChangePassword=%CAN_CHANGE_PASSWORD%;var g_bAllowChangeEmail=%USER_CAN_SET_EMAIL_ADDRESS%;var g_sUserEmail=HTMLDecode("%USER_EMAIL_ADDRESS%");var g_bSysAdmin=(%CUser.%USER_ID%.AdminType%==2||%CUser.%USER_ID%.AdminType%==4);var g_bGroupAdmin=(%CUser.%USER_ID%.AdminType%==5||%CUser.%USER_ID%.AdminType%==6);var g_bDomainAdmin=((%CUser.%USER_ID%.AdminType%==1)||(%CUser.%USER_ID%.AdminType%==3));var g_bReadOnlyAccess=(%CUser.%USER_ID%.AdminType%==3||%CUser.%USER_ID%.AdminType%==4||%CUser.%USER_ID%.AdminType%==6);var g_bAllowWebClient=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bFVJVLicense=(%CServer.%SERVER_ID%.AllowFVJV%==1);var g_bAllowFVJV=(%ALLOW_FTP_VOYAGER_JV%==1);var g_bWebClientLicense=(%CServer.%SERVER_ID%.WebClientLicense%==1);var g_sFVJVLicenseInfo="$FVJV_LICENSE_INFO$";var g_sWebClienLicenseInfo="$WEB_CLIENT_LICENSE_INFO$";var g_sLicenseEmail="%CServer.%SERVER_ID%.LicenseEMail%";var g_bUsingFIPS=(%CServer.%SERVER_ID%.UsingFIPS%==1);var g_sWebFilePath=%FILE%;var g_bAllowAdhocFileSharing=(%ALLOW_ADHOC_FILE_SHARING%==1);var g_bFileSharingLicense=(%CServer.%SERVER_ID%.FileSharingLicense%==1);var g_sAdhocFileShareLicenseInfo="$ADHOC_LICENSE_INFO$";if(!g_bSysAdmin)g_nDomainID=%DOMAIN_ID%;setTimeout("OnSendNOOP()",55000);</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Menus.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/InitialScript.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/utility.js"></script><script type="text/javascript" language="javascript">function RecommendAdminIEUpgrade(){if(g_bIslocalAdminBrowser){var bRecommendIEUpgrade=false;var nVersion=0;if(navigator.appVersion.indexOf("MSIE")!=-1){aTemp=navigator.appVersion.split("MSIE");nVersion=parseFloat(aTemp[1]);}if(nVersion>5.5&&nVersion<8)bRecommendIEUpgrade=(%WARN_OLD_BROWSER%!=0);if(navigator.userAgent.indexOf("MSIE")!=-1){var nVersionIndex=(navigator.userAgent.indexOf("MSIE")+5);var nVersionIE=parseInt(navigator.userAgent.charAt(nVersionIndex));if(nVersionIE>=8)bRecommendIEUpgrade=false;else if((navigator.userAgent.indexOf("compatible")!=-1)&&(nVersionIE>=8))bRecommendIEUpgrade=false;}if(bRecommendIEUpgrade)window.location.href="%FILE%AdminIEWarning.htm";}}</script><div id="ChangePasswordDialoginner" style="display:none;"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;"><div>$OLD_PASSWORD$:<div style="overflow:auto"><span id="OldPasswordChange"></span></div></div><div>$NEW_PASSWORD$:<br /><div style="overflow:auto"><span id="NewPasswordChange"></span></div></div><div>$VERIFY_PASSWORD$:<div style="overflow:auto"><span id="VerifyNewPasswordChange"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"></span><br /><span id="CancelChangePasswordButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var sWebClientChangePWord=undefined;var sChangePWordImg=undefined;try{if(g_bIsWebClient){sWebClientChangePWord="WC-Icon-ChangePassword";}else{sChangePWordImg="Change_Password16.png";}}catch(e){sChangePWordImg="Change_Password16.png";}BuildDialog("$CHANGE_PASSWORD_TITLE$","ChangePasswordDialog","300","155","","$CLOSE_CANCEL$",sChangePWordImg,undefined,sWebClientChangePWord);function OnChangePasswordSubmit(){var sChangePasswordCmd="%FILE%Login.xml?Command=LoginChangePassword";var ChangePasswordRequest=CreatePostRequest(sChangePasswordCmd);var sOldPassWord,sNewPassWord,sVerifyPassWord;sOldPassWord=OldPasswordInput.getControlText();sNewPassWord=NewPasswordInput.getControlText();sVerifyPassWord=VerifyNewPasswordInput.getControlText();if(sNewPassWord==sVerifyPassWord){ChangePasswordRequest.setParameter("old_password",sOldPassWord);ChangePasswordRequest.setParameter("new_password",sNewPassWord);ChangePasswordRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);ChangePasswordRequest.setAsync(true);ChangePasswordRequest.request();ChangePasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sWelcomeMsg=GetXMLValue(XMLDoc,"welcomemsg");if(nResult!=0){if(nResult==1)sResultText="$ERROR_PASSWORD_CHANGE_FAIL$";AlertDialog(GetResultText(0,"",sResultText));}else if(g_bLoginUser){ReplaceDialog("ChangePasswordDialog","LoggingInDialog");OnLoginOK(false,nResult,XMLDoc);}else{HideDialog('ChangePasswordDialog');AlertDialog("$PASSWORD_CHANGED$");}};}else{AlertDialog("$PASSWORDS_DONT_MATCH$",true);}}function OnCancelChangePassword(){HideDialog('ChangePasswordDialog');location.href="%LOGOUT%";}function ClearPasswordDialog(){OldPasswordInput.setControlText("");NewPasswordInput.setControlText("");VerifyNewPasswordInput.setControlText("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");OldPasswordInput.getContent("box/text").element().focus();if(bLogin){CancelPasswordButton.setControlText("$LOGOUT$");document.getElementById("ChangePasswordDialogCloseIcon").onmousedown=OnCancelChangePassword;}}CreateDialogPushButton("$OK_BUTTON$","ChangePasswordButton",OnChangePasswordSubmit);var CancelPasswordButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelChangePasswordButton",OnCancelChangePassword);var OldPasswordInput=CreatePasswordField("","OldPasswordChange","OldPasswordChange",undefined,200);var NewPasswordInput=CreatePasswordField("","NewPasswordChange","NewPasswordChange",undefined,200);var VerifyNewPasswordInput=CreatePasswordField("","VerifyNewPasswordChange","VerifyNewPasswordChange",undefined,200);</script><div id="UserEmailDialoginner" style="display:none;"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;">$EMAIL_DESCR$ <br /><div style="margin-top:5px;">$EMAIL$:<br /><div style="overflow:auto"><span id="CurrentUserEmail"></span></div></div><div>$VERIFY_EMAIL$:<br /><div style="overflow:auto"><span id="UserEmail"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"></span><br /><span id="LogoutUserEmailButton"></span><span id="CancelUserEmailButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sWebClientChangeEmail=undefined;var sChangeEmailImg=undefined;try{if(g_bIsWebClient){sWebClientChangeEmail="WC-Icon-ChangeEmail";}else{sChangeEmailImg="ChangeEmail.png";}}catch(e){sChangeEmailImg="ChangeEmail.png";}BuildDialog("$USER_EMAIL_TITLE$","UserEmailDialog","300","160","","$CLOSE_CANCEL$",sChangeEmailImg,undefined,sWebClientChangeEmail);function OnSetEmailAddressSubmit(){var sSetEmailCmd="%FILE%Result.xml?Command=SetEmailAddress";var SetEmailRequest=CreatePostRequest(sSetEmailCmd);var sEmailAddrs,CurrentEmailAddr;sEmailAddr=UserEmailInput.getControlText();sCurrentEmailAddr=CurrentUserEmail.getControlText();SetEmailRequest.setParameter("emailaddress",sEmailAddr);SetEmailRequest.setAsync(true);if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.request();else AlertDialog("$EMAIL_VALS_NO_MATCH$");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{HideDialog('UserEmailDialog');if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnCancelSetEmail(){HideDialog('UserEmailDialog');}function ClearSetEmailDialog(){UserEmailInput.setControlText("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(bNoCloseButton){var DialogCloseContainer=document.getElementById("UserEmailDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("UserEmailDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";CancelEmailButton.setStyle("display","none");LogoutUserEmailButton.setStyle("display","");}else{LogoutUserEmailButton.setStyle("display","none");}if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)CurrentUserEmail.setControlText(sEmail);else ClearSetEmailDialog();ShowDialog("UserEmailDialog");CurrentUserEmail.getContent("box/text").element().focus();}function OnLogoutEmailSet(){location.href="%LOGOUT%";}CreateDialogPushButton("$OK_BUTTON$","SaveUserEmailButton",OnSetEmailAddressSubmit);var CancelEmailButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelUserEmailButton",OnCancelSetEmail);var LogoutUserEmailButton=CreateDialogPushButton("$LOGOUT$","LogoutUserEmailButton",OnLogoutEmailSet);var UserEmailInput=CreateInputField("","UserEmail","UserEmail",undefined,200,undefined,undefined,OnSetEmailAddressSubmit);var CurrentUserEmail=CreateInputField("","CurrentUserEmail","CurrentUserEmail",undefined,200,undefined,undefined);</script><div id="ToolTipDialog" style="width:220px;height:180px;" class="DialogLayer"><table id="ToolTipDialogTitleBar" class="ToolTipDialogTitle" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCorner"><img src="%COMMON_FILE%Images/tooltip-left-top.png" width="27" height="23" border="0"></td><td class="ToolTipHeadContainer"><div id="ToolTipDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:5px;"><span id="ToolTipDialogTitleText" style="font-weight:bold;">&nbsp;</span></div></td><td class="ToolTipRightCorner"><a id="ToolTipClose" href="javascript:HideDialog('ToolTipDialog', true);"><img src="%COMMON_FILE%Images/tooltip-right-top.png" width="27" height="23" alt="$CLOSE_CANCEL$" border="0" onmouseover="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top-over.png'" onmouseout="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top.png'"></a></td></tr></table><div id="ToolTipDialogBody" style="width:2px;" class="ToolTipDialogBody"><div style="padding:0 5px 0 5px;"><span id="ToolTipDialogText"></span></div></div><table class="ToolTipFooter" id="ToolTipFooter" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCornerBottom">&nbsp;</td><td class="ToolTipPointerTop"><div class="BottomPointerOpening">&nbsp;</div></td><td class="ToolTipFooterFill">&nbsp;</td><td class="ToolTipRightCornerBottom">&nbsp;</td></tr></table><div style="text-align:left; vertical-align:top;" class="ToolTipPointerCell"></div></div><script type="text/javascript" language="JavaScript">var g_fnToolTipCallback=undefined;BubbleLoadingImg1=new Image();BubbleLoadingImg1.src="%COMMON_FILE%Images/tooltip-left-top.png";BubbleLoadingImg2=new Image();BubbleLoadingImg2.src="%COMMON_FILE%Images/tooltip-right-top.png";BubbleLoadingImg3=new Image();BubbleLoadingImg3.src="%COMMON_FILE%Images/tooltip-right-top-over.png";BubbleLoadingImg4=new Image();BubbleLoadingImg4.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";BubbleLoadingImg5=new Image();BubbleLoadingImg5.src="%COMMON_FILE%Images/Tooltip-fill.png";function ToolTipDialog(sTitle,sText,fn_CloseCallback,ToolTipPosObj,nWidth,nHeight,sCheckboxFunc,sResetId,xPointOffSet,yPointOffSet){if(sResetId!=undefined){var DialogIdReset=document.getElementById("ToolTipDialog");DialogIdReset.setAttribute('id',sResetId);}if(fn_CloseCallback!=undefined)g_fnToolTipCallback=fn_CloseCallback;if((document.getElementById("ToolTipDialogText")!=undefined)&&(sText!=undefined))document.getElementById("ToolTipDialogText").innerHTML=sText;if((document.getElementById("ToolTipDialogTitleText")!=undefined)&&(sTitle!=undefined))document.getElementById("ToolTipDialogTitleText").innerHTML=sTitle;if(nWidth!=undefined)document.getElementById("ToolTipDialogTitleContainer").style.width=(nWidth-60).toString()+"px";var sHideDialogFunction=String("HideDialog(");var sCheckBoxId="ToolTipDialog";if(sResetId!=""){document.getElementById("ToolTipClose").setAttribute("href","javascript:"+sHideDialogFunction+"\""+sResetId+"\", true);");sCheckBoxId=sResetId;}if(sCheckboxFunc!=undefined){document.getElementById("ToolTipDialogText").innerHTML+="<div style='padding-top:5px;'><input type='checkbox' value='noshow' onclick='"+sCheckboxFunc+sHideDialogFunction+"\""+sCheckBoxId+"\", true);'/> $DONT_SHOW_AGAIN$</div>";}ShowToolTipDialog("ToolTipDialog",false,g_fnToolTipCallback,ToolTipPosObj,nWidth,nHeight,undefined,undefined,undefined,sResetId,xPointOffSet,yPointOffSet);var nWidthAdjust;nWidthAdjust=parseInt(document.getElementById("ToolTipDialogBody").style.width);if(bIsOpera)document.getElementById("ToolTipDialogBody").style.width=(nWidthAdjust).toString()+"px";nWidthAdjust=(nWidthAdjust+2);document.getElementById("ToolTipDialogTitleBar").style.width=nWidthAdjust.toString()+"px";document.getElementById("ToolTipFooter").style.width=nWidthAdjust.toString()+"px";}</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_sBusyDialog="BusyDialog";function BusyDialog(bShow,sTitle,bWebClientIcon,bFromApplet){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top!="-5000px")bSkip=true;if(!bSkip){if(bShow)ShowDialog(g_sBusyDialog,undefined,undefined,bFromApplet);else{HideDialog(g_sBusyDialog,undefined,bFromApplet);sTitle="$BUSY_DIALOG_TITLE$";}SetupBusyDialog(sTitle,bWebClientIcon);}}function SetupBusyDialog(sTitle,bWebClientIcon){var TitleText=document.getElementById("BusyDialogTitleText");var sBusyDialogImage="su16x16.png";MCBusyDialogImage=new Image();MCBusyDialogImage.src="%COMMON_FILE%Images/su16x16.png";WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bWebClientIcon)document.getElementById("BusyDialogTitleIcon").src=WCBusyDialogImage.src;else document.getElementById("BusyDialogTitleIcon").src=MCBusyDialogImage.src;if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML="<strong>"+sTitle+"</strong>";var DialogCloseContainer=document.getElementById("BusyDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("BusyDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";}function SavingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$SAVING_DIALOG_TITLE$",bWebClientIcon);}function LoadingDialog(bShow,bWebClientIcon){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top=="-5000px")bSkip=true;if(!bSkip)BusyDialog(bShow,"$LOADING_DIALOG_TITLE$",bWebClientIcon);}function DeletingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$DELETING_DIALOG_TITLE$",bWebClientIcon);}</script><div id="BusyDialoginner" style="display:none;text-align:center;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" style="margin:0px auto 0px auto;"></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("$BUSY_DIALOG_TITLE$","BusyDialog","200","50","text-align:center","$CLOSE_CANCEL$");</script><div id="AlertDialoginner" style="display:none;"><table border="0"><tr><td style="vertical-align:top;"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px"></td><td style="text-align:left; padding-right: 10px"><span id="AlertDialogText" style="word-break: break-word; -ms-word-break: break-word; display: inline-block"></span><div id="AlertNoShowContainer" style="display:none;padding-top:10px;"><span id="AlertNoShowDialogCheckBox"></span></div></td></tr></table><div style="width:100%;text-align:center;"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></div><!--tr><td colspan="2" style="text-align:center"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></td></tr></table--></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var ExtraButton,g_bAlertNoShow,g_sAlertNoShowCookie;InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";BuildDialog("%PRODUCT%","AlertDialog","250","115","text-align:center","$CLOSE_CANCEL$");function AlertDialog(sText,bWarn,fn_OKCallback,bWebClientIcon,sExtraButtonText,fn_ExtraCallback,nWidth,nHeight,bAlertNoShow,sAlertNoShowCookie){WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";g_bAlertNoShow=false;g_sAlertNoShowCookie="";document.getElementById("AlertNoShowContainer").style.display="none";if(bWebClientIcon){document.getElementById("AlertDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("AlertDialogTitleIcon").height="16";document.getElementById("AlertDialogTitleIcon").width="16";}if((sExtraButtonText!=undefined)&&(fn_ExtraCallback!=undefined)){ExtraButton=CreatePushButton(sExtraButtonText,"ExtraButton",function(){HideDialog("AlertDialog");fn_ExtraCallback();});document.getElementById("ExtraButton").style.display="";}else{document.getElementById("ExtraButton").style.display="none";ExtraButton=undefined;fn_ExtraCallback=undefined;}if(nWidth!=undefined){document.getElementById("AlertDialog").style.width=nWidth+"px";}else document.getElementById("AlertDialog").style.width="250px";if(bAlertNoShow&&sAlertNoShowCookie!=undefined){g_bAlertNoShow=true;g_sAlertNoShowCookie=sAlertNoShowCookie;document.getElementById("AlertNoShowContainer").style.display="block";}g_fnAlertOKCallback=fn_OKCallback;if(document.getElementById("AlertImage")!=undefined){if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;document.getElementById("AlertImage").src=sImage;}if((document.getElementById("AlertDialogText")!=undefined)&&(sText!=undefined))document.getElementById("AlertDialogText").innerHTML=sText;ShowDialog("AlertDialog");OKAlertButton.focus();}function WarnDialog(sText,bWebClientIcon){AlertDialog(sText,true,undefined,bWebClientIcon);}function OnAlertDialogOkay(){HideDialog("AlertDialog");if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();document.getElementById("AlertImage").src=BlankImg.src;g_fnAlertOKCallback=undefined;if(g_bAlertNoShow){if(AlertNoShowCheckBox.getControlValue())createCookie(g_sAlertNoShowCookie,"1",60);}}var OKAlertButton=CreatePushButton("$OK_BUTTON$","AlertDialogOkButton",OnAlertDialogOkay);var AlertNoShowCheckBox=CreateCheckBox("$DONT_SHOW_AGAIN$","AlertNoShowDialogCheckBox","AlertNoShowCheckBox");</script><div id="ConfirmDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"><table border="0" id="ConfirmDialogtable"><tr><td><img src="%COMMON_FILE%Images/QuestionMark.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div id="ConfirmDialogText" style="width:200px;overflow-y:visible;overflow-x:auto;text-align:left;padding-left:2px;"></div></td></tr><tr><td colspan="2" style="text-align:center" id="ConfirmDialogbuttons"><span id="ConfirmDialogYesButton"></span><span id="ConfirmDialogNoButton"></span></td></tr></table></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("%PRODUCT%","ConfirmDialog","250","115","text-align:center","$CLOSE_CANCEL$");var g_sDeletingDialogTitle="$DELETING_DIALOG_TITLE$";var g_sConfirmDialog="ConfirmDialog";var g_fnYes=undefined,g_fnNo=undefined;var g_YesNoData=undefined;var g_bNoCloseDialog=false;var DEFAULT_CONFIRM_DIALOG_SIZE={WIDTH:"250px",HEIGHT:"115px"};function ConfirmDialog(sText,fnYes,fnNo,YesNoData,nWidth,nHeight,bDelete,bWebClientIcon,bNoCloseDialog,fnClose){var confirmDialog=document.getElementById("ConfirmDialog");var confirmDialogText=document.getElementById("ConfirmDialogText");var confirmDialogIcon=document.getElementById("ConfirmDialogTitleIcon");var dialogSize=getDialogSize(nWidth,nHeight);g_fnYes=g_fnNo=undefined;WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bNoCloseDialog)g_bNoCloseDialog=true;else g_bNoCloseDialog=false;if(bWebClientIcon){confirmDialogIcon.src=WCBusyDialogImage.src;confirmDialogIcon.height="16";confirmDialogIcon.width="16";}if((confirmDialogText!=undefined)&&(sText!=undefined)){confirmDialogText.innerHTML=sText;}g_fnYes=fnYes;g_fnNo=fnNo;g_YesNoData=YesNoData;confirmDialog.style.width=dialogSize.width;confirmDialogText.style.width=(parseInt(dialogSize.width)-50)+"px";document.getElementById("ConfirmDialogBody").style.overflow="hidden";document.getElementById("ConfirmDialogBody").style.textOverflow="ellipsis";ShowDialog("ConfirmDialog",undefined,fnClose);if(bDelete)ConfirmDialogNoButton.focus();else ConfirmDialogYesButton.focus();}function getDialogSize(customWidth,customHeight){var dialogWidth=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;var dialogHeight=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;if(!!customWidth){dialogWidth=isWithUnits(customWidth)?customWidth:customWidth+"px";}if(!!customHeight){dialogHeight=isWithUnits(customHeight)?customHeight:customHeight+"px";}return{width:dialogWidth,height:dialogHeight};}function isWithUnits(size){return size.toString().match(/px|%|vh|vw|em|rem/);}function CloseConfirmDialog(){HideDialog("ConfirmDialog");}function OnConfirmDialogYes(){if(g_fnYes!=undefined){setTimeout(function(){g_fnYes(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}if(!g_bNoCloseDialog)CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined){setTimeout(function(){g_fnNo(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}CloseConfirmDialog();}var ConfirmDialogYesButton=CreatePushButton("$YES_BUTTON$","ConfirmDialogYesButton",OnConfirmDialogYes);ConfirmDialogYesButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogYesButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogNoButton.focus();}});var ConfirmDialogNoButton=CreatePushButton("$NO_BUTTON$","ConfirmDialogNoButton",OnConfirmDialogNo);ConfirmDialogNoButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogNoButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogYesButton.focus();}});</script><div id="TopPntToolTipDialog" style="width:220px;height:180px;" class="DialogLayer"><table id="TopPntToolTipDialogTitleBar" class="ToolTipDialogTitle" cellpadding="0" cellspacing="0"><tr><td colspan="3" class="TopPointer">&nbsp;</td></tr><tr><td class="ToolTipLeftCorner"><img src="%COMMON_FILE%Images/tooltip-left-top.png" width="27" height="23" border="0"></td><td class="TopPntToolTipHeadContainer"><div id="TopPntToolTipDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:5px;"><span id="TopPntToolTipDialogTitleText" style="font-weight:bold;">&nbsp;</span></div></td><td class="ToolTipRightCorner"><a href="javascript:HideDialog('TopPntToolTipDialog', true);"><img src="%COMMON_FILE%Images/tooltip-right-top.png" width="27" height="23" alt="$CLOSE_CANCEL$" border="0" onmouseover="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top-over.png'" onmouseout="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top.png'"></a></td></tr></table><div id="TopPntToolTipDialogBody" style="width:2px;" class="ToolTipDialogBody"><div style="padding:0 5px 0 5px;"><span id="TopPntToolTipDialogText"></span></div></div><table class="ToolTipFooter" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCornerBottom">&nbsp;</td><td class="ToolTipFooterFill">&nbsp;</td><td class="ToolTipRightCornerBottom">&nbsp;</td></tr></table></div>
<script type="text/javascript" language="JavaScript">var g_fnToolTipCallback=undefined;TPBubbleLoadingImg1=new Image();TPBubbleLoadingImg1.src="%COMMON_FILE%Images/tooltip-left-top.png";TPBubbleLoadingImg2=new Image();TPBubbleLoadingImg2.src="%COMMON_FILE%Images/tooltip-right-top.png";TPBubbleLoadingImg3=new Image();TPBubbleLoadingImg3.src="%COMMON_FILE%Images/tooltip-right-top-over.png";TPBubbleLoadingImg4=new Image();TPBubbleLoadingImg4.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";TPBubbleLoadingImg5=new Image();TPBubbleLoadingImg5.src="%COMMON_FILE%Images/Tooltip-fill.png";function TopToolTipDialog(sTitle,sText,fn_CloseCallback,ToolTipPosObj,nWidth,nHeight,sCheckboxFunc,sResetId,xPointOffSet,yPointOffSet){if(fn_CloseCallback!=undefined)g_fnToolTipCallback=fn_CloseCallback;if((document.getElementById("TopPntToolTipDialogText")!=undefined)&&(sText!=undefined))document.getElementById("TopPntToolTipDialogText").innerHTML=sText;if((document.getElementById("TopPntToolTipDialogTitleText")!=undefined)&&(sTitle!=undefined))document.getElementById("TopPntToolTipDialogTitleText").innerHTML=sTitle;if(sCheckboxFunc!=undefined){sHideDialogFunction=String("HideDialog(");document.getElementById("TopPntToolTipDialogText").innerHTML+="<div style='padding-top:5px;'><input type='checkbox' value='noshow' onclick='"+sCheckboxFunc+sHideDialogFunction+"\"TopPntToolTipDialog\", true);'/> $DONT_SHOW_AGAIN$</div>";}ShowToolTipDialog('TopPntToolTipDialog',false,g_fnToolTipCallback,ToolTipPosObj,nWidth,nHeight,true,50,30,sResetId,xPointOffSet,yPointOffSet);var nWidthAdjust;nWidthAdjust=parseInt(document.getElementById("TopPntToolTipDialogBody").style.width);if(bIsOpera)document.getElementById("TopPntToolTipDialogBody").style.width=(nWidthAdjust).toString()+"px";}</script><style>#ExportServerIdentityDialogBody {left: 0;font-weight: bold;}#ExportSIPassword {width: 97% !important;}#ExportSIPasswordConfirm {width: 97% !important;}#ExportSIPath-box-text {position: static;margin: 0;padding: 0;}#ExportSIPath, #ExportSIPath-box {margin: 0;padding: 0;border: none;outline: none;width: 354px !important;}#ExportSIPath {width: 329px !important;}#ExportSIPath:not(.aw-system-control) {display: inline-block;float: left;margin-top: 4px;margin-left: 10px;}#btn-BrowseButtonExportSI {outline: none;border: none;display: inline-block;float: left;}#ExportSIPath-box-text {width: 329px;color: dimgrey;}</style><div id="ExportServerIdentityDialoginner" style="display:none;"><form name="ExportSIForm" onsubmit="return (false);" autocomplete="off"><table border="0" class="DialogTable" style="padding: 5px;"><tr><td colspan="2"><fieldset style="padding-top:2px;padding-bottom:20px;text-align:center"><legend style="color:red;font-weight:bold">$NOTE$</legend>$EXPORT_SI_INFO$</fieldset></td></tr><tr><td colspan="2" style="vertical-align:top;padding-bottom:25px;padding-top:25px;"><div><span style="padding-bottom:5px;display:inline-block;" id="ExportSIPathLabel">$EXPORT_SI_PATH$:</span></div><div><span id="BrowseButtonExportSI"></span><span id="ExportSIPath"></span></div></td></tr><tr><td style="width:120px;" id="ExportSIPasswordLabel">$ENTER_PASSWORD$:</td><td style="vertical-align:top;"><span id="ExportSIPassword"></span></td></tr><tr><td style="width:120px;padding-bottom:25px;" id="ExportSIConfirmPasswordLabel">$CONFIRM_PASSWORD$:</td><td style="vertical-align:top;padding-bottom:25px;"><span id="ExportSIPasswordConfirm"></span></td></tr><tr><td style="text-align:right;vertical-align:top;" colspan="2"><span id="SaveExportSIButton" style="margin: 5px;"></span><span id="CancelExportSIButton" style="margin: 5px;"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var passwordValidationMessage='$PASSWORD_VALIDATION_MESSAGE$';var TOOLTIP_SHOW_DURATION_IN_MILLIS=0;var TOOLTIP_SHOW_DELAY_IN_MILLIS=0;var TOOLTIP_HIDE_DELAY_IN_MILLIS=0;var TOOLTIP_HIDE_DURATION_IN_MILLIS=0;BuildDialog("$EXPORT_SI_DIALOG_TITLE$","ExportServerIdentityDialog","420","120","","$CLOSE_CANCEL$","Export.png");var SaveExportSI=CreateInputField("","ExportSIPath","ExportSIPath","",375,undefined,undefined,ExportServerIdentity);var SaveExportSIPassword=CreatePasswordField("","ExportSIPassword","ExportSIPassword","",undefined,undefined,undefined,ExportServerIdentity);var SaveExportSIConfirm=CreatePasswordField("","ExportSIPasswordConfirm","ExportSIPasswordConfirm","",undefined,undefined,undefined,ExportServerIdentity);SaveExportSIPassword.setAttribute('autocomplete','new-password');SaveExportSIConfirm.setAttribute('autocomplete','new-password');var SaveExportSIBrowse=CreatePushButton("Browse","BrowseButtonExportSI",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[SaveExportSI,true,"0","0",undefined,undefined,undefined,true]]);CreateDialogPushButton("$SAVE_EXPORT$","SaveExportSIButton",ExportServerIdentity);CreateDialogPushButton("$CANCEL_BUTTON$","CancelExportSIButton",function(){HideDialog("ExportServerIdentityDialog");ClearExportSIInputs();});$("#ExportSIPath input").attr('readonly',true);var passwordTooltip=$("#ExportSIPassword input").tooltip({"tooltipClass":"customTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_DURATION_IN_MILLIS,"delay":TOOLTIP_HIDE_DELAY_IN_MILLIS },"items":"[title]","content":function(){var element=$(this);if(element.is("[title]"))return element.attr("title");}});$("#ExportSIPassword input").attr('title',passwordValidationMessage);$('#ExportSIPassword input').keyup(function(){validateOnChange('password');});$("#ExportSIPasswordConfirm input").keyup(function(){validateOnChange('confirm');});$("#ExportSIPassword input").focusout(function(){var sExportSIFilePath=SanitizeString(SaveExportSI.getControlText());if(!sExportSIFilePath){$("#ExportSIPath .aw-ui-input").css('border-color','#b03232');$("#ExportSIPathLabel").css('color','#b03232');}});$("#ExportSIPath input").focusin(function(){$("#ExportSIPathLabel").css('color','#333333');$("#ExportSIPath .aw-ui-input").css('border-color','#ABADB3 #DBDFE6 #E3E9EF #E2E3EA');});$("#ExportSIPassword input").focusout(function(){var sPassword=SanitizeString(SaveExportSIPassword.getControlText());if(!sPassword){$("#ExportSIPassword .aw-ui-input").css('border-color','#b03232');$("#ExportSIPasswordLabel").css('color','#b03232');}});$("#ExportSIPassword input").focusin(function(){setPasswordValid();});$("#ExportSIPasswordConfirm input").focusout(function(){var sPasswordConfirm=SanitizeString(SaveExportSIConfirm.getControlText());if(!sPasswordConfirm){$("#ExportSIPasswordConfirm .aw-ui-input").css('border-color','#b03232');$("#ExportSIConfirmPasswordLabel").css('color','#b03232');}});$("#ExportSIPasswordConfirm input").focusin(function(){$("#ExportSIConfirmPasswordLabel").css('color','#333333');$("#ExportSIPasswordConfirm .aw-ui-input").css('border-color','#ABADB3 #DBDFE6 #E3E9EF #E2E3EA');});function setPasswordInvalid(){$('#ExportSIPassword .aw-ui-input').css('border-color','#b03232');$('#ExportSIPasswordLabel').css('color','#b03232');}function setPasswordValid(){$("#ExportSIPasswordLabel").css('color','#333333');$("#ExportSIPassword .aw-ui-input").css('border-color','#ABADB3 #DBDFE6 #E3E9EF #E2E3EA');}function setTooltip(text){$('#ExportSIPassword .aw-item-text').attr("title",text);}function validateOnChange(){var passwordValid=true;const passwordValidationRules=validatePassword(SaveExportSIPassword);for(var i=0;i<passwordValidationRules.length;i++){if(passwordValidationRules[i]){setPasswordInvalid();setTooltip(passwordValidationMessage);passwordValid=false;break;}}if(passwordValid){passwordTooltip.tooltip('close');setPasswordValid();setTooltip('');$('.ui-tooltip').remove();}return passwordValid;}function validatePassword(input){var sPassword=SanitizeString(input.getControlText());return[!sPassword,sPassword&&(sPassword.length<8),!/[$&+,:;=?@#|'<>.^*()%!\-\/\\]/.test(sPassword),!/[0-9]/.test(sPassword),!/[A-Z]/.test(sPassword),!/[a-z]/.test(sPassword),];}function ExportServerIdentity(){var sExportSIFilePath=SanitizeString(SaveExportSI.getControlText()),sPassword=SanitizeString(SaveExportSIPassword.getControlText()),sPasswordConfirm=SanitizeString(SaveExportSIConfirm.getControlText());if(!sPassword){$("#ExportSIPassword .aw-ui-input").css('border-color','#b03232');$("#ExportSIPasswordLabel").css('color','#b03232');return;}if(!sPasswordConfirm){$("#ExportSIPasswordConfirm .aw-ui-input").css('border-color','#b03232');$("#ExportSIConfirmPasswordLabel").css('color','#b03232');return;}if(sPassword!==sPasswordConfirm){AlertDialog("$PASSWORDS_DO_NOT_MATCH$",true,(function(){SaveExportSIConfirm.getContent("box/text").element().focus()}));return;}var ExportServerIdentityObj=createAWHttpRequest("POST","%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.ExportServerIdentity",OnSIExportDone);if(ExportServerIdentityObj){sExportSIFilePath=sExportSIFilePath.replace(/\/$/,'');ExportServerIdentityObj.setParameter("File",sExportSIFilePath);ExportServerIdentityObj.setParameter("pword",sPassword);ExportServerIdentityObj.request();}}function OnSIExportDone(){var xmlDoc=this.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"result");var sResultText=GetXMLValue(xmlDoc,"ResultText");if(xmlDoc&&nResult==0){HideDialog("ExportServerIdentityDialog");ClearExportSIInputs();}AlertDialog(GetResultText(0,"",sResultText));}function ClearExportSIInputs(){SaveExportSI.setControlText("");SaveExportSIPassword.setControlText("");SaveExportSIConfirm.setControlText("");}function OnShowExportSIDialog(){ShowDialog("ExportServerIdentityDialog");setTimeout(function(){ClearExportSIInputs();});}</script><style>#ImportServerIdentityDialogBody {left: 0;font-weight: bold;}#ImportSIPassword {width: 97% !important;}#ImportSIPath-box-text {position: static;margin: 0;padding: 0;}#ImportSIPath, #ImportSIPath-box {margin: 0;padding: 0;border: none;outline: none;width: 354px !important;}#ImportSIPath {width: 329px !important;}#ImportSIPath:not(.aw-system-control) {display: inline-block;float: left;margin-top: 4px;margin-left: 10px;}#btn-BrowseButtonImportSI {outline: none;border: none;display: inline-block;float: left;}#ImportSIPath-box-text {width: 329px;color: dimgrey;}</style><div id="ImportServerIdentityDialoginner" style="display:none;"><form name="ImportSIForm" onsubmit="return (false);" autocomplete="off"><table border="0" class="DialogTable" style="padding-left: 5px;"><tr><td style="width:330px;vertical-align:top;padding-bottom:25px;"><div><span style="padding-bottom:5px;display:inline-block;" id="ImportSIPathLabel">$IMPORT_SI_PATH$:</span></div><div><span id="BrowseButtonImportSI"></span><span id="ImportSIPath"></span></div></td></tr><tr><td style="width:330px;vertical-align:top;" id="ImportSIPasswordLabel">$ENTER_PASSWORD$:<div style="overflow:auto"><span id="ImportSIPassword"></span></div></td></tr><tr><td style="text-align:right;vertical-align:top;padding-bottom:20px;padding-top:20px;"><span id="SaveImportSIButton" style="margin: 5px;"></span><span id="CancelImportSIButton" style="margin: 5px;"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$IMPORT_SI_DIALOG_TITLE$","ImportServerIdentityDialog","420","120","","$CLOSE_CANCEL$","Import.png");var SaveImportSI=CreateInputField("","ImportSIPath","ImportSIPath","",290,undefined,undefined,ImportServerIdentity);var SaveImportSIPassword=CreatePasswordField("","ImportSIPassword","ImportSIPassword","",290,undefined,undefined,ImportServerIdentity);SaveImportSIPassword.setAttribute('autocomplete','new-password');var SaveImportSIBrowse=CreatePushButton("Browse","BrowseButtonImportSI",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[SaveImportSI,true,"0","0",undefined,undefined,undefined,true]]);CreateDialogPushButton("$SAVE_IMPORT$","SaveImportSIButton",ImportServerIdentity);CreateDialogPushButton("$CANCEL_BUTTON$","CancelImportSIButton",function(){ClearImportSIInputs();HideDialog("ImportServerIdentityDialog");});$("#ImportSIPath input").attr('readonly',true);$("#ImportSIPassword input").focusout(function(){var sPassword=SanitizeString(SaveImportSIPassword.getControlText());if(!sPassword){$("#ImportSIPassword .aw-ui-input").css('border-color','#b03232');$("#ImportSIPasswordLabel").css('color','#b03232');}});$("#ImportSIPassword input").focusin(function(){$("#ImportSIPasswordLabel").css('color','#333333');$("#ImportSIPassword .aw-ui-input").css('border-color','#ABADB3 #DBDFE6 #E3E9EF #E2E3EA');});function ImportServerIdentity(){var sImportSIFilePath=SanitizeString(SaveImportSI.getControlText()),sPassword=SanitizeString(SaveImportSIPassword.getControlText());if(!sPassword){$("#ImportSIPassword .aw-ui-input").css('border-color','#b03232');$("#ImportSIPasswordLabel").css('color','#b03232');return;}var ImportServerIdentityObj=createAWHttpRequest("POST","%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.ImportServerIdentity",OnSIImportDone);if(ImportServerIdentityObj){sImportSIFilePath=sImportSIFilePath.replace(/\/$/,'');ImportServerIdentityObj.setParameter("File",sImportSIFilePath);ImportServerIdentityObj.setParameter("pword",sPassword);ImportServerIdentityObj.request();}}function ClearImportSIInputs(){SaveImportSI.setControlText("");SaveImportSIPassword.setControlText("");}function OnSIImportDone(){var xmlDoc=this.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"result");var sResultText=GetXMLValue(xmlDoc,"ResultText");if(xmlDoc&&nResult==0){$('#CreateServerIdentity').css('display','none');toggleServerIdentityPresent(false);HideDialog("ImportServerIdentityDialog");ClearImportSIInputs();}AlertDialog(GetResultText(0,"",sResultText));}function OnShowImportSIDialog(){ShowDialog("ImportServerIdentityDialog");setTimeout(function(){ClearImportSIInputs();});}</script><script type="text/javascript" language="JavaScript">var g_EditObjectID=%SERVER_ID%;var g_ActiveRezizeGrid;var g_nGridOffSet=350;var g_bIsODBC=false;var g_bLicenseNeedUpdate=false;var g_MaxUserLicense;g_nServerSection=0;g_ActivePage=1;</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/ObjectTable.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BasicGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/AdminGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Dialog.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/NaturalSort.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/FileList.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/IPAccess.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/Events.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/XMLHTTPRequest.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/commonlogscripts.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/DomainAttrLogScripts.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><style type="text/css">/*.aw-ie #UserTableMapObj .aw-combo-box .aw-item-text, .aw-ie #GroupTableMapObj .aw-combo-box .aw-item-text {position:relative;top:0px;left:0px;width:100%;margin:-3px -1px;}*/.aw-ie #UserTableMapObj .aw-combo-box .aw-item-image, .aw-ie #GroupTableMapObj .aw-combo-box .aw-item-image {margin-top:-7px;}.aw-chrome #EditionData-Current div, #EditionData-FTPEdition div, .aw-chrome #EditionData-MFTEdition div,.aw-safari #EditionData-Current div, #EditionData-FTPEdition div, .aw-safari #EditionData-MFTEdition div{width:100px;}</style><div id="BrowseDialogDiv" style="display:none;"></div><div id="GroupEmailDialogs" style="display:none;"></div><div id="FilterDialogDiv" style="display:none;"></div><div id="IPAccessDialoginner" style="display:none;"><form name="IPAccessForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div style="width:225px;float:left;">$IP_ACCESS_RULE_LABEL$:<div style="overflow:auto"><span id="IPAccessRule"></span></div></div><div style="width:135px;float:left;padding-left:5px;height:40px;overflow:hidden;"><span id="Allow"></span></div><div style="clear:left;">$DESCRIPTION$:<br /><span id="IPRuleDescription"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveIPAccessButton"></span><span id="CancelIPAccessButton"></span><br /><br /><span id="HelpIPAccessButton"></span></td></tr><tr><td><div id="IPAccessTipsGroup"><div style="width:145px;float:left;margin-bottom:5px;padding-left:3px;">xxx = $IP_RULE_MATCH$<br />* = $IP_RULE_ANY$<br />/ = $IP_RULE_CIDR$<br /></div><div style="width:250px;float:left;padding-left:5px;margin-bottom:5px;">| &nbsp; xxx-xxx = $IP_RULE_RANGE$<br />| &nbsp; ? = $IP_RULE_ANY_CHAR$<br />|</div></div></td></tr></table></form></div><script type="text/javascript" language="javascript">var g_sRuleAddressColumn="$RULE_ADDRESS$";var g_sAccessColumn="$ACCESS$";var g_sExpiresInColumn="$EXPIRES_IN$";var g_sIPDescriptionColumn="$DESCRIPTION$";var g_sRuleAllow="$RULE_ALLOW$";var g_sRuleDeny="$RULE_DENY$";var g_sRuleExpired="$RULE_EXPIRED$";BuildDialog("$IP_ACCESS_DIALOG_TITLE$","IPAccessDialog","530","220","","$CLOSE_CANCEL$","IpAccess16.png");function OnIPAccessLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("IPAccessDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}IPAccessRadio.initValue(parseInt(IPAccessList.getCellValue(1,IPAccessList.getSelectedRows())));IPRule.setControlText(document.getElementById(IPRule.getContent("box/text").getId()).value);IPRule.getContent("box/text").element().focus();}function OnSaveIPAccess(){if(IPRule.getControlText()!="")IPAccessList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_RULE$",true,(function(){IPRule.getContent("box/text").element().focus()}));return(false);}function OnCancelIPAccess(){HideDialog('IPAccessDialog');}function OnIPAccessHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-IP-ACL.htm",sExpandNode);}var IPAccessRadio=CreateRadioButtons(1,["$RULE_ALLOW_LABEL$","$RULE_DENY_LABEL$"],"Allow","Allow","130px",undefined,[1,0]);if(g_bFireFox3Browser)document.getElementById("Allow-box").style.height="40px";var IPRule=CreateInputField("","IPAccessRule","IPAccess_IP",undefined,225,undefined,undefined,OnSaveIPAccess);var IPRuleDescription=CreateInputField("","IPRuleDescription","IPAccess_Description",undefined,410,undefined,undefined,OnSaveIPAccess);CreateGroupBox("$IP_ACCESS_TIPS$","IPAccessTipsGroup","415px","75px",true);CreateDialogPushButton("$SAVE_BUTTON$","SaveIPAccessButton",OnSaveIPAccess);CreateDialogPushButton("$CANCEL_BUTTON$","CancelIPAccessButton",OnCancelIPAccess);CreateDialogPushButton("$HELP_BUTTON$","HelpIPAccessButton",OnIPAccessHelp);</script><div id="DatabaseDialoginner" style="display:none;"><div id="DatabaseContent" style="width:525px"><div class="layercontent"><div style="display:inline;"><img alt="$DATABASE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32" class="header-icon" />$DATABASE_MAPPING_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="clear:both;padding-bottom:5px;">$TABLE_MAPPING_OBJ$:<div style="margin-bottom:5px;"><div id="UserTableobjDiv" style="float:left;width:260px;"><span id="UserTableMapObj"></span></div><div id="UserTableCheckDiv" style="float:left;width:150px;clear:both;"><span id="UserEnableTableCheckBox"></span></div><div id="GroupTableobjDiv" style="float:left;width:260px;"><span id="GroupTableMapObj"></span></div><div id="GroupTableCheckDiv" style="float:left;width:150px;clear:both;"><span id="GroupEnableTableCheckBox"></span></div><div style="clear:both;height:1px;line-height:1px;">&nbsp;</div></div></div><span id="TableMapList"></span><table style="padding-top:5px;width:100%"><tr><td><span id="EditMappingButton"></span><span id="UseDefaultMappingButton"></span></td><td style="text-align:right;"><span id="CloseMappingButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">var g_bUserTables;BuildDialog("$DATABASE_DIALOG_TITLE$","DatabaseDialog","540","375","","$CLOSE_CANCEL$","Database16.png");var g_asUserTables=["$DB_USER_INFO$","$DB_USER_GROUP$","$DB_USER_DIRACCESS$","$DB_USER_VIRPATH$","$DB_USER_IPACCESS$","$DB_USER_EVENTS$","$DB_USER_FREEFILES$","$DB_USER_USERFILES$","$DB_USER_USERBYTES$","$DB_USER_SESSFILES$","$DB_USER_SESSBYTES$","$DB_USER_AVAILABILITY$","$DB_USER_SSH_KEY_PATH$"];var g_anUserTableIDs=[%CServer.%SERVER_ID%.ODBCUserTable.ID%,%CServer.%SERVER_ID%.ODBCUserGroupMembershipTable.ID%,%CServer.%SERVER_ID%.ODBCUserDirAccessTable.ID%,%CServer.%SERVER_ID%.ODBCUserVirtualPathTable.ID%,%CServer.%SERVER_ID%.ODBCUserIPAccessTable.ID%,%CServer.%SERVER_ID%.ODBCUserSUEventTable.ID%,%CServer.%SERVER_ID%.ODBCUserUlDlRatioFreeFileTable.ID%,%CServer.%SERVER_ID%.ODBCUserUserFilesUlDlRatioTable.ID%,%CServer.%SERVER_ID%.ODBCUserUserBytesUlDlRatioTable.ID%,%CServer.%SERVER_ID%.ODBCUserSessionFilesUlDlRatioTable.ID%,%CServer.%SERVER_ID%.ODBCUserSessionBytesUlDlRatioTable.ID%,%CServer.%SERVER_ID%.ODBCUserAttrAvailabilityTable.ID%,%CServer.%SERVER_ID%.ODBCUserSSHPublicKeyFileTable.ID%];var g_anUserTableEnabled=["2",%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserGroupMembershipTable.ID%.Enabled%,"2",%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserVirtualPathTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserIPAccessTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSUEventTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserUlDlRatioFreeFileTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserUserFilesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserUserBytesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSessionFilesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSessionBytesUlDlRatioTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserAttrAvailabilityTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSSHPublicKeyFileTable.ID%.Enabled%];var g_anUserTableEnabledIcon=["table-enabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserGroupMembershipTable.ID%.Enabled%)?"table-enabled":"table-disabled","table-enabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserVirtualPathTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserIPAccessTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSUEventTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserUlDlRatioFreeFileTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserUserFilesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserUserBytesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSessionFilesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSessionBytesUlDlRatioTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserAttrAvailabilityTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCUserSSHPublicKeyFileTable.ID%.Enabled%)?"table-enabled":"table-disabled"];var g_asGroupTables=["$DB_GROUP_INFO$","$DB_GROUP_DIRACCESS$","$DB_GROUP_VIRPATH$","$DB_GROUP_IPACCESS$","$DB_GROUP_EVENTS$","$DB_GROUP_FREEFILES$","$DB_GROUP_AVAILABILITY$","$DB_GROUP_SSH_KEY_PATH$"];var g_anGroupTableIDs=[%CServer.%SERVER_ID%.ODBCGroupTable.ID%,%CServer.%SERVER_ID%.ODBCGroupDirAccessTable.ID%,%CServer.%SERVER_ID%.ODBCGroupVirtualPathTable.ID%,%CServer.%SERVER_ID%.ODBCGroupIPAccessTable.ID%,%CServer.%SERVER_ID%.ODBCGroupSUEventTable.ID%,%CServer.%SERVER_ID%.ODBCGroupUlDlRatioFreeFileTable.ID%,%CServer.%SERVER_ID%.ODBCGroupAttrAvailabilityTable.ID%,%CServer.%SERVER_ID%.ODBCGroupSSHPublicKeyFileTable.ID%];var g_anGroupTableEnabled=["2","2",%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupVirtualPathTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupIPAccessTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupSUEventTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupUlDlRatioFreeFileTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupAttrAvailabilityTable.ID%.Enabled%,%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupSSHPublicKeyFileTable.ID%.Enabled%];var g_anGroupTableEnabledIcon=["table-enabled","table-enabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupVirtualPathTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupIPAccessTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupSUEventTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupUlDlRatioFreeFileTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupAttrAvailabilityTable.ID%.Enabled%)?"table-enabled":"table-disabled",(%CODBCTableMap.%CServer.%SERVER_ID%.ODBCGroupSSHPublicKeyFileTable.ID%.Enabled%)?"table-enabled":"table-disabled"];var g_nSelTableID=0,g_nEditCol=1,g_nEditRow=0;var g_sColumnEditVal="";var g_bInitialLoad=true;var UserObjCombo=CreateComboBox(g_asUserTables[0],g_anUserTableIDs[0],g_asUserTables,g_anUserTableIDs,"UserTableMapObj","Info_UserTableMapObj",OnChangeTableObj,"",false,$USER_TABLE_MAPPING_WIDTH$,24);document.getElementById("UserTableobjDiv").width=($USER_TABLE_MAPPING_WIDTH$+10);var GroupObjCombo=CreateComboBox(g_asGroupTables[0],g_anGroupTableIDs[0],g_asGroupTables,g_anGroupTableIDs,"GroupTableMapObj","Info_GroupTableMapObj",OnChangeTableObj,"",false,$GROUP_TABLE_MAPPING_WIDTH$,24);document.getElementById("GroupTableobjDiv").width=($GROUP_TABLE_MAPPING_WIDTH$+10);UserObjCombo.getPopupTemplate().setStyle("height",(g_anUserTableEnabledIcon.length<=10)?((16*g_anUserTableEnabledIcon.length)+((AW.ie)?3:0))+"px":"163px");GroupObjCombo.getPopupTemplate().setStyle("height",(g_anGroupTableEnabledIcon.length<=10)?((16*g_anGroupTableEnabledIcon.length)+((AW.ie)?3:0))+"px":"163px");UserObjCombo.setItemImage(g_anUserTableEnabledIcon);GroupObjCombo.setItemImage(g_anGroupTableEnabledIcon);var UserEnableTableCheckBox=CreateCheckBox("$ENABLE_TABLE$","UserEnableTableCheckBox","UserEnableTable",(g_anUserTableEnabled[0]!="0")?true:false,OnSaveUserTableEnabled,true);var GroupEnableTableCheckBox=CreateCheckBox("$ENABLE_TABLE$","GroupEnableTableCheckBox","GroupEnableTable",(g_anGroupTableEnabled[0]!="0")?true:false,OnSaveGroupTableEnabled,true);if(g_bFireFox3Browser){UserObjCombo.getPopupTemplate().setStyle("margin-top","-5px");UserObjCombo.getPopupTemplate().setStyle("background-color","#fff");GroupObjCombo.getPopupTemplate().setStyle("margin-top","-5px");GroupObjCombo.getPopupTemplate().setStyle("background-color","#fff");}if(g_bSafariBrowser){UserObjCombo.getPopupTemplate().setStyle("margin-top","0px");UserObjCombo.getPopupTemplate().setStyle("background-color","#fff");GroupObjCombo.getPopupTemplate().setStyle("margin-top","0px");GroupObjCombo.getPopupTemplate().setStyle("background-color","#fff");}var TableMapList=CreateAdminGrid("TableMapList",["$DB_ATTRIBUTE$","$DB_COLUMN_NAME$"],[200,225],"ODBCTableMap.xml?ID=%OBJECT_EDIT_ID%","columnmaps","columnmap",4,OnEditTableMap);TableMapList.setCellFormat([new AW.Formats.String,new AW.Formats.XMLString,]);TableMapList.setStyle("height","200px");TableMapList.setSelectionMode("single-row");TableMapList.setSelectionMultiple(false);TableMapList.DisableSorting();TableMapList.defaultPostUpdate=TableMapList.PostUpdate;TableMapList.PostUpdate=function(){this.defaultPostUpdate();if(this.getCellText(1,1)=="")this.deleteRow(1);if(g_bInitialLoad){this.refresh();g_bInitialLoad=false;}this.setSelectedRows([-1]);BoldNonDefaultVals(TableMapList,1,2);};function OnEditTableMap(){if((TableMapList.getSelectedRows()!="")&&(TableMapList.getSelectedRows()!=-1)){g_sColumnEditVal=TableMapList.getCellText(1,TableMapList.getSelectedRows());g_nEditRow=TableMapList.getSelectedRows()[0];OnShowMappingRenameDialog(g_sColumnEditVal);}else AlertDialog("$SELECT_DB_COLUMN_EDIT$");}var sOnEditMapping=String("OnEditTableMap(");var sOnDefaultMapping=String("OnDefaultMapping(");CreateContextMenu([sOnEditMapping,sOnDefaultMapping],["$EDIT_BUTTON$...","$DEFAULT_BUTTON$..."],["FileRename","Edit"],TableMapList,"TableMapListContext",true);CreatePushButton("$EDIT_BUTTON$...","EditMappingButton",OnEditTableMap);CreatePushButton("$DEFAULT_BUTTON$","UseDefaultMappingButton",OnDefaultMapping);CreateDialogPushButton("$CLOSE_BUTTON$","CloseMappingButton",OnCloseMappingDialog);function OnSaveUserTableEnabled(){var SetUserTableEnabledRequest;SetUserTableEnabledRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.ODBCTableMap."+g_nSelTableID);SetUserTableEnabledRequest.setParameter("Enabled",(UserEnableTableCheckBox.getControlValue()?"1":"0"));SavingDialog(true);SetUserTableEnabledRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult==g_nSessionOkay){g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]=UserEnableTableCheckBox.getControlValue()?"1":"0";g_anUserTableEnabledIcon[parseInt(UserObjCombo.getSelectedItems())]=UserEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled";if(!AW.opera)UserObjCombo.setControlImage(UserEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled");UserObjCombo.setItemImage(g_anUserTableEnabledIcon);}else{UserEnableTableCheckBox.setChecked((g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]!="0")?true:false,true);}};SetUserTableEnabledRequest.request(null);}function OnSaveGroupTableEnabled(){var SetGroupTableEnabledRequest;
SetGroupTableEnabledRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.ODBCTableMap."+g_nSelTableID);SetGroupTableEnabledRequest.setParameter("Enabled",(GroupEnableTableCheckBox.getControlValue()?"1":"0"));SavingDialog(true);SetGroupTableEnabledRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult==g_nSessionOkay){g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]=GroupEnableTableCheckBox.getControlValue()?"1":"0";g_anGroupTableEnabledIcon[parseInt(GroupObjCombo.getSelectedItems())]=GroupEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled";if(!AW.opera)GroupObjCombo.setControlImage(GroupEnableTableCheckBox.getControlValue()?"table-enabled":"table-disabled");GroupObjCombo.setItemImage(g_anGroupTableEnabledIcon);}else{GroupEnableTableCheckBox.setChecked((g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]!="0")?true:false,true);}};SetGroupTableEnabledRequest.request(null);}function InitDatabaseDialog(bUser){g_nSelTableID=0;if(bUser){g_bUserTables=true;UserObjCombo.setStyle("display","block");document.getElementById("UserTableobjDiv").style.display="block";GroupObjCombo.setStyle("display","none");document.getElementById("GroupTableobjDiv").style.display="none";document.getElementById("UserTableCheckDiv").style.display="block";document.getElementById("GroupTableCheckDiv").style.display="none";UserEnableTableCheckBox.setStyle("display","none");GroupEnableTableCheckBox.setStyle("display","none");UserEnableTableCheckBox.setChecked((g_anUserTableEnabled[0]!="0")?true:false,true);UserObjCombo.setSelectedItems([0]);UserObjCombo.setControlText(g_asUserTables[0]);LoadingDialog(false);OnChangeTableObj(g_anUserTableIDs[0],true);}else{g_bUserTables=false;UserObjCombo.setStyle("display","none");document.getElementById("UserTableobjDiv").style.display="none";GroupObjCombo.setStyle("display","block");document.getElementById("GroupTableobjDiv").style.display="block";document.getElementById("UserTableCheckDiv").style.display="none";document.getElementById("GroupTableCheckDiv").style.display="block";UserEnableTableCheckBox.setStyle("display","none");GroupEnableTableCheckBox.setStyle("display","none");GroupEnableTableCheckBox.setChecked((g_anGroupTableEnabled[0]!="0")?true:false,true);GroupObjCombo.setSelectedItems([0]);GroupObjCombo.setControlText(g_asGroupTables[0]);LoadingDialog(false);OnChangeTableObj(g_anGroupTableIDs[0],true);}}function OnChangeTableObj(sValue,bSkipLoading,bForce){var nSelTableID=parseInt(sValue);if((bForce)||(nSelTableID!=g_nSelTableID)){if(!bSkipLoading)LoadingDialog(true);TableMapList.setSelectedRows([-1]);TableMapList.Reset(true);if(!bSkipLoading)TableMapList.m_bSaving=true;TableMapList.ForceUpdate("%OBJECT_EDIT_ID%",nSelTableID);g_nSelTableID=nSelTableID;if(g_bUserTables==true){if(g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]=="2")UserEnableTableCheckBox.setStyle("display","none");else UserEnableTableCheckBox.setStyle("display","block");}else{if(g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]=="2")GroupEnableTableCheckBox.setStyle("display","none");else GroupEnableTableCheckBox.setStyle("display","block");}if(!AW.opera)UserObjCombo.setControlImage(UserObjCombo.getItemImage(UserObjCombo.getSelectedItems()));if(!AW.opera)GroupObjCombo.setControlImage(GroupObjCombo.getItemImage(GroupObjCombo.getSelectedItems()));UserEnableTableCheckBox.setChecked((g_anUserTableEnabled[parseInt(UserObjCombo.getSelectedItems())]!="0")?true:false,true);GroupEnableTableCheckBox.setChecked((g_anGroupTableEnabled[parseInt(GroupObjCombo.getSelectedItems())]!="0")?true:false,true);setTimeout(function(){TableMapList.refresh();},500);}}function OnEditMapping(){if(TableMapList.getSelectedColumns().length)TableMapList.raiseEvent("editCurrentCell");else AlertDialog("$SELECT_DB_COLUMN_EDIT$");}function OnDefaultMapping(){if((TableMapList.getSelectedRows()!="")&&(TableMapList.getSelectedRows()!=-1)){g_nEditRow=TableMapList.getSelectedRows()[0];g_sColumnEditVal=TableMapList.getCellData(g_nEditCol,g_nEditRow);OnColumnValChanged.call(TableMapList,TableMapList.getCellValue(2,g_nEditRow),g_nEditCol,g_nEditRow);}else AlertDialog("$SELECT_DB_COLUMN_EDIT$");}function OnCloseMappingDialog(){HideDialog("DatabaseDialog");}function OnColumnValChanged(sText,nCol,nRow){var nCol=g_nEditCol;var nRow=g_nEditRow;if(sText==""){var asNoEmptyCols=["TableName","LoginID","GroupName","SortIndex"];var sEditCol=TableMapList.getCellText(0,nRow);for(var nIndex in asNoEmptyCols){if(asNoEmptyCols[nIndex]==sEditCol){TableMapList.UpdateText(g_sColumnEditVal,nCol,nRow);AlertDialog("$DB_NO_EMPTY_COLUMN$");return;}}}if(sText!=g_sColumnEditVal){var UpdateColRequest;if(nRow==0){UpdateColRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.ODBCTableMap."+g_nSelTableID);UpdateColRequest.setParameter("TableName",sText);}else{UpdateColRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CODBCTableMap."+g_nSelTableID+".ODBCColumnMap."+TableMapList.GetSelectedObjectID());UpdateColRequest.setParameter("ColumnName",sText);}SavingDialog(true);UpdateColRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult)TableMapList.UpdateText(g_sColumnEditVal,nCol,nRow);else TableMapList.UpdateText(sText,nCol,nRow);BoldNonDefaultVals(TableMapList,1,2);OnCloseMappingRenameDialog();};UpdateColRequest.request(null);}else OnCloseMappingRenameDialog();return(false);}function BoldNonDefaultVals(Grid,nValCol,nDefCol){for(var nIndex=0;nIndex<Grid.getRowCount();nIndex++){var element=document.getElementById(Grid.getCellTemplate(nValCol,nIndex).getContent("box/text").getId());if(element)element.style.fontWeight=(Grid.getCellValue(nValCol,nIndex).toLowerCase()!=Grid.getCellValue(nDefCol,nIndex).toLowerCase())?"bold":"normal";}}</script><div id="DatabaseRenameDialoginner" style="display:none;"><form name="rename" onsubmit="return (false);"><table class="DialogTable"><tr><td>$DATABASE_RENAME_DIALOG_DESC$:<br><div style="overflow:auto"><span id="MappingInput"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="RenameMappingButton"></span><br /><span id="CancelRenameMappingButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$DATABASE_RENAME_DIALOG_TITLE$","DatabaseRenameDialog","400","120","","$CLOSE_CANCEL$");function OnShowMappingRenameDialog(sText){MappingRenameInput.setControlText(sText);ShowDialog("DatabaseRenameDialog");MappingRenameInput.getContent("box/text").element().focus();}function OnCloseMappingRenameDialog(){HideDialog("DatabaseRenameDialog");}function OnRenameMappingSubmit(){OnColumnValChanged(MappingRenameInput.getControlText(),g_nEditCol,g_nEditRow);}CreateDialogPushButton("$OK_BUTTON$","RenameMappingButton",OnRenameMappingSubmit);CreateDialogPushButton("$CANCEL_BUTTON$","CancelRenameMappingButton",OnCloseMappingRenameDialog);var MappingRenameInput=CreateInputField("","MappingInput","new_mapping",undefined,200,undefined,undefined,OnRenameMappingSubmit);</script><div id="SQLTemplateDialoginner" style="display:none;"><div id="SQLTemplateContent" style="width:$SQL_TEMPLATE_DIALOG_WIDTH$px"><div class="layercontent"><div style="display:inline;"><img alt="$SQL_TEMPLATE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32" class="header-icon" />$SQL_TEMPLATE_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><span id="SQLTemplateList"></span><table style="padding-top:5px;width:100%"><tr><td><span id="EditTemplateButton"></span><span id="UseDefaultTemplateButton"></span></td><td style="text-align:right;"><span id="CloseTemplateButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$SQL_TEMPLATE_DIALOG_TITLE$","SQLTemplateDialog",($SQL_TEMPLATE_DIALOG_WIDTH$+15),"275","","$CLOSE_CANCEL$","Database16.png");var g_sSQLTemplateEditVal="";var aasGridData=[["$SQLT_SELECT_ALL$",DecodeString("%CServer.%SERVER_ID%.SQLSelectAllRows%"),DecodeString("%CServer.%SERVER_ID%.SQLSelectAllRows.Default%"),"SQLSelectAllRows"],["$SQLT_SELECT_ROW$",DecodeString("%CServer.%SERVER_ID%.SQLSelectSpecificRow%"),DecodeString("%CServer.%SERVER_ID%.SQLSelectSpecificRow.Default%"),"SQLSelectSpecificRow"],["$SQLT_SELECT_ROW_SORT$",DecodeString("%CServer.%SERVER_ID%.SQLSelectSpecificRowSort%"),DecodeString("%CServer.%SERVER_ID%.SQLSelectSpecificRowSort.Default%"),"SQLSelectSpecificRowSort"],["$SQLT_DELETE_ROW$",DecodeString("%CServer.%SERVER_ID%.SQLDeleteRow%"),DecodeString("%CServer.%SERVER_ID%.SQLDeleteRow.Default%"),"SQLDeleteRow"],["$SQLT_INSERT_ROW$",DecodeString("%CServer.%SERVER_ID%.SQLInsertRow%"),DecodeString("%CServer.%SERVER_ID%.SQLInsertRow.Default%"),"SQLInsertRow"],["$SQLT_UPDATE_ROW$",DecodeString("%CServer.%SERVER_ID%.SQLUpdateRow%"),DecodeString("%CServer.%SERVER_ID%.SQLUpdateRow.Default%"),"SQLUpdateRow"]];var SQLTemplateList=CreateAdminGrid("SQLTemplateList",["$SQLT_TEMPLATE$","$VALUE$"],[$SQL_TEMPLATE_LIST_COL_SIZES$],"","","",4);var sOnEditTemplate=String("OnEditTemplate(");var sOnDefaultTemplate=String("OnDefaultTemplate(");CreateContextMenu([sOnEditTemplate,sOnDefaultTemplate],["$EDIT_BUTTON$...","$DEFAULT_BUTTON$..."],["FileRename","Edit"],SQLTemplateList,"SQLTemplateListContext",true);SQLTemplateList.setCellFormat([new AW.Formats.String,new AW.Formats.XMLString,]);SQLTemplateList.setCellText(aasGridData);SQLTemplateList.setCellValue(aasGridData);SQLTemplateList.setRowCount(aasGridData.length);SQLTemplateList.refresh();SQLTemplateList.setStyle("height","200px");SQLTemplateList.setSelectionMode("single-cell");SQLTemplateList.setSelectionMultiple(false);SQLTemplateList.setCellEditable(true,1);SQLTemplateList.DisableSorting();SQLTemplateList.onCellMouseDown=function(event,nCol,nRow){return(nCol==0);};SQLTemplateList.onCellEditStarted=function(sText){g_sSQLTemplateEditVal=sText;g_nEditCol=SQLTemplateList.getSelectedColumns()[0];g_nEditRow=SQLTemplateList.getSelectedRows()[0];};SQLTemplateList.onCellEditEnded=OnSQLTemplateValChanged;BoldNonDefaultVals(SQLTemplateList,1,2);CreatePushButton("$EDIT_BUTTON$...","EditTemplateButton",OnEditTemplate);CreatePushButton("$DEFAULT_BUTTON$","UseDefaultTemplateButton",OnDefaultTemplate);CreateDialogPushButton("$CLOSE_BUTTON$","CloseTemplateButton",OnCloseTemplateDialog);function OnEditTemplate(){if(parseInt(SQLTemplateList.getSelectedColumns())==0||parseInt(SQLTemplateList.getSelectedColumns())==1){SQLTemplateList.setCurrentColumn(1);SQLTemplateList.setCurrentRow(SQLTemplateList.getSelectedRows());SQLTemplateList.raiseEvent("editCurrentCell");}else AlertDialog("$SELECT_SQL_TEMPLATE_EDIT$");}function OnDefaultTemplate(){if(SQLTemplateList.getSelectedColumns().length&&(parseInt(SQLTemplateList.getSelectedColumns())==0||parseInt(SQLTemplateList.getSelectedColumns())==1)){g_nEditCol=1;g_nEditRow=SQLTemplateList.getSelectedRows()[0];g_sSQLTemplateEditVal=SQLTemplateList.getCellText(g_nEditCol,g_nEditRow);OnSQLTemplateValChanged.call(SQLTemplateList,"",g_nEditCol,g_nEditRow);}else AlertDialog("$SELECT_SQL_TEMPLATE_EDIT$");}function OnCloseTemplateDialog(){HideDialog("SQLTemplateDialog");}function OnSQLTemplateValChanged(sText,nCol,nRow){var bUpdateCell=false;nCol=g_nEditCol;nRow=g_nEditRow;if(sText==""){sText=this.getCellText(2,nRow);bUpdateCell=true;}if(sText!=g_sSQLTemplateEditVal){var UpdateRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Server.%SERVER_ID%&StaticOnly=1");if(UpdateRequest!=undefined){UpdateRequest.setParameter(this.getCellText(3,nRow),sText);SavingDialog(true);UpdateRequest.response=function(){var nResult=OnSaveComplete(this);if(nResult){SQLTemplateList.setCellText(g_sSQLTemplateEditVal,nCol,nRow);SQLTemplateList.setCellValue(g_sSQLTemplateEditVal,nCol,nRow);}else if(bUpdateCell){SQLTemplateList.setCellText(sText,nCol,nRow);SQLTemplateList.setCellValue(sText,nCol,nRow);}BoldNonDefaultVals(SQLTemplateList,1,2);};UpdateRequest.request(null);}}else if(bUpdateCell)this.setCellText(g_sSQLTemplateEditVal,nCol,nRow);}</script><div id="RegistrationDialoginner" style="display:none;"><table border="0" class="DialogTable"><tr><td style="width:200px;vertical-align:top;">$REGISTRATION_DIALOG_TITLE$:<br/><textarea id="Reggie" class="aw-border" cols="45" rows="5" wrap="on" style="width:300px;"></textarea><div id="PasteReggieId"><span id="PasteReggieButton"></span</div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" ><span id="SaveReggieButton"></span><br /><span id="CancelReggieButton"></span><br /><br /><span id="ReggieHelpButton"></span></td></tr></table></div><!--<div id="OfflineDialoginner" style="display:none;"><table border="0" class="DialogTable"><tr><td style="width:auto;vertical-align:top;padding:0 10px;"><span class="PurpleLabelBold" style="font-size:12pt;" >$OFFLINE_ACTIVATION_TITLE$</span> ($NO_INTERNET_CONN$)<div style="margin-top:10px;">$OFFLINE_ACTIVATION_TXT$</div><ol><li>$OFFLINE_ACTIVATION_STEP1$ <span id="UniqueMachineIdButton"></span><div id="UniqueMachineIdDiv" style="display:none; margin: 0 20px 5px;">$UNIQUE_MACHINE_ID$:<br /><input type="text" readonly="readonly" id="UniqueMachineIdInput"/></div></li><li>$OFFLINE_ACTIVATION_STEP2$</li><li>$OFFLINE_ACTIVATION_STEP3$</li><li>$OFFLINE_ACTIVATION_STEP4$</li><ol type="a"><li>$OFFLINE_ACTIVATION_STEP4_A$</li><li>$OFFLINE_ACTIVATION_STEP4_B$</li><li>$OFFLINE_ACTIVATION_STEP4_C$</li></ol><li>$OFFLINE_ACTIVATION_STEP5$</li></ol>$LIC_KEY_FILE_PATH$:<div style="overflow:auto"><span id="LicKeyFilePath"></span><span id="BrowseButtonLicKeyFilePath"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" ><span id="SaveOfflineActivationButton"></span><br /><span id="CancelOfflineActivationButton"></span><br /><br /><span id="OfflineActivationHelpButton"></span></td></tr></table></div>--><script type="text/javascript" language="javascript">if(AW.ie)nReggieDialogWidth="185";else nReggieDialogWidth="165";BuildDialog("$REGISTRATION_DIALOG_TITLE$","RegistrationDialog","400",nReggieDialogWidth,"","$CLOSE_CANCEL$");CreateDialogPushButton("$SAVE_BUTTON$","SaveReggieButton",OnSaveReggie);CreateDialogPushButton("$CANCEL_BUTTON$","CancelReggieButton",OnCancelReggie);CreateDialogPushButton("$HELP_BUTTON$","ReggieHelpButton",OnReggieHelp);if(AW.ie)CreatePushButton("$PASTE_REGGIE_BUTTON$","PasteReggieButton",OnPasteReggie);function OnSaveReggie(){var sReggie=document.getElementById("Reggie").value;if(sReggie!="")SaveReggie(sReggie);else ConfirmDialog("$REGISTRATION_CLEAR_CONFIRM$",SaveReggie,undefined,sReggie);}function SaveReggie(sReggie){var SaveReggieObj=undefined;CloseConfirmDialog();if(SaveReggieObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"LicenseInfo.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.RegistrationID"),OnSaveReggieDone)){SaveReggieObj.setParameter("Value",sReggie);SavingDialog(true);SaveReggieObj.request();}}function OnSaveReggieDone(){var xmlDoc=this.getResponseXML();var nResult=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){HideDialog("RegistrationDialog");OnReggieQueryDone(xmlDoc);document.getElementById("Reggie").value="";}else AlertDialog(GetResultText(nResult,"$REGISTRATION_FAIL$",sResultText));}function OnPasteReggie(){if(AW.ie){document.getElementById("Reggie").focus();PastedText=document.getElementById("Reggie").createTextRange();PastedText.execCommand("Paste");}}function OnCancelReggie(){HideDialog("RegistrationDialog");}function OnReggieHelp(){LaunchHelp("Help-License-Details.htm","Item7_3");}</script><div id="EventsDialoginner" style="display:none;"><div style="padding:0 10px 0 10px;"><form method="post" name="EventsForm" onsubmit="return (false);"><span id="EventDialogTabs" style="-moz-user-select:-moz-none;"></span><div id="EventInfoTabsContent" class="tabs-content"><div id="EventInformation" style="display:none;"><span id="EventInfoGroup"><div style="padding:0 0 5px 5px;">$EVENT_TYPE$:<br /><span id="EventID"></span><br />$EVENTS_NAME_LABEL$:<br /><span id="EventNameInput"></span><br /><div style="margin-top:5px;"><span id="EventDisabled"></span></div><br />$DESCRIPTION$:<br /><div style="overflow:auto;"><textarea id="event_Description" name="event_Description" class="aw-border" style="width:370px;height:75px;"></textarea></div></div></span><div style="margin-top:10px;"><span id="EventActionGroup" ><div style="padding:0 0 5px 5px;">$EVENTS_ACTION_LABEL$:<br /><span id="Action"></span><div id="email-event" style="display:none;">$EVENTS_EMAIL_TO_LABEL$:<div style="overflow:auto"><span id="EmailToAddressInput" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"></span><span id="AddGroupsEmailToButton" alt="$GROUP_EMAIL_TO_NOTE$" title="$GROUP_EMAIL_TO_NOTE$"></span></div>$EVENTS_EMAIL_BCC_LABEL$ ($OPTIONAL$):<div style="overflow:auto"><span id="EmailToAddressBCCInput" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"></span><span id="AddGroupsEmailBCCButton" alt="$GROUP_EMAIL_BCC_NOTE$" title="$GROUP_EMAIL_BCC_NOTE$"></span></div></div><div id="exec-event" style="display:none;">$EVENTS_EXEC_PATH_LABEL$:<div style="overflow:auto"><span id="ExeFilePathInput"></span><span id="BrowseButtonExecPath"></span></div></div><div id="data1-event" style="display:none;"><span id="data1-text"></span>:<div style="overflow:auto"><span id="Data1Input"></span></div></div><div id="data2-event" style="display:none;"><span id="data2-text"></span>:<div style="overflow:auto;"><textarea id="event_Data2" name="event_Data2" class="aw-border" style="width:370px;height:75px;"></textarea></div></div><div id="exec-event-wait" style="display:none;">$EVENTS_EXEC_WAIT_LABEL$:<div style="overflow:auto"><span id="ExecWaitSecs"></span>($EVENTS_EXEC_WAIT_SEC$)</div></div></div></span></div></div><div id="EventFilters" style="display:none;height:410px;"><div id="EventRulesContent"><div class="layercontent"><div style="display:inline;"><img alt="$FILTER_RULE_EVENTS$" src="%ADMIN_FILE%Images/Filter32.png" width="32" height="32" class="header-icon" />$FILTER_EVENT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="width:440px;"><span id="EventFilterList"></span></div><div style="padding-top:5px;"><span id="AddEventFilterButton"></span><span id="EditEventFilterButton"></span><span id="DeleteEventFilterButton"></span></div></div></div></div></div><input type="hidden" id="ObjectID" name="ObjectID"/></form><div style="text-align:right;padding:10px 20px 0 0;"><span id="SaveEventButton"></span><span id="CancelEventButton"></span> &nbsp;&nbsp;&nbsp;<span id="HelpEventButton"></span></div></div></div><script type="text/javascript" language="javascript">var g_EventObjID;var g_sEventFilterRuleName="$NAME$";var g_sEventFilterDescr="$DESCRIPTION$";var g_sEventFilterLogic="$EVENT_RULE_LOGIC$";var g_EventRuleObjID;var nEventDialogWidth="510";BuildDialog("$EVENTS$","EventsDialog",nEventDialogWidth,"575","","$CLOSE_CANCEL$","cmd-16.png");var EventDialogTabs=CreateTabs(["$EVENTS$","$EVENTS_FILTERS$"],["EventInformation","EventFilters"],"EventDialogTabs","EventInfoTabsContent",1,OnChangeEventsTab,true);var EventFilterList=CreateEventFiltersGrid("EventFilterList","EventFilters.xml?ID=%OBJECT_EDIT_ID%",OnDelayLoadEditFilterDialog);var sOnDelayLoadAddFilterDialog=String("OnDelayLoadAddFilterDialog(");var sOnDelayLoadEditFilterDialog=String("OnDelayLoadEditFilterDialog(");var sOnRemoveEventFilter=String("OnRemoveEventFilter(");var sOnEnableFilter=String("OnEnableDisableFilter(1,");var sOnDisableFilter=String("OnEnableDisableFilter(0,");CreateContextMenu([sOnDelayLoadAddFilterDialog,sOnDelayLoadEditFilterDialog,sOnRemoveEventFilter,sOnEnableFilter,sOnDisableFilter],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(EventFilterList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(EventFilterList,"$DELETE_BUTTON$"))},OnEnableFilterContextMenu,OnDisableFilterContextMenu],["New","Edit","FileDelete",OnEnableFilterContextImage,OnDisableFilterContextImage],EventFilterList,"EventFilterListContext",true);EventFilterList.setStyle("height","330px");function OnChangeEventsTab(nOldTab,nNewTab){switch(nNewTab){case(0):break;case(1):EventFilterList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventObjID);break;}switch(nOldTab){case(0):break;case(1):EventFilterList.EnableUpdates(false);break;}}function OnEventLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("EventsDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}var nTotalEvents=parseInt(EventsList.getRowCount()+1);var sEventText="";if(g_bIsODBC){EventDialogTabs.setSelectedItems([0]);document.getElementById("AddGroupsEmailBCCButton").style.display="none";document.getElementById("AddGroupsEmailToButton").style.display="none";document.getElementById("EventDialogTabs-item-1").style.display="none";}else{document.getElementById("AddGroupsEmailBCCButton").style.display="";document.getElementById("AddGroupsEmailToButton").style.display="";document.getElementById("EventDialogTabs-item-1").style.display="";}EventsList.EnableUpdates(false);if(document.getElementById(EventNameInput.getContent("box/text").getId()).value==""){if(nTotalEvents<10){sEventText="$EVENT$ 0"+nTotalEvents;}else{sEventText="$EVENT$ "+nTotalEvents;}}else sEventText=document.getElementById(EventNameInput.getContent("box/text").getId()).value;EventNameInput.setControlText(sEventText);g_EventObjID=document.getElementById("ObjectID").value;if(EventDialogTabs.getSelectedItems()[0]==1)EventFilterList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventObjID);}function OnEventTypeLoad(sValue){EventIDComboBox.initValue(sValue);}function OnEventActionLoad(sValue){EventActionComboBox.initValue(sValue);OnEventActionChange(sValue);}function OnSetEventInputFocus(){EventNameInput.getContent("box/text").element().focus();}function OnYesSaveExec(){setTimeout(function(){SaveEvent();});}function OnNoSaveExec(){EventExecWaitMsec.setControlText("0");setTimeout(function(){SaveEvent();});}function IsUnderMaxCharsForColumn(sControlName,sTestStr,nMaxChars){var bIsUnderLimit=true;var sRCharLimitExceed="$WARN_MAX_CHAR_LIMIT$";if(sTestStr.length>nMaxChars){bIsUnderLimit=false;sRCharLimitExceed=sRCharLimitExceed.replace("$Limit",nMaxChars.toString());sRCharLimitExceed=sRCharLimitExceed.replace("$Field",sControlName);AlertDialog(sRCharLimitExceed,true);}return(bIsUnderLimit);}function PassesValidation(){var DB_COLUMN_LEN=255;var bPassed=true;var nCharBodyLimit=16384;if(g_bIsODBC){nCharBodyLimit=DB_COLUMN_LEN;}var nCharLimit=DB_COLUMN_LEN;var sText=EventNameInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventNameInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_NAME_LABEL$",sText,nCharLimit);if(bPassed){sText=document.getElementById("event_Description").value;bPassed=IsUnderMaxCharsForColumn("$DESCRIPTION$",sText,nCharBodyLimit);}if(bPassed){sText=Data1Input.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(Data1Input.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_SUBJECT_LABEL$",sText,nCharLimit);}if(bPassed){sText=document.getElementById("event_Data2").value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_BODY_LABEL$",sText,nCharBodyLimit);}if(bPassed){sText=EventEmailToInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventEmailToInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_TO_LABEL$",sText,nCharLimit);}if(bPassed){sText=EventEmailBCCInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventEmailBCCInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_BCC_LABEL$",sText,nCharLimit);}if(bPassed){sText=EventExecPathInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventExecPathInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EXEC_PATH_LABEL$",sText,nCharLimit);}return(bPassed);}function OnSaveEvent(){var nSelectedAction=EventActionComboBox.getItemValue(EventActionComboBox.getSelectedItems());if(EventNameInput.getControlText()!=""){if((nSelectedAction==2)&&parseInt(EventExecWaitMsec.getControlText())>0){ConfirmDialog("$CONFIRM_WAIT_DELAY_EXEC$",OnYesSaveExec,OnNoSaveExec);}else if((nSelectedAction==4)&&!g_bMSMQLicense){AlertDialog("$WARN_MSMQ_EVENT_NO_LICENSE$");}else if(PassesValidation()){if(g_bSysAdmin)SaveEvent();else if((nSelectedAction==1)||(nSelectedAction==2)||(nSelectedAction==4)||(nSelectedAction==3))AlertDialog("$WARN_DOMAIN_ADMIN_EVENTS$",true);else SaveEvent();}}else AlertDialog("$PLEASE_ENTER_EVENT_NAME$",true,OnSetEventInputFocus);return(false);}function SaveEvent(){g_bEventSavingObj=true;EventsList.OnSaveObject();}function OnHideEventsDialog(){document.getElementById("event_Description").scrollTop="0";document.getElementById("event_Data2").scrollTop="0";EventFilterList.EnableUpdates(false);ClearGrid(EventFilterList,true);EventsList.EnableUpdates(true);if(!g_bEventSavingObj){var objRequest=undefined;objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%CServer."+g_EditObjectID+".SUEvent");if(objRequest){objRequest.setParameter("IDs",g_EditObjectID);objRequest.request(null);}}}function OnCancelEvent(){HideDialog('EventsDialog');}function OnEventHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-Events.htm",sExpandNode);}function OnEventActionChange(sValue){var sEventActionGroupHeight="135px",sEvent_Data2Height="75px";switch(parseInt(sValue)){case 0:document.getElementById("data1-text").innerHTML="$EVENTS_EMAIL_SUBJECT_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_EMAIL_BODY_LABEL$";document.getElementById("email-event").style.display="block";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="265px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 1:document.getElementById("data1-text").innerHTML="$EVENTS_BALLOON_TITLE_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_BALLOON_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 2:document.getElementById("data1-text").innerHTML="$EVENTS_COMMAND_LINE_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="none";document.getElementById("exec-event").style.display="block";document.getElementById("exec-event-wait").style.display="block";sEventActionGroupHeight="170px";document.getElementById("EventActionGroupFS").style.height=sEventActionGroupHeight;document.getElementById("EventActionGroupFS").style.width="400px";break;case 4:document.getElementById("data1-text").innerHTML="$EVENTS_MSMQ_WRITE_TITLE_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_MSMQ_WRITE_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 3:document.getElementById("data2-text").innerHTML="$SUEVENT_ACTION_WRITE_EVENT_LOG_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="none";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";sEvent_Data2Height="109px";break;default:document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="none";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="155px";break;}document.getElementById("event_Data2").style.height=sEvent_Data2Height;}CreateGroupBox("$EVENT_INFO_GROUP$","EventInfoGroup","400px","215px",true);CreateGroupBox("$EVENT_ACTION_GROUP$","EventActionGroup","400px","135px",true);var g_aServerEventIDs=[1,2,3];var g_aDomainServerEventIDs=[100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121];var g_aEventIDs=[200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,300,301,302,303,304,305,306,400,401,402,403,406,407,404,405,500,501,502,503,600,601];var g_aServerEventText=["$SUEVENT_ID_SERVER_START_TEXT$","$SUEVENT_ID_SERVER_STOP_TEXT$","$SUEVENT_ID_SECURITY_ALERT_TEXT$"];var g_aDomainServerEventText=["$SUEVENT_ID_DOMAIN_START_TEXT$","$SUEVENT_ID_DOMAIN_STOP_TEXT$","$SUEVENT_ID_SESSION_CONNECT_TEXT$","$SUEVENT_ID_SESSION_DISCONNECT_TEXT$","$SUEVENT_ID_SESSION_CONNECT_FAILURE_TEXT$","$SUEVENT_ID_LOG_DELETED_TEXT$","$SUEVENT_ID_LOG_ROTATED_TEXT$","$SUEVENT_ID_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_LISTENER_STOP_TEXT$","$SUEVENT_ID_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_STOP_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_FAILURE_TEXT$",
"$SUEVENT_ID_PERM_DATA_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_STOP_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_STOP_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_SUCCESS_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_ERROR_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_MOVE_FILE_TEXT$"];var g_aEventIDText=["$SUEVENT_ID_USER_LOGIN_TEXT$","$SUEVENT_ID_USER_LOGOUT_TEXT$","$SUEVENT_ID_USER_LOGIN_FAILURE_TEXT$","$SUEVENT_ID_USER_PASSWORD_CHANGE_TEXT$","$SUEVENT_ID_USER_PASSWORD_CHANGE_FAILURE_TEXT$","$SUEVENT_ID_USER_ENABLED_TEXT$","$SUEVENT_ID_USER_DISABLED_TEXT$","$SUEVENT_ID_USER_DELETED_TEXT$","$SUEVENT_ID_USER_ADDED_TEXT$","$SUEVENT_ID_USER_PASSWORD_RECOVERY_SENT_TEXT$","$SUEVENT_ID_USER_PASSWORD_RECOVERY_FAILED_TEXT$","$SUEVENT_ID_USER_PASSWORD_STALE_TEXT$","$SUEVENT_ID_USER_AUTOMATICALLY_DISABLED_TEXT$","$SUEVENT_ID_USER_AUTOMATICALLY_DELETED_TEXT$","$SUEVENT_ID_USER_PREDISABLE_TEXT$","$SUEVENT_ID_USER_PREDELETE_TEXT$","$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_TEXT$","$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_FAILURE_TEXT$","$SUEVENT_ID_IP_BLOCKED_TEXT$","$SUEVENT_ID_IP_BLOCKED_TIME_TEXT$","$SUEVENT_ID_TOO_MANY_SESSIONS_TEXT$","$SUEVENT_ID_TOO_MANY_SESSIONS_ON_IP_TEXT$","$SUEVENT_ID_IP_ADDR_AUTO_BLOCKED_TIME_TEXT$","$SUEVENT_ID_SESSION_IDLE_TIMEOUT_TEXT$","$SUEVENT_ID_SESSION_TIMEOUT_TEXT$","$SUEVENT_ID_FILE_UPLOAD_TEXT$","$SUEVENT_ID_FILE_UPLOAD_FAIL_TEXT$","$SUEVENT_ID_FILE_DOWNLOAD_TEXT$","$SUEVENT_ID_FILE_DOWNLOAD_FAIL_TEXT$","$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_TEXT$","$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_FAIL_TEXT$","$SUEVENT_ID_FILE_DELETE_TEXT$","$SUEVENT_ID_FILE_MOVE_TEXT$","$SUEVENT_ID_DIR_CREATE_TEXT$","$SUEVENT_ID_DIR_DELETE_TEXT$","$SUEVENT_ID_DIR_CHANGE_TEXT$","$SUEVENT_ID_DIR_MOVE_TEXT$","$SUEVENT_ID_QUOTA_OVERAGE_TEXT$","$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$"];var aEventActions=[0,1,2];var aEventActionText=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$","$SUEVENT_ACTION_EXEC_TEXT$"];if(g_bSupportWinEventLog){aEventActionText.push("$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$");aEventActions.push(3);}if(g_bSupportsMSMQ){aEventActionText.push("$SUEVENT_ACTION_MSMQ_WRITE_TEXT$");aEventActions.push(4);}var sEventObjectType="Server";var aJoinedEventIDs;var aJoinedEventText;switch(sEventObjectType.toLowerCase()){case"server":aJoinedEventIDs=g_aServerEventIDs.concat(g_aDomainServerEventIDs,g_aEventIDs);aJoinedEventText=g_aServerEventText.concat(g_aDomainServerEventText,g_aEventIDText);break;case"domain":aJoinedEventIDs=g_aDomainServerEventIDs.concat(g_aEventIDs);aJoinedEventText=g_aDomainServerEventText.concat(g_aEventIDText);break;default:aJoinedEventIDs=g_aEventIDs;aJoinedEventText=g_aEventIDText;break;}var EventIDComboBox=CreateComboBox(aJoinedEventText[0],aJoinedEventIDs[0],aJoinedEventText,aJoinedEventIDs,"EventID","EventID",undefined,"OnEventTypeLoad()",false,370,20,OnSaveEvent);EventIDComboBox.onCurrentItemChangedEvent=EventIDComboBox.onCurrentItemChangedDef;EventIDComboBox.onCurrentItemChanged=function(nNewIndex){var nNewValue;nNewValue=this.getItemValue(nNewIndex);document.getElementById(this.getContent("hidden").getId()).value=nNewValue;this.onCurrentItemChangedEvent(nNewIndex);};EventIDComboBox.initValue=function(value,defaultvalue){if(value!=0){this.setControlText(GetEventIDText(value));this.setControlValue(value);}else this.onCurrentItemChanged(0);};function OnLoadEventDisabled(sValue){EventEnabledCheck.setChecked(sValue=="1");}var EventActionComboBox=CreateComboBox(aEventActionText[0],aEventActions[0],aEventActionText,aEventActions,"Action","Action",OnEventActionChange,"OnEventActionLoad()",false,370,20,OnSaveEvent);var EventNameInput=CreateInputField("","EventNameInput","EventName",undefined,370,undefined,undefined,OnSaveEvent);var EventEmailToInput=CreateInputField("","EmailToAddressInput","EmailToAddress",undefined,337,undefined,undefined,OnSaveEvent);document.getElementById("EmailToAddress").title="$EVENTS_EMAIL_TO_NOTE$";var EventEmailBCCInput=CreateInputField("","EmailToAddressBCCInput","EmailToAddressBCC",undefined,337,undefined,undefined,OnSaveEvent);document.getElementById("EmailToAddressBCC").title="$EVENTS_EMAIL_TO_NOTE$";var AddGroupsEmailToButton=CreatePushButton("","AddGroupsEmailToButton",OnCreateGroupEmailDialog,undefined,undefined,["To"],"GroupEmail");document.getElementById("AddGroupsEmailToButton").firstChild.title="$GROUP_EMAIL_TO_NOTE$";var AddGroupsEmailBCCButton=CreatePushButton("","AddGroupsEmailBCCButton",OnCreateGroupEmailDialog,undefined,undefined,["BCC"],"GroupEmail");document.getElementById("AddGroupsEmailBCCButton").firstChild.title="$GROUP_EMAIL_BCC_NOTE$";var Data1Input=CreateInputField("","Data1Input","Data1",undefined,370,undefined,undefined,OnSaveEvent);var EventExecPathInput=CreateInputField("","ExeFilePathInput","ExeFilePath",undefined,338,undefined,undefined,OnSaveEvent);var EventEnabledCheck=CreateCheckBox("$ENABLE_EVENT$","EventDisabled","Enabled",false,undefined,true,"OnLoadEventDisabled()",false);var EventExecWaitMsec=CreateInputField("","ExecWaitSecs","ExecWaitSecs",undefined,50,undefined,undefined,OnSaveEvent);CreateDialogPushButton("$SAVE_BUTTON$","SaveEventButton",OnSaveEvent);CreateDialogPushButton("$CANCEL_BUTTON$","CancelEventButton",OnCancelEvent);var ExecPathBrowse=CreatePushButton("","BrowseButtonExecPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[EventExecPathInput,true,"0","0"]]);ExecPathBrowse.setControlImage("Browse");CreateDialogPushButton("$HELP_BUTTON$","HelpEventButton",OnEventHelp);function OnCreateGroupEmailDialog(aEmailType){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/GroupEmailDialogs.htm?ID=%SERVER_ID%","GroupEmailDialogs",String("OnShowGroupEmailDialog("),aEmailType]);}CreatePushButton("$ADD_BUTTON$...","AddEventFilterButton",OnDelayLoadAddFilterDialog);CreatePushButton("$EDIT_BUTTON$...","EditEventFilterButton",OnDelayLoadEditFilterDialog);CreatePushButton("$DELETE_BUTTON$","DeleteEventFilterButton",OnRemoveEventFilter);function OnDelayLoadAddFilterDialog(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/EventRulesDialog.htm?ID=%SERVER_ID%","FilterDialogDiv",OnAddEventFilter]);}function OnDelayLoadEditFilterDialog(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/EventRulesDialog.htm?ID=%SERVER_ID%","FilterDialogDiv",OnEditEventFilter]);}function OnAddEventFilter(){EventFilterList.OnAddObject("EventFilter.xml%ADD_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule&Temp=1","Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule.",document.EventsFilterForm,"EventRulesDialog",[OnLoadFilterComp,OnHideFilterComp],g_bReadOnlyAccess,undefined,true);}function OnEditEventFilter(){EventFilterList.OnEditObject("EventFilter.xml","Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule.",document.EventsFilterForm,"EventRulesDialog","$SELECT_ONLY_ONE_EVENT_FILTER_EDIT$","$SELECT_ONLY_ONE_EVENT_FILTER_EDIT$",[OnLoadFilterComp,OnHideFilterComp],undefined,undefined,undefined,undefined,true);}function OnRemoveEventFilter(){EventFilterList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule&ID=%ID%","$ASK_DELETE_EVENT_FILTER$","$SELECT_ONE_EVENT_FILTER_DELETE$");}function OnLoadFilterComp(){var nLogicDefault;EventFilterList.EnableUpdates(false);g_EventRuleObjID=document.getElementById("RuleObjectID").value;EventFilterCompList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventRuleObjID);nLogicDefault=(isNaN(parseInt(EventFilterList.getCellValue(2,EventFilterList.getSelectedRows())))?0:(parseInt(EventFilterList.getCellValue(2,EventFilterList.getSelectedRows()))));EventRuleLogic.initValue(nLogicDefault);}function OnHideFilterComp(){EventFilterCompList.EnableUpdates(false);ClearGrid(EventFilterCompList,true);EventFilterList.EnableUpdates(true);}function OnEnableDisableFilter(bEnable){var EditCells=new Array();EditCells=EventFilterList.getSelectedRows().toString().split(",");var EventEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(EventFilterList.getCellData((EventFilterList.m_nNumColumns-1),EditCells[nIndex]));EventEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule."+nObjectID+"&StaticOnly=1");EventEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;EventEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;EventEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);EventEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};EventEnabledDisabledRequest[nIndex].request(null);}}function OnEnableFilterContextMenu(){if(FilterEnableOrDisable()[1]&&EventFilterList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_FILTER$";else sMenuItemName="";return(sMenuItemName);}function OnDisableFilterContextMenu(){if(FilterEnableOrDisable()[0]&&EventFilterList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_FILTER$";else sMenuItemName="";return(sMenuItemName);}function OnEnableFilterContextImage(){if(FilterEnableOrDisable()[1])sImageClass="FilterEnabled";else sImageClass="";return(sImageClass);}function OnDisableFilterContextImage(){if(FilterEnableOrDisable()[0])sImageClass="FilterDisabled";else sImageClass="";return(sImageClass);}function FilterEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=EventFilterList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(EventFilterList.getCellText(3,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}</script><div id="CommonEventsDialoginner" style="display:none;"><div style="display:inline;"><img alt="$COMMON_EVENTS$" src="%ADMIN_FILE%Images/Command32.png" width="32" height="32" class="header-icon" />$COMMON_EVENT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="CommonEventsForm" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="CommonEventGroup"><div id="CommonEventsRadioDiv" style="padding:0 0 5px 5px;"><span id="CommonEventActionRadio"></span></div><div style="padding:0 0 5px 5px;display:none;"id="CommonEventsEmailDiv">$SUEVENT_ACTION_EMAIL_TEXT$</div><div id="emailto-commonevent" style="display:none;padding:0 0 5px 5px;">$EVENTS_EMAIL_TO_LABEL$:<div style="overflow:auto" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"><span id="CommonEventEmailToInput"></span></div></div><div id="MSMQPath-commonevent" style="display:none;padding:0 0 5px 5px;">$EVENTS_MSMQ_WRITE_TITLE_LABEL$:<div style="overflow:auto" ><span id="CommonEventMSMQPathInput"></span></div></div></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveCommonEventButton"></span><br /><span id="CancelCommonEventButton"></span><br /><br /><span id="HelpCommonEventButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$COMMON_EVENTS$","CommonEventsDialog","390","290","","$CLOSE_CANCEL$","cmd-16.png");function OnCreateCommonEvents(){ShowDialog("CommonEventsDialog");}function OnCancelCommonEvent(){HideDialog('CommonEventsDialog');}function OnCommonEventChange(nCommonEvent){if(parseInt(nCommonEvent)==0){document.getElementById("MSMQPath-commonevent").style.display="none";document.getElementById("emailto-commonevent").style.display="block";document.getElementById("CommonEventGroupFS").style.height="120px";}else if(parseInt(nCommonEvent)==3){if(!g_bMSMQLicense){AlertDialog("$WARN_MSMQ_EVENT_NO_LICENSE$");setTimeout(function(){CommonEventActionRadio.setSelectedItems([0]);},0);}else{document.getElementById("emailto-commonevent").style.display="none";document.getElementById("MSMQPath-commonevent").style.display="block";document.getElementById("CommonEventGroupFS").style.height="120px";}}else{document.getElementById("MSMQPath-commonevent").style.display="none";document.getElementById("emailto-commonevent").style.display="none";document.getElementById("CommonEventGroupFS").style.height="80px";}}function OnSaveCommonEvent(){var nActionValue=parseInt(document.getElementById(CommonEventActionRadio.getContent("hidden").getId()).value);var sActionEmailTo=CommonEventEmailToInput.getControlText();var sActionMSMQPath=CommonEventMSMQPathInput.getControlText();if(nActionValue==0)sCmd="CreateCommonEmailEvents&EmailAddress="+sActionEmailTo;else if(nActionValue==2)sCmd="CreateCommonWriteEventLogEvents";else if(nActionValue==3)sCmd="CreateCommonMSMQWriteEvents&MSMQPath="+sActionMSMQPath;else sCmd="CreateCommonBalloonTipEvents";var sCommonEventsCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CServer."+g_EditObjectID+"."+sCmd;var CommonEventsRequest=CreatePostRequest(sCommonEventsCmd);CommonEventsRequest.setAsync(true);CommonEventsRequest.request();CommonEventsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else HideDialog("CommonEventsDialog");};}CreateGroupBox("$COMMON_EVENT_ACTION_GROUP$","CommonEventGroup","280px","125px",true);var asCommonEventRadioText=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$"];var anCommonEventRadioVals=[0,1];if(g_bSupportWinEventLog){asCommonEventRadioText.push("$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$");anCommonEventRadioVals.push(2);}if(g_bSupportsMSMQ){asCommonEventRadioText.push("$SUEVENT_ACTION_MSMQ_WRITE_TEXT$");anCommonEventRadioVals.push(3);}var CommonEventActionRadio=CreateRadioButtons(0,asCommonEventRadioText,"CommonEventActionRadio","CommonEventActionRadio","265px",OnCommonEventChange,anCommonEventRadioVals);if(g_bSafariBrowser)document.getElementById("CommonEventActionRadio-box").style.height="45px";var CommonEventEmailToInput=CreateInputField("","CommonEventEmailToInput","CommonEventEmailTo",undefined,250,undefined,undefined,OnSaveCommonEvent);var CommonEventMSMQPathInput=CreateInputField("","CommonEventMSMQPathInput","CommonEventMSMQPath",undefined,250,undefined,undefined,OnSaveCommonEvent);CreateDialogPushButton("$OK_BUTTON$","SaveCommonEventButton",OnSaveCommonEvent);CreateDialogPushButton("$CANCEL_BUTTON$","CancelCommonEventButton",OnCancelCommonEvent);CreateDialogPushButton("$HELP_BUTTON$","HelpCommonEventButton",OnEventHelp);</script><form id="myform"><div id="SMTPTestingDialoginner" style="display:none;"><div id="SMTPTestingContent" class="tabs-content"><div id="SMTPTestingSendData"><div style="padding: 0 0 5px 5px;"><span id="SMTPToAddrsError" class="Hidden"><label id='ErrorAddrLabel' class="Error" style="font-size: 12px;"> $SMTP_PARAMETER_ERROR$</label> <br /></span>$EVENTS_EMAIL_SUBJECT_LABEL$: <br /><span id="SMTPTestSubjectInput"></span> <br /><div style="padding-top:5px;clear:both;">$EVENTS_EMAIL_BODY_LABEL$:</div><div style="overflow:auto;clear:both;"><textarea name="SMTPTestMessageInput" id="SMTPTestMessageInput" class="aw-border" style="width:395px;height:75px;"></textarea></div><div style="padding-top:5px;clear:both;"><label id="SMTPToAddressLabel">$SMTP_TO_ADDRESS_LABEL$:</label><br /></div><div style="overflow:auto"><span id="SMTPTestToAddressInput"></span><br /></div></div></div></div><div style="text-align:right;padding:10px 20px 0 0;"><span id="SendSMTPTestDataButton"></span><span id="CancelSMTPTestingButton"></span></div></div></form><script type="text/javascript" language="javascript">BuildDialog("$SMTP_TESTING_TITLE$","SMTPTestingDialog","430","675","","$CLOSE_CANCEL$","Email16.png");function OnSMTPTesting(){ShowDialog("SMTPTestingDialog");}function OnCancelSMTPTesting(){HideDialog("SMTPTestingDialog");}function ShowAlertSMTPParametersDialog(sLabel){var sRequiredField="$SMTP_REQUIRED_FIELD$";sRequiredField=sRequiredField.replace("$Label",sLabel);AlertDialog(sRequiredField,true);return false;}function IsSMTPToAddressValid(sToAddress){var SMTPToAddr=document.getElementById('SMTPToAddressLabel');var errorLbl=document.getElementById('SMTPToAddrsError');var nRet=false;if(!IsValidEmailAddressString(sToAddress)){SMTPToAddr.setAttribute("class","Error");errorLbl.removeAttribute("class","Hidden");nRet=false;}else{SMTPToAddr.removeAttribute("class","Error");errorLbl.setAttribute("class","Hidden");nRet=true;}return nRet;}function OnNoResponse(){BusyDialog(false);AlertDialog("$SESS_SMTP_NO_RESPONSE$",true,undefined,undefined,"$CANCEL_BUTTON$",OnCancelSMTPTesting);}function OnRecieveResponse(XMLDoc,bSsl){var SESS_SMTP_TIMEOUT=55;var SESS_INVALID_PARAMETER=4;var SESS_SMTP_CONNECTION_ERROR=50;var SMTP_COMMUNICATION_FAILED=54;BusyDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sSMTPResultText=GetXMLValue(XMLDoc,"SMTPServerResponse");if(nResult==0){AlertDialog("$SMTP_CONFIGURATION_SUCCESS$",undefined,OnSaveSMTPConfig,undefined,"$NO_BUTTON$",OnCancelSMTPTesting);}else if(nResult==SMTP_COMMUNICATION_FAILED){var sResultDetails="$SESS_SMTP_UNSPECIFIED_ERROR$";OnSMTPShowLogs(sResultText,sResultDetails);}else if(nResult==SESS_SMTP_TIMEOUT&&bSsl==0){var sResultDetails="$SMTP_TIMEOUT_SSL_ERROR$";OnSMTPShowLogs(sResultText,sResultDetails);}else if((typeof sSMTPResultText!='undefined')&&(sSMTPResultText!="%SMTP_RESULT_TEXT%")){var sResultHint;if(nResult==SESS_SMTP_CONNECTION_ERROR&&bSsl==1&&(sSMTPResultText.indexOf("SSL Error:")>-1)){sResultHint="$SMTP_CONNECTION_SSL_ERROR$";}var sFinalResult;sFinalResult=sSMTPResultText+"\n\n";if(typeof sResultHint!='undefined'){sFinalResult+=sResultHint+"\n";}OnSMTPShowLogs(sResultText,sFinalResult);}else{AlertDialog(sResultText,true,undefined,undefined);}}function SendTestSMTPMail(sSMTPServerIP,sSMTPServerPort,sSMTPFromAddress,sSMTPFromName,sSMTPToAddress,bSMTPRequiredLogin,sSMTPAccountName,sSMTPPassword,bSMTPSsl,bSMTPUseSslCertificate,bSMTPUseExplicitSSL,sSMTPSubject,sSMTPMessage){var WAITING_RESPONSE_TIME_MS=100000;var sTestSMTPCmd="%ADMIN_FILE%XML/SMTPResult.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.CheckingSMTPConfiguration";var TestSMTPRequest=CreatePostRequest(sTestSMTPCmd);var SMTPNoResponseTimeOut;TestSMTPRequest.setParameter("SMTPServer",sSMTPServerIP);TestSMTPRequest.setParameter("SMTPServerPort",sSMTPServerPort);TestSMTPRequest.setParameter("SMTPFromAddress",sSMTPFromAddress);TestSMTPRequest.setParameter("SMTPFromName",sSMTPFromName);TestSMTPRequest.setParameter("SMTPSSL",bSMTPSsl);TestSMTPRequest.setParameter("SMTPUseSSLCertificate",bSMTPUseSslCertificate);TestSMTPRequest.setParameter("SMTPUseExplicitSSL",bSMTPUseExplicitSSL);TestSMTPRequest.setParameter("SMTPToAddress",sSMTPToAddress);TestSMTPRequest.setParameter("SMTPSubject",sSMTPSubject);TestSMTPRequest.setParameter("SMTPMessage",sSMTPMessage);TestSMTPRequest.setParameter("SMTPRequiresLogin",bSMTPRequiredLogin);if(bSMTPRequiredLogin==1){TestSMTPRequest.setParameter("SMTPAccountName",sSMTPAccountName);TestSMTPRequest.setParameter("SMTPPassword",sSMTPPassword);}TestSMTPRequest.request();BusyDialog(true,"$SENDING_EMAIL_BUSY_DIALOG$");SMTPNoResponseTimeOut=setTimeout(OnNoResponse,WAITING_RESPONSE_TIME_MS);TestSMTPRequest.response=function(XMLDoc){clearTimeout(SMTPNoResponseTimeOut);OnRecieveResponse(XMLDoc,bSMTPSsl);};}function OnGetSMTPTestingData(){var requiresLogin,server,port,accountName,password,fromAddress,fromName,ssl,useSslCert,useExplicitSSL,toAddress;var smtpTestSubject,smtpTestMessage,smtpTestToAddress;smtpTestSubject=SMTPTestSubjectInput.getControlText();smtpTestMessage=SMTPTestMessageInput.value;smtpTestToAddress=SMTPTestToAddressInput.getControlText();requiresLogin=((SMTPRequireLoginCheckbox.getControlValue())?"1":"0");server=Trim(SMTPServerCombo.getControlText());port=SMTPPortCombo.getControlText();accountName=SMTPAccountNameCombo.getControlText();password=SMTPPasswordCombo.getControlText();fromAddress=SMTPFromAddressCombo.getControlText();fromName=SMTPFromNameCombo.getControlText();ssl=((SMTPRequiresSSLCheckbox.getControlValue())?"1":"0");useSslCert=((SMTPUseSSLCertCheckbox.getControlValue())?"1":"0");useExplicitSSL=((SMTPUseExplicitSSLCheckbox.getControlValue())?"1":"0");if(IsSMTPToAddressValid(smtpTestToAddress)){SendTestSMTPMail(server,port,fromAddress,fromName,smtpTestToAddress,requiresLogin,accountName,password,ssl,useSslCert,useExplicitSSL,smtpTestSubject,smtpTestMessage);OnCancelSMTPTesting();}}function OnAdressChanged(){var SMTPToAddr=document.getElementById('SMTPToAddressLabel');IsSMTPToAddressValid(this.getControlText());}var SMTPTestSubjectInput=CreateInputField("$SMTP_TEST_EMAIL_SUBJECT$","SMTPTestSubjectInput","SMTPTestSubject",undefined,400);var SMTPTestToAddressInput=CreateInputField("","SMTPTestToAddressInput","SMTPTestToAddress",OnAdressChanged,400);var SMTPMsgBody=document.getElementById('SMTPTestMessageInput');SMTPMsgBody.value="$SMTP_TEST_EMAIL_BODY$";CreateDialogPushButton("$SEND_BUTTON$","SendSMTPTestDataButton",OnGetSMTPTestingData);CreateDialogPushButton("$CANCEL_BUTTON$","CancelSMTPTestingButton",OnCancelSMTPTesting);</script><div id="LogDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div id="logwindow" class="SpyLogScroll"><div id="log" style="width:100%;"></div></div><span id="CloseLog"></span></div></div><script type="text/javascript" language="javascript">var g_sAttrLogObjectType="Server";var g_nAttrLogObjectId=%SERVER_ID%;var g_sFilterLogText="";var g_GridToReload;BuildDialog("$LOG_DIALOG_TITLE$","LogDialog","775","300","","$CLOSE_CANCEL$");function OnShowLogDialog(){g_GridToReload=undefined;try{if(awActiveGrid!=undefined&&awActiveGrid.m_bUpdates)g_GridToReload=awActiveGrid;}catch(e){try{if(g_ActiveRezizeGrid!=undefined&&g_ActiveRezizeGrid.m_bUpdates)g_GridToReload=g_ActiveRezizeGrid;}catch(e){try{if(awSecondaryActiveGrid!=undefined&&awSecondaryActiveGrid.m_bUpdates)g_GridToReload=awSecondaryActiveGrid;}catch(e){g_GridToReload=undefined;}}}if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(false);InitDomainAttrLog();FreezeDomainAttrLog(false);ShowDialog("LogDialog",undefined,ResetLogDialog);}function ResetLogDialog(){if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(true);FreezeDomainAttrLog(true);document.getElementById("log").innerHTML="";}function OnOkViewLog(){HideDialog('LogDialog');}CreateDialogPushButton("$CLOSE_BUTTON$","CloseLog",OnOkViewLog);InitLog("log","",0);</script><div id="SMTPErrorDialoginner" style="display:none;"><div id="SMTPTErrorContent" class="tabs-content"><div id="SMTPErrors"><div style="padding: 0 0 5px 5px;"><label id="ErrorLabel"></label><div style="padding-top:5px;clear:both;">$SMTP_ERROR_DETAILS$:</div><div style="overflow:auto;clear:both;"><textarea name="SMTPLogsInput" id="SMTPLogsInput" class="aw-border" style="width:395px;height:95px;"></textarea></div></div></div></div><div style="text-align:right;padding:10px 20px 0 0;"><span id="SMTPViewLogsButton"></span><span id="CloseSMTPLogsButton"></span></div></div><script type="text/javascript" language="javascript">BuildDialog("$SMTP_ERROR_DIALOG_TITLE$","SMTPErrorDialog","430","675","","$CLOSE_CANCEL$","Email16.png");function OnSMTPShowLogs(sError,sErrorDetails){var SMTPErrorLabel=document.getElementById('ErrorLabel');SMTPErrorLabel.innerText=sError;var SMTPLogTextArea=document.getElementById('SMTPLogsInput');SMTPLogTextArea.value=sErrorDetails;SMTPLogTextArea.disabled=true;ShowDialog("SMTPErrorDialog");}function OnCancelSMTPLogs(){HideDialog("SMTPErrorDialog");OnCancelSMTPTesting();}CreateDialogPushButton("$VIEW_LOG$","SMTPViewLogsButton",OnShowLogDialog);CreateDialogPushButton("$CLOSE_BUTTON$","CloseSMTPLogsButton",OnCancelSMTPLogs);</script><div id="SMTPConfigDialoginner" style="display:none;"><div style="display:inline;"><img alt="$SMTP_CONFIG$" src="%ADMIN_FILE%Images/Email32.png" width="32" height="32" class="header-icon" />$SMTP_CONFIG_INFO_SERVER$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="SMTPConfigForm" id="SMTPConfigForm" onsubmit="return (false);"><div style="padding:0 0 5px 5px;"><span id="SMTPParametersError" class="Hidden"><label id='ErrorLabel' class="Error" style="font-size: 12px;"> $SMTP_PARAMETER_ERROR$</label><br /></span></div><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="SMPTServerGroup"><div style="padding:0 0 5px 5px;"><label id='smtpServerLbl'>$SMTP_SERVER_LABEL$:</label><div style="overflow:auto"><span id="SMTPServer"></span></div><label id='smtpPortLbl'>$SMTP_PORT_LABEL$:</label><div style="overflow:auto"><span id="SMTPServerPort"></span></div><div><span id="SMTPSSL"></span></div><div id="SMPTCertDiv" style="display:none;"><span id="SMTPUseSSLCertificate"></span></div><div id="SMTPExplicitDiv" style="display:none;"><span id="SMTPUseExplicitSSL"></span></div><label id='fromAddressLbl'>$SMTP_FROM_ADDRESS_LABEL$:</label><div style="overflow:auto"><span id="SMTPFromAddress"></span></div>$SMTP_FROM_NAME_LABEL$ ($OPTIONAL$):<div style="overflow:auto"><span id="SMTPFromName"></span></div><div><span id="SMTPRequiresLogin"></span></div></div></span><span id="SMPTAuthGroup" style="display:none;"><div style="padding:0 0 5px 5px;"><label id="accountNameLbl">$SMTP_ACCOUNT_NAME_LABEL$:</label><div style="overflow:auto"><span id="SMTPAccountName"></span></div>$SMTP_ACCOUNT_PASSWORD_LABEL$:<div style="overflow:auto"><span id="SMTPPassword"></span></div></div></span><div style="padding:5px 0 5px 10px;"><span id="TestSMTPConfigButton"></span><br /></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveSMTPConfigButton"></span><br /><span id="CancelSMTPConfigButton"></span><br /><br /><span id="HelpSMTPConfigButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var sPortValue,sDefaultPortValue;BuildDialog("$SMTP_CONFIG_TITLE$","SMTPConfigDialog","450","390","","$CLOSE_CANCEL$","Email16.png");function OnSMTPConfig(){CleanupErrors();ShowHideSMTPAuth();ShowDialog("SMTPConfigDialog");}function ShowHideSMTPAuth(){var bValue=SMTPRequireLoginCheckbox.getControlValue();if(bValue)document.getElementById("SMPTAuthGroup").style.display="block";else document.getElementById("SMPTAuthGroup").style.display="none";}function ShowHideSMTPSSLCert(){var bValue=SMTPRequiresSSLCheckbox.getControlValue();var bExplicitSSL=SMTPUseExplicitSSLCheckbox.getControlValue();if(bValue){document.getElementById("SMPTCertDiv").style.display="block";document.getElementById("SMTPExplicitDiv").style.display="block";if(!bExplicitSSL){SMTPPortCombo.initValue("465",sDefaultPortValue);SMTPPortCombo.setControlText("465");}else{if(sPortValue.length)SMTPPortCombo.setControlText(sPortValue);else SMTPPortCombo.setControlText(sDefaultPortValue);}}else{document.getElementById("SMPTCertDiv").style.display="none";document.getElementById("SMTPExplicitDiv").style.display="none";SMTPPortCombo.initValue(sPortValue,sDefaultPortValue);if(sPortValue.length)SMTPPortCombo.setControlText(sPortValue);else SMTPPortCombo.setControlText(sDefaultPortValue);}}function OnToggleExplicitSSL(){var bValue=SMTPUseExplicitSSLCheckbox.getControlValue();if(bValue){if(sPortValue.length)SMTPPortCombo.setControlText(sPortValue);else SMTPPortCombo.setControlText(sDefaultPortValue);}else{SMTPPortCombo.initValue("465",sDefaultPortValue);SMTPPortCombo.setControlText("465");}}function OnCancelSMTPConfig(){HideDialog('SMTPConfigDialog');}function OnSaveSMTPConfigEx(){var requiresLogin,server,port,accountName,password,fromAddress,fromName,ssl,useSslCert,useExplicitSSL;if(bSMTPTriState){requiresLogin=document.getElementById(SMTPRequireLoginCheckbox.getContent("hidden").getId()).value;server=Trim(document.getElementById(SMTPServerCombo.getContent("hidden").getId()).value);port=document.getElementById(SMTPPortCombo.getContent("hidden").getId()).value;accountName=document.getElementById(SMTPAccountNameCombo.getContent("hidden").getId()).value;password=document.getElementById(SMTPPasswordCombo.getContent("hidden").getId()).value;fromAddress=document.getElementById(SMTPFromAddressCombo.getContent("hidden").getId()).value;fromName=document.getElementById(SMTPFromNameCombo.getContent("hidden").getId()).value;ssl=document.getElementById(SMTPRequiresSSLCheckbox.getContent("hidden").getId()).value;useSslCert=document.getElementById(SMTPUseSSLCertCheckbox.getContent("hidden").getId()).value;useExplicitSSL=document.getElementById(SMTPUseExplicitSSLCheckbox.getContent("hidden").getId()).value;}else{requiresLogin=((SMTPRequireLoginCheckbox.getControlValue())?"1":"0");server=Trim(SMTPServerCombo.getControlText());port=SMTPPortCombo.getControlText();accountName=SMTPAccountNameCombo.getControlText();password=SMTPPasswordCombo.getControlText();fromAddress=SMTPFromAddressCombo.getControlText();fromName=SMTPFromNameCombo.getControlText();ssl=((SMTPRequiresSSLCheckbox.getControlValue())?"1":"0");useSslCert=((SMTPUseSSLCertCheckbox.getControlValue())?"1":"0");useExplicitSSL=((SMTPUseExplicitSSLCheckbox.getControlValue())?"1":"0");}SavingDialog(true);var sSMTPConfigCmd="%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Server."+g_EditObjectID+"&StaticOnly=1";var SMTPConfigRequest=CreatePostRequest(sSMTPConfigCmd);SMTPConfigRequest.setParameter("SMTPRequiresLogin",requiresLogin);SMTPConfigRequest.setParameter("SMTPServer",server);SMTPConfigRequest.setParameter("SMTPServerPort",port);SMTPConfigRequest.setParameter("SMTPAccountName",accountName);SMTPConfigRequest.setParameter("SMTPPassword",password);SMTPConfigRequest.setParameter("SMTPFromAddress",fromAddress);SMTPConfigRequest.setParameter("SMTPFromName",fromName);SMTPConfigRequest.setParameter("SMTPSSL",ssl);SMTPConfigRequest.setParameter("SMTPUseSSLCertificate",useSslCert);SMTPConfigRequest.setParameter("SMTPUseExplicitSSL",useExplicitSSL);SMTPConfigRequest.request();SMTPConfigRequest.response=function(XMLDoc){BusyDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else HideDialog("SMTPConfigDialog");};}function OnSaveSMTPConfig(){var sRequiredField="$SMTP_REQUIRED_FIELD$";var server=String(SMTPServerCombo.getControlText());var fromAddress=String(SMTPFromAddressCombo.getControlText());if(server.length>0||fromAddress.length>0){if(server.length<1){
sRequiredField=sRequiredField.replace("$Label","$SMTP_SERVER_LABEL$");AlertDialog(sRequiredField);}else if((fromAddress.length<1)||(!IsValidEmailAddressString(fromAddress))){sRequiredField=sRequiredField.replace("$Label","$SMTP_FROM_ADDRESS_LABEL$");AlertDialog(sRequiredField);}else OnSaveSMTPConfigEx();}else OnSaveSMTPConfigEx();}function OnSMTPConfigHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-SMTP.htm",sExpandNode);}function CleanupErrors(){var serverLbl=document.getElementById('smtpServerLbl');var portLbl=document.getElementById('smtpPortLbl');var accountNameLbl=document.getElementById('accountNameLbl');var fromAddressLbl=document.getElementById('fromAddressLbl');var errorLbl=document.getElementById('SMTPParametersError');var labelsArray=[serverLbl,portLbl,fromAddressLbl,accountNameLbl];var i;for(i=0;i<labelsArray.length;i++){labelsArray[i].removeAttribute("class","Error");}errorLbl.setAttribute("class","Hidden");}function OnParameterValid(server,port,fromAddress,loginRequired,accountName){var bRet=true;var nPort=parseInt(port);var errorLbl=document.getElementById('SMTPParametersError');CleanupErrors();if(server.length<1){document.getElementById('smtpServerLbl').setAttribute("class","Error");bRet=false;}if(isNaN(nPort)||nPort<0||nPort>parseInt(65535)){document.getElementById('smtpPortLbl').setAttribute("class","Error");bRet=false;}if(!IsValidEmailAddressString(fromAddress)){document.getElementById('fromAddressLbl').setAttribute("class","Error");bRet=false;}if(loginRequired){if((!IsValidEmailAddressString(accountName))){document.getElementById('accountNameLbl').setAttribute("class","Error");bRet=false;}}if(bRet==false){errorLbl.setAttribute("class","Hidden");}else{errorLbl.removeAttribute("class","Hidden");}return bRet;}function OnSMTPConfigCheck(){var server=SMTPServerCombo.getControlText();var port=SMTPPortCombo.getControlText();var requiresLogin=SMTPRequireLoginCheckbox.getControlValue();var accountName=SMTPAccountNameCombo.getControlText();var fromAddress=SMTPFromAddressCombo.getControlText();var errorLbl=document.getElementById('SMTPParametersError');if(OnParameterValid(server,port,fromAddress,requiresLogin,accountName)){errorLbl.setAttribute("class","Hidden");OnSMTPTesting();}else{errorLbl.removeAttribute("class","Hidden");}}function OnSMTPServerLoad(){var sServerValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPServer%");var sDefaultServerValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPServer.Default%");SMTPServerCombo.initValue(sServerValue,sDefaultServerValue);if(sServerValue.length){SMTPServerCombo.setControlText(sServerValue);}else SMTPServerCombo.setControlText(sDefaultServerValue);sPortValue="%CServer.%SERVER_ID%.SMTPServerPort%";sDefaultPortValue="%CServer.%SERVER_ID%.SMTPServerPort.Default%";SMTPPortCombo.initValue(sPortValue,sDefaultPortValue);if(sPortValue.length){SMTPPortCombo.setControlText(sPortValue);}else SMTPPortCombo.setControlText(sDefaultPortValue);var sSMTPFromValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPFromAddress%");var sDefaultSMTPFromValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPFromAddress.Default%");var sSMTPFromNameValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPFromName%");var sDefaultSMTPFromNameValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPFromName.Default%");SMTPFromNameCombo.initValue(sSMTPFromNameValue,sDefaultSMTPFromNameValue);if(sSMTPFromNameValue.length)SMTPFromNameCombo.setControlText(sSMTPFromNameValue);else SMTPFromNameCombo.setControlText(sDefaultSMTPFromNameValue);SMTPFromAddressCombo.initValue(sSMTPFromValue,sDefaultSMTPFromValue);if(sSMTPFromValue.length)SMTPFromAddressCombo.setControlText(sSMTPFromValue);else SMTPFromAddressCombo.setControlText(sDefaultSMTPFromValue);var sSMTPAccountNameValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPAccountName%");var sDefaultSMTPAccountNameValue=GetDecodedDirPath("%CServer.%SERVER_ID%.SMTPAccountName.Default%");var nDefaultSMTPAccountNameValue=parseInt("%CServer.%SERVER_ID%.SMTPAccountName.IsDefault%");SMTPAccountNameCombo.initValue(sSMTPAccountNameValue,sDefaultSMTPAccountNameValue);if(sSMTPAccountNameValue.length){SMTPAccountNameCombo.setControlText(sSMTPAccountNameValue);}else SMTPAccountNameCombo.setControlText(sDefaultSMTPAccountNameValue);if((bSMTPTriState)&&(nDefaultSMTPAccountNameValue)){setTimeout(function(){document.getElementById(SMTPAccountNameCombo.getContent("hidden").getId()).value="";},500);}var sSMTPPasswordValue=DecodeString("%CServer.%SERVER_ID%.SMTPPassword%");var sDefaultSMTPPasswordValue=DecodeString("%CServer.%SERVER_ID%.SMTPPassword.Default%");SMTPPasswordCombo.initValue(sSMTPPasswordValue,sDefaultSMTPPasswordValue);SMTPPasswordCombo.setControlText(sSMTPPasswordValue);document.getElementById(SMTPPasswordCombo.getContent("hidden").getId()).value=sSMTPPasswordValue;if(sSMTPPasswordValue.length)SMTPPasswordCombo.setControlText(sSMTPPasswordValue);else SMTPPasswordCombo.setControlText(sDefaultSMTPPasswordValue);}function BuildIEInput(){var SMTPForm=document.getElementById("SMTPPassword-box");var ElemId=SMTPPasswordCombo.getContent("box/text").getId();var InputElement=document.getElementById(ElemId);var sInputVal=InputElement.value;var NextSibling=InputElement.nextSibling;var sStyle=InputElement.getAttribute("style");var sClass=InputElement.className;var sName=InputElement.name;SMTPForm.removeChild(InputElement);var Passwd_field=document.createElement("INPUT");Passwd_field.setAttribute("type","password");Passwd_field.setAttribute("value",sInputVal);Passwd_field.setAttribute("style",sStyle);Passwd_field.setAttribute("name",sName);Passwd_field.setAttribute("id",ElemId);SMTPForm.insertBefore(Passwd_field,NextSibling);document.getElementById(ElemId).className=sClass;}CreateGroupBox("$SMTP_SERVER_GROUP$","SMPTServerGroup","320px","245px",true);CreateGroupBox("$SMTP_AUTH_GROUP$","SMPTAuthGroup","280px","100px",true);var bSMTPTriState=true;if(sEventObjectType.toLowerCase()=="server")bSMTPTriState=false;var SMTPServerCombo=CreateComboBox("","",[],[],"SMTPServer","SMTPServer",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPPortCombo=CreateComboBox("","",[],[],"SMTPServerPort","SMTPServerPort",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPAccountNameCombo=CreateComboBox("","",[],[],"SMTPAccountName","SMTPAccountName",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPPasswordCombo=CreateComboBox("","",[],[],"SMTPPassword","SMTPPassword",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);if(AW.ie)BuildIEInput();else SMTPPasswordCombo.getContent("box/text").setAttribute("type","password");var SMTPFromAddressCombo=CreateComboBox("","",[],[],"SMTPFromAddress","SMTPFromAddress",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPFromNameCombo=CreateComboBox("","",[],[],"SMTPFromName","SMTPFromName",undefined,undefined,bSMTPTriState,250,20,OnSaveSMTPConfig,true);var SMTPRequiresSSLCheckbox,SMTPUseSSLCertCheckbox,SMTPUseExplicitSSLCheckbox;if(bSMTPTriState){SMTPRequiresSSLCheckbox=CreateTriStateCheckBox("$SMTP_REQUIRE_SSL$","SMTPSSL","SMTPSSL","%CServer.%SERVER_ID%.SMTPSSL%","%CServer.%SERVER_ID%.SMTPSSL.Default%","%CServer.%SERVER_ID%.SMTPSSL.IsDefault%",ShowHideSMTPSSLCert);SMTPUseSSLCertCheckbox=CreateTriStateCheckBox("$SMTP_USE_SSL_CERT$","SMTPUseSSLCertificate","SMTPUseSSLCertificate","%CServer.%SERVER_ID%.SMTPUseSSLCertificate%","%CServer.%SERVER_ID%.SMTPUseSSLCertificate.Default%","%CServer.%SERVER_ID%.SMTPUseSSLCertificate.IsDefault%");SMTPUseExplicitSSLCheckbox=CreateTriStateCheckBox("$SMTP_USE_EXPLICIT_SSL$","SMTPUseExplicitSSL","SMTPUseExplicitSSL","%CServer.%SERVER_ID%.SMTPUseExplicitSSL%","%CServer.%SERVER_ID%.SMTPUseExplicitSSL.Default%","%CServer.%SERVER_ID%.SMTPUseExplicitSSL.IsDefault%",OnToggleExplicitSSL);}else{SMTPRequiresSSLCheckbox=CreateCheckBox("$SMTP_REQUIRE_SSL$","SMTPSSL","SMTPSSL","%CServer.%SERVER_ID%.SMTPSSL%",ShowHideSMTPSSLCert);SMTPUseSSLCertCheckbox=CreateCheckBox("$SMTP_USE_SSL_CERT$","SMTPUseSSLCertificate","SMTPUseSSLCertificate","%CServer.%SERVER_ID%.SMTPUseSSLCertificate%");SMTPUseExplicitSSLCheckbox=CreateCheckBox("$SMTP_USE_EXPLICIT_SSL$","SMTPUseExplicitSSL","SMTPUseExplicitSSL","%CServer.%SERVER_ID%.SMTPUseExplicitSSL%",OnToggleExplicitSSL);}var SMTPRequireLoginCheckbox;if(bSMTPTriState)SMTPRequireLoginCheckbox=CreateTriStateCheckBox("$SMTP_REQUIRE_LOGIN$","SMTPRequiresLogin","SMTPRequiresLogin","%CServer.%SERVER_ID%.SMTPRequiresLogin%","%CServer.%SERVER_ID%.SMTPRequiresLogin.Default%","%CServer.%SERVER_ID%.SMTPRequiresLogin.IsDefault%",ShowHideSMTPAuth);else SMTPRequireLoginCheckbox=CreateCheckBox("$SMTP_REQUIRE_LOGIN$","SMTPRequiresLogin","SMTPRequiresLogin","%CServer.%SERVER_ID%.SMTPRequiresLogin%",ShowHideSMTPAuth);OnSMTPServerLoad();CreateDialogPushButton("$SAVE_BUTTON$","SaveSMTPConfigButton",OnSaveSMTPConfig);CreateDialogPushButton("$CANCEL_BUTTON$","CancelSMTPConfigButton",OnCancelSMTPConfig);CreateDialogPushButton("$HELP_BUTTON$","HelpSMTPConfigButton",OnSMTPConfigHelp);CreatePushButton("$TEST_SMTP_BUTTON$","TestSMTPConfigButton",OnSMTPConfigCheck,110,25);</script><div id="LogDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div id="logwindow" class="SpyLogScroll"><div id="log" style="width:100%;"></div></div><span id="CloseLog"></span></div></div><script type="text/javascript" language="javascript">var g_sAttrLogObjectType="Server";var g_nAttrLogObjectId=%SERVER_ID%;var g_sFilterLogText="";var g_GridToReload;BuildDialog("$LOG_DIALOG_TITLE$","LogDialog","775","300","","$CLOSE_CANCEL$");function OnShowLogDialog(){g_GridToReload=undefined;try{if(awActiveGrid!=undefined&&awActiveGrid.m_bUpdates)g_GridToReload=awActiveGrid;}catch(e){try{if(g_ActiveRezizeGrid!=undefined&&g_ActiveRezizeGrid.m_bUpdates)g_GridToReload=g_ActiveRezizeGrid;}catch(e){try{if(awSecondaryActiveGrid!=undefined&&awSecondaryActiveGrid.m_bUpdates)g_GridToReload=awSecondaryActiveGrid;}catch(e){g_GridToReload=undefined;}}}if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(false);InitDomainAttrLog();FreezeDomainAttrLog(false);ShowDialog("LogDialog",undefined,ResetLogDialog);}function ResetLogDialog(){if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(true);FreezeDomainAttrLog(true);document.getElementById("log").innerHTML="";}function OnOkViewLog(){HideDialog('LogDialog');}CreateDialogPushButton("$CLOSE_BUTTON$","CloseLog",OnOkViewLog);InitLog("log","",0);</script><div id="GatewayDialoginner" style="display:none;"><form name="GatewayForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div>$GATEWAY_ADDRESS$:<div style="overflow:auto"><span id="GatewayIP"></span></div></div><div>$LISTENER_PORT$:<div style="overflow:auto"><span id="GatewayPort"></span></div></div><div>$PUBLIC_IP_ADDRESS$:<div style="overflow:auto"><span id="GatewayPublicIP"></span></div></div><div style="margin-top:5px;"><span id="Status"></span></div><div>$DESCRIPTION$:<br /><span id="GatewayDescription"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveGatewayButton"></span><span id="CancelGatewayButton"></span><br /><br /><span id="HelpGatewayButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$GATEWAY$","GatewayDialog","420","225","","$CLOSE_CANCEL$","Gateway16.png");function OnGatewayLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("GatewayDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}GatewayIP.setControlText(document.getElementById(GatewayIP.getContent("box/text").getId()).value);GatewayIP.getContent("box/text").element().focus();}function OnLoadGatewayDisabled(sValue){GatewayEnabledCheck.setChecked(sValue=="1");}function OnSaveGateway(){if(GatewayIP.getControlText()!="")GatewayList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_GATEWAY_IP$",true,(function(){GatewayIP.getContent("box/text").element().focus()}));return(false);}function OnCancelGateway(){HideDialog('GatewayDialog');}function OnGatewayHelp(){LaunchHelp("Help-Gateway.htm","Item7_3");}var GatewayEnabledCheck=CreateCheckBox("$ENABLE_GATEWAY$","Status","Enabled",false,undefined,true,"OnLoadGatewayDisabled()",false);var GatewayIP=CreateInputField("","GatewayIP","Gateway_IP",undefined,225,undefined,undefined,OnSaveGateway);var GatewayPort=CreateInputField("","GatewayPort","Gateway_Port",undefined,225,undefined,undefined,OnSaveGateway);var GatewayPublicIP=CreateInputField("","GatewayPublicIP","Gateway_PublicIP",undefined,225,undefined,undefined,OnSaveGateway);var GatewayDescription=CreateInputField("","GatewayDescription","Gateway_Description",undefined,310,undefined,undefined,OnSaveGateway);CreateDialogPushButton("$SAVE_BUTTON$","SaveGatewayButton",OnSaveGateway);CreateDialogPushButton("$CANCEL_BUTTON$","CancelGatewayButton",OnCancelGateway);CreateDialogPushButton("$HELP_BUTTON$","HelpGatewayButton",OnGatewayHelp);</script><div id="GatewayPropertiesDialoginner" style="display:none;"><form name="GatewayPropForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div id="GW-StatusGroupBox" style="clear:left;"><div style="line-height:34px;"><div style="float:left;width:40px;"><div id="GW-Icon" style="width:32px;height:32px;margin-right:5px;float:left;">&nbsp;</div></div><strong><span id="GW-Status"></span></strong></div><div style="clear:left;"><div style="width:290px;">$AVAIL_PUBLIC_IPS$:</div><div id="GW-PublicIPs" style="font-weight:bold;height:70px;overflow-y:auto;border:1px solid black;width:300px;background-color:#fff;padding:5px;"></div></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="CancelGatewayPropButton"></span><br /><br /><span id="HelpGatewayPropButton"></span></td></tr><tr><td colspan="2"><div id="GW-InstallInfo" style="clear:left;padding-top:10px;"><div style="float:left; width:40px;padding-top:10px;"><img alt="$GATEWAY$" src="%ADMIN_FILE%Images/Gateway32.png" width="32" height="32" class="header-icon" /></div><div style="float:left; width:auto;"><div style="clear:left"><div style="float:left;width:100px;">$VERSION$:</div><strong><span id="GW-GatewayVersion"></span></strong></div><div style="clear:left"><div style="float:left;width:100px;">$BUILD_DATE$:</div><strong><span id="GW-BuildDate"></span></strong></div><div style="clear:left"><div style="float:left;width:100px;">$INSTALL_DATE$:</div><strong><span id="GW-InstallTime"></span></strong></div><div id="GW-TrialDays" style="clear:left"><div style="float:left;width:100px;">$REGGIE_TRIAL$:</div><strong><span id="GW-TrialDaysRemaining"></span></strong></div></div></div><div id="GW-ReggieGroupBox" style="clear:left;padding-top:5px;"><div id="GW-ReggieInfo" style="padding-bottom:10px;"><div style="clear:left"><div style="float:left;width:100px;">$REGGIE_NAME$:</div><strong><span id="GW-ReggieName"></span></strong></div><div style="clear:left"><div style="float:left;width:100px;">$REGGIE_EMAIL$:</div><strong><span id="GW-ReggieEmail"></span></strong></div><div style="clear:left"><div style="float:left;width:100px;">$REGGIE_DATE$:</div><strong><span id="GW-PurchaseTime"></span></strong></div><div style="clear:left"><div style="float:left;width:100px;">$REGGIE_UPDATES$:</div><strong><span id="GW-ReggieTime"></span></strong></div></div><div id="GW-PurchaseInfo" style="padding-bottom:10px;">$GATEWAY_PURCHASE_INFO$</div><div id="GW-Reggiebox" style="float:right;width:auto;padding:5px 0 0 0;"><textarea id="GatewayReggie" class="aw-border" wrap="on" style="width:434px;height:70px;"></textarea></div><div id="GW-ReggieSavebox" style="clear:both;float:right;width:auto;padding:5px 0 0 0;"><span id="SaveGatewayPropButton"></span></div></div></td></tr></table><input type="hidden" id="Gateway_Id" name="Gateway_Id" /></form></div><script type="text/javascript" language="javascript">var g_tPropertiesTimeout;BuildDialog("$GATEWAY$ - $PROPERTIES$","GatewayPropertiesDialog","470","480","","$CLOSE_CANCEL$","Gateway16.png");if(AW.ie){document.getElementById("GatewayReggie").style.width="434px";document.getElementById("GW-Reggiebox").style.paddingRight="4px";document.getElementById("GW-ReggieSavebox").style.paddingRight="4px";}else{document.getElementById("GatewayReggie").style.width="430px";}function OnSaveGatewayProp(){var sReggie=document.getElementById("GatewayReggie").value;if(sReggie!="")SaveGatewayProp(sReggie);else ConfirmDialog("$REGISTRATION_GATEWAY_CLEAR_CONFIRM$",SaveGatewayProp,undefined,sReggie);}function SaveGatewayProp(sReggie){var SaveGatewayReggieObj=undefined;var nGatewayID=document.getElementById("Gateway_Id").value;CloseConfirmDialog();if(SaveGatewayReggieObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"Result.xml%OBJECT_COMMAND_REF%CGateway."+nGatewayID+".SetReggie"),OnSaveGatewayReggieDone)){SaveGatewayReggieObj.setParameter("Reggie",sReggie);SavingDialog(true);SaveGatewayReggieObj.request();}}function OnSaveGatewayReggieDone(){var xmlDoc=this.getResponseXML();var nResult=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){if(g_tPropertiesTimeout)clearTimeout(g_tPropertiesTimeout);g_tPropertiesTimeout=setTimeout("OnGatewayProperties(true)",1000);document.getElementById("GatewayReggie").value="";}else AlertDialog(GetResultText(nResult,"$REGISTRATION_GATEWAY_FAIL$",sResultText));}function OnCancelGatewayProp(){HideDialog('GatewayPropertiesDialog');document.getElementById("GW-Status").innerHTML="";document.getElementById("GW-PublicIPs").innerHTML="$NO_PUBLIC_IPS$";document.getElementById("GW-GatewayVersion").innerHTML="";document.getElementById("GW-InstallTime").innerHTML="";document.getElementById("GW-ReggieName").innerHTML="";document.getElementById("GW-ReggieEmail").innerHTML="";document.getElementById("GW-ReggieTime").innerHTML="";document.getElementById("GW-PurchaseTime").innerHTML="";document.getElementById("GW-TrialDaysRemaining").innerHTML="";document.getElementById("GW-BuildDate").innerHTML="";document.getElementById("GatewayReggie").value="";document.getElementById("Gateway_Id").value="";if(g_tPropertiesTimeout)clearTimeout(g_tPropertiesTimeout);}function GetLargeStatusIcon(nStatus){switch(nStatus){case 0x01:return("GW-Running");break;case 0x02:return("GW-NotFound");break;case 0x05:return("GW-Trial");break;case 0x09:return("GW-TrialNearEnd");break;case 0x10:return("GW-TrialExpired");break;case 0x21:return("GW-UpdateNearEnd");break;case 0x41:return("GW-UpdateExpired");break;case 0x80:return("GW-Disabled");break;default:return("GW-Unknown");break;}}function OnGatewayProperties(bBypassDialog){var nRow=GatewayList.getSelectedRows();if((nRow!="")&&(nRow!=-1)&&nRow.toString().split(",").length==1){var nStatus=parseInt(GatewayList.getCellData(1,nRow));var bEnabled=parseInt(GatewayList.getCellData(2,nRow));if(nStatus==0x02||nStatus==0x00||bEnabled!=1)AlertDialog("$CANNOT_CONNECT_TO_GATEWAY$");else{var sPublicIPs=GatewayList.getCellData(5,nRow);var sGatewayVersion=GatewayList.getCellData(6,nRow);var nInstallTime=GatewayList.getCellData(7,nRow);var sReggieName=GatewayList.getCellData(8,nRow);var sReggieEmail=GatewayList.getCellData(9,nRow);var nReggieTime=GatewayList.getCellData(10,nRow);var nReggieDays=parseInt(GatewayList.getCellData(11,nRow));var nTrialDaysRemaining=parseInt(GatewayList.getCellData(12,nRow));var nBuildDate=GatewayList.getCellData(13,nRow);var nGatewayID=GatewayList.getCellData(15,nRow);var nReggieDaysRemaining=parseInt(GatewayList.getCellData(14,nRow));var GatewayInstallDate=new Date(nInstallTime*1000);var GatewayReggieDate=new Date(nReggieTime*1000);var GatewayBuildDate=new Date(nBuildDate*1000);var UpgradeDate=new Date(GatewayReggieDate.getTime()+(nReggieDays*86400000));document.getElementById("GW-Status").innerHTML=GetGatewayStatusTxt(nStatus);document.getElementById("GW-PublicIPs").innerHTML=(sPublicIPs!="")?sPublicIPs.replace(new RegExp(",","g"),"<br />"):"$NO_PUBLIC_IPS$";document.getElementById("GW-GatewayVersion").innerHTML=sGatewayVersion;document.getElementById("GW-InstallTime").innerHTML=(nInstallTime!=0)?GatewayInstallDate.toLocaleDateString()+" "+GatewayInstallDate.toLocaleTimeString():"";document.getElementById("GW-ReggieName").innerHTML=decodeURIComponent(sReggieName);document.getElementById("GW-ReggieEmail").innerHTML=decodeURIComponent(sReggieEmail);document.getElementById("GW-ReggieTime").innerHTML=(nReggieTime!=0)?UpgradeDate.toLocaleDateString()+" ("+nReggieDaysRemaining+" $REGGIE_DAYS_REMAIN$)":"";document.getElementById("GW-PurchaseTime").innerHTML=(nReggieTime!=0)?GatewayReggieDate.toLocaleDateString():"";document.getElementById("GW-TrialDaysRemaining").innerHTML=nTrialDaysRemaining+" $REGGIE_DAYS_REMAIN$";document.getElementById("GW-BuildDate").innerHTML=(nBuildDate!=0)?GatewayBuildDate.toLocaleDateString()+" "+GatewayBuildDate.toLocaleTimeString():"";document.getElementById("Gateway_Id").value=nGatewayID;document.getElementById("GW-Icon").className="lg-image-"+GetLargeStatusIcon((bEnabled)?nStatus:0x80);if(nStatus==0x05||nStatus==0x09||nStatus==0x10)document.getElementById("GW-TrialDays").style.display="block";else document.getElementById("GW-TrialDays").style.display="none";if(sReggieName==""&&sReggieEmail==""&&parseInt(nReggieTime)==0){document.getElementById("GW-ReggieInfo").style.display="none";document.getElementById("GW-PurchaseInfo").style.display="block";document.getElementById("GW-ReggieGroupBoxFS").style.height="170px";}else{document.getElementById("GW-ReggieInfo").style.display="block";document.getElementById("GW-PurchaseInfo").style.display="none";document.getElementById("GW-ReggieGroupBoxFS").style.height="195px";}if(g_tPropertiesTimeout)clearTimeout(g_tPropertiesTimeout);if(bBypassDialog==undefined||!bBypassDialog)ShowDialog('GatewayPropertiesDialog');else{g_tPropertiesTimeout=setTimeout("OnGatewayProperties(true)",1000);}}}else{if(nRow.toString().split(",").length>1)AlertDialog("$SELECT_ONLY_ONE_GATEWAY_PROP$");else AlertDialog("$SELECT_ONE_GATEWAY_PROP$");}}function OnGatewayPropHelp(){LaunchHelp("Help-Gateway.htm","Item7_3");}CreateGroupBox("$STATUS$","GW-StatusGroupBox","360px","150px");CreateGroupBox("$DATE_INFO_GROUP$","GW-InstallInfo","450px","90px");CreateGroupBox("$REGISTRATION_DIALOG_TITLE$","GW-ReggieGroupBox","450px","150px");CreateDialogPushButton("$SAVE_BUTTON$","SaveGatewayPropButton",OnSaveGatewayProp);CreateDialogPushButton("$CLOSE_BUTTON$","CancelGatewayPropButton",OnCancelGatewayProp);CreateDialogPushButton("$HELP_BUTTON$","HelpGatewayPropButton",OnGatewayPropHelp);</script><form id="myform"><div id="ServerIdentityStartDialoginner" style="display:none;"><div class="tabs-content"><div><div style="padding:5px;">$SERVER_IDENTITY_ALERT_MESSAGE$</div></div></div></div></form><script type="text/javascript" language="javascript">BuildDialog("$SERVER_IDENTITY_START_TITLE$","ServerIdentityStartDialog","630","675","","$CLOSE_CANCEL$","Email16.png");function ShowServerIdentityStartDialog(){ShowDialog("ServerIdentityStartDialog");}function OnCreateServerIdentityDone(){const result=GetXMLValue(this.getResponseXML(),"result");if(+result===0){$('#CreateServerIdentity').css('display','none');toggleServerIdentityPresent(false);}AlertDialog(GetXMLValue(this.getResponseXML(),"ResultText"),false,function(){HideDialog("ServerIdentityStartDialog");});}function toggleServerIdentityPresent(isNotPresent){if(!document.getElementById('ServerIdentity')){return;}if(isNotPresent){document.getElementById('IdentityStatus').innerHTML="$NOT_CREATED$";$('#IdentityStatus').css('color','red');document.getElementById('IdentityInfo').innerHTML="$IDENTITY_NOT_CREATED$";$('#ExportSIRow').css('display','none');$('#CreateSIRow').css('display','table-row');$('#ImportSIRow').css('display','table-row');}else{document.getElementById('IdentityStatus').innerHTML="$CREATED$";$('#IdentityStatus').css('color','green');document.getElementById('IdentityInfo').innerHTML="$IDENTITY_CREATED$";$('#CreateSIRow').css('display','none');$('#ImportSIRow').css('display','none');$('#ExportSIRow').css('display','table-row');}}function OnCreateServerIdentity(){var CreateServerIdentityObj=createAWHttpRequest("POST","%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.CreateServerIdentity",OnCreateServerIdentityDone);if(CreateServerIdentityObj)CreateServerIdentityObj.request();}</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--></head><body><script type="text/javascript" language="JavaScript">document.addEventListener('DOMContentLoaded',function(){var createServerIdentityContainer=document.getElementById("CreateServerIdentity");if(g_bSysAdmin&&g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY_FOR_READONLY_SYSADMIN$</a></div>';}if(g_bSysAdmin&&!g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a onclick="javascript:navigateToServerIdentityTab(); return false;" target="_blank" id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY$</a></div>';}});</script><div id="container"><div id="MC-logo" style="overflow:visible;"><div id="sulogo-div"><div class="header-logo-container"><a href="javascript:LoadConsolePage('%ADMIN_FILE%', true)"><img src="%COMMON_FILE%Images/swlogo.png" id="SWLOGO" style="border:none;" alt="$CONSOLE_TITLE$"/></a></div><div class="sulogo-prodname"><strong style="font-size:12pt; margin-right: 8px;">%PRODUCT%</strong><span style="font-size:10pt;">$MANAGEMENT_CONSOLE$</span></div></div><div id="TrialExpire" style="display:none;"><div><a href="https://ecomm.solarwinds.com/onepagecheckout/Servu?sku=7205&CMPSource=SERVUSITE#/" target="_blank" id="TrialExpireTxt" class="DaysExpireTxt"><span id="TrialExpireDays"></span>$DAYS$ $TRIAL_EXPIRES_IN$. $BUY_NOW$</a></div></div><div id="CreateServerIdentity" style="display:none;"></div><div class="header-user-block"><span class="head-item head-user"><span id="UserOptBtn" class="menu-toggle"><span class="head-icon"></span><span id="CurrentlyLoggedIn" style="font-weight:bold;"></span></span></span><span class="head-item head-help"><a href="javascript:MainHelp();"><span class="head-icon"></span></a></span><span class="head-item head-menu"><span id="ManConNavBarJumpToList" class="menu-toggle"><span class="head-icon"></span></span></span></div></div><noscript><center><p>$NO_SCRIPT_TEXT$</p></center></noscript><div class="maincontent" ><div id="leftCol-Contain"><div id="leftCol-Nav"><div class="menu-nav" id="MenuListNav"><ul id="nav"><li id="navmenuserver-global" style="display:none;"><a id="navmenuserver-global-href" href="#"><div><span class="navDomain icon"></span><span class="navDomain text">$GLOBAL$</span></div></a><ul><li data-active='6' class='activetab'><a id="navmenuserver-global-dashboard-href" href="javascript:LoadConsolePage('%ADMIN_FILE%')"><span></span>$DASHBOARD$</a></li><li data-active='0' class='activetab'><a id="navmenuserver-global-details-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%Server.htm', 1,0,true);">$SERVERDETAILS$</a></li><li data-active='1' class='activetab'><a id="navmenuserver-global-users-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerUsers.htm', 1,1,true);">$USERS$</a></li><li data-active='2' class='activetab'><a id="navmenuserver-global-groups-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerGroups.htm', 1,2,true);">$GROUPS$</a></li><li data-active='3' class='activetab'><a id="navmenuserver-global-dirs-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerDir.htm', 1,3,true);">$DIRECTORIES$</a></li><li data-active='4' class='activetab'><a id="navmenuserver-global-limits-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerLimits.htm', 1,4,true);">$LIMITS$</a></li><li data-active='5' class='activetab'><a id="navmenuserver-global-activity-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerActivity.htm', 1,5,true);">$SERVERACTIVITY$</a></li></ul></li><li id="navmenuserver-DomainStart" class="NavDomainStart"><span class="navHeadTxtWhite">$DOMAINS$ <span id="DomainStart-Count"></span></span></li><div class="nav-add-domain"><a id="AddDomain-btn" href="javascript:OnShowDomainWizard();" style="align-items: center;"><img src="%COMMON_FILE%Images/add_domain_icon.png" width="20px" height="20px" alt="$NEW_DOMAIN_BUTTON$" title="$NEW_DOMAIN_BUTTON$" border="0" /><span id="brdcrumb-main" class="navHeadTxtWhite">$NEW_DOMAIN$</span></a></div></ul><div id="nav-loading" style="width:230px;text-align:center;"><img src='%COMMON_FILE%Images/domain-load.gif' alt='$LOADING_DOMAINS$' border='0' style="margin:0 auto;"/></div></div><div class="TreeInfoBox"><div style="min-height:400px; display: flex; flex-direction: column; flex-grow: 1; justify-content: flex-end"><div id="MaintContainUpdate" class="MaintInfoBox"><span class="TreeInfoBox__text-panel">$LATEST_UPDATE$</span><div id="SU-UpdateInfo" style="margin-top:10px;color:#333333;">$NO_UPDATE$</div></div><div id="MaintContain" class="MaintInfoBox"><div class="TreeInfoBox__text-secondary">$MAINTENANCE_ENDS$:</div><div class="TreeInfoBox__text-default" id="MaintDaybox"><span id="MaintDays"></span> $DAYS$, <span id="MaintDate"></span></div></div></div></div></div><div class="content-container"><div class="breadcrumb-container"><div style="display:inline-block;padding-left:15px"><span id="breadcrumb"></span></div></div><div id="TreeCol"><div class="MainHeaderInfo" style="vertical-align:top;"><img src="%ADMIN_FILE%Images/domains32.png" width="32" height="32" class="tab-header" alt="$SERVER_PAGE_INFO$" /><strong style="display:inline-block;padding-top:10px;">$SERVERDETAILS$</strong> - $SERVER_PAGE_INFO$</div><br style="clear:both" /><span id="PageTabs"></span><div id="TabsContent" class="tabs-content"><div id="IPAccess" style="display:none;"><div class="layercontent"><div class="ie6positionfix">
<table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$IPACCESS$" src="%ADMIN_FILE%Images/IpAccess32.png" width="32" height="32"/></td><td style="vertical-align:top;">$SERVER_IP_ACCESS_INFO$</td></tr></table><table border="0" cellpadding="0" cellspacing="0"><tr><td style="width:100%;padding-right:8px;"><span id="IPAccessList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span></td><td style="width:40px;text-align:center;"><span id="IPAccessTopArrow"></span><br /><span id="IPAccessUpArrow"></span><br /><br /><span id="IPAccessDownArrow"></span><br /><span id="IPAccessBottomArrow"></span></td></tr></table><div style="padding:5px 28px 0 0;"><span id="ExportIPButton" style="float:right;"></span><span id="ImportIPButton" style="float:right;"></span><span id="AddIPButton"></span><span id="EditIPButton"></span><span id="RemoveIPButton"></span>&nbsp;&nbsp;&nbsp;<span id="IPSort"></span></div><script type="text/javascript" language="JavaScript">var sConfirmSortIpMsg="$CONFIRM_SORT_IP$";function OnAddIPAccess(){IPAccessList.OnAddObject("IPAccess.xml%DEFAULT_OBJECT_REF%CServer.%SERVER_ID%.IPAccess","Result.xml%ADD_OBJECT_REF%CServer.%SERVER_ID%.IPAccess",document.IPAccessForm,"IPAccessDialog",[OnIPAccessLoad],g_bReadOnlyAccess);}function OnEditIPAccess(){IPAccessList.OnEditObject("IPAccess.xml","Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.IPAccess.",document.IPAccessForm,"IPAccessDialog","$SELECT_ONLY_ONE_IPACCESS_EDIT$","$SELECT_ONE_IPACCESS_EDIT$",[OnIPAccessLoad]);}function OnRemoveIPAccess(){IPAccessList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CServer.%SERVER_ID%.IPAccess&ID=%SERVER_ID%","$ASK_DELETE_IPACCESS$","$SELECT_ONE_IPACCESS_DELETE$");}function OnExportIPDone(sFilePath){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();nLen=nCountFormatted.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));AlertDialog(nCountFormatted+" $IP_EXPORT_MSG$<br><br>"+this.FilePathName);}else{AlertDialog(GetResultText(nResult,"",sResultText));}}function OnImportIPDone(){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){var nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();var nLen=nCountFormatted.length;var nTotalUsersInFile=new Number(parseInt(nCountFormatted)).toLocaleString();var nTotalUsersInFileLen=nTotalUsersInFile.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));if(nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==".00"||nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==",00")nTotalUsersInFile=nTotalUsersInFile.substr(0,(nTotalUsersInFileLen-3));sImportStr=nCountFormatted+" $OF$ "+nTotalUsersInFile+" $IP_IMPORT_MSG$<br><br>"+this.FilePathName;AlertDialog(sImportStr);}else AlertDialog(GetResultText(0,"",sResultText));}function OnImportIPAccess(sFilePath){var ImportIPObj=undefined;var sImportFile=sFilePath;if(Trim(sImportFile)!=""){if(ImportIPObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.ImportIPAccess"),OnImportIPDone)){ImportIPObj.setParameter("File",sImportFile);ImportIPObj.FilePathName=sImportFile;SavingDialog(true);ImportIPObj.request();}}}function OnExportIPAccess(sFilePath){CloseConfirmDialog();var ExportUsersObj=undefined;var sExportFile=sFilePath;sExportType=g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.ExportIPAccess";if(Trim(sExportFile)!=""){if(ExportUsersObj=createAWHttpRequest("POST",(sExportType),OnExportIPDone)){ExportUsersObj.setParameter("File",sExportFile);ExportUsersObj.FilePathName=sExportFile;SavingDialog(true);ExportUsersObj.request();}}}var IPAccessList=CreateIPAccessGrid("IPAccessList","ServerIPAccess.xml?ID=%SERVER_ID%",OnEditIPAccess);IPAccessList.onKeyDelete=OnRemoveIPAccess;IPAccessList.NoResizeColumns([1,1,1,0]);var SortCheckbox=CreateCheckBox("$ENABLE_SORT_VIEW$","IPSort","IPSort",false,OnSortCheckBoxValueChanged);CreatePushButton("$ADD_BUTTON$...","AddIPButton",OnAddIPAccess);CreatePushButton("$EDIT_BUTTON$...","EditIPButton",OnEditIPAccess);CreatePushButton("$DELETE_BUTTON$","RemoveIPButton",OnRemoveIPAccess);var ImportIPButton=CreatePushButton("$IMPORT_BUTTON$...","ImportIPButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnImportIPAccess]],"ImportDB");var ExportIPButton=CreatePushButton("$EXPORT_BUTTON$...","ExportIPButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnExportIPAccess]],"ExportDB");IPAccessList.InitObjectMove(["IPAccessTopArrow","IPAccessUpArrow","IPAccessDownArrow","IPAccessBottomArrow"],"CServer.%SERVER_ID%.IPAccess");var sOnEditIPAccess=String("OnEditIPAccess(");var sOnAddIPAccess=String("OnAddIPAccess(");var sOnRemoveIPAccess=String("OnRemoveIPAccess(");CreateContextMenu([sOnEditIPAccess,"",sOnAddIPAccess,sOnRemoveIPAccess],[function(){return(OnEqualOneContextMenu(IPAccessList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(IPAccessList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(IPAccessList,"$DELETE_BUTTON$"))}],["Edit","","New","FileDelete"],IPAccessList,"IPAccessListContext",true);</script></div></div></div><div id="Gateway" style="display:none;"><div id="GatewayLayer" style="width:100%"><div class="layercontent"><div class="ie6positionfix"><div style="display:inline;"><img alt="$GATEWAY$" src="%ADMIN_FILE%Images/Gateway32.png" width="32" height="32" class="header-icon" />$GATEWAY_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="GatewayTabContent"><span id="GatewayList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="MoreInfoGatewayButton" style="float:right;"></span><span id="AddGatewayButton"></span><span id="EditGatewayButton"></span><span id="RemoveGatewayButton"></span>&nbsp;&nbsp;&nbsp;<span id="GatewayPropertiesButton"></span></div></div></div></div></div><script type="text/javascript" language="JavaScript">var g_GatewayProperties;AW.Formats.GatewayEnabled=AW.Formats.Number.subclass();AW.Formats.GatewayEnabled.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if(parseInt(data))return("$YES_BUTTON$");else return("$NO_BUTTON$");};};AW.Formats.GatewayStatus=AW.Formats.Number.subclass();AW.Formats.GatewayStatus.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){if(parseInt(Grid.getCellData(2,nRow))!=1)data=0x80;sText=GetGatewayStatusTxt(parseInt(data));if(sText)return(sText);else return("");};};function OnAddGateway(){GatewayList.OnAddObject("Gateway.xml%DEFAULT_OBJECT_REF%CServer.%SERVER_ID%.Gateway","Result.xml%ADD_OBJECT_REF%CServer.%SERVER_ID%.Gateway",document.GatewayForm,"GatewayDialog",[OnGatewayLoad],g_bReadOnlyAccess);}function OnEditGateway(){GatewayList.OnEditObject("Gateway.xml","Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Gateway.",document.GatewayForm,"GatewayDialog","$SELECT_ONLY_ONE_GATEWAY_EDIT$","$SELECT_ONE_GATEWAY_EDIT$",[OnGatewayLoad]);}function OnRemoveGateway(){GatewayList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CServer.%SERVER_ID%.Gateway&ID=%SERVER_ID%","$ASK_DELETE_GATEWAY$","$SELECT_A_GATEWAY_TO_DELETE$");}var GatewayList=CreateAdminGrid("GatewayList",["$GATEWAY_ADDRESS$","$STATUS$","$ENABLED$","$PUBLIC_IP_ADDRESS$","$DESCRIPTION$"],[250,250,75,200,200],"Gateways.xml?ID=%ID%","gateways","gateway",16,OnEditGateway);GatewayList.setCellFormat([new AW.Formats.XMLString,new AW.Formats.GatewayStatus,new AW.Formats.GatewayEnabled,new AW.Formats.XMLString,new AW.Formats.XMLString]);GatewayList.onKeyDelete=OnRemoveGateway;GatewayList.NoResizeColumns([1,1,1,1,0]);GatewayList.getCellImage=function(nColumn,nRow){return(GatewayFormat.call(this,nColumn,nRow));};CreatePushButton("$ADD_BUTTON$...","AddGatewayButton",OnAddGateway);CreatePushButton("$EDIT_BUTTON$...","EditGatewayButton",OnEditGateway);CreatePushButton("$DELETE_BUTTON$","RemoveGatewayButton",OnRemoveGateway);CreatePushButton("$PROPERTIES$...","GatewayPropertiesButton",OnGatewayProperties);var GateWayMoreInfoButton=CreatePushButton("$MORE_INFO_BUTTON$","MoreInfoGatewayButton",OnGatewayMoreInfo);GateWayMoreInfoButton.setControlImage("Gateway_Icon");function GatewayFormat(nColumn,nRow){var nStatus=parseInt(this.getCellData(1,nRow));if(parseInt(this.getCellData(2,nRow))!=1)nStatus=0x80;switch(nStatus){case 0x01:return("GW-Running");break;case 0x02:return("GW-NotFound");break;case 0x05:return("GW-Trial");break;case 0x09:return("GW-TrialNearEnd");break;case 0x10:return("GW-TrialExpired");break;case 0x21:return("GW-UpdateNearEnd");break;case 0x41:return("GW-UpdateExpired");break;case 0x80:return("GW-Disabled");break;default:return("GW-Unknown");break;}}function GetGatewayStatusTxt(nStatus){switch(nStatus){case 0x01:return("$GATEWAY_RUNNING_TXT$");break;case 0x02:return("$GATEWAY_CANNOT_CONNECT_TXT$");break;case 0x05:return("$GATEWAY_RUNNING_TRIAL_TXT$");break;case 0x09:return("$GATEWAY_RUNNING_NEAR_TRIAL_END_TXT$");break;case 0x10:return("$GATEWAY_TRIAL_EXPIRED_TXT$");break;case 0x21:return("$GATEWAY_RUNNING_NEAR_UPDATE_END_TXT$");break;case 0x41:return("$GATEWAY_RUNNING_UPDATE_EXPIRED_TXT$");break;case 0x80:return("$DISABLED$");break;default:return("$GATEWAY_NO_CONNECTION_ATTEMPT_TXT$");break;}}function OnGatewayEditContextMenu(objGrid){if(objGrid.getSelectedRows().length==1){sMenuItemName="$EDIT_BUTTON$...";}else{sMenuItemName="";}return(sMenuItemName);}function OnGatewayDeleteContextMenu(objGrid){if(objGrid.getSelectedRows().length>0){sMenuItemName="$DELETE_BUTTON$";}else{sMenuItemName="";}return(sMenuItemName);}function OnEnableDisableGateway(bEnable){var EditCells=new Array();EditCells=GatewayList.getSelectedRows().toString().split(",");var GatewayEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(GatewayList.getCellData((GatewayList.m_nNumColumns-1),EditCells[nIndex]));GatewayEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Gateway."+nObjectID+"&StaticOnly=1");GatewayEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;GatewayEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;GatewayEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);GatewayEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};GatewayEnabledDisabledRequest[nIndex].request(null);}}function OnEnableGatewayContextMenu(){if(GatewayEnableOrDisable()[1]&&GatewayList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_GATEWAY$";else sMenuItemName="";return(sMenuItemName);}function OnDisableGatewayContextMenu(){if(GatewayEnableOrDisable()[0]&&GatewayList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_GATEWAY$";else sMenuItemName="";return(sMenuItemName);}function OnEnableGatewayContextImage(){if(GatewayEnableOrDisable()[1])sImageClass="GatewayEnabled";else sImageClass="";return(sImageClass);}function OnDisableGatewayContextImage(){if(GatewayEnableOrDisable()[0])sImageClass="GatewayDisabled";else sImageClass="";return(sImageClass);}function GatewayEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=GatewayList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(GatewayList.getCellData(2,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}function OnGatewayMoreInfo(){window.open("http://www.Serv-U.com/Gateway/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP","_Info","noopener");}var sOnEditGateway=String("OnEditGateway(");var sOnAddGateway=String("OnAddGateway(");var sOnRemoveGateway=String("OnRemoveGateway(");var sOnGatewayProperties=String("OnGatewayProperties(false,");var sOnGatewayEnable=String("OnEnableDisableGateway(1,");var sOnGatewayDisable=String("OnEnableDisableGateway(0,");CreateContextMenu([sOnAddGateway,sOnEditGateway,sOnRemoveGateway,"",sOnGatewayProperties,sOnGatewayEnable,sOnGatewayDisable],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(GatewayList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(GatewayList,"$DELETE_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(GatewayList,g_sMenuDividers))},function(){return(OnEqualOneContextMenu(GatewayList,"$PROPERTIES$..."))},OnEnableGatewayContextMenu,OnDisableGatewayContextMenu],["New","Edit","FileDelete","","Properties",OnEnableGatewayContextImage,OnDisableGatewayContextImage],GatewayList,"GatewayListContext",true);</script></div><div id="Database" style="display:none;"><div class="layercontent"><div class="ie6positionfix"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$DATABASE$" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32"/></td><td style="vertical-align:top;">$DATABASE_INFO$</td></tr></table><div style="height:250px"><form name="ODBC" onsubmit="return (false);"><div id="DatabaseTabContent"><div id="DataSourceGroup"><div style="float:left;width:225px;">$ODBC_SOURCE$:<br/><div style="overflow:auto"><span id="ODBCSource"></span></div>$ODBC_ACCOUNT$:<br/><div style="overflow:auto"><span id="ODBCAccount"></span></div>$ODBC_PASSWORD$:<br/><div style="overflow:auto"><span id="ODBCPassword"></span></div><br /></div><div style="float:left;width:225px;padding-top:5px;"><span id="ODBCAutoCreateTables"></span><br /><span id="ODBCAutoCreateColumns"></span><br /><span id="ODBCEditSQLTemplates" style="position:relative;top:5px;"></span><br /><span id="ODBCSaveButton" style="position:relative;top:10px;"></span> <span id="ODBCHelpButton" style="position:relative;top:10px;margin-left:5px;"></span></div></div><div style="padding-top:15px;clear:both;">$ODBC_COLUMN_MAPPING_INFO$<br /><br /><span id="ODBCMapUserColumns"></span><span id="ODBCMapGroupColumns"></span></div></div><div style="text-align:center;" id="DatabaseTabContentContainer"><div id="DatabaseTabContentNone" class="UpgradeLicenseMsg"><img id="DatabaseTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="DatabaseTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></form><script type="text/javascript" language="JavaScript">CreateGroupBox("$DATA_SOURCE_GROUP$","DataSourceGroup","550px","150px");var ODBCSourceInput=CreateInputField("%CServer.%SERVER_ID%.ODBCSource%","ODBCSource","ODBCSource","",180,undefined,undefined,OnSaveODBCSettings);CreateInputField("%CServer.%SERVER_ID%.ODBCAccount%","ODBCAccount","ODBCAccount","",180,undefined,undefined,OnSaveODBCSettings);var databasePasswordField=CreatePasswordField("%CServer.%SERVER_ID%.ODBCPassword%","ODBCPassword","ODBCPassword","",180,undefined,undefined,OnSaveODBCSettings);setTimeout(function(){initPasswordTypeToggler(databasePasswordField,"ODBCPassword");});CreateCheckBox("$ODBC_AUTO_CREATE_TABLES$","ODBCAutoCreateTables","ODBCAutoCreateTables",%CServer.%SERVER_ID%.ODBCAutoCreateTables%,OnCheckBoxValueChanged);CreateCheckBox("$ODBC_AUTO_CREATE_COLUMNS$","ODBCAutoCreateColumns","ODBCAutoCreateColumns",%CServer.%SERVER_ID%.ODBCAutoCreateColumns%,OnCheckBoxValueChanged);CreatePushButton("$SAVE_BUTTON$","ODBCSaveButton",OnSaveODBCSettings);CreatePushButton("$ODBC_EDIT_SQL_TEMPLATES$...","ODBCEditSQLTemplates",OnEditSQLTemplates);CreatePushButton("$HELP_BUTTON$","ODBCHelpButton",OnODBCHelp);CreatePushButton("$ODBC_MAP_USER_COLUMNS$...","ODBCMapUserColumns",OnMapUserColumns);CreatePushButton("$ODBC_MAP_GROUP_COLUMNS$...","ODBCMapGroupColumns",OnMapGroupColumns);if("%CServer.%SERVER_ID%.ODBCLicense%"!="1")DisableTab("DatabaseTabContent");function OnSaveODBCSettings(){var SaveODBCRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Server.%SERVER_ID%&StaticOnly=1");SavingDialog(true);SaveODBCRequest.setParameter("ODBCSource",document.ODBC.ODBCSource.value);SaveODBCRequest.setParameter("ODBCAccount",document.ODBC.ODBCAccount.value);SaveODBCRequest.setParameter("ODBCPassword",document.ODBC.ODBCPassword.value);SaveODBCRequest.response=function(){var nResult=OnSaveComplete(this);if((nResult==0)&&(ODBCSourceInput.getControlText()!="")&&("Server"=="Domain"))createCookie("domainodbc",1,1);else createCookie("domainodbc",0,1);};SaveODBCRequest.request(null);return(false);}function OnEditSQLTemplates(){ShowDialog("SQLTemplateDialog");}function OnCheckBoxValueChanged(CheckBox){CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Server.%SERVER_ID%&StaticOnly=1");}function OnMapUserColumns(){InitDatabaseDialog(true);ShowDialog("DatabaseDialog");}function OnMapGroupColumns(){InitDatabaseDialog(false);ShowDialog("DatabaseDialog");}function OnODBCHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-Database-Access.htm",sExpandNode);}</script></div></div></div></div><div id="Events" style="display:none"><div id="EventsLayer" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$EVENTS$" src="%ADMIN_FILE%Images/Command32.png" width="32" height="32" class="header-icon" />$EVENTS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="EventsTabContent"><span id="EventsList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="ConfigSMTPButton" style="float:right;"></span><span id="AddEventButton"></span><span id="EditEventButton"></span><span id="RemoveEventButton"></span>&nbsp;&nbsp;&nbsp;<span id="CommonEventButton"></span><span id="TestEventButton"></span></div></div><div style="text-align:center;" id="EventsTabContentContainer"><div id="EventsTabContentNone" class="UpgradeLicenseMsg"><img id="EventsTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="EventsTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><script type="text/javascript" language="JavaScript">var g_sEventNameColumn="$NAME$";var g_sEventDescriptionColumn="$DESCRIPTION$";var g_sEventTypeColumn="$EVENT_TYPE$";var g_sEventActionColumn="$EVENTS_ACTION_LABEL$";var g_asEventColWidth=[180,180,180,180];var g_bEventSavingObj=false;var g_sEventRuleVar="$EVENTS_RULE_VAR$";var g_sEventRuleConstant="$EVENTS_RULE_CONSTANT$";var g_sEventRuleComp="$EVENTS_RULE_COMP$";var g_sEventRuleDataType="$EVENTS_RULE_DATA_TYPE$";var g_sRuleIf="$IF$";var g_sAND="$AND$";var g_sOR="$OR$";function GetEventIDText(nEventType){var asEvents={1:"$SUEVENT_ID_SERVER_START_TEXT$",2:"$SUEVENT_ID_SERVER_STOP_TEXT$",3:"$SUEVENT_ID_SECURITY_ALERT_TEXT$",100:"$SUEVENT_ID_DOMAIN_START_TEXT$",101:"$SUEVENT_ID_DOMAIN_STOP_TEXT$",102:"$SUEVENT_ID_SESSION_CONNECT_TEXT$",103:"$SUEVENT_ID_SESSION_DISCONNECT_TEXT$",104:"$SUEVENT_ID_SESSION_CONNECT_FAILURE_TEXT$",200:"$SUEVENT_ID_USER_LOGIN_TEXT$",201:"$SUEVENT_ID_USER_LOGOUT_TEXT$",202:"$SUEVENT_ID_USER_LOGIN_FAILURE_TEXT$",203:"$SUEVENT_ID_USER_PASSWORD_CHANGE_TEXT$",204:"$SUEVENT_ID_USER_PASSWORD_CHANGE_FAILURE_TEXT$",304:"$SUEVENT_ID_IP_ADDR_AUTO_BLOCKED_TIME_TEXT$",305:"$SUEVENT_ID_SESSION_IDLE_TIMEOUT_TEXT$",306:"$SUEVENT_ID_SESSION_TIMEOUT_TEXT$",205:"$SUEVENT_ID_USER_ENABLED_TEXT$",206:"$SUEVENT_ID_USER_DISABLED_TEXT$",207:"$SUEVENT_ID_USER_DELETED_TEXT$",208:"$SUEVENT_ID_USER_ADDED_TEXT$",209:"$SUEVENT_ID_USER_PASSWORD_RECOVERY_SENT_TEXT$",210:"$SUEVENT_ID_USER_PASSWORD_RECOVERY_FAILED_TEXT$",211:"$SUEVENT_ID_USER_PASSWORD_STALE_TEXT$",212:"$SUEVENT_ID_USER_AUTOMATICALLY_DISABLED_TEXT$",213:"$SUEVENT_ID_USER_AUTOMATICALLY_DELETED_TEXT$",214:"$SUEVENT_ID_USER_PREDISABLE_TEXT$",215:"$SUEVENT_ID_USER_PREDELETE_TEXT$",216:"$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_TEXT$",217:"$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_FAILURE_TEXT$",105:"$SUEVENT_ID_LOG_DELETED_TEXT$",106:"$SUEVENT_ID_LOG_ROTATED_TEXT$",107:"$SUEVENT_ID_LISTENER_SUCCESS_TEXT$",109:"$SUEVENT_ID_LISTENER_FAILURE_TEXT$",108:"$SUEVENT_ID_LISTENER_STOP_TEXT$",110:"$SUEVENT_ID_GATEWAY_LISTENER_SUCCESS_TEXT$",112:"$SUEVENT_ID_GATEWAY_LISTENER_FAILURE_TEXT$",111:"$SUEVENT_ID_GATEWAY_LISTENER_STOP_TEXT$",113:"$SUEVENT_ID_PERM_DATA_LISTENER_SUCCESS_TEXT$",115:"$SUEVENT_ID_PERM_DATA_LISTENER_FAILURE_TEXT$",114:"$SUEVENT_ID_PERM_DATA_LISTENER_STOP_TEXT$",116:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_SUCCESS_TEXT$",118:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_FAILURE_TEXT$",117:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_STOP_TEXT$",300:"$SUEVENT_ID_IP_BLOCKED_TEXT$",301:"$SUEVENT_ID_IP_BLOCKED_TIME_TEXT$",302:"$SUEVENT_ID_TOO_MANY_SESSIONS_TEXT$",303:"$SUEVENT_ID_TOO_MANY_SESSIONS_ON_IP_TEXT$",400:"$SUEVENT_ID_FILE_UPLOAD_TEXT$",401:"$SUEVENT_ID_FILE_UPLOAD_FAIL_TEXT$",402:"$SUEVENT_ID_FILE_DOWNLOAD_TEXT$",403:"$SUEVENT_ID_FILE_DOWNLOAD_FAIL_TEXT$",406:"$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_TEXT$",407:"$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_FAIL_TEXT$",404:"$SUEVENT_ID_FILE_DELETE_TEXT$",405:"$SUEVENT_ID_FILE_MOVE_TEXT$",500:"$SUEVENT_ID_DIR_CREATE_TEXT$",501:"$SUEVENT_ID_DIR_DELETE_TEXT$",502:"$SUEVENT_ID_DIR_CHANGE_TEXT$",503:"$SUEVENT_ID_DIR_MOVE_TEXT$",600:"$SUEVENT_ID_QUOTA_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",119:"$SUEVENT_ID_FILE_MGMT_RULE_SUCCESS_TEXT$",120:"$SUEVENT_ID_FILE_MGMT_RULE_ERROR_TEXT$",121:"$SUEVENT_ID_FILE_MGMT_RULE_MOVE_FILE_TEXT$"};if(asEvents[nEventType])return(asEvents[nEventType]);else return(nEventType);}function GetEventActionText(nActionType){var asActions=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$","$SUEVENT_ACTION_EXEC_TEXT$","$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$","$SUEVENT_ACTION_MSMQ_WRITE_TEXT$"];if(asActions[nActionType])return(asActions[nActionType]);else return(nActionType);}function OnSMTPConfigAlert(){AlertDialog("$SMTP_CONFIG_WARN$");}var bSetEventGridHeight=true;var g_bServerDomain=false;switch(sEventObjectType.toLowerCase()){case"server":case"domain":g_asEventColWidth=[180,180,180,180];bSetEventGridHeight=false;g_bServerDomain=true;break;default:g_asEventColWidth=[120,170,120,130];bSetEventGridHeight=true;break;}var EventsList=CreateEventsGrid("EventsList","ServerEvents.xml?ID=%SERVER_ID%",OnEditEvent,g_asEventColWidth);var sOnEditEvent=String("OnEditEvent(");var sOnAddEvent=String("OnAddEvent(");var sOnDeleteEvent=String("OnRemoveEvent(");var sOnEnableEvent=String("OnEnableDisableEvent(1,");var sOnDisableEvent=String("OnEnableDisableEvent(0,");CreateContextMenu([sOnAddEvent,sOnEditEvent,sOnDeleteEvent,sOnEnableEvent,sOnDisableEvent],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(EventsList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(EventsList,"$DELETE_BUTTON$"))},OnEnableEventContextMenu,OnDisableEventContextMenu],["New","Edit","FileDelete",OnEnableEventContextImage,OnDisableEventContextImage],EventsList,"EventsListContext",true);EventsList.onKeyDelete=OnRemoveEvent;if(bSetEventGridHeight){var nEventsListHeight=$EVENTS_LIST_HEIGHT$;if(AW.unix)nEventsListHeight=(nEventsListHeight-5);EventsList.setStyle("height",nEventsListHeight+"px");}CreatePushButton("$ADD_BUTTON$...","AddEventButton",OnAddEvent);CreatePushButton("$EDIT_BUTTON$...","EditEventButton",OnEditEvent);CreatePushButton("$DELETE_BUTTON$","RemoveEventButton",OnRemoveEvent);CreatePushButton("$CREATE_COMMON_EVENTS_BUTTON$...","CommonEventButton",OnCreateCommonEvents);CreatePushButton("$TEST_EVENTS_BUTTON$","TestEventButton",OnTestEvent);var fnSMTPConfig=(g_bServerDomain)?OnSMTPConfig:OnSMTPConfigAlert;var SMTPButton=CreatePushButton("$CONFIG_SMTP_BUTTON$...","ConfigSMTPButton",fnSMTPConfig);SMTPButton.setControlImage("SMTP_Icon");if(!g_bServerDomain)SMTPButton.setStyle("display","none");if((parseInt("%CServer.%SERVER_ID%.EventLicense%")!=1)&&(sEventObjectType.toLowerCase()!="server"))DisableTab("EventsTabContent",EventsList);function OnEnableDisableEvent(bEnable){var EditCells=new Array();EditCells=EventsList.getSelectedRows().toString().split(",");var EventEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(EventsList.getCellData((EventsList.m_nNumColumns-1),EditCells[nIndex]));EventEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer."+g_EditObjectID+".SUEvent."+nObjectID+"&StaticOnly=1");EventEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;EventEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;EventEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);EventEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};EventEnabledDisabledRequest[nIndex].request(null);}}function OnEnableEventContextMenu(){if(EventEnableOrDisable()[1]&&EventsList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_EVENT$";else sMenuItemName="";return(sMenuItemName);}function OnDisableEventContextMenu(){if(EventEnableOrDisable()[0]&&EventsList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_EVENT$";else sMenuItemName="";return(sMenuItemName);}function OnEnableEventContextImage(){if(EventEnableOrDisable()[1])sImageClass="LSTNEnabled";else sImageClass="";return(sImageClass);}function OnDisableEventContextImage(){if(EventEnableOrDisable()[0])sImageClass="LSTNDisabled";else sImageClass="";return(sImageClass);}function EventEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=EventsList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(EventsList.getCellText(9,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}function OnAddEvent(){g_bEventSavingObj=false;EventsList.OnAddObject("Event.xml%ADD_OBJECT_REF%CServer."+g_EditObjectID+".SUEvent&Temp=1","Result.xml%UPDATE_OBJECT_REF%CServer."+g_EditObjectID+".SUEvent.",document.EventsForm,"EventsDialog",[OnEventLoad,OnHideEventsDialog],g_bReadOnlyAccess);}function OnEditEvent(){g_bEventSavingObj=false;EventsList.OnEditObject("Event.xml?Command=CreateTempObject&Object=CServer."+g_EditObjectID+".SUEvent.","Result.xml%UPDATE_OBJECT_REF%CServer."+g_EditObjectID+".SUEvent.",document.EventsForm,"EventsDialog","$SELECT_ONLY_ONE_EVENT_EDIT$","$SELECT_ONE_EVENT_EDIT$",[OnEventLoad,OnHideEventsDialog],true);}function OnRemoveEvent(){EventsList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CServer."+g_EditObjectID+".SUEvent&ID=%ID%","$ASK_DELETE_EVENT$","$SELECT_ONE_EVENT_DELETE$");}function OnViewLog(){OnShowLogDialog();}function OnTestEvent(){if((EventsList.getSelectedRows()!="")&&(EventsList.getSelectedRows()!=-1)){var TestCells=new Array();TestCells=EventsList.getSelectedRows().toString().split(",");if(TestCells.length==1){nTestObjectID=parseInt(EventsList.getCellData((EventsList.m_nNumColumns-1),TestCells[0]));var sTestEventsCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CSUEvent."+nTestObjectID+".Test";var TestEventsRequest=CreatePostRequest(sTestEventsCmd);TestEventsRequest.setAsync(true);TestEventsRequest.request();TestEventsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else{AlertDialog("$EVENT_DISPATCHED_SUCCESS$",undefined,undefined,undefined,"$VIEW_LOG$",OnViewLog);}};}else WarnDialog("$SELECT_ONLY_ONE_EVENT_TEST$");}else WarnDialog("$SELECT_ONE_EVENT_TEST$");}</script></div><div id="License" style="display:none;"><div class="layercontent"><table cellpadding="0" cellspacing="0" style="padding-bottom:5px;"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$LICENSE$" src="%ADMIN_FILE%Images/SU32.png" width="32" height="32"/></td><td style="vertical-align:top;">$LICENSE_INFO$<span id="LicenseInfoTextTrial" style="diplay:none;">$LICENSE_INFO_TRIAL$</span><span id="LicenseInfoTextRegistered" style="diplay:none;">$LICENSE_INFO_REGISTERED$</span></td></tr></table><div class="ie6positionfix"><div style="width:auto; float:left;padding-bottom:5px;margin-right:10px"><div id="ReggieInfo"><div id="ReggieLabels" style="float:left;width:120px;">$REGGIE_NAME$:<br />$REGGIE_EMAIL$:<br />$REGGIE_EDITION$:<br />$REGGIE_COPIES$:<br />$REGGIE_DATE$:<br />$REGGIE_UPDATES$:<br /></div><div id="ReggieData" style="float:left;width:355px;"><span id="ReggieName" style="font-weight:bold;"></span><br /><span id="ReggieEmail" style="font-weight:bold;"></span><br /><span id="ReggieEdition" style="font-weight:bold;"></span><br /><span id="ReggieCopies" style="font-weight:bold;"></span><br /><span id="ReggieDate" style="font-weight:bold;"></span><br /><span id="ReggieUpdates" style="font-weight:bold;"></span><br /></div><div style="clear:left;text-align:right;padding-right:10px;"><span id="ExpireNoticeButton"></span></div></div></div><div style="width:auto;float:left;padding-bottom:5px;"><div id="AdditionalProductInfo"><div id="Productabels-GW" style="float:left;width:auto;line-height:20px;padding-right:2px;"><strong>$GATEWAY$</strong>:</div>
<div id="ProductData-GW" style="float:left;width:auto;line-height:20px;"><span id="EditionGateway"></span></div><div id="UpgradeGWData" style="float:left;width:auto;line-height:20px;"><div id="UpgradeGateway" style="height:20px;line-height:20px;white-space: nowrap;"></div></div><div style="clear:left;"><a href="%GATEWAY_HOME%" target="_blank" rel="noopener noreferrer"><img src="%ADMIN_FILE%Images/Gateway32.png" border="0" width="32" height="32" style="float:left;margin:0 5px 10px 0;"/></a>$GATEWAY_PRODUCT_INFO$</div><div style="clear:both;"></div></div></div><div style="clear:left;"><div id="EditionInfo" style="float:left;clear:left;"><table cellpadding="0" cellspacing="0"><tr><td style=""></td><td id="EditionName-Current" style="vertical-align:bottom;text-align:center;display:none;width:100px;"><img id="EditionArrow-Current" src="%COMMON_FILE%Images/blank.gif" border="0" width="24" height="24" alt="" /><div style="background:#a0c4dc;color:#5a5a57;"><strong><span id="EditionChartName"></span></strong></div></td><td style="vertical-align:bottom;text-align:center;width:100px;"><img id="EditionArrow-FTPEdition" src="%COMMON_FILE%Images/blank.gif" border="0" width="24" height="24" alt="$REGGIE_FTP_EDITION$"/><div style="background:URL(%COMMON_FILE%Images/Silver-BG-Grad.png) repeat-x bottom left;color:#5a5a57;"><strong>$REGGIE_FTP_EDITION$</strong></div></td><td style="vertical-align:bottom;text-align:center;width:100px;"><img id="EditionArrow-MFTEdition" src="%COMMON_FILE%Images/blank.gif" border="0" width="24" height="24" alt="$REGGIE_MFT_EDITION$"/><div style="background:URL(%COMMON_FILE%Images/Platinum-BG-Grad.png) repeat-x bottom left;color:#5a5a57;"><strong>$REGGIE_MFT_EDITION$</strong></div></td></tr><tr><td style="text-align:right;white-space:nowrap;"><div id="EditionLabels" style="line-height:16px;white-space:nowrap;"><div class="EditionSection">$EDITION_MAX_USAGE_SECTION$</div><div>$EDITION_MAX_DOMAINS$ <span id="TotalDomainsUsed">(<strong>$USING$ %CServer.%SERVER_ID%.TotalDomains%</strong>)</span></div><div>$EDITION_MAX_USER$ <span id="TotalUsersUsed"></span></div><div>$EDITION_MAX_SESSIONS$ <span id="TotalSessionsUsed">(<strong>$USING$ %CServer.%SERVER_ID%.SessionCount%</strong>)</span></div><div class="EditionSection">$EDITION_CAPABILITIES_SECTION$</div><div>$EDITION_ACCESS_ANYWHERE$</div><div>$EDITION_VIRTUAL_PATHS$</div><div>$EDITION_QUOTAS$</div><div>$EDITION_RATIOS$</div><div>$EDITION_VIRTUAL_HOSTS$</div><div>$EDITION_FILE_MANAGEMENT$</div><div>$EDITION_EVENTS$</div><div style="height:19px;">$EDITION_MSMQ$<sup>3</sup></div><div>$EDITION_FILE_SHARING$</div><div class="EditionSection">$EDITION_ARCHITECTURE_SECTION$</div><div>Windows/Linux, 32/64-bit</div><div style="height:19px;">$EDITION_GATEWAY$<sup>1</sup></div><div style="height:19px;">$EDITION_HIGH_AVAILABILITY$<sup>2</sup></div><div class="EditionSection">$EDITION_PROTOCOLS_SECTION$</div><div>IPv6 $AND$ IPv4</div><div>$EDITION_ENCRYPTION$</div><div>$EDITION_ENCRYPTION_HTTPS$</div><div>$EDITION_ENCRYPTION_SSH$</div><div>$EDITION_FIPS$</div><div>$EDITION_CA_CERTIFICATE$</div><div class="EditionSection">$EDITION_WEB_MOBILE_SECTION$</div><div>$EDITION_WEB_CLIENT$</div><div>$EDITION_WEB_CLIENT_PRO$</div><div>$EDITION_FVJV$</div><div class="EditionSection">$EDITION_ADMIN_SECTION$</div><div>$EDITION_USER_PASSWORD_RECOVER$</div><div>$EDITION_USER_GROUP_STATS$</div><div>$EDITION_REMOTE_ADMIN$</div><div>$EDITION_REMOTE_ADMIN_IPAD$</div><div class="EditionSection">$EDITION_CUSTOM_INTEGRATION_SECTION$</div><div>$EDITION_CUSTOM_LOGO_TITLE$</div><div>$EDITION_CUSTOM_HTML$</div><div>$EDITION_INTEGRATION_DLL$</div><div>$EDITION_ODBC$</div><div style="height:19px;">$EDITION_WINDOWS_AUTH$<sup>3</sup></div><div class="NoBorders">$EDITION_LDAP_AUTH$</div></div></td><td id="EditionInfo-Current" style="text-align:center;display:none;background:#b7dbf3;"><div id="EditionData-Current" style="text-align:center;line-height:16px;"><div class="EditionSectionFill">&nbsp;</div><div id="EditionMaxDomains"></div><div id="EditionMaxUsers"></div><div id="EditionMaxSessions"></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionAccessAnywhere"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionVirtualPaths"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionQuotas"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionRatios"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionVirtualHosts"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionFileManagement"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionSUEvent"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionMSMQLicense" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionFileSharing"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="Edition64bit"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionGateway" style="line-height:19px;height:19px;"><img style="margin-top:2px;" src="%COMMON_FILE%Images/DollarSign16.png" border="0" width="16" height="16" /></div><div id="EditionHighAvailability" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionIPv6"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionEncryption"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionEncryptionHTTPS"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionEncryptionSSH"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionFIPS"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionCACertificate"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionWebClient"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionWebClientPro"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionFVJVClient"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionUserPasswordRecover"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionUserGroupStats"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionRemoteAdmin"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionRemoteAdminIpad"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionCustomLogo"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionCustomHTML"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionSUIntegrationDLL"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionODBC"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionWindowsAuth" style="line-height:19px;height:19px;"><img style="margin-top:2px;" src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="NoBorders" id="EditionLDAPAuth"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div></div></td><td style="text-align:center; background:URL(%COMMON_FILE%Images/Silver-BG-Grad.png) repeat-x center center"><div id="EditionData-FTPEdition" style="text-align:center;line-height:16px;"><div class="EditionSectionFill">&nbsp;</div><div id="EditionMaxDomains-FTPEdition"></div><div id="EditionMaxUsers-FTPEdition"></div><div id="EditionMaxSessions-FTPEdition"></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionAccessAnywhere-FTPEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionVirtualPaths-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionQuotas-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionRatios-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionVirtualHosts-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFileManagement-FTPEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionSUEvent-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionMSMQLicense-FTPEdition" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFileSharing-FTPEdition"><img src="%COMMON_FILE%Images/blank.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="Edition64bit-FTPEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionGateway-FTPEdition" style="line-height:19px;height:19px;"><img style="margin-top:2px;" src="%COMMON_FILE%Images/DollarSign16.png" border="0" width="16" height="16" /></div><div id="EditionHighAvailability-FTPEdition" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionIPv6-FTPEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionEncryption-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionEncryptionHTTPS-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionEncryptionSSH-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFIPS-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionCACertificate-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionWebClient-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionWebClientPro-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFVJVClient-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionUserPasswordRecover-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionUserGroupStats-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionRemoteAdmin-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionRemoteAdminIpad-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionCustomLogo-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionCustomHTML-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionSUIntegrationDLL-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionODBC-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionWindowsAuth-FTPEdition" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="NoBorders" id="EditionLDAPAuth-FTPEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div></div></td><td style="text-align:center;background:URL(%COMMON_FILE%Images/Platinum-BG-Grad.png) repeat-x center center"><div id="EditionData-MFTEdition" style="text-align:center;line-height:16px;"><div class="EditionSectionFill">&nbsp;</div><div id="EditionMaxDomains-MFTEdition"></div><div id="EditionMaxUsers-MFTEdition"></div><div id="EditionMaxSessions-MFTEdition"></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionAccessAnywhere-MFTEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionVirtualPaths-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionQuotas-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionRatios-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionVirtualHosts-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFileManagement-MFTEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionSUEvent-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionMSMQLicense-MFTEdition" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFileSharing-MFTEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="Edition64bit-MFTEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionGateway-MFTEdition" style="line-height:19px;height:19px;"><img style="margin-top:2px;" src="%COMMON_FILE%Images/DollarSign16.png" border="0" width="16" height="16" /></div><div id="EditionHighAvailability-MFTEdition" style="line-height:19px;height:19px;"><img style="margin-top:2px;" src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionIPv6-MFTEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div id="EditionEncryption-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionEncryptionHTTPS-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionEncryptionSSH-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFIPS-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionCACertificate-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionWebClient-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionWebClientPro-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionFVJVClient-MFTEdition"><img src="%COMMON_FILE%Images/Check16.png" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionUserPasswordRecover-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionUserGroupStats-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionRemoteAdmin-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionRemoteAdminIpad-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="EditionSectionFill">&nbsp;</div><div id="EditionCustomLogo-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionCustomHTML-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionSUIntegrationDLL-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionODBC-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div id="EditionWindowsAuth-MFTEdition" style="line-height:19px;height:19px;"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div><div class="NoBorders" id="EditionLDAPAuth-MFTEdition"><img src="%COMMON_FILE%Images/blank.gif" border="0" width="16" height="16" /></div></div></td></tr></table><div style="margin-top:5px;"><img src="%COMMON_FILE%Images/DollarSign16.png" style="float:left; border="0" width="16" height="16" /> = $EDITON_AVAIL_PURCHASE_INFO$  1 = $EDITON_INSTALL_INFO$  2 = $EDITON_LIC_REQUIRED_INFO$	 3 = $EDITON_WIN_ONLY_INFO$</div></div></div><!--div style="float:left;width:150px;"><img id="FIPSImage" alt="$EDITION_FIPS$" src="%ADMIN_FILE%Images/FIPSDisabled.png"/><div style="display:none" id="FIPS-Div"><span id="EnableFIPS"></span></div></div--></div></div><div style="padding-top:10px;clear:left;"><span id="RegisterButton"></span>&nbsp;<span id="LostIDButton"></span>&nbsp;<span id="PurchaseButton"></span>&nbsp;<span id="UpdatePurchaseButton"></span>&nbsp;&nbsp;&nbsp;&nbsp;<!--<span id="ParkLicenseButton"></span>&nbsp;&nbsp;<span id="SyncLicenseButton"></span>--></div></div><div id="ProgramInfo" style="display:none;"><div class="layercontent"><table cellpadding="0" cellspacing="0" style="padding-bottom:5px;"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$PROGRAM_INFO$" src="%ADMIN_FILE%Images/SU32.png" width="32" height="32"/></td><td style="vertical-align:top;"><div style="float:left;width:205px;"><strong>%PRODUCT% $FILE_SERVER$<span id="SUBitVersion"></span></strong><br /><strong>$VERSION$ %VERSION%</strong></div></td></tr></table><div class="ie6positionfix"><div style="float:left;width:410px;margin-right:10px;"><div id="DateInfoGroup"><div><div style="float:left;width:105px;">$BUILD_DATE$:<br />$INSTALL_DATE$:</div><div style="float:left;width:270px;"><strong><span id="BuildDate"></span></strong><br /><strong><span id="InstallDate"></span></strong></div><div style="height:1px;overflow:hidden;clear:both;">&nbsp;</div></div><div style="clear:left;margin-right:5px;"><hr style="height:1px;" /><div style="margin-top:5px; float:left;width:$OS_INFO_WIDTH$px;"><span id="OSName-label">$OS_NAME$:<br /></span><span id="OSVer-label">$VERSION$:<br /></span><span id="OSServicePack-label">$OS_SERVICE_PACK_NAME$:</span></div><div style="margin-top:5px;float:left;width:185px;"><strong><span id="OSName"></span></strong><br /><strong><span id="OSVer"></span></strong><br /><strong><span id="OSServicePack"></span></strong></div><div id="OSLogo" style="clear:both;padding-left:95px;display:none;"><img id="OSLogoImg" width="200" height="60" src="%COMMON_FILE%Images/blank.gif" border="0" /></div></div></div><br /><div id="DevelopmentInfoGroup"><div style="float:left;width:100px;">$DEVELOPED_BY$:<br /></div><div style="float:left;width:275px;"><a href="%COMPANY_URL_HOME%" target="_blank" rel="noopener noreferrer">%COMPANY_NAME%</a><br /></div><div style="clear:left;">&#169; %COPYRIGHT_END_YEAR% %COMPANY_NAME_FORMAL% $ALL_RIGHTS_RESERVED$</div></div><br /></div><div style="float:left;width:410px;padding-bottom:10px;"><div id="ContactInfoGroup"><div style="float:left;width:150px;"><div style="height:15px;">SolarWinds</div><div style="clear:both;margin-top: 12px;"></div><a href="%COMPANY_URL_HOME%" target="_blank" rel="noopener noreferrer">www.SolarWinds.com</a><div style="padding-top:5px;"><a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer"><img src="%COMMON_FILE%Images/130x33_RS_new24.png" border="0" width="130" height="33"/></a></div></div></div><br /><div id="LegalInfoGroup">$LEGAL_INFORMATION$</div></div><div style="clear:both;"></div></div></div></div><div id="ServerIdentity" style="display:none;min-height:200px;padding-bottom:10px;"><div><img alt="$PROGRAM_INFO$" src="%ADMIN_FILE%Images/SU32.png" width="32" height="32" style="float:left;padding-right:5px;"/><span>$IDENTITY_INFO$</span></div><div class="layercontent"><div class="ie6positionfix"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;"><fieldset style="padding: 2px 250px 25px 35px;"><legend style="font-weight:bold;">$SERVER_IDENTITY$</legend><div style="padding-bottom:3px;"><span style="font-weight:bold;">$IDENTITY$:&nbsp</span><strong><span id="IdentityStatus"></span></strong></div><div><img alt="Encryption" src="/Admin/Images/Encryption.png" width="32" height="32" style="float:left;"/><div style="float:left;margin-left:10px;padding-top:10px;"><strong><span id="IdentityInfo"></span></strong><br/></div></div></fieldset></td></tr><tr id="CreateSIRow"><td style="vertical-align:top; padding-top:20px;"><fieldset style="padding: 55px 250px 55px 35px;"><legend style="font-weight:bold;">$CREATE_SERVER_IDENTITY$</legend><div style="display:inline-block;float:left;padding-top:3px;width:21%;"><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" id="CreateSIButton" style="margin-left:4px;padding-left:0px;" onclick="javascript:OnCreateServerIdentity()"><span style="display:inline-block;float:left;width:20px;height:20px;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><path d="M200,224H56a8,8,0,0,1-8-8V40a8,8,0,0,1,8-8h96l56,56V216A8,8,0,0,1,200,224Z" fill="#B490CA" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"></path><polyline points="148 32 148 92 208 92" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"></polyline><line x1="104" y1="152" x2="152" y2="152" fill="none" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"></line><line x1="128" y1="128" x2="128" y2="176" fill="#B490CA" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"></line></svg></span><span style="display:inline-block;float:left;padding-top:5px;">$CREATE_SI_BUTTON$</span></button></div><div style="display:inline-block;float:left;width:79%;"><span>$CREATE_INFO$</span></div></fieldset></td></tr><tr id="ExportSIRow"><td style="vertical-align:top;padding-top:20px;"><fieldset style="padding: 55px 250px 55px 35px;"><legend style="font-weight:bold;">$EXPORT_SERVER_IDENTITY$</legend><div style="display:inline-block;float:left;padding-top:3px;width:21%;"><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" id="ExportSIButton" style="margin-left:4px;" onclick="javascript:showExportSIDialog()"><span class="button_img aw-image-Export"></span><span>$EXPORT_SI_BUTTON$</span></button></div><div style="display:inline-block;float:left;width:79%;"><span>$EXPORT_INFO$</span></div></fieldset></td></tr><tr id="ImportSIRow"><td style="vertical-align:top;padding-top:20px;"><fieldset style="padding: 55px 250px 55px 35px;"><legend style="font-weight:bold;">$IMPORT_SERVER_IDENTITY$</legend><div style="display:inline-block;float:left;padding-top:3px;width:21%;"><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" id="ImportSIButton" style="margin-left:4px;" onclick="javascript:showImportSIDialog()"><span class="button_img aw-image-Import"></span><span>$IMPORT_SI_BUTTON$</span></button></div><div style="display:inline-block;float:left;width:79%;"><span>$IMPORT_INFO$</span></div></fieldset></td></tr><tr id="ServerIdentityButtons"><td><div style="padding-top: 10px;"><span id="MoreInfoServerIdentityButton" style="float:right;"></span></div></td></tr></table></div></div></div></div><script type="text/javascript" language="JavaScript">var g_bLoading=true,g_bLoadShown=false,g_bRegistered=false,g_bShowExpNoticeBubble=true;var g_ReggieQuery=undefined,g_bReggieQueried=false;var g_sUnregistered="$REGGIE_UNREGISTERED$";var g_nCurrentTab;var g_asGatewayInfo;g_sHelpPage="Help-IP-ACL.htm";g_sHelpNode="Item7_3";var aServerMainHelpPages=["Help-IP-ACL.htm","Help-Gateway.htm","Help-Database-Access.htm","Help-Events.htm","Help-License-Details.htm","Help-Prog-Info.htm"];CreateGroupBox("$REGGIE_INFO_GROUP$","ReggieInfo",$EDITION_INFO_GROUP_BOX_WIDTH$,160);CreateGroupBox("$EDITION_INFO_GROUP$","EditionInfo",$EDITION_INFO_GROUP_BOX_WIDTH$,810);CreateGroupBox("$ADDITIONAL_PROD_INFO_GROUP$","AdditionalProductInfo",$EDITION_INFO_GROUP_BOX_WIDTH$,100);CreatePushButton("$ENTER_LICENCE_ID_BUTTON$...","RegisterButton",OnRegister);CreatePushButton("$LOST_ID_BUTTON$...","LostIDButton",OnLostID);var PurchaseButton=CreatePushButton("$PURCHASE_BUTTON$...","PurchaseButton",OnPurchase);var UpdatePurchaseButton=CreatePushButton("$UPGRADE_BUTTON$...","UpdatePurchaseButton",OnUpdate);if(g_ReggieQuery=createAWHttpRequest("GET",(g_sAdminXMLPath+"LicenseInfo.xml"),OnReggieQueryDone))g_ReggieQuery.request();function OnParkLicense(){if(g_ReggieQuery=createAWHttpRequest("GET",("%ADMIN_FILE%XML/LicenseInfo.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.ParkLicense"),OnReggieQueryDone)){g_ReggieQuery.request();}}function OnSyncLicense(){if(g_ReggieQuery=createAWHttpRequest("GET",("%ADMIN_FILE%XML/LicenseInfo.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.SyncLicense"),OnReggieQueryDone)){g_ReggieQuery.request();}}function GetGatewayLicenses(){var objGetGateways=createAWHttpRequest("GET","%ADMIN_FILE%XML/Gateways.xml?ForceList=1",function(){var xmlDoc=this.getResponseXML();var aoElements=xmlDoc.getElementsByTagName("gateway");var aoEnabledElements=xmlDoc.getElementsByTagName("Enabled");var aoStatusElements=xmlDoc.getElementsByTagName("Status");var nEnabledGW=0;var nTrialGW=0;var bHaveTrial=false;var sGWEditionColor="green";var sOnUpdateGW=String("OnUpdateGW(");var sOnApplyGWLicense=String("OnApplyGWLicense(");g_asGatewayInfo=[];for(var i=0;i<aoElements.length;i++){if(parseInt(aoEnabledElements[i].childNodes[0].nodeValue)){nEnabledGW++;switch(parseInt(aoStatusElements[i].childNodes[0].nodeValue)){case 0x05:case 0x09:case 0x10:nTrialGW++;break;}}}if(nEnabledGW>0){sGWEditionType=nEnabledGW+" $EDITION_ENABLED$";sGWPurchaseLink="&nbsp;  (\<a href=\"javascript:"+sOnUpdateGW+"1);\">$PURCHASE_MORE$<\/a>";if(nTrialGW>0){bHaveTrial=true;sGWPurchaseLink="&nbsp;  (\<a href=\"javascript:"+sOnUpdateGW+"1);\">$PURCHASE_BUTTON$<\/a>";}if(nEnabledGW>nTrialGW)sGWPurchaseLink+=" - \<a href=\"javascript:"+sOnUpdateGW+"0);\">$RENEW_LICENSE$<\/a> - \<a href=\"javascript:"+sOnApplyGWLicense+");\">$APPLY_LICENSE$<\/a>) ";else sGWPurchaseLink+=" - \<a href=\"javascript:"+sOnApplyGWLicense+");\">$APPLY_LICENSE$<\/a>) ";}else{sGWEditionType="$EDITION_DISABLED$";sGWEditionColor="red";sGWPurchaseLink="&nbsp;  (\<a href=\"javascript:"+sOnUpdateGW+"2);\">$PURCHASE_BUTTON$ - \<a href=\"javascript:"+sOnApplyGWLicense+");\">$APPLY_LICENSE$<\/a><\/a>)";}document.getElementById("EditionGateway").style.color=sGWEditionColor;document.getElementById("EditionGateway").innerHTML=sGWEditionType;document.getElementById("UpgradeGateway").innerHTML=sGWPurchaseLink;});if(objGetGateways)objGetGateways.request();}function OnReggieQueryDone(xmlDoc){var nDaysRemaining=0;if(xmlDoc==undefined)xmlDoc=this.getResponseXML();if(xmlDoc){if(GetXMLValueInt(xmlDoc,"IsRegistered")){var asReggieInfo=[];var bIsTempID=GetXMLValueInt(xmlDoc,"LicenseIsTemp");var sTemp=(bIsTempID)?" ($REGGIE_TEMP$)":"";var sLicenseName=(GetXMLValue(xmlDoc,"LicenseName"))?GetXMLValue(xmlDoc,"LicenseName"):"";var sLicenseEmail=(GetXMLValue(xmlDoc,"LicenseEMail"))?GetXMLValue(xmlDoc,"LicenseEMail"):"";if(bIsTempID)ShowHideTrialNotification(true);else ShowHideTrialNotification(false);g_bRegistered=true;asReggieInfo.push(sLicenseName);asReggieInfo.push(sLicenseEmail);g_sLicenseEmail=asReggieInfo[1];if(GetXMLValueInt(xmlDoc,"IsFTPEdition"))asReggieInfo.push("$REGGIE_FTP_EDITION$"+sTemp);else if(GetXMLValueInt(xmlDoc,"IsMFTEdition"))asReggieInfo.push("$REGGIE_MFT_EDITION$"+sTemp);if(GetXMLValueInt(xmlDoc,"LicenseIsSite"))asReggieInfo.push("$REGGIE_SITE$");else if(GetXMLValueInt(xmlDoc,"LicenseIsDepartment"))asReggieInfo.push("$REGGIE_DEPT$");else if(GetXMLValueInt(xmlDoc,"LicenseIsEnterprise"))asReggieInfo.push("$REGGIE_ENT$");else asReggieInfo.push(GetXMLValue(xmlDoc,"LicenseCopies"));var ReggieDate=new Date(GetXMLValueInt(xmlDoc,"LicenseTime")*1000);asReggieInfo.push(ReggieDate.toLocaleDateString());var bLicenseFreeForLife=GetXMLValueInt(xmlDoc,"LicenseFreeForLife");if(bLicenseFreeForLife){asReggieInfo.push("$REGGIE_FREE_FOR_LIFE$");if(!GetXMLValueInt(xmlDoc,"LicenseFVJV"))g_bShowExpNoticeBubble=false;}var nLicenseDays=GetXMLValueInt(xmlDoc,"LicenseDays");g_bLicenseNeedUpdate=false;if(nLicenseDays!=0){var UpgradeDate=new Date(ReggieDate.getTime()+(nLicenseDays*86400000));nDaysRemaining=GetXMLValue(xmlDoc,"LicenseDaysRemaining");asReggieInfo.push("$REGGIE_EXPIRE$ "+UpgradeDate.toLocaleDateString()+" ("+nDaysRemaining+" $REGGIE_DAYS_REMAIN$)");ShowMaintenenceInfoBox(parseInt(nDaysRemaining),parseInt(nLicenseDays),ReggieDate);if(nDaysRemaining<=90){g_bLicenseNeedUpdate=true;document.getElementById("ReggieInfoFS").style.height="140px";document.getElementById("AdditionalProductInfoFS").style.height="140px";CreatePushButton("$PURCHASE_UPDATE$...","ExpireNoticeButton",OnUpdate);g_bReggieQueried=true;if(g_nCurrentTab==4)setTimeout("OnShowExpireNoticeBubble()",0);}}LoadReggieInfo(asReggieInfo);document.getElementById("LicenseInfoTextTrial").style.display='none';document.getElementById("LicenseInfoTextRegistered").style.display='';UpdatePurchaseButton.setStyle("display","");PurchaseButton.setStyle("display","none");}else{if(GetXMLValueInt(xmlDoc,"LicenseIsPastTrial"))
LoadReggieInfo([g_sUnregistered,g_sUnregistered,"$REGGIE_TRIAL_EXPIRED$","1","$REGGIE_TRIAL_EXPIRED$","$REGGIE_TRIAL_EXPIRED$"]);else{var sDaysRemain=GetXMLValue(xmlDoc,"LicenseDaysRemaining")+" $REGGIE_DAYS_REMAIN$";LoadReggieInfo([g_sUnregistered,g_sUnregistered,"$REGGIE_TRIAL$","1",sDaysRemain,sDaysRemain]);}ShowHideTrialNotification(true);$("#MaintContain").hide();g_bRegistered=false;PurchaseButton.setStyle("display","");document.getElementById("LicenseInfoTextTrial").style.display='';document.getElementById("LicenseInfoTextRegistered").style.display='none';UpdatePurchaseButton.setStyle("display","none");}LoadEditionInfo(xmlDoc);}g_bLoading=false;if(g_bLoadShown)LoadingDialog(g_bLoadShown=false);}function GetEditionData(){var sEditionsCmd=g_sAdminXMLPath+"EditionInfo.xml?"+SyncRequestParameter();var EditionsTable=new AW.XML.Table;var aEdition=new Array();var aEditionCols=["FTPSLicense","CACertLicense","SSHLicense","RemoteAdminLicense","ODBCLicense","WinAuthLicense","VirtualPathsLicense","VirtualHostsLicense","QuotaLicense","ULDLRatioLicense","CustomLogoLicense","UserGroupStatsLicense","EventLicense","MaxDomainsLicense","MaxUsersLicense","MaxSessionsLicense","WebClientLicense","HTTPSLicense","FIPSLicense","PasswordRecovery","IntegrationDLLLicense","WebClientProLicense","CustomHTMLLicense","BrandingRemovalLicense","MSMQLicense","LDAPAuthLicense","FileSharingLicense"];EditionsTable.setURL(sEditionsCmd);EditionsTable.setRows("//Editions/*");EditionsTable.setColumns(aEditionCols);EditionsTable.response1=EditionsTable.response;EditionsTable.response=function(data){this.response1(data);nTotalEditions=this.getCount();for(row=0;row<nTotalEditions;row++){nFTPSLicense=this.getData(0,row);nCACertLicense=this.getData(1,row);nSSHLicense=this.getData(2,row);nRemoteAdminLicense=this.getData(3,row);nODBCLicense=this.getData(4,row);nWinAuthLicense=this.getData(5,row);nVirtualPathsLicense=this.getData(6,row);nVirtualHostsLicense=this.getData(7,row);nQuotaLicense=this.getData(8,row);nULDLRatioLicense=this.getData(9,row);nCustomLogoLicense=this.getData(10,row);nUserGroupStatsLicense=this.getData(11,row);nEventLicense=this.getData(12,row);nMaxDomainsLicense=this.getData(13,row);nMaxUsersLicense=this.getData(14,row);nMaxSessionsLicense=this.getData(15,row);nWebClientLicense=this.getData(16,row);nHTTPSLicense=this.getData(17,row);nFIPSLicense=this.getData(18,row);nPasswordRecovery=this.getData(19,row);nIntegrationDLLLicense=this.getData(20,row);nWebClientProLicense=this.getData(21,row);nCustomHTMLLicense=this.getData(22,row);nBrandingRemovalLicense=0;nMSMQLicense=this.getData(24,row);nLDAPAuthLicense=this.getData(25,row);nFileSharingLicense=this.getData(26,row);aEdition[row]=new EditionsInfo(nFTPSLicense,nCACertLicense,nSSHLicense,nRemoteAdminLicense,nODBCLicense,nWinAuthLicense,nVirtualPathsLicense,nVirtualHostsLicense,nQuotaLicense,nULDLRatioLicense,nCustomLogoLicense,nUserGroupStatsLicense,nEventLicense,nMaxDomainsLicense,nMaxUsersLicense,nMaxSessionsLicense,nWebClientLicense,nHTTPSLicense,nFIPSLicense,nPasswordRecovery,nIntegrationDLLLicense,nWebClientProLicense,nCustomHTMLLicense,nBrandingRemovalLicense,nMSMQLicense,nLDAPAuthLicense,nFileSharingLicense);}SetEditonChart(aEdition[0],"FTPEdition");SetEditonChart(aEdition[1],"MFTEdition");};EditionsTable.request();}function LoadReggieInfo(asInfo){document.getElementById("ReggieName").innerHTML=asInfo[0];document.getElementById("ReggieEmail").innerHTML=asInfo[1];document.getElementById("ReggieEdition").innerHTML=asInfo[2];document.getElementById("EditionChartName").innerHTML=asInfo[2];document.getElementById("ReggieCopies").innerHTML=asInfo[3];document.getElementById("ReggieDate").innerHTML=asInfo[4];document.getElementById("ReggieUpdates").innerHTML=asInfo[5];}function LoadEditionInfo(xmlDoc){var sEnabled="%COMMON_FILE%Images/Check16.png",sDisabled="%COMMON_FILE%Images/blank.gif",sUnlimited="$EDITION_UNLIMITED$",sTrial="$REGGIE_TRIAL$";var nMaxDomains=GetXMLValueInt(xmlDoc,"MaxDomainsLicense"),nMaxUsers=GetXMLValueInt(xmlDoc,"MaxUsersLicense"),nMaxSessions=GetXMLValueInt(xmlDoc,"MaxSessionsLicense");g_MaxUserLicense=nMaxUsers;if(GetXMLValueInt(xmlDoc,"LicenseIsPastTrial")&&!GetXMLValueInt(xmlDoc,"IsRegistered")){document.getElementById("EditionMaxDomains").innerHTML="0";document.getElementById("EditionMaxUsers").innerHTML="0";document.getElementById("EditionMaxSessions").innerHTML="0";}else{document.getElementById("EditionMaxDomains").innerHTML=(nMaxDomains>0)?String(nMaxDomains):sUnlimited;document.getElementById("EditionMaxUsers").innerHTML=(nMaxUsers>0)?String(nMaxUsers):sUnlimited;document.getElementById("EditionMaxSessions").innerHTML=(nMaxSessions>0)?String(nMaxSessions):sUnlimited;}document.getElementById("EditionEncryption").firstChild.src=GetXMLValueInt(xmlDoc,"FTPSLicense")?sEnabled:sDisabled;document.getElementById("EditionCACertificate").firstChild.src=GetXMLValueInt(xmlDoc,"CACertLicense")?sEnabled:sDisabled;document.getElementById("EditionEncryptionSSH").firstChild.src=GetXMLValueInt(xmlDoc,"SSHLicense")?sEnabled:sDisabled;document.getElementById("EditionRemoteAdmin").firstChild.src=GetXMLValueInt(xmlDoc,"RemoteAdminLicense")?sEnabled:sDisabled;document.getElementById("EditionRemoteAdminIpad").firstChild.src=GetXMLValueInt(xmlDoc,"RemoteAdminLicense")?sEnabled:sDisabled;document.getElementById("EditionODBC").firstChild.src=GetXMLValueInt(xmlDoc,"ODBCLicense")?sEnabled:sDisabled;document.getElementById("EditionWindowsAuth").firstChild.src=GetXMLValueInt(xmlDoc,"WinAuthLicense")?sEnabled:sDisabled;document.getElementById("EditionLDAPAuth").firstChild.src=GetXMLValueInt(xmlDoc,"LDAPAuthLicense")?sEnabled:sDisabled;document.getElementById("EditionVirtualPaths").firstChild.src=GetXMLValueInt(xmlDoc,"VirtualPathsLicense")?sEnabled:sDisabled;document.getElementById("EditionVirtualHosts").firstChild.src=GetXMLValueInt(xmlDoc,"VirtualHostsLicense")?sEnabled:sDisabled;document.getElementById("EditionQuotas").firstChild.src=GetXMLValueInt(xmlDoc,"QuotaLicense")?sEnabled:sDisabled;document.getElementById("EditionRatios").firstChild.src=GetXMLValueInt(xmlDoc,"ULDLRatioLicense")?sEnabled:sDisabled;document.getElementById("EditionFIPS").firstChild.src=GetXMLValueInt(xmlDoc,"FIPSLicense")?sEnabled:sDisabled;document.getElementById("EditionUserPasswordRecover").firstChild.src=GetXMLValueInt(xmlDoc,"PasswordRecovery")?sEnabled:sDisabled;document.getElementById("EditionCustomLogo").firstChild.src=GetXMLValueInt(xmlDoc,"CustomLogoLicense")?sEnabled:sDisabled;document.getElementById("EditionCustomHTML").firstChild.src=GetXMLValueInt(xmlDoc,"CustomHTMLLicense")?sEnabled:sDisabled;document.getElementById("EditionWebClient").firstChild.src=GetXMLValueInt(xmlDoc,"WebClientLicense")?sEnabled:sDisabled;document.getElementById("EditionWebClientPro").firstChild.src=GetXMLValueInt(xmlDoc,"WebClientProLicense")?sEnabled:sDisabled;document.getElementById("EditionFVJVClient").firstChild.src=GetXMLValueInt(xmlDoc,"AllowFVJV")?sEnabled:sDisabled;document.getElementById("EditionUserGroupStats").firstChild.src=GetXMLValueInt(xmlDoc,"UserGroupStatsLicense")?sEnabled:sDisabled;document.getElementById("EditionEncryptionHTTPS").firstChild.src=GetXMLValueInt(xmlDoc,"HTTPSLicense")?sEnabled:sDisabled;document.getElementById("EditionSUEvent").firstChild.src=GetXMLValueInt(xmlDoc,"EventLicense")?sEnabled:sDisabled;document.getElementById("EditionSUIntegrationDLL").firstChild.src=GetXMLValueInt(xmlDoc,"IntegrationDLLLicense")?sEnabled:sDisabled;document.getElementById("EditionMSMQLicense").firstChild.src=GetXMLValueInt(xmlDoc,"MSMQLicense")?sEnabled:sDisabled;document.getElementById("EditionFileSharing").firstChild.src=GetXMLValueInt(xmlDoc,"FileSharingLicense")?sEnabled:sDisabled;g_bFVJVLicense=GetXMLValueInt(xmlDoc,"AllowFVJV")?true:false;g_bWebClientLicense=GetXMLValueInt(xmlDoc,"WebClientLicense")?true:false;g_bUsingFIPS=GetXMLValueInt(xmlDoc,"UsingFIPS")?true:false;if(GetXMLValue(xmlDoc,"ODBCLicense")=="0")DisableTab("DatabaseTabContent");else EnableTab("DatabaseTabContent");if(GetXMLValue(xmlDoc,"EventLicense")=="0")DisableTab("EventsTabContent",EventsList);else EnableTab("EventsTabContent",EventsList);if(GetXMLValueInt(xmlDoc,"IsFTPEdition")){OnBuildReggieChart("FTPEdition");GetGatewayLicenses();}else if(GetXMLValueInt(xmlDoc,"IsMFTEdition")){OnBuildReggieChart("MFTEdition");GetGatewayLicenses();}else OnBuildReggieChart("Current");GetUserLicenseInfo();setTimeout("GetEditionData()");}function OnBuildReggieChart(sEditionType){document.getElementById("EditionInfo-Current").style.display="none";document.getElementById("EditionName-Current").style.display="none";document.getElementById("EditionData-MFTEdition").style.border="none";document.getElementById("EditionData-FTPEdition").style.border="none";document.getElementById("EditionData-Current").style.border="none";document.getElementById("EditionArrow-MFTEdition").src="%COMMON_FILE%Images/blank.gif";document.getElementById("EditionArrow-FTPEdition").src="%COMMON_FILE%Images/blank.gif";document.getElementById("EditionArrow-Current").src="%COMMON_FILE%Images/blank.gif";if(sEditionType=="Current"){document.getElementById("EditionInfo-Current").style.display="block";document.getElementById("EditionName-Current").style.display="block";document.getElementById("EditionInfoFS").style.width=($EDITION_INFO_GROUP_BOX_WIDTH$+30)+"px";document.getElementById("EditionInfoFS").style.height=810+"px";}else document.getElementById("EditionInfoFS").style.width="$EDITION_INFO_GROUP_BOX_WIDTH$px";document.getElementById("EditionData-"+sEditionType).style.border="4px solid #a8f90c";document.getElementById("EditionArrow-"+sEditionType).src="%COMMON_FILE%Images/Edition-Down-Arrow.png";}function OnRegister(){ShowDialog("RegistrationDialog");document.getElementById("Reggie").focus();}function OnLostID(){var windowPopup=window.open("https://customerportal.solarwinds.com/Home","CustomerService","noopener");if((windowPopup)&&(windowPopup.focus))windowPopup.focus();}function OnPurchase(){var windowPopup=window.open("http://www.solarwinds.com/company/contact-us","CustomerService","noopener");if((windowPopup)&&(windowPopup.focus))windowPopup.focus();}function OnUpdate(){var windowPopup=window.open("http://www.solarwinds.com/company/contact-us","CustomerService","noopener");if((windowPopup)&&(windowPopup.focus))windowPopup.focus();}function OnUpdateGW(nLicType){var windowPopup;if(nLicType==2||nLicType==1){if(!g_bRegistered)windowPopup=window.open("https://ecomm.solarwinds.com/onepagecheckout/Servu?sku=7215&CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&continue=1&prodadd=16&prod=su","CustomerService","noopener");else windowPopup=window.open("https://ecomm.solarwinds.com/onepagecheckout/Servu?sku=7215&CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&continue=1&prodadd=15&prod=su","CustomerService","noopener");if((windowPopup)&&(windowPopup.focus))windowPopup.focus();}else{ConfirmDialog("$CONFIRM_UPGRADE_GW$",OnConfirmUpgrade);}}function OnApplyGWLicense(){g_ActiveTab.setSelectedItems([1]);}function OnConfirmUpgrade(){var windowPopup=windowPopup=window.open("http://www.solarwinds.com/company/contact-us","CustomerService","noopener");if((windowPopup)&&(windowPopup.focus))windowPopup.focus();}var dateTemp=new Date(parseInt("%BUILD_DATE%")*1000);document.getElementById("BuildDate").innerHTML=dateTemp.toLocaleDateString()+" "+dateTemp.toLocaleTimeString();dateTemp=new Date(parseInt("%INSTALL_DATE%")*1000);document.getElementById("InstallDate").innerHTML=dateTemp.toLocaleDateString()+" "+dateTemp.toLocaleTimeString();var bIs64Bit=(parseInt(%CServer.%SERVER_ID%.Is64Bit%)!=0);var bIsOS64=(parseInt(%CServer.%SERVER_ID%.IsOS64%)!=0);var sOSName="%CServer.%SERVER_ID%.OSName%";var sOSMajorVersion="%CServer.%SERVER_ID%.OSMajorVersion%";var sOSMinorVersion="%CServer.%SERVER_ID%.OSMinorVersion%";var sOSBuildNumber="%CServer.%SERVER_ID%.OSBuildNumber%";var sOSFullVersion="%CServer.%SERVER_ID%.OSVersion%";var bOSIsServer=(parseInt(%CServer.%SERVER_ID%.OSIsServer%)!=0);var sOSServicePackName="%CServer.%SERVER_ID%.OSServicePackName%";var s64Bit="(64-bit)";var s32Bit="(32-bit)";var nGroupHeightInfo=175;if(sOSServicePackName!="")nGroupHeightInfo=185;CreateGroupBox("$DATE_INFO_GROUP$","DateInfoGroup",400,nGroupHeightInfo);CreateGroupBox("$CONTACT_INFO_GROUP$","ContactInfoGroup",400,nGroupHeightInfo);CreateGroupBox("$DEV_INFO_GROUP$","DevelopmentInfoGroup",400,115);CreateGroupBox("$LEGAL_INFO_GROUP$","LegalInfoGroup",400,115);if(sOSName=="Linux"){document.getElementById("OSName").innerHTML=sOSName+"&nbsp;"+(bIsOS64?s64Bit:s32Bit);document.getElementById("OSVer").innerHTML=sOSFullVersion;}else {document.getElementById("OSName").innerHTML="Windows OS family";document.getElementById("OSVer").style.display="none";document.getElementById("OSVer-label").style.display="none";}var sLinuxLogo=(bIsOS64)?"Linux-Logo-64bit.png":"Linux-Logo-32bit.png";if(sOSName!="Linux"||sOSServicePackName==""){document.getElementById("OSServicePack-label").style.display="none";document.getElementById("OSServicePack").style.display="none";}else document.getElementById("OSServicePack").innerHTML=sOSServicePackName;var OSLogo=(sOSName.indexOf("Linux")>-1)?sLinuxLogo:"Windows-regular-logo.png";if(OSLogo!=""){document.getElementById("OSLogoImg").src="%COMMON_FILE%Images/"+OSLogo;if(sOSName.indexOf("Linux")>-1){document.getElementById("OSLogoImg").width="201";document.getElementById("OSLogoImg").height="80";}else{document.getElementById("OSLogoImg").width="200";document.getElementById("OSLogoImg").height="60";}document.getElementById("OSLogo").style.display="block";}if(bIs64Bit){document.getElementById("SUBitVersion").innerHTML="&nbsp;"+s64Bit;}else document.getElementById("SUBitVersion").innerHTML="&nbsp;"+s32Bit;function toggleServerIdentityPresent(isNotPresent){if(!document.getElementById('ServerIdentity')){return;}if(isNotPresent){document.getElementById('IdentityStatus').innerHTML="$NOT_CREATED$";$('#IdentityStatus').css('color','red');document.getElementById('IdentityInfo').innerHTML="$IDENTITY_NOT_CREATED$";$('#ExportSIRow').css('display','none');$('#CreateSIRow').css('display','table-row');$('#ImportSIRow').css('display','table-row');}else{document.getElementById('IdentityStatus').innerHTML="$CREATED$";$('#IdentityStatus').css('color','green');document.getElementById('IdentityInfo').innerHTML="$IDENTITY_CREATED$";$('#CreateSIRow').css('display','none');$('#ImportSIRow').css('display','none');$('#ExportSIRow').css('display','table-row');}}toggleServerIdentityPresent(g_bSysAdmin&&!g_bReadOnlyAccess&&%SERVER_IDENTITY_ALERT_TRIGGERED%);function OnServerIdentityMoreInfo(){window.open("https://www.solarwinds.com/documentation/kbloader.aspx?kb=R128","_blank");}if(document.getElementById('ServerIdentity')){var ServerIdentityMoreInfoButton=CreatePushButton("$MORE_INFO_BUTTON$","MoreInfoServerIdentityButton",OnServerIdentityMoreInfo);}function OnChangeTab(nOldTab,nNewTab){switch(nOldTab){case(0):IPAccessList.EnableUpdates(false);break;case(1):GatewayList.EnableUpdates(false);break;case(3):EventsList.EnableUpdates(false);break;}switch(nNewTab){case(0):IPAccessList.EnableUpdates(true);g_ActiveRezizeGrid=IPAccessList;g_nGridOffSet=370;ResizeGrids(true);break;case(1):GatewayList.EnableUpdates(true);g_ActiveRezizeGrid=GatewayList;g_nGridOffSet=375;ResizeGrids(true);break;case(4):if(g_bLoading)LoadingDialog(g_bLoadShown=true);break;case(3):EventsList.EnableUpdates(true);g_ActiveRezizeGrid=EventsList;g_nGridOffSet=375;ResizeGrids(true);break;}g_sHelpPage=aServerMainHelpPages[nNewTab];g_nCurrentTab=nNewTab;if(g_bReggieQueried&&nNewTab==4&&g_bShowExpNoticeBubble)setTimeout("OnShowExpireNoticeBubble()",0);}function OnShowExpireNoticeBubble(){if(g_bShowExpNoticeBubble){HideDialog("BusyDialog");ToolTipDialog("$UPDATE_NOTICE_BALLOON_TITLE$","$UPDATE_NOTICE_BALLOON_TIP$",undefined,"ExpireNoticeButton",230,175);g_bShowExpNoticeBubble=false;}}function EditionsInfo(nFTPSLicense,nCACertLicense,nSSHLicense,nRemoteAdminLicense,nODBCLicense,nWinAuthLicense,nVirtualPathsLicense,nVirtualHostsLicense,nQuotaLicense,nULDLRatioLicense,nCustomLogoLicense,nUserGroupStatsLicense,nEventLicense,nMaxDomainsLicense,nMaxUsersLicense,nMaxSessionsLicense,nWebClientLicense,nHTTPSLicense,nFIPSLicense,nPasswordRecovery,nIntegrationDLLLicense,nWebClientProLicense,nCustomHTMLLicense,nBrandingRemovalLicense,nMSMQLicense,nLDAPAuthLicense,nFileSharingLicense){this.FTPSLicense=nFTPSLicense;this.CACertLicense=nCACertLicense;this.SSHLicense=nSSHLicense;this.RemoteAdminLicense=nRemoteAdminLicense;this.ODBCLicense=nODBCLicense;this.WinAuthLicense=nWinAuthLicense;this.VirtualPathsLicense=nVirtualPathsLicense;this.VirtualHostsLicense=nVirtualHostsLicense;this.QuotaLicense=nQuotaLicense;this.ULDLRatioLicense=nULDLRatioLicense;this.FIPSLicense=nFIPSLicense;this.PasswordRecovery=nPasswordRecovery;this.CustomLogoLicense=nCustomLogoLicense;this.CustomHTMLLicense=nCustomHTMLLicense;this.UserGroupStatsLicense=nUserGroupStatsLicense;this.EventLicense=nEventLicense;this.MaxDomainsLicense=nMaxDomainsLicense;this.MaxUsersLicense=nMaxUsersLicense;this.MaxSessionsLicense=nMaxSessionsLicense;this.WebClientLicense=nWebClientLicense;this.WebClientProLicense=nWebClientProLicense;this.HTTPSLicense=nHTTPSLicense;this.IntegrationDLLLicense=nIntegrationDLLLicense;this.BrandingRemovalLicense=nBrandingRemovalLicense;this.MSMQLicense=nMSMQLicense;this.LDAPAuthLicense=nLDAPAuthLicense;this.FileSharingLicense=nFileSharingLicense;}function SetEditonChart(aEditionObj,sEdition){var sEnabled="%COMMON_FILE%Images/Check16.png",sDisabled="%COMMON_FILE%Images/blank.gif",sUnlimited="$EDITION_UNLIMITED$";var nMaxDomains=parseInt(aEditionObj.MaxDomainsLicense),nMaxUsers=parseInt(aEditionObj.MaxUsersLicense),nMaxSessions=parseInt(aEditionObj.MaxSessionsLicense);document.getElementById("EditionMaxDomains-"+sEdition).innerHTML=(nMaxDomains>0)?String(nMaxDomains):sUnlimited;document.getElementById("EditionMaxUsers-"+sEdition).innerHTML=(nMaxUsers>0)?String(nMaxUsers):sUnlimited;document.getElementById("EditionMaxSessions-"+sEdition).innerHTML=(nMaxSessions>0)?String(nMaxSessions):sUnlimited;document.getElementById("EditionEncryption-"+sEdition).firstChild.src=parseInt(aEditionObj.FTPSLicense)?sEnabled:sDisabled;document.getElementById("EditionCACertificate-"+sEdition).firstChild.src=parseInt(aEditionObj.CACertLicense)?sEnabled:sDisabled;document.getElementById("EditionEncryptionSSH-"+sEdition).firstChild.src=parseInt(aEditionObj.SSHLicense)?sEnabled:sDisabled;document.getElementById("EditionRemoteAdmin-"+sEdition).firstChild.src=parseInt(aEditionObj.RemoteAdminLicense)?sEnabled:sDisabled;document.getElementById("EditionRemoteAdminIpad-"+sEdition).firstChild.src=parseInt(aEditionObj.RemoteAdminLicense)?sEnabled:sDisabled;document.getElementById("EditionODBC-"+sEdition).firstChild.src=parseInt(aEditionObj.ODBCLicense)?sEnabled:sDisabled;document.getElementById("EditionWindowsAuth-"+sEdition).firstChild.src=parseInt(aEditionObj.WinAuthLicense)?sEnabled:sDisabled;document.getElementById("EditionLDAPAuth-"+sEdition).firstChild.src=parseInt(aEditionObj.LDAPAuthLicense)?sEnabled:sDisabled;document.getElementById("EditionVirtualPaths-"+sEdition).firstChild.src=parseInt(aEditionObj.VirtualPathsLicense)?sEnabled:sDisabled;document.getElementById("EditionVirtualHosts-"+sEdition).firstChild.src=parseInt(aEditionObj.VirtualHostsLicense)?sEnabled:sDisabled;document.getElementById("EditionQuotas-"+sEdition).firstChild.src=parseInt(aEditionObj.QuotaLicense)?sEnabled:sDisabled;document.getElementById("EditionRatios-"+sEdition).firstChild.src=parseInt(aEditionObj.ULDLRatioLicense)?sEnabled:sDisabled;document.getElementById("EditionFIPS-"+sEdition).firstChild.src=parseInt(aEditionObj.FIPSLicense)?sEnabled:sDisabled;document.getElementById("EditionUserPasswordRecover-"+sEdition).firstChild.src=parseInt(aEditionObj.PasswordRecovery)?sEnabled:sDisabled;document.getElementById("EditionCustomLogo-"+sEdition).firstChild.src=parseInt(aEditionObj.CustomLogoLicense)?sEnabled:sDisabled;document.getElementById("EditionCustomHTML-"+sEdition).firstChild.src=parseInt(aEditionObj.CustomHTMLLicense)?sEnabled:sDisabled;document.getElementById("EditionWebClient-"+sEdition).firstChild.src=parseInt(aEditionObj.WebClientLicense)?sEnabled:sDisabled;document.getElementById("EditionWebClientPro-"+sEdition).firstChild.src=parseInt(aEditionObj.WebClientProLicense)?sEnabled:sDisabled;document.getElementById("EditionUserGroupStats-"+sEdition).firstChild.src=parseInt(aEditionObj.UserGroupStatsLicense)?sEnabled:sDisabled;document.getElementById("EditionEncryptionHTTPS-"+sEdition).firstChild.src=parseInt(aEditionObj.HTTPSLicense)?sEnabled:sDisabled;document.getElementById("EditionSUEvent-"+sEdition).firstChild.src=parseInt(aEditionObj.EventLicense)?sEnabled:sDisabled;document.getElementById("EditionSUIntegrationDLL-"+sEdition).firstChild.src=parseInt(aEditionObj.IntegrationDLLLicense)?sEnabled:sDisabled;document.getElementById("EditionMSMQLicense-"+sEdition).firstChild.src=parseInt(aEditionObj.MSMQLicense)?sEnabled:sDisabled;document.getElementById("EditionFileSharing-"+sEdition).firstChild.src=parseInt(aEditionObj.FileSharingLicense)?sEnabled:sDisabled;}function GetUserLicenseInfo(){if(g_MaxUserLicense!=-1){var UserLicenseObj=undefined;if(UserLicenseObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"MCLicenseUserInfo.xml?ID=%SERVER_ID%"),OnGetUserLicenseInfoDone)){UserLicenseObj.request();}}else document.getElementById("TotalUsersUsed").innerHTML="(<strong>$EDITION_UNLIMITED$</strong>)";}function OnGetUserLicenseInfoDone(){var xmlDoc=this.getResponseXML();var nTotalUsers=GetXMLValue(xmlDoc,"TotalUsers");if(nTotalUsers!=undefined){document.getElementById("TotalUsersUsed").innerHTML="(<strong>$USING$ "+nTotalUsers+" </strong>)";}}function showExportSIDialog(){OnShowExportSIDialog();}function showImportSIDialog(){OnShowImportSIDialog();}if(g_bSysAdmin&&!g_bReadOnlyAccess){g_ActiveTab=CreateTabs(["$IPACCESS$","$GATEWAY$","$DATABASE$","$EVENTS$","$LICENSE$","$PROGRAM_INFO$","$SERVER_IDENTITY$"],["IPAccess","Gateway","Database","Events","License","ProgramInfo","ServerIdentity"],"PageTabs","TabsContent",1,OnChangeTab);}else{g_ActiveTab=CreateTabs(["$IPACCESS$","$GATEWAY$","$DATABASE$","$EVENTS$","$LICENSE$","$PROGRAM_INFO$"],["IPAccess","Gateway","Database","Events","License","ProgramInfo"],"PageTabs","TabsContent",1,OnChangeTab);}if(window.location.search.indexOf("EditSMTP=1")>0)OnSMTPConfig();if((parseInt(GetURLParameter("Page"))-1)>1)g_ActiveTab.setSelectedItems([(parseInt(GetURLParameter("Page"))-1)]);</script></div></div><div style='clear:both;'>&nbsp;</div></div></div><div class="footerDiv"><a href="%PRODUCT_HOME%" target="_blank" rel="noopener noreferrer">%PRODUCT%</a> <span id="SUVersionNumber">%VERSION%</span> &copy; 1995 - %COPYRIGHT_END_YEAR% <a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer">%COMPANY_NAME_FORMAL%</a>&nbsp;$ALL_RIGHTS_RESERVED$</div><ul id="UserOptList" style="display: none; width: auto;min-width: 100px;"><li id="UserOptList-password" style="display: none;"><a href="#" data-handler="javascript:ChangePasswordDialog();" >$CHANGE_PASSWORD_BUTTON$</a></li><li id="UserOptList-changeemail" style="display: none;"><a href="#" data-handler="javascript:OnShowChangeEmailDialog();" >$CHANGE_EMAIL_BUTTON$</a></li><li id="UserOptList-logout"><a href="#" data-handler="javascript:OnLogOut();">$LOGOUT$</a></li></ul><ul id="HelpOptList" class="menu-toggle" style="display: none; width: auto;min-width: 100px;"><li id="HelpOptList-whatsnew"><a href="#" data-handler="javascript:WhatsNewShow();" class="ActionOption" style="white-space:nowrap;"><span class="Action-ico"><img src="%COMMON_FILE%Images/FolderSize.png" class="SUWCActionico" alt="$WHATS_NEW$" border="0"/></span>$WHATS_NEW$</a></li></ul></div><div id="FooterDelayContent" style="display:none;"></div><ul id="AdhocNavBarJumpToMenu" style="display: none; width: auto;min-width: 160px;"><li id="MCNavOption"><a href="#AdhocHeadJumpto" id="MCNavOption-href" data-handler="javascript:OnJumpTo(0);">$MANAGEMENT_CONSOLE$</a></li><li id="WCNavOption"><a href="#AdhocHeadJumpto" id="WCNavOption-href" data-handler="javascript:OnJumpTo(1);">$BASIC_WEB_CLIENT$</a></li><li id="WCNewNavOption"><a href="#AdhocHeadJumpto" id="WCNewNavOption-href" data-handler="javascript:OnJumpTo(4);">$WEB_CLIENT_NEW$</a></li><li id="FSNewNavOption"><a href="#AdhocHeadJumpto" id="FSNewNavOption-href" data-handler="javascript:OnJumpTo(5);">$WEB_CLIENT_SHARE_NEW$</a></li><li id="FJNavOption"><a href="#AdhocHeadJumpto" id="FJNavOption-href" data-handler="javascript:OnJumpTo(2);">$FVJV$</a></li><li id="FSNavOption"><a href="#AdhocHeadJumpto" id="FSNavOption-href" data-handler="javascript:OnJumpTo(3);">$FILE_SHARING$</a></li></ul><script type="text/javascript">$(document).ready(function(){var g_bShowMC=(%IS_ADMIN%=="1")?true:false;var g_bShowWC=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bShowFVJV=(%ALLOW_FTP_VOYAGER_JV%=="1")?true:false;var g_bShowFileSharing=(%ALLOW_ADHOC_FILE_SHARING%=="1")?true:false;$("#ManConNavBarJumpToList").contextMenu({"menu":"AdhocNavBarJumpToMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#AdhocNavBarJumpToMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocNavBarJumpToMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});var nTotalHidden=0;if(!g_bShowMC||g_JumpToPage==0){$("#MCNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==1){$("#WCNavOption").hide();nTotalHidden+=1;}if(!g_bShowFVJV||g_JumpToPage==2){$("#FJNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==3){$("#FSNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==4){$("#WCNewNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==5){$("#FSNewNavOption").hide();nTotalHidden+=1;}if(nTotalHidden==6)$(".AdhocNavBarJumpTo").hide();else $(".AdhocNavBarJumpTo").show();});function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href="%FILE%ListDir.htm";break;case(2):location.href="%COMMON_FILE%FVJVLoggedIn.htm";break;case(3):location.href="%FILE%Share/Console.htm";break;case(4):location.href="/WebClientNew/Browser/~";break;case(5):location.href="/WebClientNew/Requested";break;}}</script><script type="text/javascript" language="javascript">var g_bFooterDelayLoaded=false;var g_bIsFileNameSelected=true;var g_bFooterIsWindowAuth=(%WINDOWS_AUTH_SUPPORT%==1);function IsFooterDelayLoaded(){return(g_bFooterDelayLoaded);}function OnFooterDelayLoaded(){g_bFooterDelayLoaded=true;}function OnLogOut(){g_bLinkRequested=true;clearSessionCookies('domainid');clearSessionCookies('domainodbc');location.href='%LOGOUT%';}function OnMoreWebClientInfo(){window.open("https://customerportal.solarwinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank","noopener");}function LaunchBasicWebClient(){if(g_bWebClientLicense){LoadingDialog(true);location.href="%FILE%ListDir.htm?Dir=%CURRENT_DIR%";}else ConfirmDialog(g_sWebClienLicenseInfo,OnMoreWebClientInfo);}function MainHelp(){LaunchHelp(g_sHelpPage,g_sHelpNode);}function OnShowChangeEmailDialog(){OnShowSetEmailDialog(g_sUserEmail);g_sUserEmail="";}if(%IS_LOCAL_ADMIN%){sLoggedInUser="($LOCAL_ADMIN$)";sLoggedInUserAlt="$LOCAL_ADMIN$";}else{sLoggedInUser=FormatClientString("%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)");sLoggedInUserAlt="%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)";}document.getElementById("CurrentlyLoggedIn").innerHTML=sLoggedInUser;setTimeout(function(){LoadDynamicContent("%ADMIN_FILE%Include/footerInclude.htm?ID=%ID%","FooterDelayContent",OnFooterDelayLoaded);});if(g_bOperaBrowser)document.body.onmousedown=function(){return false;};$(document).ready(function(){$('.menu-toggle').on('click',function(e){$('.menu-toggle').removeClass('active');$(this).addClass('active');});$(document).on('mouseup',function(e){var container=$(".menu-toggle");if(!container.is(e.target)&&container.has(e.target).length===0){$('.menu-toggle').removeClass('active');}});$("#UserOptBtn").contextMenu({"menu":"UserOptList","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#UserOptList").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#UserOptList").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});if(!(%IS_LOCAL_ADMIN%)){if(g_bAllowChangePassword)$("#UserOptList-password").show();if(g_bAllowChangeEmail)$("#UserOptList-changeemail").show();}});</script></body></html>