<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Result.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
%PRIV_GROUP_ADMIN%<div id="GoToDialoginner" style="display:none;"><form name="Go_To_Form" onsubmit="return (false);"><table class="DialogTable"><tr><td>$GO_TO_PATH$:<br /><div style="overflow:auto"><span id="GoToPathInput"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="GoToButton"></span><br /><span id="CancelGoToButton"></span></td></tr></table></form></div><script type="text/javascript" language="JavaScript">var sWebClientGoTo=undefined;var sGoToImg=undefined;try{if(g_bIsWebClient){sWebClientGoTo="WC-Icon-GoTo";}else sGoToImg="GoTo.png";}catch(e){sGoToImg="GoTo.png";}BuildDialog("$GO_TO_DIRECTORY$","GoToDialog","300","155","","$CLOSE_CANCEL$",sGoToImg,undefined,sWebClientGoTo);function GoToDialog(){GoToInput.setControlText(decodeURIComponent(g_sCurrentDir));ShowDialog("GoToDialog");GoToInput.getContent("box/text").element().focus();}function OnGoToPathSubmit(){var sGoToPath=SanitizeString(GoToInput.getControlText());OnCancelGoTo();OnFileOpen(true,sGoToPath,true);}function OnCancelGoTo(){HideDialog("GoToDialog");}CreateDialogPushButton("$OK_BUTTON$","GoToButton",OnGoToPathSubmit);CreateDialogPushButton("$CANCEL_BUTTON$","CancelGoToButton",OnCancelGoTo);var GoToInput=CreateInputField("","GoToPathInput","GoToPathInput",undefined,200,undefined,undefined,OnGoToPathSubmit);</script><div id="CreateDirDialoginner" style="display:none;"><form name="CreateDir" onsubmit="return (false);"><table class="DialogTable"><tr><td>$NEW_DIR_NAME_LABEL$<br><div style="overflow:auto"><span id="NewDirInput"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="CreateDirButton"></span><br /><span id="CancelCreateDirButton"></span></td></tr></table></form></div><script type="text/javascript" language="JavaScript">var sWebClientNewDir=undefined;var sNewDirImg=undefined;try{if(g_bIsWebClient){sWebClientNewDir="WC-Icon-NewDir";}else{sNewDirImg="NewDir.png";}}catch(e){sNewDirImg="NewDir.png";}BuildDialog("$CREATE_DIR$","CreateDirDialog","300","220","","$CLOSE_CANCEL$",sNewDirImg,undefined,sWebClientNewDir);function CreateDirDialog(){g_bContextKeepAppletHidden=true;DirInput.setControlText("");ShowDialog("CreateDirDialog");DirInput.getContent("box/text").element().focus();}function OnCreateDirSubmit(){var sNewDirPath=DirInput.getControlText();if(sNewDirPath!=""){var sNewDirCmd="/?Command=CreateDir&Dir="+g_sCurrentDir;var NewDirRequest=CreatePostRequest(sNewDirCmd);NewDirRequest.setParameter("new_dir",sNewDirPath);NewDirRequest.request();NewDirRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==3){if(decodeURIComponent(g_sCurrentDir)=="/")sCurrentCreateDirPath="";else sCurrentCreateDirPath=decodeURIComponent(g_sCurrentDir);var path='';try{path=decodeURIComponent(sNewDirPath);}catch(e){path=sNewDirPath;}AlertDialog(GetResultText(nResult,"$SESS_CANNOT_CREATE_DIR1_STR$ /"+SanitizeString(path)+"<br/><br/>$SESS_CANNOT_CREATE_DIR2_STR$",sResultText));}else AlertDialog(GetResultText(0,"",sResultText));}else{ReplaceDialog("CreateDirDialog",g_sBusyDialog);RefreshList(false);if(g_nShowList!=0)FilesList.element().focus();}};}}function OnCancelCreateDir(){HideDialog("CreateDirDialog");}CreateDialogPushButton("$OK_BUTTON$","CreateDirButton",OnCreateDirSubmit);CreateDialogPushButton("$CANCEL_BUTTON$","CancelCreateDirButton",OnCancelCreateDir);var DirInput=CreateInputField("","NewDirInput","new_dir",undefined,200,undefined,undefined,OnCreateDirSubmit);</script><div id="BrowseDialoginner" style="display:none;"><table cellpadding="0" cellspacing="0" border="0" style="white-space:nowrap;padding-left:5px;margin-bottom:2px;"><tr><td style="width:20px;white-space:nowrap;"><img src="%COMMON_FILE%Images/folders16.png" width="16" height="16" style="padding:0px 1px;border:none;"/></td><td style="white-space:nowrap;"><div id="CurrentDirBlock" style="width:360px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;" title=""><span id="CrumbBar"></span></div></td></tr></table><div class="taskbar"><table cellpadding="0" cellspacing="0" border="0" style="width:100%;white-space:nowrap;"><tr><td class="leftdivider" style="padding-left:15px;text-align:left;white-space:nowrap;vertical-align:middle;height:26px;"><table cellpadding="0" cellspacing="0" border="0"><tr><td style="width:20px;white-space:nowrap;"><a href="javascript:RefreshList(true);"><img src="%COMMON_FILE%Images/Refresh.png" border="0" align="middle" alt="$REFRESH$" style="margin:0px 1px;border:none;"></a></td><td style="white-space:nowrap;"><a href="javascript:RefreshList(true);" class="highlightbuttonbox">$REFRESH$</a></td><td style="white-space:nowrap;width:10px;"><span class="dividerline" >&nbsp;</span></td><td style="width:20px;white-space:nowrap;text-align:center;"><span><a href="javascript:GoToDialog();"><img src="%COMMON_FILE%Images/GoTo.png" border="0" align="middle" alt="$GO$"style="margin:0px 1px;border:none;"></a></span></td><td style="white-space:nowrap;"><span><a href="javascript:GoToDialog();" class="highlightbuttonbox">$GO$</a></span></td><td id="CreateDirDivCell" style="white-space:nowrap;width:0px;"><span id="CreateDirDiv"></span></td><td id="CreateDirImgCell" style="white-space:nowrap;width:0px;"><span id="CreateDirImg"></span></td><td style="white-space:nowrap;"><span id="CreateDirLink"></span></td><td id="ParentDirDivCell" style="white-space:nowrap;width:0px;"><span id="ParentDirDiv"></span></td><td id="ParentDirImgCell" style="white-space:nowrap;width:0px;"><span id="ParentDirImg"></span></td><td style="white-space:nowrap;"><span id="ParentDirLink"></span></td></tr></table></td></tr></table></div><div style="padding-left:5px;"><span id="DriveText" style="display:none;">$DRIVES$: <br /></span><span id="DriveVolumesCombo"></span></div><div id="ListFilesContainer" style="width:415px"><span id="ListDirs"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span></div><div style="text-align:right;padding:0 5px 0 0;">$DIRECTORIES$: <span id="TotalDirs">0</span> &nbsp;&nbsp; <span id="BrowseFileCount">$FILES$: <span id="TotalFiles">0</span> &nbsp;&nbsp; $SIZE$: <span id="TotalSize">0</span></span></div><div style="width:410px;padding-left:5px;"><span id="BrowsePromptLabel">$DIRECTORY_PATH$</span>: <span id="BrowseFileNameCreatTip"></span><div style="overflow:auto"><span id="DirPath"></span></div></div><div style="text-align:right;padding-right:10px;margin-top:5px;"><span id="SelectDirbutton"></span><span id="CancelDirbutton"></span></div></div><script type="text/javascript" language="javascript">var g_sCurrentDir,g_sHomeDir,g_objDirInput,g_sPreviousDir;var g_bIsVisable=false;var g_sDirsOnly="0";var g_sFilesOnly="0";var g_bSelectFilesOnly=false;var g_bFileNameOnly=false;var g_sDirLockPath;var g_bLockFolder=false;var DriveCombo;var g_bAllowSelectionChange=false;var g_RetryAttempts=0;var g_MaxRetryAttempts=2;var g_fnCallback;var g_sCurrentHostText="$CURR_DIR_HOST$";var g_sNoSubDirs="$NO_SUB_DIRS$";var g_nBrowseDialogHeight="585";var g_nBrowseDialogListHeight="400";var g_sOpen="$OPEN$";var g_sDownload="$DOWNLOAD$";if(g_nScreenHeight<=768){g_nBrowseDialogHeight="485";g_nBrowseDialogListHeight="300";}BuildDialog("$BROWSE$","BrowseDialog","425",g_nBrowseDialogHeight,"","$CLOSE_CANCEL$","Browse-16.png");g_sHomeDir="%CURRENT_DIR%";if(g_sCurrentDir==""||g_sCurrentDir==undefined)g_sCurrentDir=g_sHomeDir;g_sPreviousDir=g_sCurrentDir;var FilesList=CreateBasicGrid("ListDirs",["$NAME$"],[275],"","files",OnFileOpen);var sOnBrowseFileOpen=String("OnFileOpen(");var sOnBrowseFileSelect=String("OnSelectPath(");CreateContextMenu([sOnBrowseFileOpen,sOnBrowseFileSelect],[OnBrowseFileListContextMenu,"$SELECT_BUTTON$"],[OnBrowseFileListContextImages,"select"],FilesList);FilesList.setSelectionMode("single-row");FilesList.setStyle("height",g_nBrowseDialogListHeight+"px");FilesList.getCellImage=function(nColumn,nRow){return(GetFileImage.call(this,this.getCellText(nColumn,nRow),nColumn,nRow));};FilesList.defineRowProperty("color",function(nRow){if(parseInt(this.getCellData(12,nRow)))return("blue");else if(parseInt(this.getCellData(13,nRow)))return("#13920d");else return("#000000");});FilesList.getRowTemplate().setStyle("color",function(){return this.getRowProperty("color");});FilesList.setCellFormat([new AW.Formats.BWCFileString,new AW.Formats.Filesize,new AW.Formats.LocaleDate,new AW.Formats.XMLString]);FilesList.setSortColumn(0);FilesList.setSortDirection("ascending",0);FilesList.onKeyEnter=OnFileOpen;FilesList.m_fnPostUpdate=function(){var xmlDoc=this.m_XMLTable.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"ErrorResponse");var sResultText=GetXMLValue(xmlDoc,"ResultText");if(nResult!=0){g_RetryAttempts++;if(g_sPreviousDir==g_sCurrentDir)g_sCurrentDir=encodeURI("~");else g_sCurrentDir=g_sPreviousDir;if(g_RetryAttempts<g_MaxRetryAttempts){setTimeout(function(){OnPreviousDir(false);},500);}else if(g_RetryAttempts==g_MaxRetryAttempts){g_sCurrentDir=encodeURI("~");setTimeout(function(){OnPreviousDir(false);},500);}else{LoadingDialog(false);AlertDialog(GetResultText(0,"",sResultText),undefined,undefined,true);}}else{var nTotalSize=0;for(var nIndex=0;nIndex<this.getRowCount();nIndex++)nTotalSize+=this.getCellValue(1,nIndex);document.getElementById("TotalFiles").innerHTML=FormatNumberCommas(this.m_XMLTable.getCount()-g_nTotalDirs,true);document.getElementById("TotalDirs").innerHTML=FormatNumberCommas(this.m_XMLTable.selectNodes("//file[FileIsDir=1]").length,true);document.getElementById("TotalSize").innerHTML=FormatFileSize(nTotalSize,true);FilesList.setCurrentRow(0);FilesList.setSelectedRows([-1]);g_sCurrentDir=GetXMLValue(xmlDoc,"CurrentDir",true);SetCurrentDirOnPage();g_sPreviousDir=g_sCurrentDir;g_RetryAttempts=0;if(g_bSelectFilesOnly)SetDirInput("");if(!g_bIsVisable){ReplaceDialog('BusyDialog','BrowseDialog',OnDismissBrowseDialog);sCurrentPageDir=GetDecodedDirPath(g_sCurrentDir);if(!g_bSelectFilesOnly)DirectoryPathInput.setControlText(sCurrentPageDir);g_bIsVisable=true;}else LoadingDialog(false);setTimeout(function(){ScrollEvent();},0);g_bAllowSelectionChange=true;}};FilesList.onSelectedRowsChanged=function(anSelectedRows){var nColumnPosition=3;if(g_bFileNameOnly)nColumnPosition=0;if((g_bSelectFilesOnly)&&(FilesList.getCellText(4,anSelectedRows[0])!=1)){if(g_bAllowSelectionChange)SetDirInput(encodeURIComponent(HTMLDecode(FilesList.getCellText(nColumnPosition,anSelectedRows[0]))));}else if(!g_bSelectFilesOnly){if(g_bAllowSelectionChange)SetDirInput(encodeURIComponent(HTMLDecode(FilesList.getCellText(nColumnPosition,anSelectedRows[0]))));}else SetDirInput("");};sCurrentPageDir=GetDecodedDirPath(g_sCurrentDir);var DirectoryPathInput=CreateInputField("","DirPath","DirPath","",405,undefined,undefined,OnSelectPath);var DriveRequest;var sPageID="%ID%";if(sPageID=="")sPageID="%SERVER_ID%";if(DriveRequest=createAWHttpRequest("GET",(g_sAdminXMLPath+"DomainAttrListDrives.htm?ID="+sPageID),OnLoadDrives))DriveRequest.request();CreatePushButton("$SELECT_BUTTON$","SelectDirbutton",OnSelectPath);CreatePushButton("$CANCEL_BUTTON$","CancelDirbutton",OnHideBrowse);function OnLoadDrives(){var asDriveNames=new Array(),asDrivePaths=new Array(),asDriveTypes=new Array();var aasDriveInfo=eval(this.getResponseText());if(aasDriveInfo.length){if(AW.ie)aasDriveInfo.pop();for(var nIndex=0;nIndex<aasDriveInfo.length;nIndex++){asDrivePaths.push(decodeURIComponent(aasDriveInfo[nIndex][0]));if(aasDriveInfo[nIndex][1]=="")asDriveNames.push(asDrivePaths[nIndex]);else asDriveNames.push(asDrivePaths[nIndex]+" ("+decodeURIComponent(aasDriveInfo[nIndex][1]).replace("()","")+")");asDriveTypes.push(aasDriveInfo[nIndex][2]);}document.getElementById("DriveText").style.display="block";DriveCombo=CreateComboBox("<<$SELECT_DRIVE$>>","",asDriveNames,asDrivePaths,"DriveVolumesCombo","DriveVolumesCombo",OnDriveChange,undefined,false,150,22,undefined);SetDriveIcons(DriveCombo,asDriveTypes);UpdateDriveCombo();}}function OnSelectPath(){if((parseInt(FilesList.getCellText(4,FilesList.getSelectedRows()))==0)&&(parseInt(FilesList.getSelectedRows())>=0))g_bIsFileNameSelected=true;else g_bIsFileNameSelected=false;if((g_bSelectFilesOnly)&&(FilesList.getCellText(4,FilesList.getSelectedRows())==1)){OnFileOpen();}else{if(g_objDirInput!=undefined&&g_fnCallback!=undefined){setTimeout(function(){g_fnCallback(DirectoryPathInput.getControlText(),g_objDirInput);},0);}else if(g_objDirInput!=undefined){var selectedPath=DirectoryPathInput.getControlText();var currentDir=GetDecodedDirPath(g_sCurrentDir);if((selectedPath.substring(0,1)!='/')&&(currentDir!='/'))selectedPath=currentDir+'/'+selectedPath;g_objDirInput.setControlText(selectedPath);g_objDirInput.getContent("box/text").element().focus();}else if(g_fnCallback!=undefined){setTimeout(function(){g_fnCallback(DirectoryPathInput.getControlText());},0);}if(g_objDirInput!=undefined){setTimeout(function(){HideDialog("BrowseDialog");},10);}}}function OnHideBrowse(){HideDialog("BrowseDialog");}function ParentDir(){var nPos=0;nPos=g_sCurrentDir.lastIndexOf("/");if(nPos<0)nPos=g_sCurrentDir.lastIndexOf("%2F");if(nPos<0)g_sCurrentDir=g_sHomeDir;else{if(nPos==0)g_sCurrentDir="/";else g_sCurrentDir=g_sCurrentDir.substring(0,nPos);}RefreshList(true);if(!g_bSelectFilesOnly)SetDirInput(g_sCurrentDir);}function OnPreviousDir(bShowLoading){var bLoadingDialog=true;if(!bShowLoading)bLoadingDialog=false;RefreshList(bLoadingDialog);if(!g_bSelectFilesOnly)SetDirInput(g_sCurrentDir);}function SetDirInput(sDir){var nDriveCheck;var sDirPath;sDirPath=GetDecodedDirPath(sDir);DirectoryPathInput.setControlText(sDirPath);}function RefreshList(bShowLoadingDialog,bByPassLock){if(g_bLockFolder&&bByPassLock!=true)AlertDialog("$BROWSE_FOLDER_LOCK_ALERT$");else{if(bShowLoadingDialog)LoadingDialog(true);OnResetTotals();g_bAllowSelectionChange=false;FilesList.Update("%FILE%ListError.xml?Command=List&DirsOnly="+g_sDirsOnly+"&FilesOnly="+g_sFilesOnly+"&Dir="+g_sCurrentDir);}}function OnFileOpen(bDir,sPath,bGoTo){var bDoDir=false;var sDownloadFilePath="";var bLoading;if(bGoTo){bDoDir=true;g_sCurrentDir=encodeURIComponent(sPath);}else{if(FilesList.getCellText(4,FilesList.getSelectedRows())==1){bDoDir=true;g_sCurrentDir=encodeURIComponent(HTMLDecode(FilesList.getCellText(3,FilesList.getSelectedRows())));}}if(bDoDir){if(bGoTo)bLoading=false;else bLoading=true;RefreshList(bLoading);}else OnSelectPath();}function SetCurrentDirOnPage(){var nPos=0,sCurrentPageDir;var bHome=false;sCurrentPageDir=GetDecodedDirPath(g_sCurrentDir);document.getElementById("CrumbBar").innerHTML=BuildCrumbBar(g_sCurrentDir);document.getElementById("CurrentDirBlock").title=sCurrentPageDir;if(!g_bSelectFilesOnly)DirectoryPathInput.setControlText(sCurrentPageDir);nPos=g_sCurrentDir.lastIndexOf("/");if(nPos<0)nPos=g_sCurrentDir.lastIndexOf("%2F");if(nPos<=0)bHome=true;if((g_sCurrentDir!="/")&&(g_sCurrentDir!="%2F")){var sParentDirBrowse=String("ParentDir();");document.getElementById("ParentDirImg").innerHTML='<a href="javascript:'+sParentDirBrowse+'"><img src="%FILE%Images/parent-up.png" border="0" align="middle" alt="$UP_ONE_DIRECTORY$" style="margin:0px 1px;border:none;"></a>';document.getElementById("ParentDirLink").innerHTML='<a href="javascript:'+sParentDirBrowse+'" class="highlightbuttonbox">$PARENT_DIR$</a>';document.getElementById("ParentDirDiv").innerHTML='<span  class="dividerline">&nbsp;</span>';document.getElementById("ParentDirImgCell").style.width="20px";document.getElementById("ParentDirDivCell").style.width="10px";}else{document.getElementById("ParentDirImg").innerHTML='';document.getElementById("ParentDirLink").innerHTML='';document.getElementById("ParentDirDiv").innerHTML='';document.getElementById("ParentDirImgCell").style.width="0";document.getElementById("ParentDirDivCell").style.width="0";}if(!g_bLockFolder){var sCreateDirBrowse=String("CreateDirDialog();");document.getElementById("CreateDirImg").innerHTML='<a href="javascript:'+sCreateDirBrowse+'"><img src="%COMMON_FILE%Images/NewDir.png" border="0" align="middle" alt="$CREATE_DIR$" style="margin:0px 1px;border:none;"></a>';document.getElementById("CreateDirLink").innerHTML='<a href="javascript:'+sCreateDirBrowse+'" class="highlightbuttonbox">$CREATE_DIR$</a>';document.getElementById("CreateDirDiv").innerHTML='<span  class="dividerline">&nbsp;</span>';document.getElementById("CreateDirImgCell").style.width="20px";document.getElementById("CreateDirDivCell").style.width="10px";}else{document.getElementById("CreateDirImg").innerHTML='';document.getElementById("CreateDirLink").innerHTML='';document.getElementById("CreateDirDiv").innerHTML='';document.getElementById("CreateDirImgCell").style.width="0";document.getElementById("CreateDirDivCell").style.width="0";}UpdateDriveCombo();}function OnDismissBrowseDialog(){g_bIsFileNameSelected=true;}function UpdateDriveCombo(){var sCurrentPageDir=GetDecodedDirPath(g_sCurrentDir);if(DriveCombo!=undefined){DriveCombo.setSelectedItems([]);nDriveCheck=sCurrentPageDir.search(eval("/\\w\\:/"));if(nDriveCheck>=0){sDirPath=sCurrentPageDir.substring(nDriveCheck,(nDriveCheck+3));DriveCombo.setControlText(sDirPath);}else DriveCombo.setControlText("<<$SELECT_DRIVE$>>");DriveCombo.setControlValue("");}}function OnDriveChange(sItemValue){if(sItemValue!=""){g_sCurrentDir=encodeURIComponent(sItemValue);if(!g_bSelectFilesOnly)SetDirInput(g_sCurrentDir);RefreshList(true);}}function SetDriveIcons(obj,anDriveTypes){var asDriveIcons=new Array();for(var nIndex=0;nIndex<anDriveTypes.length;nIndex++){asDriveIcons.push(GetDriveIcon(anDriveTypes[nIndex]));}obj.setItemImage(asDriveIcons);}function OnBrowse(aParams){var sDisplayFileInfo="inline";var bShowCreateFileLabel;g_bIsFileNameSelected=false;g_bIsVisable=false;g_bLockFolder=false;g_objDirInput=aParams[0];g_bSelectFilesOnly=aParams[1];g_sFilesOnly=aParams[2];g_sDirsOnly=aParams[3];g_fnCallback=aParams[4];g_bFileNameOnly=aParams[5];g_sDirLockPath=aParams[6];bShowCreateFileLabel=aParams[7];if(g_objDirInput!=undefined&&g_objDirInput.getControlText()!=""){if(g_sDirLockPath!=undefined&&g_sDirLockPath.getControlText()!=""){g_sCurrentDir=encodeURIComponent(g_sDirLockPath.getControlText());g_bLockFolder=true;}else{g_sCurrentDir=encodeURIComponent(g_objDirInput.getControlText());nPos=g_sCurrentDir.lastIndexOf("\\");if(nPos<0)nPos=g_sCurrentDir.lastIndexOf("%5C");if(nPos<0)nPos=g_sCurrentDir.lastIndexOf("/");if(nPos<0)nPos=g_sCurrentDir.lastIndexOf("%2F");if(nPos==0)g_sCurrentDir="/";else{if(g_sCurrentDir.substring(nPos).lastIndexOf(".")<0)g_sCurrentDir=encodeURIComponent(g_objDirInput.getControlText());else g_sCurrentDir=g_sCurrentDir.substring(0,nPos);}}}if(parseInt(g_sDirsOnly)==1)sDisplayFileInfo="none";if(bShowCreateFileLabel)$("#BrowseFileNameCreatTip").text("($BROWSE_CREATE_FILE_NAME_TIP$)");else $("#BrowseFileNameCreatTip").text("");if(g_bSelectFilesOnly)$("#BrowsePromptLabel").text("$FILE_PATH$");else $("#BrowsePromptLabel").text("$DIRECTORY_PATH$");document.getElementById("BrowseFileCount").style.display=sDisplayFileInfo;RefreshList(false,true);}</script>