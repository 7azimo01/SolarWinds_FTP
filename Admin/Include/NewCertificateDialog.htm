<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
%PRIV_DOMAIN_ADMIN%<div id="NewCertificateDialoginner" style="display:none;"><div id="NewCertContent" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$NEW_CERTIFICATE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Certificate32.png" width="32" height="32" class="header-icon" />$NEW_CERTIFICATE_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="NewCertificateForm"><span id="NewCertOutputGroup">$CERT_SET_NAME$:<div style="overflow:auto"><span id="NewCertSetName"></span></div>$CERT_OUTPUT_PATH$:<div style="overflow:auto"><span id="NewCertOutputPath"></span> <span id="NewCertOutputPathBrowse"></span></div></span><div id="NewCertInfoGroup"><div style="float:left;width:225px;">$CERT_CITY_TOWN$:<div style="overflow:auto"><span id="NewCertCityTown"></span></div>$CERT_STATE_PROVINCE$:<div style="overflow:auto"><span id="NewCertStateProvince"></span></div>$CERT_COUNTRY$:<div style="overflow:auto"><span id="NewCertCountry"></span></div>$CERT_PASSWORD$:<div style="overflow:auto"><span id="NewCertPassword"></span></div></div><div style="float:left;width:225px;padding-left:5px;">$CERT_ORGANIZATION$:<div style="overflow:auto"><span id="NewCertOrganization"></span></div>$CERT_COMMON_NAME$ / $CERT_DOMAIN_NAME$:<div style="overflow:auto"><span id="NewCertCommonName"></span></div>$CERT_UNIT$:<div style="overflow:auto"><span id="NewCertUnit"></span></div>$PRIVATE_KEY_LENGTH$:<div style="overflow:auto"><span id="NewCertSSLKeyLength"></span></div></div></div><div style="padding:5px 0 0 0;clear:both;"><span id="CreateNewCertButton"></span><span id="CancelNewCertButton"></span><span id="HelpNewCertButton"></span></div></form></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$NEW_CERTIFICATE_DIALOG_TITLE$","NewCertificateDialog","500","410","","$CLOSE_CANCEL$");CreateGroupBox("$CERT_OUTPUT_GROUP$","NewCertOutputGroup",480,112);CreateInputField("","NewCertSetName","NewCertSetName",undefined,400);var CertOutputPathInput=CreateInputField("","NewCertOutputPath","NewCertOutputPath",undefined,400);var NewCertOutputPathBrowse=CreatePushButton("","NewCertOutputPathBrowse",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[CertOutputPathInput,false,"0","1"]]);NewCertOutputPathBrowse.setControlImage("Browse");CreateGroupBox("$CERT_INFORMATION$","NewCertInfoGroup",480,180);CreateInputField("","NewCertCityTown","NewCertCityTown",undefined,220);CreateInputField("","NewCertStateProvince","NewCertStateProvince",undefined,220);var CertCountryInput=CreateInputField("","NewCertCountry","NewCertCountry",undefined,220);CreatePasswordField("","NewCertPassword","NewCertPassword",undefined,220);CreateInputField("","NewCertOrganization","NewCertOrganization",undefined,220);CreateInputField("","NewCertCommonName","NewCertCommonName",undefined,220);CreateInputField("","NewCertUnit","NewCertUnit",undefined,220);var SSLCertKeyLengthCombo=CreateComboBox("2048","2048",["$PRIVATE_KEY_LEN_1024$","2048","$PRIVATE_KEY_LEN_4096$"],["1024","2048","4096"],"NewCertSSLKeyLength","NewCertSSLKeyLength",undefined,"",false,220,undefined,OnCreateNewCertificate);SSLCertKeyLengthCombo.setSelectedItems([1]);CertCountryInput.onControlTextChanged=function(sText){if(this.m_bIgnore)return;if(sText.length>2)sText=sText.substr(0,2);this.m_bIgnore=true;this.setControlText(sText.toLocaleUpperCase());this.m_bIgnore=false;};CreateDialogPushButton("$CREATE_BUTTON$","CreateNewCertButton",OnCreateNewCertificate);CreateDialogPushButton("$CANCEL_BUTTON$","CancelNewCertButton",OnCancelNewCertificate);CreateDialogPushButton("$HELP_BUTTON$","HelpNewCertButton",OnNewCertificateHelp);function OnCreateNewCertificate(){var NewCertForm=document.NewCertificateForm;var bOkay=true;var sErrorStr="$NEW_CERT_EMPTY_FIELD$";for(var nIndex in NewCertForm.elements){if((NewCertForm.elements[nIndex]!=null)&&(NewCertForm.elements[nIndex].value=="")&&NewCertForm.elements[nIndex].id.indexOf("Browse")<0&&NewCertForm.elements[nIndex].id.indexOf("btn-")<0){bOkay=false;break;}}if(String(document.NewCertificateForm.NewCertCountry.value).length!=2){sErrorStr="$NEW_CERT_TWO_DIGIT_COUNTRY$";bOkay=false;}if(bOkay){var CreateCertRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+g_sPageObjectType+"."+g_sPageObjectID+".CreateCertificate");SavingDialog(true);CreateCertRequest.setParameter("CertName",document.NewCertificateForm.NewCertSetName.value);CreateCertRequest.setParameter("CertPath",document.NewCertificateForm.NewCertOutputPath.value);CreateCertRequest.setParameter("City",document.NewCertificateForm.NewCertCityTown.value);CreateCertRequest.setParameter("State",document.NewCertificateForm.NewCertStateProvince.value);CreateCertRequest.setParameter("Country",document.NewCertificateForm.NewCertCountry.value);CreateCertRequest.setParameter("Password",document.NewCertificateForm.NewCertPassword.value);CreateCertRequest.setParameter("Organization",document.NewCertificateForm.NewCertOrganization.value);CreateCertRequest.setParameter("CommonName",document.NewCertificateForm.NewCertCommonName.value);CreateCertRequest.setParameter("Unit",document.NewCertificateForm.NewCertUnit.value);CreateCertRequest.setParameter("PrivateKeyLength",SSLCertKeyLengthCombo.getItemValue(SSLCertKeyLengthCombo.getSelectedItems()[0]));CreateCertRequest.response=function(){var nResult=OnSaveComplete(this);if(!nResult)ConfirmDialog("$NEW_CERT_USE_NOW$",OnUseNewCert,function(){CloseConfirmDialog();OnCancelNewCertificate();});};CreateCertRequest.request(null);}else AlertDialog(sErrorStr);}function OnUseNewCert(){var sCertPath=document.NewCertificateForm.NewCertOutputPath.value;var sCertName=document.NewCertificateForm.NewCertSetName.value;var sCertPassword=document.NewCertificateForm.NewCertPassword.value;var sSlash=(sCertPath.indexOf('/')>=0)?"/":"\\";if(sCertPath.substr(sCertPath.length-1)!=sSlash)sCertPath+=sSlash;CloseConfirmDialog();OnCancelNewCertificate();SSLCertificateInput.setControlText(sCertPath+sCertName+".crt");SSLKeyInput.setControlText(sCertPath+sCertName+".key");SSLPasswordInput.setControlText(sCertPassword);SSLCACertificateInput.setControlText("");OnSaveSSLCert();}function OnShowNewCertificateDialog(){if(g_bUsingFIPS){SSLCertKeyLengthCombo.setItemText(["2048","$PRIVATE_KEY_LEN_4096$"]);SSLCertKeyLengthCombo.setItemValue(["2048","4096"]);SSLCertKeyLengthCombo.setItemCount(2);SSLCertKeyLengthCombo.setSelectedItems([0]);SSLCertKeyLengthCombo.setControlText(SSLCertKeyLengthCombo.getItemText([0]));}else{SSLCertKeyLengthCombo.setItemText(["$PRIVATE_KEY_LEN_1024$","2048","$PRIVATE_KEY_LEN_4096$"]);SSLCertKeyLengthCombo.setItemValue(["1024","2048","4096"]);SSLCertKeyLengthCombo.setItemCount(3);SSLCertKeyLengthCombo.setSelectedItems([1]);SSLCertKeyLengthCombo.setControlText(SSLCertKeyLengthCombo.getItemText([1]));}ReplaceDialog(g_sBusyDialog,"NewCertificateDialog");}function OnCancelNewCertificate(){HideDialog("NewCertificateDialog");}function OnNewCertificateHelp(){if(g_bDomainNav){sExpandNode="Item5_4";sHelpFile="Help-Encryption-Domain.htm";}else{sExpandNode="Item2_3";sHelpFile="Help-Encryption-Server.htm";}LaunchHelp(sHelpFile,sExpandNode);}</script>