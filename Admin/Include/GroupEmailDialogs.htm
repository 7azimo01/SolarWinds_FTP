%PRIV_GROUP_ADMIN%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<div id="GroupEmailListinner" style="display:none;"><div id="EmailGroups" style="padding:0 5px 0 5px;"><div style="display:inline;"><img alt="$GROUP_EMAIL_LIST_DIALOG_TITLE$" src="%COMMON_FILE%Images/GroupEmail32.png" width="32" height="32" class="header-icon" />$EMAIL_GROUPS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><table border="0" cellpadding="0" cellspacing="0" style="width:100%;padding-right:10px;"><tr><td style="vertical-align:top;width:auto;"><span id="EmailGroupsList"></span></td><td style="text-align:center;width:40px;"><div><span id="AddEmailGroupButton"></span></div><div><span id="RemoveEmailGroupButton"></span></div></td><td style="vertical-align:top;width:auto;"><span id="EmailSelectGroupsList"></span></td></tr></table><div style="text-align:right;padding:10px 20px 0 0;"><span id="OKEmailGroupButton"></span><span id="CancelEmailGroupButton"></span></div></div></div><script type="text/javascript" language="javascript">var gEmailGroupType;BuildDialog("$GROUP_EMAIL_LIST_DIALOG_TITLE$","GroupEmailList","525","335","","$CLOSE_CANCEL$","GroupEmail16.png");function OnShowGroupEmailDialog(aEmailType){gEmailGroupType=aEmailType[0];EventsList.EnableUpdates(false);GroupsEmailList.setSelectedRows([-1]);SelectGroupsEmailList.setSelectedRows([-1]);if(gEmailGroupType=="To"){sClassType="ToGroupName";SelectGroupsEmailList.EnableUpdates(true,"%SELECT_GROUP_EMAIL_OBJECT%","ToGroups.xml?ID="+g_EventObjID);GroupsEmailList.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml?ID="+g_EventObjID);}else{sClassType="BccGroupName";SelectGroupsEmailList.EnableUpdates(true,"%SELECT_GROUP_EMAIL_OBJECT%","BCCGroups.xml?ID="+g_EventObjID);GroupsEmailList.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml?ID="+g_EventObjID);}ReplaceDialog(g_sBusyDialog,"GroupEmailList",OnGroupEmailListUpdate);}function OnRemoveEmailGroupDone(){if(gEmailGroupType=="To"){GroupsEmailList.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml?ID="+g_EventObjID);}else{GroupsEmailList.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml?ID="+g_EventObjID);}}function OnRemoveEmailGroup(){if(gEmailGroupType=="To"){sClassType="ToGroupName";}else{sClassType="BccGroupName";}GroupsEmailList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSUEvent."+g_EventObjID+"."+sClassType,undefined,"$SELECT_ONE_GROUP_EMAIL_DELETE$",OnRemoveEmailGroupDone);}function OnGroupEmailListUpdate(){GroupsEmailList.EnableUpdates(false);SelectGroupsEmailList.EnableUpdates(false);EventsList.EnableUpdates(true);ClearGrid(GroupsEmailList,true);ClearGrid(SelectGroupsEmailList,true);}function OnOKCancelEmailGroup(){HideDialog('GroupEmailList');GroupsEmailList.EnableUpdates(false);SelectGroupsEmailList.EnableUpdates(false);EventsList.EnableUpdates(true);ClearGrid(GroupsEmailList,true);ClearGrid(SelectGroupsEmailList,true);}function OnSaveSelectEmailGroup(){if((SelectGroupsEmailList.getSelectedRows()!="")&&(SelectGroupsEmailList.getSelectedRows()!=-1)){var IDs=new Array();var sFormNames="";SelectedCells=SelectGroupsEmailList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var sGroupID=SelectGroupsEmailList.getCellText(0,SelectedCells[nIndex]);IDs.push(sGroupID);}if(gEmailGroupType=="To"){sClassType="ToGroupName";}else{sClassType="BccGroupName";}var AddGroupRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml?Command=ObjectCommand&Object=CSUEvent."+g_EventObjID+".AddGroupNames");AddGroupRequest.setParameter("Class","C"+sClassType);AddGroupRequest.setParameter("GroupName",IDs);AddGroupRequest.response=function(){var xmlDoc=this.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"result");var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((nResult!=undefined)&&(nResult!=g_nSessionOkay))AlertDialog(GetResultText(0,"",sResultText));if(gEmailGroupType=="To"){GroupsEmailList.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailToGroups.xml?ID="+g_EventObjID);}else{GroupsEmailList.ForceUpdate("%GROUP_EMAIL_OBJECT%","EmailBCCGroups.xml?ID="+g_EventObjID);}};SavingDialog(true);AddGroupRequest.request(null);}else AlertDialog("$SELECT_ONLY_ONE_EMAIL_GROUP$");}var AddEmailAvailableGroupButton=CreatePushButton("","AddEmailGroupButton",OnSaveSelectEmailGroup,undefined,undefined,undefined,"GreenLeftArrow");var RemoveEmailAvailableGroupButton=CreatePushButton("","RemoveEmailGroupButton",OnRemoveEmailGroup,undefined,undefined,undefined,"GreenRightArrow");AddEmailAvailableGroupButton.setStyle("visibility","hidden");RemoveEmailAvailableGroupButton.setStyle("visibility","hidden");var GroupsEmailList=CreateAdminGrid("EmailGroupsList",["$GROUP_EMAIL_LIST_DIALOG_TITLE$"],[216],"%GROUP_EMAIL_OBJECT%","groups","group",2);GroupsEmailList.setStyle("height","200px");GroupsEmailList.onSelectedRowsChangedDef=GroupsEmailList.onSelectedRowsChanged;GroupsEmailList.onSelectedRowsChanged=function(anSelectedRows){if((anSelectedRows.length>=1)&&(anSelectedRows[0]!=-1)){RemoveEmailAvailableGroupButton.setStyle("visibility","visible");SelectGroupsEmailList.setSelectedRows([-1]);}else RemoveEmailAvailableGroupButton.setStyle("visibility","hidden");this.onSelectedRowsChangedDef(anSelectedRows);};GroupsEmailList.getCellImage=function(nCol,nRow){return("Group");};var SelectGroupsEmailList=CreateAdminGrid("EmailSelectGroupsList",["$SELECT_GROUP_DIALOG_TITLE$"],[216],"%SELECT_GROUP_EMAIL_OBJECT%","groups","group",2,OnSaveSelectEmailGroup);SelectGroupsEmailList.setStyle("height","200px");SelectGroupsEmailList.onSelectedRowsChangedDef=SelectGroupsEmailList.onSelectedRowsChanged;SelectGroupsEmailList.onSelectedRowsChanged=function(anSelectedRows){if((anSelectedRows.length>=1)&&(anSelectedRows[0]!=-1)){AddEmailAvailableGroupButton.setStyle("visibility","visible");GroupsEmailList.setSelectedRows([-1]);}else AddEmailAvailableGroupButton.setStyle("visibility","hidden");this.onSelectedRowsChangedDef(anSelectedRows);};SelectGroupsEmailList.getCellImage=function(nCol,nRow){return("Group");};CreateDialogPushButton("$CANCEL_BUTTON$","CancelEmailGroupButton",OnOKCancelEmailGroup);CreateDialogPushButton("$OK_BUTTON$","OKEmailGroupButton",OnOKCancelEmailGroup);</script>