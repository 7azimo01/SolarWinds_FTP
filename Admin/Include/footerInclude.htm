%PRIV_GROUP_ADMIN%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<script type="text/javascript" language="javascript">var g_bTreeIsWindowAuth=(%WINDOWS_AUTH_SUPPORT%==1);var g_bFoundDomain=false;var m_bUpdateAvail=(%UPGRADE_AVAILABLE%!=0);var m_sLatestVersion="%LATEST_RELEASE_VERSION%";var m_sInstalledVersion="%VERSION%";var m_sLatestReleaseDate="%LATEST_RELEASE_DATE%";var g_domainConfigExecuted=false;function DomainLicenseInfo(bWizard){var DomainLicenseObj=undefined;if(bWizard)fnCallback=OnDomainWizLicenseInfoDone;else fnCallback=OnDomainLicenseInfoDone;if(DomainLicenseObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"MCLicenseDomainInfo.xml?ID=%SERVER_ID%"),fnCallback)){DomainLicenseObj.request();}}function OnDomainLicenseInfoDone(){var xmlDoc=this.getResponseXML();var nMaxDomains=GetXMLValue(xmlDoc,"MaxDomainsLicense");var nTotalDomains=GetXMLValue(xmlDoc,"TotalDomains");if(nMaxDomains!="-1"&&nMaxDomains!="0"){document.getElementById("TotalDomainsDiv").innerHTML="$USING$ "+nTotalDomains+" $OF$ "+nMaxDomains+" $MAX_DOMAINS_ALLOWED$";document.getElementById("TotalDomainsDiv").style.display="block";}}function OnDomainWizLicenseInfoDone(){var xmlDoc=this.getResponseXML();var nMaxDomains=GetXMLValue(xmlDoc,"MaxDomainsLicense");var nTotalDomains=GetXMLValue(xmlDoc,"TotalDomains");if(nMaxDomains!="-1"&&nMaxDomains!="0"){document.getElementById("WizTotalDomainsDiv").innerHTML="$USING$ "+nTotalDomains+" $OF$ "+nMaxDomains+" $MAX_DOMAINS_ALLOWED$";document.getElementById("WizTotalDomainsDiv").style.display="block";}}</script><div id="WizSMTPConfigDialoginner" style="display:none;"><div style="display:inline;"><img alt="$SMTP_CONFIG$" src="%ADMIN_FILE%Images/Email32.png" width="32" height="32" class="header-icon" />$SMTP_CONFIG_INFO_DOMAIN$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="WizSMTPConfigForm" id="WizSMTPConfigForm" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="WizSMPTServerGroup"><div style="padding:0 0 5px 5px;">$SMTP_SERVER_LABEL$:<div style="overflow:auto"><span id="WizSMTPServer"></span></div>$SMTP_PORT_LABEL$:<div style="overflow:auto"><span id="WizSMTPServerPort"></span></div><div><span id="WizSMTPSSL"></span></div><div id="WizSMPTCertDiv" style="display:none;"><span id="WizSMTPUseSSLCertificate"></span></div><div id="WizSMTPExplicitDiv" style="display:none;"><span id="WizSMTPUseExplicitSSL"></span></div>$SMTP_FROM_ADDRESS_LABEL$:<div style="overflow:auto"><span id="WizSMTPFromAddress"></span></div>$SMTP_FROM_NAME_LABEL$ ($OPTIONAL$):<div style="overflow:auto"><span id="WizSMTPFromName"></span></div><div><span id="WizSMTPRequiresLogin"></span></div></div></span><span id="WizSMPTAuthGroup" style="display:none;"><div style="padding:0 0 5px 5px;">$SMTP_ACCOUNT_NAME_LABEL$:<div style="overflow:auto"><span id="WizSMTPAccountName"></span></div>$SMTP_ACCOUNT_PASSWORD_LABEL$:<div style="overflow:auto"><span id="WizSMTPPassword"></span></div></div></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="WizSaveSMTPConfigButton"></span><br /><span id="WizCancelSMTPConfigButton"></span><br /><br /><span id="WizHelpSMTPConfigButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var sWizPortValue;sWizPortValue="%CServer.%SERVER_ID%.SMTPServerPort%";BuildDialog("$SMTP_CONFIG_TITLE$","WizSMTPConfigDialog","450","390","","$CLOSE_CANCEL$","Email16.png");function OnSMTPConfigWiz(){ShowHideSMTPAuthWiz();ShowDialog("WizSMTPConfigDialog");}function ShowHideSMTPAuthWiz(){var bValue=WizSMTPRequireLoginCheckbox.getControlValue();if(bValue)document.getElementById("WizSMPTAuthGroup").style.display="block";else document.getElementById("WizSMPTAuthGroup").style.display="none";}function ShowHideSMTPSSLCertWiz(){var bValue=WizSMTPRequiresSSLCheckbox.getControlValue();var bExplicitSSL=WizSMTPUseExplicitSSLCheckbox.getControlValue();if(bValue){document.getElementById("WizSMPTCertDiv").style.display="block";document.getElementById("WizSMTPExplicitDiv").style.display="block";if(!bExplicitSSL){SMTPPortInput.setControlText("465");}else{if(sWizPortValue.length)SMTPPortInput.setControlText(sWizPortValue);}}else{document.getElementById("WizSMPTCertDiv").style.display="none";document.getElementById("WizSMTPExplicitDiv").style.display="none";if(sWizPortValue.length)SMTPPortInput.setControlText(sWizPortValue);}}function OnToggleExplicitSSLWiz(){var bValue=WizSMTPUseExplicitSSLCheckbox.getControlValue();if(bValue){if(sWizPortValue.length)SMTPPortInput.setControlText(sWizPortValue);}else{SMTPPortInput.setControlText("465");}}function OnCancelSMTPConfigWiz(){HideDialog('WizSMTPConfigDialog');}function OnSaveSMTPConfigWizEx(){HideDialog("WizSMTPConfigDialog");}function OnSaveSMTPConfigWiz(){var sRequiredField="$SMTP_REQUIRED_FIELD$";var server=String(SMTPServerInput.getControlText());var fromAddress=String(SMTPFromAddressInput.getControlText());if(server.length>0||fromAddress.length>0){if(server.length<1){sRequiredField=sRequiredField.replace("$Label","$SMTP_SERVER_LABEL$");AlertDialog(sRequiredField);}else if((fromAddress.length<1)||(!IsValidEmailAddressString(fromAddress))){sRequiredField=sRequiredField.replace("$Label","$SMTP_FROM_ADDRESS_LABEL$");AlertDialog(sRequiredField);}else OnSaveSMTPConfigWizEx();}else OnSaveSMTPConfigWizEx();}function OnSMTPConfigHelpWiz(){var sExpandNode="Item10_4";LaunchHelp("Help-SMTP.htm",sExpandNode);}CreateGroupBox("$SMTP_SERVER_GROUP$","WizSMPTServerGroup","320px","245px",true);CreateGroupBox("$SMTP_AUTH_GROUP$","WizSMPTAuthGroup","280px","100px",true);var SMTPServerInput=CreateInputField("","WizSMTPServer","WizSMTPServer","",250,undefined,undefined);var SMTPPortInput=CreateInputField("","WizSMTPServerPort","WizSMTPServerPort","",250,undefined,undefined);var SMTPAccountNameInput=CreateInputField("","WizSMTPAccountName","WizSMTPAccountName","",250,undefined,undefined);var SMTPPasswordInput=CreatePasswordField("","WizSMTPPassword","WizSMTPPassword","",250,undefined,undefined);var SMTPFromAddressInput=CreateInputField("","WizSMTPFromAddress","WizSMTPFromAddress","",250,undefined,undefined);var SMTPFromNameInput=CreateInputField("","WizSMTPFromName","WizSMTPFromName","",250,undefined,undefined);var WizSMTPRequiresSSLCheckbox=CreateCheckBox("$SMTP_REQUIRE_SSL$","WizSMTPSSL","WizSMTPSSL","0",ShowHideSMTPSSLCertWiz);var WizSMTPUseSSLCertCheckbox=CreateCheckBox("$SMTP_USE_SSL_CERT$","WizSMTPUseSSLCertificate","WizSMTPUseSSLCertificate","0");var WizSMTPUseExplicitSSLCheckbox=CreateCheckBox("$SMTP_USE_EXPLICIT_SSL$","WizSMTPUseExplicitSSL","WizSMTPUseExplicitSSL","0",OnToggleExplicitSSLWiz);var WizSMTPRequireLoginCheckbox=CreateCheckBox("$SMTP_REQUIRE_LOGIN$","WizSMTPRequiresLogin","WizSMTPRequiresLogin","0",ShowHideSMTPAuthWiz);CreateDialogPushButton("$OK_BUTTON$","WizSaveSMTPConfigButton",OnSaveSMTPConfigWiz);CreateDialogPushButton("$CANCEL_BUTTON$","WizCancelSMTPConfigButton",OnCancelSMTPConfigWiz);CreateDialogPushButton("$HELP_BUTTON$","WizHelpSMTPConfigButton",OnSMTPConfigHelpWiz);</script><script type="text/javascript" language="javascript">var g_nCurrentDomainWizardPage=0;var g_aDomainWizPageArray=[1,2,3,4,5,6];var g_aDomainWizTextArray=["$DOMAIN_DETAILS$","$SERVER_TYPE$","$FILE_SHARING$","$PROTOCOLS$","$IP_LISTENERS$","$ENCRYPTION$"];var g_bMFTLicense=(parseInt(%CServer.%SERVER_ID%.IsMFTEdition%)!=0);var g_nTotalDomainWizardPages=6;if(!g_bMFTLicense){g_aDomainWizPageArray=[1,4,5,6];g_nTotalDomainWizardPages=6;}var g_bPasswordRecoveryLicense=(parseInt("%CServer.%SERVER_ID%.PasswordRecoveryLicense%")?true:false);</script><div id="DomainWizardDialoginner" style="display:none;"><div style="width:175px;float:left;height:410px;background:#f5f5f5;border-right:1px solid #c5c5c5;padding:25px 20px 0;"><span class="PurpleLabelBold" style="font-size:12pt;" >$WELCOME$!</span><div style="font-size:12pt;">$SU_SETUP_WIZ$</div><p>$DOMAIN_WIZARD_INFO$</p><div><table id="WizStepTable" padding="0" border="0" cellspacing="0" cellpadding="0"><tr id="WizStep-1"><td><div class="circle active"><span>1</span></div><div class="wizstep active"></div></td><td class="steptext active"><span>$DOMAIN_DETAILS$</span></td></tr><tr id="WizStep-2"><td><div class="circle"><span>2</span></div><div class="wizstep" style="display:none;"></div></td><td class="steptext"><span>$SERVER_TYPE$</span></td></tr><tr id="WizStep-3" style="display:none;"><td><div class="circle"><span>3</span></div><div class="wizstep"></div></td><td class="steptext"><span>$FILE_SHARING$</span></td></tr><tr id="WizStep-4" style="display:none;"><td><div class="circle"><span>4</span></div><div class="wizstep"></div></td><td class="steptext"><span>$PROTOCOLS$</span></td></tr><tr id="WizStep-5" style="display:none;"><td><div class="circle"><span>5</span></div><div class="wizstep"></div></td><td class="steptext"><span>$IP_LISTENERS$</span></td></tr><tr id="WizStep-6" style="display:none;"><td><div class="circle"><span>6</span></div></td><td class="steptext"><span>$ENCRYPTION$</span></td></tr></table></div></div><div style="width:584px;float:left;height:410px;"><div style="height: 100%;margin-bottom: -75px;padding: 25px;"><form name="Domain_Wizard_Form" onsubmit="return (false);"><div style="clear:both;text-align:right;display:none;padding-right:5px;" id="WizTotalDomainsDiv">&nbsp;</div><table border="0" class="DialogTable"><tr><td style="vertical-align:top;height:275px;padding:0 5px 0 5px;"><div id="DomainWizardDialog-1" style="display:block;">$DOMAIN_NAME_WIZARD_DESCR$ <br /><br />$NAME$:<br/><div style="overflow:auto"><span id="DomainName-Wizard"></span></div><br />$DOMAIN_DESCR_WIZARD_DESCR$ <br /><br />$DESCRIPTION$:<br/><textarea name="Wizard_Description" id="Wizard_Description" class="aw-border" style="width:350px;" cols="80" rows="5"></textarea><br /><span id="NewEnableDomain"></span></div><div id="DomainWizardDialog-2" style="display:none;"><span class="PurpleLabelBold">$WHAT_TYPE_SERVER$</span><div style="margin-top:20px;clear:both;"><div class="dialog-Groupbox" style="width:200px;height:120px;float:left;"><span class="PurpleLabelBold" style="font-size:11pt;">$FILE_TRANSFER_SERVER$</span><div style="margin:10px 0;font-weight:bold;font-size:9pt; height:50px;">$SETUP_FILE_TRANS_TXT$</div><div><span id="FileServerTypeTrans"></span></div></div><div class="dialog-Groupbox" style="width:200px;height:120px;margin-left:35px;float:left;"><span class="PurpleLabelBold" style="font-size:11pt;">$FILE_SHARING_SERVER$</span><div style="margin:10px 0;font-weight:bold;font-size:9pt; height:50px;">$SETUP_FILE_SHARING_TXT$</div><div><span id="FileServerTypeSharing"></span></div></div></div></div><div id="DomainWizardDialog-3" style="display:none;"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$FILE_SHARE_TAB$" src="%COMMON_FILE%Images/FileShare32.png" width="32" height="32"/></td><td style="vertical-align:top;">$FILE_SHARE_TAB_INFO$</td></tr></table><div><div><label id="AdHocURLDomainLabel-Wiz" for="AdHocURLDomain-Wiz">$FILE_SHARE_DOMAIN_URL$:</label><br /><div style="overflow:auto;"><span id="AdHocURLDomain-Wiz"></span></div></div><div><label id="AdHocRootPathLabel-Wiz" for="AdHocFileShareRoot-Wiz">$FILE_SHARE_ROOT_PATH$:</label><br /><div style="overflow:auto"><span id="AdHocFileShareRoot-Wiz"></span><span id="AdHocFileShareRootBrowseWiz"></span></div></div><div id="AdHocURLSecure-Wiz"></div><span id="WizConfigSMTPButton" style="float:right;"></span></div></div><div id="DomainWizardDialog-4" style="display:none;">$DOMAIN_TYPE_WIZARD_DESCR$ <br /><br /><div style="margin-bottom:5px;"><div style="float:left;width:210px;"><span id="EnableFTPProtocol"></span></div><div style="float:left;width:70px;"><div style="overflow:auto"><span id="FTPPortInput-Wizard"></span></div></div></div><div style="margin-bottom:5px;clear:both;" id="WizardFTPSOptions"><div style="float:left;width:210px;"><span id="EnableSSLProtocol"></span></div><div style="float:left;width:70px;"><div style="overflow:auto"><span id="SSLPortInput-Wizard"></span></div></div></div><div style="margin-bottom:5px;clear:both;" id="WizardSSHOptions"><div style="float:left;width:210px;"><span id="EnableSSHProtocol"></span></div><div style="float:left;width:70px;"><div style="overflow:auto"><span id="SSHPortInput-Wizard"></span></div></div></div><div style="margin-bottom:5px;clear:both;"><div style="float:left;width:210px;"><span id="EnableHTTPProtocol"></span></div><div style="float:left;width:70px;"><div style="overflow:auto"><span id="HTTPPortInput-Wizard"></span></div></div></div><div style="margin-bottom:5px;clear:both;" id="WizardHTTPSOptions"><div style="float:left;width:210px;"><span id="EnableHTTPSProtocol"></span></div><div style="float:left;width:70px;"><div style="overflow:auto"><span id="HTTPSPortInput-Wizard"></span></div></div></div></div><div id="DomainWizardDialog-5" style="display:none;">$DOMAIN_IP_WIZARD_DESCR$ <br /><br />$LISTENER_IPV4$:<br/><div style="overflow:auto"><span id="Listener_IPv4_WizardCombo"></span></div><div id="IPv6Container" style="display:none;"><span id="EnableIPv4"></span><br />$LISTENER_IPV6$:<br/><div style="overflow:auto"><span id="Listener_IPv6_WizardCombo"></span></div><span id="EnableIPv6"></span></div></div><div id="DomainWizardDialog-6" style="display:none;">$DOMAIN_PASSWORD_ENCRYPT_WIZARD_DESCR$ <br /><br /><span id="EnablePasswordRecovery"></span></div></td></tr></table></form></div><div style="width:100%;background:#eae9eb;height:50px;border-top:1px solid #c5c5c5;text-align:right;line-height: 50px;"><span id="BackDomainWizardButton"></span>&nbsp;&nbsp;<span id="NextDomainWizardButton"></span>&nbsp;&nbsp;&nbsp;<span id="CancelDomainWizardButton" style="padding-right:25px;"></span></div></div><div style="height:1px;clear:both;overflow:hidden;">&nbsp;</div></div><script type="text/javascript" language="javascript">var g_bShowPWRecoveryAlert=true;BuildDialog("$DOMAIN_WIZARD$","DomainWizardDialog","800","","","$CLOSE_CANCEL$");$("#DomainWizardDialogBody").css("padding","0");function OnLaunchUserPage(){SubmitDomain("%ADMIN_FILE%DomainUsers.htm",1,"ShowWiz=1");}function OnHideDomainWizard(){$(document).unbind("keypress.key13");}function OnCancelUserPage(nObjectId){if((!g_bConsoleInclude)&&(nObjectId!="")&&g_bDomainNav){g_bLinkRequested=true;LoadingDialog(true);var sCurrentURL=window.location.href;var NewURLString=sCurrentURL.replace(GetURLParameter("ID"),nObjectId);window.location=NewURLString;}else if(nObjectId!=""){var nScrollTo;if(!g_bDomainNav||g_bConsoleInclude)nScrollTo=nObjectId;OnLoadDomain(true,nScrollTo);}g_bShowAskUserCreation=false;}function OnSaveWizardDomain(){var sDomainName=DomainNameWizardInput.getControlText();var sDomainDescription=document.Domain_Wizard_Form.Wizard_Description.value;var bHasFileShare=false;var nDomainType=1;if(g_bMFTLicense){if(FileTransferSetupCheck.getControlValue()&&FileSharingSetupCheck.getControlValue())nDomainType=3;else if(FileSharingSetupCheck.getControlValue()){nDomainType=2;}}if(nDomainType==2||nDomainType==3){var sAdHocRootPathWiz=AdHocRootPathWiz.getControlText();var sAdHocDomainURLWiz=AdHocDomainURLWiz.getControlText();var bAdHocURLSecureWiz=(AdHocURLSecureWiz.getControlValue()?1:0);var sSMTPServerInput=SMTPServerInput.getControlText();var sSMTPPortInput=SMTPPortInput.getControlText();var sSMTPAccountNameInput=SMTPAccountNameInput.getControlText();var sSMTPPasswordInput=SMTPPasswordInput.getControlText();var sSMTPFromAddressInput=SMTPFromAddressInput.getControlText();var sSMTPFromNameInput=SMTPFromNameInput.getControlText();var bWizSMTPRequiresSSLCheckbox=(WizSMTPRequiresSSLCheckbox.getControlValue()?1:0);var bWizSMTPUseSSLCertCheckbox=(WizSMTPUseSSLCertCheckbox.getControlValue()?1:0);var bWizSMTPUseExplicitSSLCheckbox=(WizSMTPUseExplicitSSLCheckbox.getControlValue()?1:0);var bWizSMTPRequireLoginCheckbox=(WizSMTPRequireLoginCheckbox.getControlValue()?1:0);bHasFileShare=true;}var sFTPPort=FTPListenerPortWizardInput.getControlText();var sSSLPort=SSLListenerPortWizardInput.getControlText();var sSSHPort=SSHListenerPortWizardInput.getControlText();var sHTTPPort=HTTPListenerPortWizardInput.getControlText();var sHTTPSPort=HTTPSListenerPortWizardInput.getControlText();var bEnableDomain=(WizardEnableDomain.getControlValue()?1:0);var bEnableFTP=(WizardEnableFTP.getControlValue()?1:0);var bEnableFTPS=(WizardEnableSSL.getControlValue()?1:0);var bEnableSSH=(WizardEnableSSH.getControlValue()?1:0);var bEnableHTTP=(WizardEnableHTTP.getControlValue()?1:0);var bEnableHTTPS=(WizardEnableHTTPS.getControlValue()?1:0);if(bHasFileShare&&nDomainType==2){if(bAdHocURLSecureWiz){bEnableHTTPS=1;bEnableHTTP=0;}else{bEnableHTTP=1;bEnableHTTPS=0;}sHTTPPort="80";sHTTPSPort="443";}if(ListenerIPv4WizardInput.getControlText()=="$LISTENER_IPV4_ALL$")sIPv4Value="";else sIPv4Value=ListenerIPv4WizardInput.getControlText();if(ListenerIPv6WizardInput.getControlText()=="$LISTENER_IPV6_ALL$")sIPv6Value="::";else sIPv6Value=ListenerIPv6WizardInput.getControlText();var sBindIPv4Address=sIPv4Value;var sBindIPv6Address=sIPv6Value;var bCreateIPv4=(EnableListenerIPv4.getControlValue())?1:0;var bCreateIPv6=(g_bIPV6Capable&&EnableListenerIPv6.getControlValue())?1:0;var bEnablePasswordRecovery=document.getElementById(WizardEnablePasswordRecovery.getContent("hidden").getId()).value;if((Trim(sDomainName))!=""){SavingDialog(true);var WizardDomainRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.CreateDomain");WizardDomainRequest.setParameter("DomainUsage",nDomainType);WizardDomainRequest.setParameter("DomainName",Trim(sDomainName));WizardDomainRequest.setParameter("Description",sDomainDescription);WizardDomainRequest.setParameter("Enabled",bEnableDomain);if(nDomainType!=2){WizardDomainRequest.setParameter("EnableFTP",bEnableFTP);WizardDomainRequest.setParameter("EnableFTPS",bEnableFTPS);WizardDomainRequest.setParameter("EnableSSH",bEnableSSH);WizardDomainRequest.setParameter("EnableFTP",bEnableFTP);WizardDomainRequest.setParameter("FTPPort",sFTPPort);WizardDomainRequest.setParameter("FTPSPort",sSSLPort);WizardDomainRequest.setParameter("SSHPort",sSSHPort);}WizardDomainRequest.setParameter("EnableHTTP",bEnableHTTP);WizardDomainRequest.setParameter("EnableHTTPS",bEnableHTTPS);WizardDomainRequest.setParameter("HTTPPort",sHTTPPort);WizardDomainRequest.setParameter("HTTPSPort",sHTTPSPort);WizardDomainRequest.setParameter("BindIPv4Address",sBindIPv4Address);WizardDomainRequest.setParameter("BindIPv6Address",sBindIPv6Address);WizardDomainRequest.setParameter("CreateIPv4",bCreateIPv4);WizardDomainRequest.setParameter("CreateIPv6",bCreateIPv6);WizardDomainRequest.setParameter("EnablePasswordRecovery",bEnablePasswordRecovery);if(bHasFileShare){WizardDomainRequest.setParameter("AdHocFileShareRoot",sAdHocRootPathWiz);WizardDomainRequest.setParameter("AdHocURLDomain",sAdHocDomainURLWiz);WizardDomainRequest.setParameter("AdHocURLSecure",bAdHocURLSecureWiz);WizardDomainRequest.setParameter("SMTPServer",sSMTPServerInput);WizardDomainRequest.setParameter("SMTPServerPort",sSMTPPortInput);WizardDomainRequest.setParameter("SMTPAccountName",sSMTPAccountNameInput);WizardDomainRequest.setParameter("SMTPPassword",sSMTPPasswordInput);WizardDomainRequest.setParameter("SMTPFromAddress",sSMTPFromAddressInput);WizardDomainRequest.setParameter("SMTPFromName",sSMTPFromNameInput);WizardDomainRequest.setParameter("SMTPSSL",bWizSMTPRequiresSSLCheckbox);WizardDomainRequest.setParameter("SMTPUseSSLCertificate",bWizSMTPUseSSLCertCheckbox);WizardDomainRequest.setParameter("SMTPUseExplicitSSL",bWizSMTPUseExplicitSSLCheckbox);WizardDomainRequest.setParameter("SMTPRequiresLogin",bWizSMTPRequireLoginCheckbox);}WizardDomainRequest.setAsync(true);WizardDomainRequest.request();WizardDomainRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else{var nDomainObjId=GetXMLValue(XMLDoc,"ObjectID");bByPassRefresh=true;g_nDomainID=nDomainObjId;OnUpdateDomainManager(nDomainObjId,sDomainName);HideDialog("DomainWizardDialog");if(parseInt("%CServer.%SERVER_ID%.CanEmail%")==0&&(parseInt(bEnablePasswordRecovery)==1||(bEnablePasswordRecovery==""&&parseInt("%CServer.%SERVER_ID%.EnablePasswordRecovery%")==1))){setTimeout(function(){AlertDialog("$NO_SMTP_CONFIG$",true,OnConfirmCreateUsers);},0);}else{setTimeout(function(){OnConfirmCreateUsers();},0);}}};}else AlertDialog("$PLEASE_ENTER_DOMAIN_NAME$",undefined,OnEnterDomainName);}function OnConfirmCreateUsers(){setTimeout(function(){ConfirmDialog("$CONFIRM_CREATE_USER$",OnLaunchUserPage,OnCancelUserPage,g_nDomainID);});}function OnCancelWizardDomain(){HideDialog("DomainWizardDialog");}function OnEnterDomainName(){ResetDomainWizard(true);document.getElementById("DomainName_Wizard-box-text").focus();}function OnSetInitialFocus(){OnSetDomainWizardFocus(1);}function ResetDomainWizard(bPartialReset){if(!bPartialReset){DomainNameWizardInput.setControlText("");ListenerIPv4WizardInput.setControlText("$LISTENER_IPV4_ALL$");ListenerIPv4WizardInput.setControlValue("");ListenerIPv6WizardInput.setControlText("$LISTENER_IPV6_ALL$");ListenerIPv6WizardInput.setControlValue("::");document.getElementById("Wizard_Description").value="";FTPListenerPortWizardInput.setControlText("21");SSLListenerPortWizardInput.setControlText("990");SSHListenerPortWizardInput.setControlText("22");HTTPListenerPortWizardInput.setControlText("80");HTTPSListenerPortWizardInput.setControlText("443");WizardEnableDomain.setChecked(true,true);WizardEnableFTP.setChecked(true,true);WizardEnableSSL.setChecked(true,true);WizardEnableSSH.setChecked(true,true);WizardEnableHTTP.setChecked(true,true);WizardEnableHTTPS.setChecked(true,true);}NextDomainWizardButton.setControlText("$NEXT_BUTTON$&gt;&gt;");BackDomainWizardButton.setStyle("visibility","hidden");document.getElementById("DomainWizardDialog-"+g_aDomainWizPageArray[g_nCurrentDomainWizardPage].toString()).style.display="none";document.getElementById("DomainWizardDialog-1").style.display="block";g_nCurrentDomainWizardPage=0;if("%CServer.%SERVER_ID%.SSHLicense%"!="1"){document.getElementById("WizardSSHOptions").style.display="none";WizardEnableSSH.setChecked(false);if("%CServer.%SERVER_ID%.FTPSLicense%"!="1"){document.getElementById("WizardFTPSOptions").style.display="none";WizardEnableSSL.setChecked(false);}if("%CServer.%SERVER_ID%.HTTPSLicense%"!="1"){document.getElementById("WizardHTTPSOptions").style.display="none";WizardEnableHTTPS.setChecked(false);}}setTimeout("OnSetInitialFocus()");$(document).unbind("keypress.key13");$(document).bind("keypress.key13",function(event){var keycode=(event.keyCode?event.keyCode:event.which);if(parseInt(keycode)==13){event.stopPropagation();OnDomainNextWizard();}else if(parseInt(keycode)==27&&(nTopDialog!=undefined)){if(nTopDialog>=0){var TopDialog=Dialogs[nTopDialog].m_Dialog;if((TopDialog.id!=undefined)&&(TopDialog.id!="BusyDialog"))HideDialog(TopDialog.id);}}});DomainLicenseInfo(true);if(g_bMFTLicense){FileTransferSetupCheck.setControlValue(true);FileSharingSetupCheck.setControlValue(true);}else{g_aDomainWizPageArray=[1,4,5,6];g_nTotalDomainWizardPages=6;}$(".steptext,.wizstep,.circle").removeClass("active");$("#WizStep-1 .steptext,#WizStep-1 .wizstep, #WizStep-1 .circle").addClass("active");}function EnterKeyPress(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;var FFEnter=(window.event)?13:e.DOM_VK_RETURN;var evt=e?e:window.event;if((IEKeyCode==FFEsc)&&(nTopDialog!=undefined)){if(nTopDialog>=0){var TopDialog=Dialogs[nTopDialog].m_Dialog;if((TopDialog.id!=undefined)&&(TopDialog.id!="BusyDialog"))HideDialog(TopDialog.id);}}else if((IEKeyCode==FFEnter)){setTimeout(function(){OnDomainNextWizard();},0);}}function OnDomainNextWizard(){var bStopNext=false;if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==5){if(ListenerIPv4WizardInput.getControlText()=="$LISTENER_IPV4_ALL$"){document.getElementById(ListenerIPv4WizardInput.getContent("hidden").getId()).value="";}if(ListenerIPv6WizardInput.getControlText()=="$LISTENER_IPV6_ALL$"){document.getElementById(ListenerIPv6WizardInput.getContent("hidden").getId()).value="::";}var bCheckIPv4=(EnableListenerIPv4.getControlValue())?true:false;var bCheckIPv6=(g_bIPV6Capable&&EnableListenerIPv6.getControlValue())?true:false;if((!bCheckIPv4&&!bCheckIPv6)){bStopNext=true;AlertDialog("$PLEASE_CREATE_IP_LISTENER$",undefined,undefined);}}if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==1&&(Trim(DomainNameWizardInput.getControlText()))==""){setTimeout(function(){AlertDialog("$PLEASE_ENTER_DOMAIN_NAME$",undefined,OnEnterDomainName);},0);$(document).unbind("keypress.key13");}else if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==2&&(!FileTransferSetupCheck.getControlValue()&&!FileSharingSetupCheck.getControlValue())){setTimeout(function(){AlertDialog("$PLEASE_SELECT_SERVER_TYPE$");},0);}else if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==3&&((Trim(AdHocRootPathWiz.getControlText()))==""||(Trim(AdHocDomainURLWiz.getControlText()))=="")){setTimeout(function(){AlertDialog("$PLEASE_ENTER_SHARE_DETAILS$");},0);}else if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==g_nTotalDomainWizardPages)OnSaveWizardDomain();else if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]<g_nTotalDomainWizardPages&&!bStopNext){document.getElementById("DomainWizardDialog-"+g_aDomainWizPageArray[g_nCurrentDomainWizardPage].toString()).style.display="none";g_nCurrentDomainWizardPage++;if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==g_nTotalDomainWizardPages)NextDomainWizardButton.setControlText("$FINISH_BUTTON$");if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==1)BackDomainWizardButton.setStyle("visibility","hidden");else BackDomainWizardButton.setStyle("visibility","visible");document.getElementById("DomainWizardDialog-"+g_aDomainWizPageArray[g_nCurrentDomainWizardPage].toString()).style.display="block";OnSetDomainWizardFocus(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]);}$(".steptext,.wizstep,.circle").removeClass("active");$("#WizStep-"+(g_nCurrentDomainWizardPage+1)+" .steptext,#WizStep-"+(g_nCurrentDomainWizardPage+1)+" .wizstep, #WizStep-"+(g_nCurrentDomainWizardPage+1)+" .circle").addClass("active");}function OnSetDomainWizardFocus(nFocusLayer){var sFocusElement;switch(nFocusLayer){case(1):sFocusElement="DomainName_Wizard-box-text";break;case(5):ListenerIPv4WizardInput.setSelectedItems([-1]);ListenerIPv6WizardInput.setSelectedItems([-1]);break;}if(sFocusElement!=undefined)document.getElementById(sFocusElement).focus();}function OnDomainBackWizard(){if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]>1){document.getElementById("DomainWizardDialog-"+g_aDomainWizPageArray[g_nCurrentDomainWizardPage].toString()).style.display="none";g_nCurrentDomainWizardPage--;if(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]==1)BackDomainWizardButton.setStyle("visibility","hidden");NextDomainWizardButton.setControlText("$NEXT_BUTTON$&gt;&gt;");NextDomainWizardButton.setStyle("visibility","visible");document.getElementById("DomainWizardDialog-"+g_aDomainWizPageArray[g_nCurrentDomainWizardPage].toString()).style.display="block";OnSetDomainWizardFocus(g_aDomainWizPageArray[g_nCurrentDomainWizardPage]);}$(".steptext,.wizstep,.circle").removeClass("active");$("#WizStep-"+(g_nCurrentDomainWizardPage+1)+" .steptext,#WizStep-"+(g_nCurrentDomainWizardPage+1)+" .wizstep, #WizStep-"+(g_nCurrentDomainWizardPage+1)+" .circle").addClass("active");}function OnShowServerSettings(){var sServerRecoverPasswordVal=g_bEnablePasswordRecovery;if(!g_bPasswordRecoveryLicense)sServerRecoverPasswordVal="0";ServerEnablePasswordRecovery.setControlValue(sServerRecoverPasswordVal);ShowDialog("ChangeServerSettingsDialog");}function OnRecoverPassWordChecked(){if(!g_bPasswordRecoveryLicense&&g_bShowPWRecoveryAlert){AlertDialog("$FEATURE_NOT_AVAILABLE$");g_bShowPWRecoveryAlert=false;}}var DomainNameWizardInput=CreateInputField("","DomainName-Wizard","DomainName_Wizard","",180,undefined,undefined);var WizardEnableDomain=CreateCheckBox("$ENABLE_DOMAIN$","NewEnableDomain","New_Enabled",true,undefined,true);var WizardEnableFTP=CreateCheckBox("$LISTENER_TYPE_FTP_DESC$","EnableFTPProtocol","Enable_FTP",true,undefined,true);var WizardEnableSSL=CreateCheckBox("$LISTENER_TYPE_IMPLICIT_SSL_DESC$","EnableSSLProtocol","Enable_SSL",true,undefined,true);var WizardEnableSSH=CreateCheckBox("$LISTENER_TYPE_SSH_DESC$","EnableSSHProtocol","Enable_SSH",true,undefined,true);var WizardEnableHTTP=CreateCheckBox("$LISTENER_TYPE_HTTP_DESC$","EnableHTTPProtocol","Enable_HTTP",true,undefined,true);var WizardEnableHTTPS=CreateCheckBox("$LISTENER_TYPE_HTTPS_DESC$","EnableHTTPSProtocol","Enable_HTTPS",true,undefined,true);var AdHocRootPathWiz=CreateInputField("","AdHocFileShareRoot-Wiz","AdHocFileShareRoot_wiz",undefined,340,20,false,undefined,true);var AdHocDomainURLWiz=CreateInputField("","AdHocURLDomain-Wiz","AdHocURLDomain_wiz",undefined,340,20,false,undefined,true);var AdHocURLSecureWiz=CreateCheckBox("$FILE_SHARE_USE_SECURE_URL$","AdHocURLSecure-Wiz","AdHocURLSecure_wiz",0,undefined);var AdHocRootPathBrowseWiz=CreatePushButton("","AdHocFileShareRootBrowseWiz",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[AdHocRootPathWiz,false,"0","1",OnSetAdHocRootPathWiz,false,undefined]]);AdHocRootPathBrowseWiz.setControlImage("Browse");function OnSetAdHocRootPathWiz(sValue,inputObj){if(AdHocRootPathWiz.getControlText()=="")AdHocRootPathWiz.setControlText(decodeURIComponent(g_sCurrentDir));inputObj.setControlText(sValue);inputObj.getContent("box/text").element().focus();}function OnShowDomainWizard(){ResetDomainWizard(false);ShowDialog('DomainWizardDialog',undefined,OnHideDomainWizard);}var aIPv4WizardListener=new Array();var aIPv4WizardListenerText=new Array();var aIPv4WizardRaw=new Array();aIPv4WizardListenerText[0]="$LISTENER_IPV4_ALL$";aIPv4WizardListener[0]="";sRawIPv4WizardListeners="%CServer.%SERVER_ID%.AvailableIPv4Addresses%";aIPv4WizardRaw=sRawIPv4WizardListeners.split(',');aIPv4WizardListenerText=aIPv4WizardListenerText.concat(aIPv4WizardRaw);aIPv4WizardListener=aIPv4WizardListener.concat(aIPv4WizardRaw);var aIPv6WizardListener=new Array();var aIPv6WizardListenerText=new Array();var aIPv6WizardRaw=new Array();var g_bIPV6Capable=false;aIPv6WizardListenerText[0]="$LISTENER_IPV6_ALL$";aIPv6WizardListener[0]="::";sRawIPv6WizardListeners="%CServer.%SERVER_ID%.AvailableIPv6Addresses%";if(sRawIPv6WizardListeners!=""){g_bIPV6Capable=true;aIPv6WizardRaw=sRawIPv6WizardListeners.split(',');
aIPv6WizardListenerText=aIPv6WizardListenerText.concat(aIPv6WizardRaw);aIPv6WizardListener=aIPv6WizardListener.concat(aIPv6WizardRaw);}function OnCreateIPv4Checked(){if(EnableListenerIPv4.getControlValue())ListenerIPv4WizardInput.SetDisabled(false);else ListenerIPv4WizardInput.SetDisabled(true);}function OnCreateIPv6Checked(){if(EnableListenerIPv6.getControlValue())ListenerIPv6WizardInput.SetDisabled(false);else ListenerIPv6WizardInput.SetDisabled(true);}var ListenerIPv4WizardInput=CreateComboBox("$LISTENER_IPV4_ALL$","",aIPv4WizardListenerText,aIPv4WizardListener,"Listener_IPv4_WizardCombo","Listener_IPv4_WizardCombo",undefined,undefined,false,250,20,undefined,true,true);var ListenerIPv6WizardInput=CreateComboBox("$LISTENER_IPV6_ALL$","::",aIPv6WizardListenerText,aIPv6WizardListener,"Listener_IPv6_WizardCombo","Listener_IPv6_WizardCombo",undefined,undefined,false,250,20,undefined,true,true);if(aIPv4WizardListener.length>1)ListenerIPv4WizardInput.getPopupTemplate().setStyle("height",(aIPv4WizardListener.length<=10)?((16*aIPv4WizardListener.length)+((AW.ie)?3:0))+"px":"163px");else if(aIPv4WizardListener.length==1)ListenerIPv4WizardInput.getPopupTemplate().setStyle("height",((g_bFireFox4Browser)?"24px":"20px"));if(g_bIPV6Capable)document.getElementById("IPv6Container").style.display="block";if(aIPv6WizardListener.length>1)ListenerIPv6WizardInput.getPopupTemplate().setStyle("height",(aIPv6WizardListener.length<=10)?((16*aIPv6WizardListener.length)+((AW.ie)?3:0))+"px":"163px");else if(aIPv6WizardListener.length==1)ListenerIPv6WizardInput.getPopupTemplate().setStyle("height",((g_bFireFox4Browser)?"24px":"20px"));var EnableListenerIPv4=CreateCheckBox("$CREATE_IPV4$","EnableIPv4","EnableIPv4",true,OnCreateIPv4Checked,true);var EnableListenerIPv6=CreateCheckBox("$CREATE_IPV6$","EnableIPv6","EnableIPv6",true,OnCreateIPv6Checked,true);var FTPListenerPortWizardInput=CreateInputField("21","FTPPortInput-Wizard","FTP_Port","",60,undefined,undefined);var SSLListenerPortWizardInput=CreateInputField("990","SSLPortInput-Wizard","SSL_Port","",60,undefined,undefined);var SSHListenerPortWizardInput=CreateInputField("22","SSHPortInput-Wizard","SSH_Port","",60,undefined,undefined);var HTTPListenerPortWizardInput=CreateInputField("80","HTTPPortInput-Wizard","HTTP_Port","",60,undefined,undefined);var HTTPSListenerPortWizardInput=CreateInputField("443","HTTPSPortInput-Wizard","HTTPS_Port","",60,undefined,undefined);var CancelWizardDomainButton=CreatePushButton("$CANCEL_BUTTON$","CancelDomainWizardButton",OnCancelWizardDomain,85,25);var sRecoverPasswordVal="%CServer.%SERVER_ID%.EnablePasswordRecovery%";var sRecoverPasswordIsDefault="1";if(!g_bPasswordRecoveryLicense){sRecoverPasswordVal="0";sRecoverPasswordIsDefault="0";}var WizardEnablePasswordRecovery=CreateTriStateCheckBox("$ENABLE_PASSWORD_RECOVER_DESC$","EnablePasswordRecovery","Enable_PasswordRecovery",sRecoverPasswordVal,sRecoverPasswordVal,sRecoverPasswordIsDefault,OnRecoverPassWordChecked);var NextDomainWizardButton=CreatePushButton("$NEXT_BUTTON$&gt;&gt;","NextDomainWizardButton",OnDomainNextWizard,80,25,undefined,undefined,"button_green");var BackDomainWizardButton=CreatePushButton("&lt;&lt;$BACK_BUTTON$","BackDomainWizardButton",OnDomainBackWizard,80,25);BackDomainWizardButton.setStyle("visibility","hidden");</script><div id="ChangeServerSettingsDialoginner" style="display:none;"><div style="padding:0 0 0 5px;"><div style="float:left;width:290px">$DOMAIN_PASSWORD_ENCRYPT_WIZARD_DESCR$ <br /><br /><span id="ServerEnablePasswordRecovery"></span></div><div style="float:left;width:100px;text-align:right;"><span id="SaveServerSettingsButton"></span><br /><span id="CancelServerSettingsButton"></span></div><div style="clear:both"></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$CHANGE_SERVER_SETTINGS$","ChangeServerSettingsDialog","425","220","","$CLOSE_CANCEL$");var g_bEnablePasswordRecovery=(parseInt("%CServer.%SERVER_ID%.EnablePasswordRecovery%")?true:false);function OnSaveServerSettings(){SavingDialog(true);var sServerEncryptPasswordRecovery=(ServerEnablePasswordRecovery.getControlValue()?"1":"");var SaveServerSettingsRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Server.%SERVER_ID%&StaticOnly=1");SaveServerSettingsRequest.setParameter("EnablePasswordRecovery",sServerEncryptPasswordRecovery);SaveServerSettingsRequest.setAsync(true);SaveServerSettingsRequest.request();SaveServerSettingsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else{HideDialog("ChangeServerSettingsDialog");WizardEnablePasswordRecovery.m_bIgonoreCB=true;WizardEnablePasswordRecovery.setControlValue(ServerEnablePasswordRecovery.getControlValue());WizardEnablePasswordRecovery.setBoldText(false);g_bEnablePasswordRecovery=ServerEnablePasswordRecovery.getControlValue();}};}function OnServerTypeChange(checkbox){var nVal=2;if(!FileTransferSetupCheck.getControlValue()&&!FileSharingSetupCheck.getControlValue()){AlertDialog("$PLEASE_SELECT_SERVER_TYPE$");}else{if(FileTransferSetupCheck.getControlValue()&&FileSharingSetupCheck.getControlValue())nVal=2;else if(FileTransferSetupCheck.getControlValue()){nVal=0;}else{nVal=1;}switch(parseInt(nVal)){case(0):g_aDomainWizPageArray=[1,2,4,5,6];g_nTotalDomainWizardPages=6;break;case(1):g_aDomainWizPageArray=[1,2,3,5];g_nTotalDomainWizardPages=5;break;case(2):g_aDomainWizPageArray=[1,2,3,4,5,6];g_nTotalDomainWizardPages=6;break;}WizStepSetup(true);}}function WizStepSetup(bHideTypeSelect){if(bHideTypeSelect)$("#WizStep-3,#WizStep-4,#WizStep-5,#WizStep-6").css("display","none");else $("#WizStep-2,#WizStep-3,#WizStep-4,#WizStep-5,#WizStep-6").css("display","none");for(var nIndex=0;nIndex<g_aDomainWizPageArray.length;nIndex++){$("#WizStep-"+(nIndex+1)+" .steptext span").text(g_aDomainWizTextArray[(g_aDomainWizPageArray[nIndex]-1)]);$("#WizStep-"+(nIndex+1)+" .circle span").text(nIndex+1);$("#WizStep-"+(nIndex+1)).css("display","");if(nIndex==(g_aDomainWizPageArray.length-1))$("#WizStep-"+(nIndex+1)+" .wizstep").css("display","none");else $("#WizStep-"+(nIndex+1)+" .wizstep").css("display","block");}}function OnCancelServerSettings(){HideDialog("ChangeServerSettingsDialog");}var ServerEnablePasswordRecovery=CreateCheckBox("$ENABLE_PASSWORD_RECOVER_DESC$","ServerEnablePasswordRecovery","ServerEnable_PasswordRecovery",g_bEnablePasswordRecovery,OnRecoverPassWordChecked,true);var SaveServerSettingsButton=CreateDialogPushButton("$SAVE_BUTTON$","SaveServerSettingsButton",OnSaveServerSettings,60,30);var CancelServerSettingsButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelServerSettingsButton",OnCancelServerSettings,60,30);var WizSMTPButton=CreatePushButton("$CONFIG_SMTP_BUTTON$...","WizConfigSMTPButton",OnSMTPConfigWiz);WizSMTPButton.setControlImage("SMTP_Icon");var FileTransferSetupCheck,FileSharingSetupCheck;if(g_bMFTLicense){FileTransferSetupCheck=CreateCheckBox("$FILE_TRANSFER_SERVER$","FileServerTypeTrans","ServerTypeTrans",true,OnServerTypeChange,true);FileSharingSetupCheck=CreateCheckBox("$FILE_SHARING_SERVER$","FileServerTypeSharing","ServerTypeSharing",true,OnServerTypeChange,true);}else WizStepSetup();</script><script type="text/javascript" language="JavaScript">var g_bDomainCheck=true;var g_bShowAskUserCreation=false;var bByPassRefresh=false;var nWidthSpeed=15;var nSpeed=15;function OnUpdateDomainManager(nObjectId,sNewDomainName){LoadDomain(nObjectId,sNewDomainName,0);if((!g_bConsoleInclude)&&(!bByPassRefresh)&&(nObjectId!="")){g_bLinkRequested=true;LoadingDialog(true);var sCurrentURL=window.location.href;var NewURLString=sCurrentURL.replace(GetURLParameter("ID"),nObjectId);window.location=NewURLString;}}function LoadDomain(nDomainId,sDomainName,nDomainODBC){if(sBrowserType!="Microsoft Internet Explorer")g_bIEDomainCheck=false;if((nDomainId!=""&&nDomainId!=null&&nDomainId!=undefined)&&(sDomainName!=""&&sDomainName!=null&&sDomainName!=undefined)){createCookie("domainname",sDomainName,60);createCookie("domainid",nDomainId,1);createCookie("domainodbc",nDomainODBC,1);}if(g_bConsoleInclude){if(g_bODBC64BitWarn){setTimeout(function(){CheckConfirmDialog("$WARN_ODBC_64BIT_UPGRADE$",SetODBC64BitValue,undefined,undefined,400,245);},600);}}}function OnAutoShowWizard(){if(g_bConsoleInclude)g_bShowAskUserCreation=true;ResetDomainWizard(false);ReplaceDialog('$CONFIRM_DIALOG$','DomainWizardDialog',OnHideDomainWizard);}function OnLoadDomain(bRefresh,nScrollTo){if(g_bSysAdmin){GetDomains(true,bRefresh,nScrollTo);g_bTreeNavVisible=true;if(g_bConsoleInclude){clearSessionCookies('domainid');LoadDomain();}else g_nDomainID=readCookie('domainid');}else{CreateDomainNavTree([["%CDomain.%DOMAIN_ID%.DomainName%","%DOMAIN_ID%","%CDomain.%DOMAIN_ID%.Enabled%"]],"Tree",true);}}function DomainIDLookup(sDomainName,nAltDomainId,sAltDomainName,nAltDomainODBC){var sDomainLookupXML="%ADMIN_FILE%XML/DomainIDLookup.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.FindDomain";DomainIDRequest=CreatePostRequest(sDomainLookupXML);DomainIDRequest.setParameter("DomainName",Trim(sDomainName));DomainIDRequest.setAsync(true);DomainIDRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var nDomainLookUpID=GetXMLValueInt(XMLDoc,"DomainID");var nDomainLookUpODBC=GetXMLValueInt(XMLDoc,"ODBCAvailable");if(nResult!=0){LoadDomain(nAltDomainId,sAltDomainName,nAltDomainODBC);}else{LoadDomain(nDomainLookUpID,sDomainName,nDomainLookUpODBC);}};DomainIDRequest.request();}function UpdateDomainNavHeight(){var nContentViewHeight=$("#TreeCol").outerHeight(true);var nUpdateViewHeight=400;var nNewheight=(nContentViewHeight-nUpdateViewHeight);if((nNewheight)>410){$("#MenuListNav").css("max-height",nNewheight+"px");if($("#MenuListNav").children(":first").attr("id")!="nav")$("#MenuListNav").children(":first").css("max-height",nNewheight+"px");}setTimeout(function(){$(".menu-nav").mCustomScrollbar("update");},0);}function CreateDomainNavTree(anDomainNames,sElementID,bLoadTreeInHTML,bRefresh,nScrollto){var nTreeNodeLevel=1;var nPagePosition=0;var sOnSubmitServer=String("SubmitServerNavFrame(");var sOnSubmitDomain=String("SubmitDomainNavFrame(");var sLoadConsolePage=String("LoadConsolePage('%ADMIN_FILE%')");var sBuildDomainNavMenu="";var sScrollTo="";var sBreadCrumbPage="";var sBreadCrumbMain="";var asDomainPageNames=["$DOMAIN_DETAILS$","$USERS$","$GROUPS$","$DIRECTORIES$","$LIMITS$","$DOMAIN_ACTIVITY$","$DASHBOARD$"];var asServerPageNames=["$SERVERDETAILS$","$USERS$","$GROUPS$","$DIRECTORIES$","$LIMITS$","$SERVERACTIVITY$","$DASHBOARD$","$EXTEND_TRIAL$"];if(g_nSelectedTab!=undefined)nCurrentTreeTabPos=(parseInt(g_nSelectedTab)-1);else nCurrentTreeTabPos=(parseInt(GetURLParameter("Page"))-1);if(bRefresh){$(".nav-add-domain").nextAll().remove();}if(g_bDomainAdmin){sOnSubmitDomain=String("SubmitDomain(");}else if(g_bGroupAdmin){sOnSubmitDomain=String("SubmitDomain(");}else{$("#navmenuserver-global").css("display","");$("#AddDomain-btn").css("display","flex");}if((!g_bDomainNav||g_bConsoleInclude)&&g_bSysAdmin){sBreadCrumbMain="$GLOBAL$";if(!g_bConsoleInclude){$("#navmenuserver-global").find("ul li[data-active='"+(g_ActivePage-1)+"'] a").addClass("activelink");sBreadCrumbPage=asServerPageNames[(g_ActivePage-1)];}else{$("#navmenuserver-global").find("ul li[data-active='6'] a").addClass("activelink");sBreadCrumbPage=asServerPageNames[6];}if(bRefresh){$("#navmenuserver-global a").removeClass("open");$("#navmenuserver-global a").next("ul").css("display","none");$("#navmenuserver-global").find("span.arrow").removeClass("up").addClass("down");}else{$("#navmenuserver-global a").addClass("open");$("#navmenuserver-global a").next("ul").css("display","block");$("#navmenuserver-global").find("span.arrow").removeClass("down").addClass("up");}}anDomainNames.sort(function(a,b){var aDisabled=a[2];var bDisabled=b[2];var result=0;if(aDisabled==bDisabled){result=a[0]-b[0];}else{if(aDisabled==0){result=1;}else{result=-1;}}return result;});for(var nIndex=0;nIndex<(anDomainNames.length);nIndex++){var nDomainID=anDomainNames[nIndex][1];var sDomainName=anDomainNames[nIndex][0];var iDomainEnabled=anDomainNames[nIndex][2];var sCleanDomainName=CleanPathByEscapeWithEncoding(sDomainName);var sDecodedDomainName=decodeURIComponent(sDomainName);var sOpenMenuClass="";var sOpenMenuStyle="";var aActiveTabColor=["inactivelink","inactivelink","inactivelink","inactivelink","inactivelink","inactivelink","inactivelink"];sArrowTypeIco="down";if(g_bDomainNav&&(nDomainID==g_nDomainID)){if(g_bDomainAdmin&&g_bConsoleInclude)g_ActivePage=7;if(g_bGroupAdmin&&(g_ActivePage==""))g_ActivePage=2;sOpenMenuClass="open";sOpenMenuStyle="display:block;";sArrowTypeIco="up";aActiveTabColor[(g_ActivePage-1)]="activelink";sScrollTo=nDomainID;if(!g_bConsoleInclude){sBreadCrumbPage=asDomainPageNames[(g_ActivePage-1)];sBreadCrumbMain=sDecodedDomainName;}}if(bRefresh&&(nScrollto==nDomainID)){sOpenMenuClass="open";sOpenMenuStyle="display:block;";sArrowTypeIco="up";sScrollTo=nDomainID;}if(iDomainEnabled==0){sOpenMenuClass="disabled "+sOpenMenuClass;}else{sOpenMenuClass="enabled "+sOpenMenuClass;}sBuildDomainNavMenu+="<li id='navmenu-"+nDomainID+"'><a href='#' id='navmenu-"+nDomainID+"-href' class='navmenuserver-domain "+sOpenMenuClass+"'><div><span class='navDomain icon'></span><span class='navDomain text'>"+sDecodedDomainName+"</span></div></a>"+"<ul style='"+sOpenMenuStyle+"' >";if(g_bDomainAdmin){sBuildDomainNavMenu+=" <li data-active='6' class='activetab'><a id='navmenu-"+nDomainID+"-dashboard-href' href=\"javascript:"+sLoadConsolePage+";\" class='"+aActiveTabColor[6]+"'><span></span>"+asDomainPageNames[6]+"</a></li>";}if(!g_bGroupAdmin){sBuildDomainNavMenu+=" <li data-active='0' class='activetab'><a  id='navmenu-"+nDomainID+"-details-href' href=\"javascript:"+sOnSubmitDomain+"'"+g_sFilePath+"Domain.htm', 1,'','"+nDomainID+"', 1, '"+sCleanDomainName+"',true);\" class='"+aActiveTabColor[0]+"'>"+asDomainPageNames[0]+"</a></li>";}sBuildDomainNavMenu+="  <li data-active='1' class='activetab'><a id='navmenu-"+nDomainID+"-users-href' href=\"javascript:"+sOnSubmitDomain+"'"+g_sFilePath+"DomainUsers.htm', 1,'','"+nDomainID+"', 2, '"+sCleanDomainName+"',true);\" class='"+aActiveTabColor[1]+"'>"+asDomainPageNames[1]+"</a></li>"+"<li data-active='2' class='activetab'><a id='navmenu-"+nDomainID+"-groups-href' href=\"javascript:"+sOnSubmitDomain+"'"+g_sFilePath+"DomainGroups.htm', 1,'','"+nDomainID+"', 3, '"+sCleanDomainName+"',true);\" class='"+aActiveTabColor[2]+"'>"+asDomainPageNames[2]+"</a></li>";if(!g_bGroupAdmin){sBuildDomainNavMenu+="<li data-active='3' class='activetab'><a id='navmenu-"+nDomainID+"-dirs-href' href=\"javascript:"+sOnSubmitDomain+"'"+g_sFilePath+"DomainDir.htm', 1,'','"+nDomainID+"', 4, '"+sCleanDomainName+"',true);\" class='"+aActiveTabColor[3]+"'>"+asDomainPageNames[3]+"</a></li>"+"<li data-active='4' class='activetab'><a id='navmenu-"+nDomainID+"-limits-href' href=\"javascript:"+sOnSubmitDomain+"'"+g_sFilePath+"DomainLimits.htm', 1,'','"+nDomainID+"', 5, '"+sCleanDomainName+"',true);\" class='"+aActiveTabColor[4]+"'>"+asDomainPageNames[4]+"</a></li>";}sBuildDomainNavMenu+="<li data-active='5' class='activetab'><a id='navmenu-"+nDomainID+"-activity-href' href=\"javascript:"+sOnSubmitDomain+"'"+g_sFilePath+"DomainActivity.htm', 1,'','"+nDomainID+"', 6, '"+sCleanDomainName+"',true);\" class='"+aActiveTabColor[5]+"'>"+asDomainPageNames[5]+"</a></li>"+"</ul>"+"</li>";g_bFoundDomain=true;nDomainTotal=nIndex;}g_domainConfigExecuted=true;$(sBuildDomainNavMenu).appendTo("#nav");if(nIndex>0)$("#DomainStart-Count").text("("+nIndex+")");else $("#DomainStart-Count").text("");$("#nav-loading").remove();$("#breadcrumb").html(sBreadCrumbMain+"<span>&#62;</span>"+sBreadCrumbPage);if(bRefresh){$(".menu-nav").mCustomScrollbar("destroy");$("#nav > li > a").unbind("click");}$(document).ready(function(){$("#nav > li > a").on("click",function(e){if($(this).parent().has("ul")){e.preventDefault();}if(!$(this).hasClass("open")){$("#nav li:not(#navmenuserver-global) ul").slideUp(350);$("#nav li:not(#navmenuserver-global) a").removeClass("open");$("#nav li:not(#navmenuserver-global) a span.arrow").removeClass("up").addClass("down");$(this).next("ul").slideDown(350);$(this).addClass("open");$(this).find("span.arrow").removeClass("down").addClass("up");}else if($(this).hasClass("open")){$(this).removeClass("open");$(this).find("span.arrow").removeClass("up").addClass("down");$(this).next("ul").slideUp(350);}UpdateDomainNavHeight();});$(".menu-nav").mCustomScrollbar({scrollButtons:{enable:true },scrollInertia:50,theme:"dark",advanced:{updateOnContentResize:true }});if(sScrollTo!=""){setTimeout(function(){$(".menu-nav").mCustomScrollbar("scrollTo","#navmenu-"+sScrollTo);},500);}if((!%SERVER_IDENTITY_ALERT_TRIGGERED%)&&(!g_bServerIdentityAlertTriggered)&&!g_bFoundDomain&&g_bConsoleInclude)ConfirmDialog("$CONFIRM_CREATE_DOMAIN$",OnAutoShowWizard,undefined,undefined);UpdateDomainNavHeight();});bTreeLoaded=true;}function HighlightActivePageLink(){$("#navmenu-"+g_nDomainID+" ul li.activetab a").removeClass("activelink");$("#navmenu-"+g_nDomainID).find("ul li[data-active='"+g_nSelectedTab+"'] a").addClass("activelink");}function GetDomains(bLoadTreeInHTML,bRefresh,nScrollTo){var objGetDomains=createAWHttpRequest("GET","%ADMIN_FILE%XML/Domains.xml?ForceList=1",function(){var xmlDoc=this.getResponseXML();var aoElements=xmlDoc.getElementsByTagName("Domain");var aoIdElements=xmlDoc.getElementsByTagName("ID");var aoDomainNameElements=xmlDoc.getElementsByTagName("DomainName");var aoDomainEnabled=xmlDoc.getElementsByTagName("Enabled");g_asDomainInfo=[];for(var i=0;i<aoElements.length;i++){g_asDomainInfo.push([aoDomainNameElements[i].childNodes[0].nodeValue,aoIdElements[i].childNodes[0].nodeValue,aoDomainEnabled[i].childNodes[0].nodeValue]);}g_asDomainInfo.sort(DomainSortAlpha);CreateDomainNavTree(g_asDomainInfo,"Tree",bLoadTreeInHTML,bRefresh,nScrollTo);});if(objGetDomains)objGetDomains.request();}function OnBuyNowTrial(){window.open("http://www.solarwinds.com/company/contact-us","_blank");}function OnLMUpdate(){var sLMLink="https://customerportal.solarwinds.com/";window.open(sLMLink,"_blank");}var g_bConsoleInclude=(parseInt(g_sConsoleInclude)?true:false);var g_asDomainInfo,g_anDomainIds;OnLoadDomain();var BuyNowTrialButton=CreatePushButton("$BUY_NOW$","BuyNowTrial",OnBuyNowTrial,80,25,undefined,undefined,"button_green");$(document).ready(function(){if((%CServer.%SERVER_ID%.LicenseIsTemp%==1)||(%CServer.%SERVER_ID%.IsRegistered%==0))ShowHideTrialNotification(true);else ShowMaintenenceInfoBox(parseInt("%CServer.%SERVER_ID%.LicenseDaysRemaining%"),parseInt("%CServer.%SERVER_ID%.LicenseDays%"),new Date(parseInt("%CServer.%SERVER_ID%.LicenseTime%")*1000));if(g_bSysAdmin&&%SERVER_IDENTITY_ALERT_TRIGGERED%){$('#CreateServerIdentity').css('display','block');}if(m_bUpdateAvail){$('#MaintContainUpdate').css('display','block');$('.latest-updates').css('display','block');var sUpdateHtml;var sWhichOSName="%CServer.%SERVER_ID%.OSName%";sUpdateHtml="<div class='TreeInfoBox__text-default'>$SU_UPDATE_AVAILABLE_TXT$</div>";sUpdateHtml+="<div class='TreeInfoBox__text-small-secondary'>$SU_NEWEST_VERSION$: <span id='SU-UpdateNewestV' class='TreeInfoBox__text-small'></span></div>";sUpdateHtml+="<div class='TreeInfoBox__text-small-secondary'>$SU_INSTALL_VERSION$: <span id='SU-UpdateInstalledV' class='TreeInfoBox__text-small'></span></div>";if((sWhichOSName.indexOf("Linux")<0)&&(m_sLatestReleaseDate!=""))sUpdateHtml+="<div>$RELEASED$: <span id='SU-ReleasedDate'></span></div>";sUpdateHtml+="<div id='UpdateLMButton'></div>";$("#SU-UpdateInfo").html(sUpdateHtml);$("#SU-UpdateInstalledV").text(decodeURIComponent(m_sInstalledVersion));$("#SU-UpdateNewestV").text(decodeURIComponent(m_sLatestVersion));if((sWhichOSName.indexOf("Linux")<0)&&(m_sLatestReleaseDate!=""))$("#SU-ReleasedDate").text(decodeURIComponent(m_sLatestReleaseDate));CreatePushButton("$LEARN_MORE$","UpdateLMButton",OnLMUpdate,undefined,undefined,undefined,undefined,"TreeInfoBox__btn-primary");}$(window).resize(function(){var nHeightAdjust=247;$('#TreeCol').css("min-height",($(window).height()-nHeightAdjust)+"px");UpdateDomainNavHeight();});$(window).trigger('resize');});</script>