<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
%PRIV_DOMAIN_ADMIN%<div id="NewPrivateKeyDialoginner" style="display:none;"><div id="NewPrivateKeyContent" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$NEW_PRIVATE_KEY_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Certificate32.png" width="32" height="32" class="header-icon" />$NEW_PRIVATE_KEY_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="NewPrivateKeyForm"><span style="float:left;width:385px;"><span id="NewPrivateKeyOutputGroup">$PRIVATE_KEY_NAME$:<div style="overflow:auto"><span id="NewPrivateKeySetName"></span></div>$PRIVATE_KEY_OUTPUT_PATH$:<div style="overflow:auto"><span id="NewPrivateKeyOutputPath"></span> <span id="NewPrivateKeyOutputPathBrowse"></span></div></span><div id="NewPrivateKeyInfoGroup" style="padding-bottom:10px;">$PRIVATE_KEY_TYPE$:<div style="overflow:auto"><span id="NewPrivateKeyType"></span></div>$PRIVATE_KEY_LENGTH$:<div style="overflow:auto"><span id="NewPrivateKeyLength"></span></div>$PRIVATE_KEY_PASSWORD$:<div style="overflow:auto"><span id="NewPrivateKeyPassword"></span></div></div></span><span style="float:left;width:95px;text-align:right;vertical-align:top;padding:5px 5px 0 0;"><span id="CreateNewPrivateKeyButton"></span><br /><span id="CancelNewPrivateKeyButton"></span><br /><br /><span id="HelpNewPrivateKeyButton"></span></span></form><div style="clear:both;"></div></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$NEW_PRIVATE_KEY_DIALOG_TITLE$","NewPrivateKeyDialog","500","355","","$CLOSE_CANCEL$");CreateGroupBox("$PRIVATE_KEY_OUTPUT_GROUP$","NewPrivateKeyOutputGroup",380,112);var PrivateKeyNameInput=CreateInputField("","NewPrivateKeySetName","NewPrivateKeySetName",undefined,320);var PrivateKeyOutputPathInput=CreateInputField("","NewPrivateKeyOutputPath","NewPrivateKeyOutputPath",undefined,320);var NewPrivateKeyOutputPathBrowse=CreatePushButton("","NewPrivateKeyOutputPathBrowse",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[PrivateKeyOutputPathInput,false,"0","1"]]);NewPrivateKeyOutputPathBrowse.setControlImage("Browse");var PrivateKeyType=["$PRIVATE_KEY_TYPE_DSA$","$PRIVATE_KEY_TYPE_RSA$","$PRIVATE_KEY_TYPE_ECDSA$"];var PrivateKeyTypeVal=["0","1","2"];var PrivateKeyLength=["$PRIVATE_KEY_LEN_1024$","2048","$PRIVATE_KEY_LEN_4096$"];var PrivateECDSAKeyLength=["$PRIVATE_ECDSA_KEY_LEN_256$","$PRIVATE_ECDSA_KEY_LEN_384$","$PRIVATE_ECDSA_KEY_LEN_521$"];var PrivateKeyLengthVal=["1024","2048","4096"];var PrivateECDSAKeyLengthVal=["256","384","521"];CreateGroupBox("$PRIVATE_KEY_INFORMATION$","NewPrivateKeyInfoGroup",380,140);var PrivateKeyTypeComboBox=CreateComboBox(PrivateKeyType[1],PrivateKeyTypeVal[1],PrivateKeyType,PrivateKeyTypeVal,"NewPrivateKeyType","NewPrivateKeyType",OnPrivateKeyTypeChange,"OnPrivateKeyTypeLoad()",false,320,undefined,OnCreateNewPrivateKey);var PrivateKeyLengthCombo=CreateComboBox(PrivateKeyLength[0],PrivateKeyLengthVal[0],PrivateKeyLength,PrivateKeyLengthVal,"NewPrivateKeyLength","NewPrivateKeyLength",undefined,"",false,320,undefined,OnCreateNewPrivateKey);function OnPrivateKeyTypeLoad(sValue){PrivateKeyTypeComboBox.initValue(sValue);OnPrivateKeyTypeChange(sValue);}function OnPrivateKeyTypeChange(sValue){switch(parseInt(sValue)){case 0:PrivateKeyLengthCombo.setItemText(PrivateKeyLength.slice(0,1));PrivateKeyLengthCombo.setItemValue(PrivateKeyLengthVal.slice(0,1));PrivateKeyLengthCombo.setItemCount(PrivateKeyLength.slice(0,1).length);PrivateKeyLengthCombo.setSelectedItems([0]);PrivateKeyLengthCombo.setControlText(PrivateKeyLengthCombo.getItemText([0]));break;case 1:if(g_bUsingFIPS){PrivateKeyLengthCombo.setItemText(PrivateKeyLength.slice(1));PrivateKeyLengthCombo.setItemValue(PrivateKeyLengthVal.slice(1));PrivateKeyLengthCombo.setItemCount(PrivateKeyLength.slice(1).length);}else{PrivateKeyLengthCombo.setItemText(PrivateKeyLength);PrivateKeyLengthCombo.setItemValue(PrivateKeyLengthVal);PrivateKeyLengthCombo.setItemCount(PrivateKeyLength.length);}PrivateKeyLengthCombo.setSelectedItems([0]);PrivateKeyLengthCombo.setControlText(PrivateKeyLengthCombo.getItemText([0]));break;case 2:PrivateKeyLengthCombo.setItemText(PrivateECDSAKeyLength);PrivateKeyLengthCombo.setItemValue(PrivateECDSAKeyLengthVal);PrivateKeyLengthCombo.setItemCount(PrivateECDSAKeyLength.length);PrivateKeyLengthCombo.setSelectedItems([0]);PrivateKeyLengthCombo.setControlText(PrivateKeyLengthCombo.getItemText([0]));break;}}CreatePasswordField("","NewPrivateKeyPassword","NewPrivateKeyPassword",undefined,320);CreateDialogPushButton("$CREATE_BUTTON$","CreateNewPrivateKeyButton",OnCreateNewPrivateKey);CreateDialogPushButton("$CANCEL_BUTTON$","CancelNewPrivateKeyButton",OnCancelNewPrivateKey);CreateDialogPushButton("$HELP_BUTTON$","HelpNewPrivateKeyButton",OnNewPrivateKeyHelp);function OnCreateNewPrivateKey(){if((!PrivateKeyNameInput.getControlText().length)||(!PrivateKeyOutputPathInput.getControlText().length))AlertDialog("$NEW_PRIVATE_KEY_EMPTY_FIELD$");else{var CreatePrivateKeyRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+g_sPageObjectType+"."+g_sPageObjectID+".CreatePrivateKey");SavingDialog(true);CreatePrivateKeyRequest.setParameter("PrivateKeyName",document.NewPrivateKeyForm.NewPrivateKeySetName.value);CreatePrivateKeyRequest.setParameter("PrivateKeyPath",document.NewPrivateKeyForm.NewPrivateKeyOutputPath.value);CreatePrivateKeyRequest.setParameter("PrivateKeyType",PrivateKeyTypeComboBox.getItemValue(PrivateKeyTypeComboBox.getSelectedItems()[0]));CreatePrivateKeyRequest.setParameter("PrivateKeyLength",PrivateKeyLengthCombo.getItemValue(PrivateKeyLengthCombo.getSelectedItems()[0]));CreatePrivateKeyRequest.setParameter("Password",document.NewPrivateKeyForm.NewPrivateKeyPassword.value);CreatePrivateKeyRequest.response=function(){var nResult=OnSaveComplete(this);if(!nResult)ConfirmDialog("$NEW_PRIVATE_KEY_USE_NOW$",OnUseNewPrivateKey,function(){CloseConfirmDialog();OnCancelNewPrivateKey();});};CreatePrivateKeyRequest.request(null);}}function OnUseNewPrivateKey(){var sPrivateKeyPath=document.NewPrivateKeyForm.NewPrivateKeyOutputPath.value;var sPrivateKeyName=document.NewPrivateKeyForm.NewPrivateKeySetName.value;var sPrivateKeyPassword=document.NewPrivateKeyForm.NewPrivateKeyPassword.value;var sSlash=(sPrivateKeyPath.indexOf('/')>=0)?"/":"\\";if(sPrivateKeyPath.substr(sPrivateKeyPath.length-1)!=sSlash)sPrivateKeyPath+=sSlash;CloseConfirmDialog();OnCancelNewPrivateKey();SSHKeyInput.setControlText(sPrivateKeyPath+sPrivateKeyName+".key");SSHPasswordInput.setControlText(sPrivateKeyPassword);OnSaveSSHCert();}function OnShowNewPrivateKeyDialog(){if(g_bUsingFIPS){PrivateKeyTypeComboBox.setItemText(PrivateKeyType.slice(1));PrivateKeyTypeComboBox.setItemValue(PrivateKeyTypeVal.slice(1));PrivateKeyTypeComboBox.setItemCount(PrivateKeyType.slice(1).length);PrivateKeyTypeComboBox.setSelectedItems([0]);PrivateKeyTypeComboBox.setControlText(PrivateKeyTypeComboBox.getItemText([0]));PrivateKeyLengthCombo.setItemText(PrivateKeyLength.slice(1));PrivateKeyLengthCombo.setItemValue(PrivateKeyLengthVal.slice(1));PrivateKeyLengthCombo.setItemCount(PrivateKeyLength.slice(1).length);PrivateKeyLengthCombo.setSelectedItems([0]);PrivateKeyLengthCombo.setControlText(PrivateKeyLengthCombo.getItemText([0]));}else{PrivateKeyTypeComboBox.setItemText(PrivateKeyType);PrivateKeyTypeComboBox.setItemValue(PrivateKeyTypeVal);PrivateKeyTypeComboBox.setItemCount(PrivateKeyType.length);PrivateKeyTypeComboBox.setSelectedItems([1]);PrivateKeyTypeComboBox.setControlText(PrivateKeyTypeComboBox.getItemText([1]));PrivateKeyLengthCombo.setItemText(PrivateKeyLength);PrivateKeyLengthCombo.setItemValue(PrivateKeyLengthVal);PrivateKeyLengthCombo.setItemCount(PrivateKeyLength.length);PrivateKeyLengthCombo.setSelectedItems([0]);PrivateKeyLengthCombo.setControlText(PrivateKeyLengthCombo.getItemText([0]));}ReplaceDialog(g_sBusyDialog,"NewPrivateKeyDialog");}function OnCancelNewPrivateKey(){HideDialog("NewPrivateKeyDialog");}function OnNewPrivateKeyHelp(){if(g_bDomainNav){sExpandNode="Item5_4";sHelpFile="Help-Encryption-Domain.htm";}else{sExpandNode="Item2_3";sHelpFile="Help-Encryption-Server.htm";}LaunchHelp(sHelpFile,sExpandNode);}</script>