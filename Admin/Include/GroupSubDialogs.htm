%PRIV_GROUP_ADMIN%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Result.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<script type="text/javascript" language="JavaScript">var g_bWebClientProLicense=("%CServer.%SERVER_ID%.WebClientProLicense%"!="0");var g_bBrandingRemovalLicense=("%CServer.%SERVER_ID%.BrandingRemovalLicense%"!="0");var g_GroupMfaConfig={TOTPAble:false,TOTPProvisioning:"",TOTPProvisioningDefault:"",IsTOTPProvisioningDefault:false,TOTPCompanyName:"",TOTPCompanyNameDefault:"$MFA_PRODUCT_NAME$"};function OnChangeGroupsTab(nOldTab,nNewTab){if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(false);awActiveGrid=aGridCtrls[nNewTab];if((!isNaN(nOldTab))&&(awActiveGrid!=undefined))awActiveGrid.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EditObjectID);g_sGroupTabDialogHelp=aGroupTabHelpPages[nNewTab];}function OnCancelGroupDialogButton(){g_bSavingObj=false;HideDialog("GroupDialog");}function WinGroupChildCreateSuccess(){g_nWinParentGroup=undefined;}function WinGroupChildCreateFail(){GroupNameInput.setControlText(g_sGroupNameSave);}function OnSaveGroup(){OnSaveFileLogging(undefined,undefined,true);}function ValidateSaveGroup(){if(IsValidGroup()){g_bSavingObj=true;g_nPaddingVal=0;if(g_bWinChildGroup&&(!g_bEditNTGroup&&!g_bEditGroupTemplate&&!g_bEditLDAPGroup)){g_sGroupNameSave=GroupNameInput.getControlText();var bBadGroupName=false;if(g_sGroupNameSave.indexOf(".")>=0){var EditCells=new Array();EditCells=g_ActiveGroupGrid.getSelectedRows().toString().split(",");bBadGroupName=CheckOUGroupName(EditCells[0],g_sGroupNameSave);}if(!bBadGroupName){if(g_nWinParentGroup!=""&&g_nWinParentGroup!=undefined){document.getElementById("GroupName-Hidden").value=g_nWinParentGroup+"."+g_sGroupNameSave;}else document.getElementById("GroupName-Hidden").value=GroupNameInput.getControlText();g_ActiveGroupGrid.OnSaveObject(WinGroupChildCreateSuccess,undefined,WinGroupChildCreateFail);}else AlertDialog("$SU_VALID_GROUP_NAME_INVALID_STR$");}else{document.getElementById("GroupName-Hidden").value=GroupNameInput.getControlText();g_ActiveGroupGrid.OnSaveObject();}}}function IsValidGroup(){var bValid=false;if(GroupNameInput.getControlText()==""){AlertDialog("$SU_VALID_GROUP_NAME_EMPTY_STR$");setTimeout(function(){DialogTabs.setSelectedItems([0]);GroupNameInput.getContent("box/text").element().focus();});}else bValid=true;return(bValid);}function GetEditObjectID(){return(g_EditObjectID);}function OnGroupHelp(){LaunchHelp(g_sGroupTabDialogHelp,"RootItem5");}function OnShowGroupDialog(Grid,EditObjectTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=EditObjectTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=EditObjectTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=EditObjectTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=EditObjectTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("GroupDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}Grid.EnableUpdates(false);g_EditObjectID=Grid.m_nEditObjectID;if((g_sActiveGroupType=="OUGroups")||(g_sActiveGroupType=="LDAPGroups")||(g_bEditNTGroup)||(g_bEditLDAPGroup)||(g_bEditGroupTemplate))EnableDisableMembersTab(true,g_sActiveGroupType);else EnableDisableMembersTab();if(g_bNewGroup){setTimeout(function(){DialogTabs.setSelectedItems([0]);GroupNameInput.getContent("box/text").element().focus();});}if(AW.ie){for(var sName in aGridCtrls)ClearGrid(aGridCtrls[sName],true);}if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EditObjectID);if((g_bEditNTGroup)||(g_bEditGroupTemplate)||(g_bEditLDAPGroup)){GroupNameInput.setControlDisabled(true);if(g_bEditNTGroup)sDefaultGroupText="$WINDOWS_AUTH_GROUP_NAME$";else if(g_bEditLDAPGroup)sDefaultGroupText="$LDAP_AUTH_GROUP_NAME$";else sDefaultGroupText="$DEFAULT_GROUP_TEMPLATE$";GroupNameInput.setControlText(sDefaultGroupText);}else if((g_sActiveGroupType=="OUGroups"||g_sActiveGroupType=="LDAPGroups")&&!g_bNewGroup){GroupNameInput.setControlDisabled(false);var EditCells=new Array();EditCells=g_ActiveGroupGrid.getSelectedRows().toString().split(",");sOUFullGroupName=HTMLDecode(FormatClientString(g_ActiveGroupGrid.getCellData((0),EditCells[0])));sOUChildName=g_ActiveGroupGrid.getCellText((0),EditCells[0]);if(sOUFullGroupName!=sOUChildName)g_nWinParentGroup=sOUFullGroupName.replace("."+sOUChildName,"");else g_nWinParentGroup="";GroupNameInput.setControlText(sOUChildName);g_bWinChildGroup=true;}else{GroupNameInput.setControlDisabled(false);if(g_bNewGroup)GroupNameInput.setControlText("");}document.getElementById("GroupInfoText").style.display=(g_bEditGroupTemplate)?"none":"block";document.getElementById("GroupTemplateInfoText").style.display=(g_bEditGroupTemplate)?"block":"none";OnLoadUserTriStateCheck(EditObjectTable,"LockInHomeDir","1","$LOCK_HOME_DIR$");g_IncludeRespCodeMsgFiles=OnLoadUserTriStateCheck(EditObjectTable,"IncludeRespCodesInMsgFiles","1","$WELCOME_MSG_CHECK_LABEL$",undefined,"DialogIncludeRespCodesInMsgFiles");OnLoadUserTriStateCheck(EditObjectTable,"Enabled","1","$ENABLE_ACCOUNT$","Input");InitGroupWindowTitle();saveGroupMfaConfig(EditObjectTable);CheckGroupErrorState(EditObjectTable);g_bSavingObj=false;}function CheckGroupErrorState(XMLTable){var aNodes=[];var sVal="";if((!g_bSysAdmin)&&(aNodes=XMLTable.GetCollectionByAttrib("var","name","AdminType"))&&(aNodes.length)&&(XMLTable.GetNodeValue(aNodes[0],"val")!="0")){HideDialog("GroupDialog");AlertDialog("$USER_PRIV_CANT_EDIT$",true);}}function OnLoadUserTriStateCheck(XMLTable,sAttrName,sDefault,sCheckLabel,sPreAttrName,sAltInputName){var aNodes=[];var sInputName=sAttrName;if(sAltInputName!=undefined)sInputName=sAltInputName;if(sPreAttrName!=undefined){if(sAltInputName!=undefined)sInputName=sPreAttrName+"_"+sAltInputName;else sInputName=sPreAttrName+"_"+sAttrName;}if((aNodes=XMLTable.GetCollectionByAttrib("var","name",sAttrName))&&(aNodes.length)){var Element=aNodes[0];if(sAltInputName!=undefined)sAttrName=sAltInputName;return(CreateTriStateCheckBox(sCheckLabel,sInputName,sAttrName,XMLTable.GetNodeValue(Element,"val"),XMLTable.GetNodeValue(Element,"defaultval"),XMLTable.GetNodeValue(Element,"default")));}else{if(sAltInputName!=undefined)sAttrName=sAltInputName;return(CreateTriStateCheckBox(sCheckLabel,sInputName,sAttrName,"",sDefault,"1"));}}function saveGroupMfaConfig(EditObjectTable){var totpProvisioningNode=EditObjectTable.GetCollectionByAttrib("var","name","TOTPProvisioning")[0];var totpCompanyNameNode=EditObjectTable.GetCollectionByAttrib("var","name","TOTPCompanyName")[0];var totpAbleNode=EditObjectTable.GetCollectionByAttrib("var","name","TOTPAble")[0];g_GroupMfaConfig.TOTPAble=!!+EditObjectTable.GetNodeValue(totpAbleNode,"val");g_GroupMfaConfig.TOTPProvisioning=EditObjectTable.GetNodeValue(totpProvisioningNode,"val");g_GroupMfaConfig.TOTPProvisioningDefault=EditObjectTable.GetNodeValue(totpProvisioningNode,"defaultval");g_GroupMfaConfig.IsTOTPProvisioningDefault=!!+EditObjectTable.GetNodeValue(totpProvisioningNode,"default");g_GroupMfaConfig.TOTPCompanyName=decodeURIComponent(EditObjectTable.GetNodeValue(totpCompanyNameNode,"val"));g_GroupMfaConfig.TOTPCompanyNameDefault=decodeURIComponent(EditObjectTable.GetNodeValue(totpCompanyNameNode,"defaultval"));var isHideMfa=!g_GroupMfaConfig.TOTPAble||(g_sActiveGroupType=="ODBCGroups")||(g_sActiveGroupType=="OUGroups")||(g_sActiveGroupType=="LDAPGroups")||(g_bEditNTGroup)||(g_bEditLDAPGroup)||(g_bEditGroupTemplate);EnableDisableMFATab(isHideMfa,g_sActiveGroupType);updateGroupMfaState(g_GroupMfaConfig);}function OnHideGroupDialog(){if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(false);g_nPaddingVal=0;g_ActiveGroupGrid.EnableUpdates(true);for(var sName in aGridCtrls)ClearGrid(aGridCtrls[sName],true);ClearGrid(RatioFreeFilesList,true);if(!g_bSavingObj){var objRequest=undefined;if((g_bEditNTGroup)||(g_bEditGroupTemplate)||(g_bEditLDAPGroup))objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%C"+g_sPageObjectType+".%ID%.Group");else objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%C"+g_sActiveGroupType+"."+g_nActiveGroupID+".Group");if(objRequest){objRequest.setParameter("IDs",g_EditObjectID);objRequest.request(null);}}EnableDisableMembersTab();g_EditObjectID=-1;g_bNewGroup=false;g_bEditNTGroup=false;g_bEditLDAPGroup=false;g_bEditGroupTemplate=false;g_bWinChildGroup=false;}var g_sGroupTabDialogHelp="Help-Group-Information.htm";var aGroupTabHelpPages=["Help-Group-Information.htm","Help-Directory-Access.htm","Help-Virtual-Paths.htm","Help-User-Log-Domain.htm","Help-Group-Members.htm","Help-Events.htm","Help-IP-ACL.htm","Help-Limits-Settings-Group.htm"];var nWidthAdjust=750;if(AW.theme=="vista"||AW.theme=="aqua")nWidthAdjust=(nWidthAdjust+$VISTA_DIALOG_INCREASE$);var sGroupSubDialogHeight="554";BuildDialog("$GROUP_PROPERTIES$","GroupDialog",nWidthAdjust,sGroupSubDialogHeight,"","$CLOSE_CANCEL$","Groups16.png");var DialogTabs=CreateTabs(["$GROUP_INFO_TAB$","$DIRACCESS$","$VIRPATHS$","$LOGGING$","$MEMBERS$","$EVENTS$","$IPACCESS$","$LIMITS$","$MFA_TAB_NAME$"],["GroupInfo","DirAccess","VirtualPaths","Logging","Members","Events","IPAccess","Limits","GroupMFA"],"DialogTabs","DialogTabsContent",1,OnChangeGroupsTab,true);DialogTabs.setSize(nWidthAdjust-25);AdjustDialogWidth("GroupDialog",nWidthAdjust);</script><div id="IPAccessDialoginner" style="display:none;"><form name="IPAccessForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div style="width:225px;float:left;">$IP_ACCESS_RULE_LABEL$:<div style="overflow:auto"><span id="IPAccessRule"></span></div></div><div style="width:135px;float:left;padding-left:5px;height:40px;overflow:hidden;"><span id="Allow"></span></div><div style="clear:left;">$DESCRIPTION$:<br /><span id="IPRuleDescription"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveIPAccessButton"></span><span id="CancelIPAccessButton"></span><br /><br /><span id="HelpIPAccessButton"></span></td></tr><tr><td><div id="IPAccessTipsGroup"><div style="width:145px;float:left;margin-bottom:5px;padding-left:3px;">xxx = $IP_RULE_MATCH$<br />* = $IP_RULE_ANY$<br />/ = $IP_RULE_CIDR$<br /></div><div style="width:250px;float:left;padding-left:5px;margin-bottom:5px;">| &nbsp; xxx-xxx = $IP_RULE_RANGE$<br />| &nbsp; ? = $IP_RULE_ANY_CHAR$<br />|</div></div></td></tr></table></form></div><script type="text/javascript" language="javascript">var g_sRuleAddressColumn="$RULE_ADDRESS$";var g_sAccessColumn="$ACCESS$";var g_sExpiresInColumn="$EXPIRES_IN$";var g_sIPDescriptionColumn="$DESCRIPTION$";var g_sRuleAllow="$RULE_ALLOW$";var g_sRuleDeny="$RULE_DENY$";var g_sRuleExpired="$RULE_EXPIRED$";BuildDialog("$IP_ACCESS_DIALOG_TITLE$","IPAccessDialog","530","220","","$CLOSE_CANCEL$","IpAccess16.png");function OnIPAccessLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("IPAccessDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}IPAccessRadio.initValue(parseInt(IPAccessList.getCellValue(1,IPAccessList.getSelectedRows())));IPRule.setControlText(document.getElementById(IPRule.getContent("box/text").getId()).value);IPRule.getContent("box/text").element().focus();}function OnSaveIPAccess(){if(IPRule.getControlText()!="")IPAccessList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_RULE$",true,(function(){IPRule.getContent("box/text").element().focus()}));return(false);}function OnCancelIPAccess(){HideDialog('IPAccessDialog');}function OnIPAccessHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-IP-ACL.htm",sExpandNode);}var IPAccessRadio=CreateRadioButtons(1,["$RULE_ALLOW_LABEL$","$RULE_DENY_LABEL$"],"Allow","Allow","130px",undefined,[1,0]);if(g_bFireFox3Browser)document.getElementById("Allow-box").style.height="40px";var IPRule=CreateInputField("","IPAccessRule","IPAccess_IP",undefined,225,undefined,undefined,OnSaveIPAccess);var IPRuleDescription=CreateInputField("","IPRuleDescription","IPAccess_Description",undefined,410,undefined,undefined,OnSaveIPAccess);CreateGroupBox("$IP_ACCESS_TIPS$","IPAccessTipsGroup","415px","75px",true);CreateDialogPushButton("$SAVE_BUTTON$","SaveIPAccessButton",OnSaveIPAccess);CreateDialogPushButton("$CANCEL_BUTTON$","CancelIPAccessButton",OnCancelIPAccess);CreateDialogPushButton("$HELP_BUTTON$","HelpIPAccessButton",OnIPAccessHelp);</script><div id="DirAccessDialoginner" style="display:none;"><form method="post" name="DirAccessForm"><input type="hidden" name="Access" id="DirAccessMask" /><input type="hidden" name="MaxSize" id="DirAccessMaxSize" /><table border="0" class="DialogTable"><tr><td style="width:320px;height:50px;vertical-align:top;">$PATH$:<div style="overflow:auto"><span id="DirAccessPath"></span><span id="BrowseButtonDirAccess"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveDirAccessButton"></span><span id="CancelDirAccessButton"></span><br /><br /><span id="HelpDirAccessButton"></span><br /><br /><br /><span id="FullAccessButton"></span><span id="ROAccessButton"></span><div id="DirAccessADVContain" style="margin-top:60px;"><span id="DirAccessAdvancedButton"></span></div></td></tr><tr><td style="width:335px;height:200px;"><div style="width:auto;float:left;"><div id="DirAccessFileGroup"><div style="margin-top:5px;"><div style="width:75px;float:left;"><span id="FileRead"></span><br /><span id="FileWrite"></span><br /><span id="FileAppend"></span><br /><span id="FileRename"></span><br /></div><div style="width:90px;float:left;"><span id="FileDelete"></span><br /><span id="FileExecute"></span><span style="padding:3px 0 0 1px;"><img src="%ADMIN_FILE%Images/Warn16.png" width="16" height="16" alt="$CAUTION$" style="cursor:pointer;" onclick="javascript:OnWarnExecute();"/></span><br /></div></div></div></div><div style="width:auto;float:left;margin-left:5px;"><span id="DirAccessDirGroup"><div style="margin-top:5px;"><span id="DirList"></span><br /><span id="DirCreate"></span><br /><span id="DirRename"></span><br /><span id="DirRemove"></span></div></span></div><div style="clear:both;"><div id="DirAccessSubDirGroup" style="float:left;clear:left;margin-top:10px;"><div style="margin-top:5px;"><span id="SubdirInherit"></span></div></div><div style="float:left;width:auto;padding-left:5px;padding-top:20px;height:50px;"><div><div>$MAX_SIZE_DISP$:</div><div style="overflow:auto;"><span id="MaxSizeDispNum"></span>&nbsp;&nbsp;$MAX_SIZE_LABEL$ $MAX_SIZE_COMMENT$</div></div></div></div></td></tr><tr><td colspan="2"><div id="DirAccessAsContainer" style="clear:left;"><span id="DirAccessAsGroup" style="display:none;"><div style="padding-left:5px;" id="DirAccessWinAuth">$USER_NAME$:<div style="overflow:auto"><span id="NTUser"></span></div>$PASSWORD$:<div style="overflow:auto"><span id="NTPassword"></span></div>$WINDOWS_DOMAIN_NAME$ ($OPTIONAL$):<div style="overflow:auto"><span id="NT_Domain"></span></div></div><div style="text-align:center;" id="DirAccessWinAuthContainer"><div id="DirAccessWinAuthNone" class="UpgradeLicenseMsg"><img id="DirAccessWinAuthDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="DirAccessWinAuthBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></span></div></td></tr></table></form></div><script type="text/javascript" language="javascript">var g_sPathColumn="$PATH$";var g_sAccessColumn="$ACCESS$";var g_sMaxSizeColumn="$MAX_SIZE$";var g_bDirAccessAdvancedShown=false;var nDirAccessGroupWidth="300px";var nDirAccessGroupHeight="130px";var g_bShowDirAccessADV=(%WINDOWS_AUTH_SUPPORT%==1);BuildDialog("$DIR_ACCESS_DIALOG_TITLE$","DirAccessDialog","450","340","","$CLOSE_CANCEL$","folders16.png");var g_aDirAccessChecks=new Array(11);var DirAccessPathInput=CreateInputField("","DirAccessPath","Dir",undefined,275,undefined,undefined,OnSaveDirAccess);var MaxSizeInput=CreateInputField("","MaxSizeDispNum","MaxSizeDisp",undefined,50,undefined,undefined,OnSaveDirAccess);MaxSizeInput.getContent('box/text').setStyle('text-align','right');CreateGroupBox("$DIR_ACCESS_FILES$","DirAccessFileGroup","185px","115px",true);CreateGroupBox("$DIR_ACCESS_DIRS$","DirAccessDirGroup","115px","115px",true);CreateGroupBox("$DIR_ACCESS_SUBDIRS$","DirAccessSubDirGroup","115px","50px",true);if("%CServer.%SERVER_ID%.WinAuthLicense%"!="1"){DisableTab("DirAccessWinAuth");document.getElementById("DirAccessWinAuthNone").className="UpgradeLicenseMsgNoMargin";nDirAccessGroupWidth="400px";nDirAccessGroupHeight="140px";}if(g_bSysAdmin)document.getElementById("DirAccessAsContainer").style.display="block";var NTUserNameInput=CreateInputField("","NTUser","NTUser",undefined,275,undefined,undefined,OnSaveDirAccess);var NTDomainInput=CreateInputField("","NT_Domain","Info_NTDomain",undefined,275,undefined,undefined,OnSaveDirAccess);var NTPasswordInput=CreatePasswordField("","NTPassword","NTPassword","",275,undefined,undefined,OnSaveDirAccess);setTimeout(function(){initPasswordTypeToggler(NTPasswordInput,"NTPassword");});CreateGroupBox("$DIR_ACCESS_AS_WIN_USER$","DirAccessAsGroup",nDirAccessGroupWidth,nDirAccessGroupHeight,true);var DirAccessAdvancedButton=CreatePushButton("$ADVANCED_BUTTON$ >>","DirAccessAdvancedButton",OnDirAccessAdvanced);if(!g_bShowDirAccessADV)document.getElementById("DirAccessADVContain").style.display="none";CreateDialogPushButton("$SAVE_BUTTON$","SaveDirAccessButton",OnSaveDirAccess);CreateDialogPushButton("$CANCEL_BUTTON$","CancelDirAccessButton",OnCancelDirAccess);CreateDialogPushButton("$HELP_BUTTON$","HelpDirAccessButton",OnDirAccessHelp);CreateDialogPushButton("$DIR_ACCESS_FULL_ACCESS$","FullAccessButton",OnFullAccess);CreateDialogPushButton("$DIR_ACCESS_RO_ACCESS$","ROAccessButton",OnReadOnly);var DirAccessBrowse=CreatePushButton("","BrowseButtonDirAccess",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[DirAccessPathInput,false,"0","0"]]);DirAccessBrowse.setControlImage("Browse");function OnDirAccessLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("DirAccessDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}var nMask=parseInt(document.getElementById("DirAccessMask").value);g_aDirAccessChecks[0]=CreateDirAccessCheckbox("$ACCESS_READ$","FileRead","DirAccessMask",SU_DIR_ACCESS_READ,nMask);g_aDirAccessChecks[1]=CreateDirAccessCheckbox("$ACCESS_WRITE$","FileWrite","DirAccessMask",SU_DIR_ACCESS_WRITE,nMask);g_aDirAccessChecks[2]=CreateDirAccessCheckbox("$ACCESS_APPEND$","FileAppend","DirAccessMask",SU_DIR_ACCESS_APPEND,nMask);g_aDirAccessChecks[3]=CreateDirAccessCheckbox("$ACCESS_DELETE$","FileDelete","DirAccessMask",SU_DIR_ACCESS_DELETE,nMask);g_aDirAccessChecks[4]=CreateDirAccessCheckbox("$ACCESS_RENAME$","FileRename","DirAccessMask",SU_DIR_ACCESS_RENAME,nMask);g_aDirAccessChecks[5]=CreateDirAccessCheckbox("$ACCESS_EXECUTE$","FileExecute","DirAccessMask",SU_DIR_ACCESS_EXECUTE,nMask);g_aDirAccessChecks[6]=CreateDirAccessCheckbox("$ACCESS_LIST$","DirList","DirAccessMask",SU_DIR_ACCESS_LIST,nMask);g_aDirAccessChecks[7]=CreateDirAccessCheckbox("$ACCESS_CREATE$","DirCreate","DirAccessMask",SU_DIR_ACCESS_CREATE,nMask);g_aDirAccessChecks[8]=CreateDirAccessCheckbox("$ACCESS_REMOVE$","DirRemove","DirAccessMask",SU_DIR_ACCESS_REMOVE,nMask);g_aDirAccessChecks[9]=CreateDirAccessCheckbox("$ACCESS_RENAME$","DirRename","DirAccessMask",SU_DIR_ACCESS_RENAME_DIR,nMask);g_aDirAccessChecks[10]=CreateDirAccessCheckbox("$ACCESS_INHERIT$","SubdirInherit","DirAccessMask",SU_DIR_ACCESS_SUBDIR_INHERIT,nMask);if(!g_bSysAdmin)g_aDirAccessChecks[5].setControlDisabled(true);MaxSizeInput.setControlText(parseInt(document.getElementById("DirAccessMaxSize").value)/1048576);DirAccessPathInput.setControlText(document.getElementById(DirAccessPathInput.getContent("box/text").getId()).value);DirAccessPathInput.getContent("box/text").element().focus();if(g_bSysAdmin&&(document.getElementById(NTUserNameInput.getContent("box/text").getId()).value!=""&&"%CServer.%SERVER_ID%.WinAuthLicense%"=="1")){if(!g_bDirAccessAdvancedShown){document.getElementById("DirAccessAsGroup").style.display="block";DirAccessAdvancedButton.setControlText("$ADVANCED_BUTTON$ &lt;&lt;");g_bDirAccessAdvancedShown=(!g_bDirAccessAdvancedShown);}}else if(g_bSysAdmin&&(document.getElementById(NTUserNameInput.getContent("box/text").getId()).value==""&&"%CServer.%SERVER_ID%.WinAuthLicense%"=="1")){if(g_bDirAccessAdvancedShown){document.getElementById("DirAccessAsGroup").style.display="none";DirAccessAdvancedButton.setControlText("$ADVANCED_BUTTON$ &gt;&gt;");g_bDirAccessAdvancedShown=(!g_bDirAccessAdvancedShown);}}}function OnChangeMaxSize(sText){var nVal=parseInt(sText);if(isNaN(nVal))nVal=0;document.getElementById("DirAccessMaxSize").value=(nVal*1048576);MaxSizeInput.setControlText(nVal);}function OnSaveDirAccess(){OnChangeMaxSize(MaxSizeInput.getControlText());if(DirAccessPathInput.getControlText()!="")DirAccessList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_PATH$");}function OnCancelDirAccess(){HideDialog("DirAccessDialog");}function OnDirAccessHelp(){LaunchHelp("Help-Directory-Access.htm","Item2_4");}function OnFullAccess(){SetMaskValue(7967);}function OnReadOnly(){SetMaskValue(4353);}function SetMaskValue(nMask){document.getElementById("DirAccessMask").value=nMask;for(var nIndex in g_aDirAccessChecks)g_aDirAccessChecks[nIndex].UpdateState(nMask);}function OnWarnExecute(){AlertDialog("$EXECUTE_CAUTION$");}function OnDirAccessAdvanced(){if(g_bDirAccessAdvancedShown=(!g_bDirAccessAdvancedShown)){document.getElementById("DirAccessAsGroup").style.display="block";DirAccessAdvancedButton.setControlText("$ADVANCED_BUTTON$ &lt;&lt;");}else{document.getElementById("DirAccessAsGroup").style.display="none";DirAccessAdvancedButton.setControlText("$ADVANCED_BUTTON$ &gt;&gt;");}}</script><div id="VirtualPathDialoginner" style="display:none;"><form method="post" name="VirPathForm"><table class="DialogTable"><tr><td><img alt="$VIRPATHS$" src="%ADMIN_FILE%Images/VirtualPaths32.png" width="32" height="32" class="header-icon" />$VIRPATH_DIALOG_INFO$</td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveVirPathButton"></span><br /><span id="CancelVirPathButton"></span><br /><br /><span id="HelpVirPathButton"></span></td></tr><tr><td>$VIRPATH_PHYSICAL$:<div style="overflow:auto"><span id="PhysicalPath"></span><span id="BrowseButtonVirPath"></span></div>$VIRPATH_VIRTUAL$:<div style="overflow:auto"><span id="VirtualPath"></span></div><span id="VirPathMaxSize"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var PhysicalPath=CreateInputField("","PhysicalPath","PhysicalPath",undefined,310,undefined,undefined,OnSaveVirPath);var VirtualPath=CreateInputField("","VirtualPath","VirtualPath",undefined,310,undefined,undefined,OnSaveVirPath);var VirtualPathIncludeMaxSize=CreateCheckBox("$VIRPATH_INCLUDE_IN_MAX_SIZE$","VirPathMaxSize","IncludeInMaxSize",false,undefined,true,"OnLoadVirPathMaxSize()");BuildDialog("$VIRPATH_DIALOG_TITLE$","VirtualPathDialog","460","195","","$CLOSE_CANCEL$","VirtualPaths16.png");CreateDialogPushButton("$SAVE_BUTTON$","SaveVirPathButton",OnSaveVirPath);CreateDialogPushButton("$CANCEL_BUTTON$","CancelVirPathButton",OnCancelVirPath);CreateDialogPushButton("$HELP_BUTTON$","HelpVirPathButton",OnVirPathHelp);var VirPathBrowse=CreatePushButton("","BrowseButtonVirPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[PhysicalPath,false,"0","0"]]);VirPathBrowse.setControlImage("Browse");function OnVirPathLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("VirtualPathDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}PhysicalPath.setControlText(document.getElementById(PhysicalPath.getContent("box/text").getId()).value);VirtualPath.setControlText(document.getElementById(VirtualPath.getContent("box/text").getId()).value);}function OnSaveVirPath(){if((PhysicalPath.getControlText()!="")&&(VirtualPath.getControlText()!=""))VirPathsList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_VIRPATH$");}function OnCancelVirPath(){HideDialog('VirtualPathDialog');}function OnLoadVirPathMaxSize(sValue){VirtualPathIncludeMaxSize.setChecked((sValue!="0")?true:false,true);}function OnVirPathHelp(){var sExpandNode="RootItem6";switch(g_nDomainHelpType){case(0):sExpandNode="RootItem6";break;case(1):sExpandNode="RootItem5";break;case(2):sExpandNode="Item2_4";break;}LaunchHelp("Help-Virtual-Paths.htm",sExpandNode);}</script><div id="LimitsDialoginner" style="display:none;"><form name="LimitForm" onsubmit="return (false);"><div style="display:inline;"><img alt="$LIMIT_LABEL$" src="%ADMIN_FILE%Images/Limits32.png" width="32" height="32" class="header-icon" style="padding-left:5px;"/>$LIMIT_EDIT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="float:left;width:$LIMIT_DIALOG_WIDTH$px;padding-left:5px;overflow:hidden;text-overflow:ellipsis;">$LIMIT_LABEL$:<br /><span id="LimitSelectCombo"></span><br /><div id="LimitCheckDiv" style="padding-top:12px;height:36px;"><span id="LimitCheckbox"></span></div><div id="LimitEditDiv" style="padding-top:8px;height:40px;vertical-align:top;"><div><span id="LimitEditInfo"></span></div><div style="clear:left;overflow:auto;line-height:16px;float:left;width:auto;"><span id="LimitEditInput"></span></div> <div style="float:left;width:auto;line-height:18px;padding-left:3px;"><span id="LimitEditLabel"></span></div><div style="clear:both;height:1px;overflow:hidden;">&nbsp;</div><input id="LimitEditValue" type="hidden" /></div><div id="LimitComboDiv" style="padding-top:8px;height:40px;"><span style="" id="LimitComboEditInfo"></span><br /><span id="LimitEditCombo"></span></div><div id="LimitBrowseDiv" style="padding-top:8px;height:45px;"><span id="LimitBrowseInfo"></span>	<br /><div style="overflow:auto"><span id="LimitBrowse"></span><span id="LimitBrowseButton"></span></div></div><div id="LimitAdvancedDiv" style="display:none;margin-bottom:5px;"><div id="LimitAdvancedGroup"><span id="LimitToTimeOfDay"></span><br /><div style="float:left;width:125px;">$LIMIT_START_TIME$:<br /><span id="LimitStartTime"></span><input type="hidden" id="StartTime" /></div><div style="float:left;width:125;">$LIMIT_END_TIME$:<br /><span id="LimitEndTime"></span><input type="hidden" id="EndTime" /></div></div><div id="LimitTODGroup"><div style="float:left;width:100px;"><span id="Monday"></span><br /><span id="Tuesday"></span><br /><span id="Wednesday"></span></div><div style="float:left;width:100px;"><span id="Thursday"></span><br /><span id="Friday"></span></div><div style="float:left;width:100px;"><span id="Saturday"></span><br /><span id="Sunday"></span></div></div></div><span id="LimitAdvancedButton"></span></div><div style="float:left;width:80px;"><span id="SaveLimitButton"></span><span id="CancelLimitButton"></span><br /><br /><span id="HelpLimitButton"></span></div><div style="clear:both;"></div></form></div><script type="text/javascript" language="javascript">var g_aDaysChecks=[];var g_bAdvancedShown=false,g_bEditLimit=false,g_bInitTimes=false;var g_aasAvailableLimits=[];var g_nCurrentLimit=0;var g_asLimitEditLabels=["","KB/$ACTIVITY_SEC_ABBREV$","$LIMIT_MINUTES$","$LIMIT_SESSIONS$","$DAYS$","$LIMIT_CHARACTERS$","$LIMIT_SFTP_VERSION$","KB"];var g_asTimes=[];var StartTimeCombo=undefined;var EndTimeCombo=undefined;BuildDialog("$LIMITS_DIALOG_TITLE$","LimitsDialog",($LIMIT_DIALOG_WIDTH$+100),"385","","$CLOSE_CANCEL$","Limits16.png");var LimitListCombo=CreateComboBox("","",[],[],"LimitSelectCombo","LimitSelectCombo",OnChangeLimitList,"",false,$LIMIT_SELECT_COMBO_WIDTH$,undefined,OnSaveLimit);var LimitCheckBox=CreateCheckBox("","LimitCheckbox","LimitCheckbox",true);var LimitEditBox=CreateInputField("","LimitEditInput","LimitEdit",undefined,60,undefined,true,OnSaveLimit);var LimitBrowse=CreateInputField("","LimitBrowse","LimitBrowse",undefined,355,undefined,false,OnSaveLimit);var LimitBrowseButton=CreatePushButton("","LimitBrowseButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[LimitBrowse,true,"0","0"]]);LimitBrowseButton.setControlImage("Browse");var LimitCombo=CreateComboBox("","",[],[],"LimitEditCombo","LimitEditCombo",undefined,"",false,385,undefined,OnSaveLimit);CreateGroupBox("$LIMIT_TIME_OF_DAY$","LimitAdvancedGroup",325,95);var LimitApplyTODCheck=CreateCheckBox("$LIMIT_APPLY_TOD$","LimitToTimeOfDay","Info_LimitToTimeOfDay",false,OnChangeApplyTOD);CreateGroupBox("$LIMIT_DAYS_OF_WEEK$","LimitTODGroup",325,95);g_aDaysChecks.push(CreateCheckBox("$DAY_MONDAY$","Monday","Info_Monday",true,undefined,true));g_aDaysChecks.push(CreateCheckBox("$DAY_TUESDAY$","Tuesday","Info_Tuesday",true,undefined,true));g_aDaysChecks.push(CreateCheckBox("$DAY_WEDNESDAY$","Wednesday","Info_Wednesday",true,undefined,true));g_aDaysChecks.push(CreateCheckBox("$DAY_THURSDAY$","Thursday","Info_Thursday",true,undefined,true));g_aDaysChecks.push(CreateCheckBox("$DAY_FRIDAY$","Friday","Info_Friday",true,undefined,true));g_aDaysChecks.push(CreateCheckBox("$DAY_SATURDAY$","Saturday","Info_Saturday",true,undefined,true));g_aDaysChecks.push(CreateCheckBox("$DAY_SUNDAY$","Sunday","Info_Sunday",true,undefined,true));var LimitsAdvancedButton=CreatePushButton("$ADVANCED_BUTTON$ &gt;&gt;","LimitAdvancedButton",OnLimitAdvanced);var SaveLimitsButton=CreateDialogPushButton("$SAVE_BUTTON$","SaveLimitButton",OnSaveLimit);CreateDialogPushButton("$CANCEL_BUTTON$","CancelLimitButton",OnCancelLimit);CreateDialogPushButton("$HELP_BUTTON$","HelpLimitButton",OnLimitHelp);function OnChangeDirListMask(){var sVal=this.getControlText().toLowerCase(),sMask="rwxrwxrwx";if(sVal=="")sVal="rw-rw-rw-";
if(sVal.length<9){while(sVal.length<9)sVal+=" ";}else sVal=sVal.substring(0,9);for(var nIndex=0;nIndex<sVal.length;nIndex++){if(!((sVal[nIndex]==sMask[nIndex])||(sVal[nIndex]=='-')))sVal=sVal.substr(0,nIndex)+sMask[nIndex]+sVal.substr(nIndex+1);}this.setControlText(sVal);}function OnLimitLoad(aasLimits,bEdit){if(g_sPageType=="users"){if(g_nActiveUserOrg==g_nODBCUserOrg){document.getElementById("LimitAdvancedDiv").style.display="none";document.getElementById("LimitAdvancedButton").style.display="none";}else document.getElementById("LimitAdvancedButton").style.display="block";}else if(g_sPageType=="group"){if(g_sActiveGroupType=="ODBCGroups"){document.getElementById("LimitAdvancedDiv").style.display="none";document.getElementById("LimitAdvancedButton").style.display="none";}else document.getElementById("LimitAdvancedButton").style.display="block";}var asLabels=[],asValues=[];g_aasAvailableLimits.length=0;g_nCurrentLimit=0;g_bEditLimit=bEdit;for(var nIndex=0;nIndex<aasLimits.length;nIndex++){asLabels.push(aasLimits[nIndex][0]);asValues.push(nIndex.toString());g_aasAvailableLimits.push(aasLimits[nIndex].slice(0));}LimitListCombo.setItemText(asLabels);LimitListCombo.setItemValue(asValues);LimitListCombo.setItemCount(asLabels.length);if(asLabels.length>1)LimitListCombo.getPopupTemplate().setStyle("height",(asLabels.length<=10)?((16*asLabels.length)+((AW.ie)?3:0))+"px":"163px");else if(asLabels.length==1)LimitListCombo.getPopupTemplate().setStyle("height",((g_bFireFox4Browser)?"24px":"20px"));if(!g_bInitTimes){var nTemp=0;while(nTemp<86400000){g_asTimes.push(FormatTODTime(nTemp));nTemp+=1800000;}StartTimeCombo=CreateComboBox(g_asTimes[0],"",g_asTimes,[],"LimitStartTime","LimitStartTime",undefined,"",false,115,undefined,undefined,true);EndTimeCombo=CreateComboBox(g_asTimes[g_asTimes.length-1],"",g_asTimes,[],"LimitEndTime","LimitEndTime",undefined,"",false,115,undefined,undefined,true);g_bInitTimes=true;}if(g_bDefaultLimitAdd){var anSelectedRows=LimitsList.getSelectedRows();sLimitName=GetLimitInfo(anSelectedRows[0])[0];for(var nIndex=0;nIndex<LimitListCombo.getItemCount();nIndex++){if(LimitListCombo.getItemText(nIndex)==sLimitName){LimitListCombo.setSelectedItems([nIndex]);LimitListCombo.setControlText(LimitListCombo.getItemText(nIndex));OnChangeLimitList(nIndex.toString(),true);break;}}}else{LimitListCombo.setSelectedItems([0]);LimitListCombo.setControlText(LimitListCombo.getItemText(0));OnChangeLimitList("0",true);}}function OnChangeLimitList(sValue,bUpdateTOD){g_nCurrentLimit=parseInt(sValue);if((!isNaN(g_nCurrentLimit))&&(g_nCurrentLimit<g_aasAvailableLimits.length)){if(g_aasAvailableLimits[g_nCurrentLimit][1]=="0"){document.getElementById("LimitCheckDiv").style.display="block";document.getElementById("LimitEditDiv").style.display="none";document.getElementById("LimitComboDiv").style.display="none";document.getElementById("LimitBrowseDiv").style.display="none";LimitCheckBox.setControlText(g_aasAvailableLimits[g_nCurrentLimit][0]);LimitCheckBox.setChecked((g_aasAvailableLimits[g_nCurrentLimit][2]=="1")?true:false);}else if(g_aasAvailableLimits[g_nCurrentLimit][1]=="8"){document.getElementById("LimitCheckDiv").style.display="none";document.getElementById("LimitEditDiv").style.display="none";document.getElementById("LimitComboDiv").style.display="block";document.getElementById("LimitBrowseDiv").style.display="none";var asComboValues=[];var LimitSelectedItem=0;if(g_aasAvailableLimits[g_nCurrentLimit][9]=="HTTPLoginPageDefaultLanguage"){var sLimitLang=decodeURIComponent(g_aasAvailableLimits[g_nCurrentLimit][2]);asComboValues=g_asLangVals;for(var nIndex=0;nIndex<g_asLimitComboStrings[g_aasAvailableLimits[g_nCurrentLimit][9]].length;nIndex++){if(sLimitLang==asComboValues[nIndex]){LimitSelectedItem=nIndex;break;}}}else{for(var nIndex=0;nIndex<g_asLimitComboStrings[g_aasAvailableLimits[g_nCurrentLimit][9]].length;nIndex++){asComboValues.push(nIndex.toString());}LimitSelectedItem=g_aasAvailableLimits[g_nCurrentLimit][2];}LimitCombo.setItemText(g_asLimitComboStrings[g_aasAvailableLimits[g_nCurrentLimit][9]]);LimitCombo.setItemValue(asComboValues);LimitCombo.setItemCount(asComboValues.length);if(asComboValues.length>1)LimitCombo.getPopupTemplate().setStyle("height",(asComboValues.length<=10)?((16*asComboValues.length)+((AW.ie)?3:0))+"px":"163px");else if(asComboValues.length==1)LimitCombo.getPopupTemplate().setStyle("height",((g_bFireFox4Browser)?"24px":"20px"));LimitCombo.setSelectedItems([LimitSelectedItem]);LimitCombo.setControlText(LimitCombo.getItemText(parseInt(LimitSelectedItem)));document.getElementById("LimitComboEditInfo").innerHTML=g_aasAvailableLimits[g_nCurrentLimit][0];}else if(g_aasAvailableLimits[g_nCurrentLimit][1]=="9"){var nDefaultVal=decodeURIComponent(g_aasAvailableLimits[g_nCurrentLimit][2]);document.getElementById("LimitCheckDiv").style.display="none";document.getElementById("LimitEditDiv").style.display="none";document.getElementById("LimitComboDiv").style.display="none";document.getElementById("LimitBrowseDiv").style.display="block";LimitBrowse.setControlText(String(nDefaultVal));}else{var nScale=parseInt(g_aasAvailableLimits[g_nCurrentLimit][3]);var nDefaultVal=parseInt(g_aasAvailableLimits[g_nCurrentLimit][2]);document.getElementById("LimitEditDiv").style.display="block";document.getElementById("LimitCheckDiv").style.display="none";document.getElementById("LimitComboDiv").style.display="none";document.getElementById("LimitBrowseDiv").style.display="none";document.getElementById("LimitEditInfo").innerHTML=g_aasAvailableLimits[g_nCurrentLimit][0];var sEditLabelsText="";if(g_asLimitEditLabels[g_aasAvailableLimits[g_nCurrentLimit][1]]!=undefined)sEditLabelsText=g_asLimitEditLabels[g_aasAvailableLimits[g_nCurrentLimit][1]];else if(g_aasAvailableLimits[g_nCurrentLimit][1]=="12")sEditLabelsText="MB";if(g_aasAvailableLimits[g_nCurrentLimit][1]=="13")sEditLabelsText="$LIMIT_SECONDS$";document.getElementById("LimitEditLabel").innerHTML=sEditLabelsText;if(g_aasAvailableLimits[g_nCurrentLimit][9]=="DirListingMask"){LimitEditBox.setStyle("width","80px");LimitEditBox.getContent('box/text').setStyle('text-align','left');LimitEditBox.setControlText(g_aasAvailableLimits[g_nCurrentLimit][2]);LimitEditBox.onControlEditEnded=OnChangeDirListMask;}else if(g_aasAvailableLimits[g_nCurrentLimit][9]=="FileOwner"||g_aasAvailableLimits[g_nCurrentLimit][9]=="FileGroup"){LimitEditBox.setStyle("width","80px");LimitEditBox.getContent('box/text').setStyle('text-align','left');LimitEditBox.setControlText(decodeURIComponent(g_aasAvailableLimits[g_nCurrentLimit][2]));LimitEditBox.onControlEditEnded=function(){return(false);};}else{LimitEditBox.setStyle("width","60px");LimitEditBox.getContent('box/text').setStyle('text-align','right');LimitEditBox.onControlEditEnded=function(){return(false);};LimitEditBox.setControlText(String(nDefaultVal/nScale));}}if(bUpdateTOD)LoadLimitTODValues(g_aasAvailableLimits[g_nCurrentLimit].slice(4));if(g_sPageType=="users"){if(g_nActiveUserOrg==g_nODBCUserOrg){document.getElementById("LimitAdvancedDiv").style.display="none";document.getElementById("LimitAdvancedButton").style.display="none";}else document.getElementById("LimitAdvancedButton").style.display="block";}else if(g_sPageType=="group"){if(g_sActiveGroupType=="ODBCGroups"){document.getElementById("LimitAdvancedDiv").style.display="none";document.getElementById("LimitAdvancedButton").style.display="none";}else document.getElementById("LimitAdvancedButton").style.display="block";}if(g_aasAvailableLimits[g_nCurrentLimit][9]=="PasswordType"){document.getElementById("LimitAdvancedDiv").style.display="none";document.getElementById("LimitAdvancedButton").style.display="none";LimitsAdvancedButton.setControlText("$ADVANCED_BUTTON$ &gt;&gt;");}else document.getElementById("LimitAdvancedButton").style.display="block";if(g_aasAvailableLimits[g_nCurrentLimit][9]=="AllowHTTPIPAddressChange"){setTimeout(function(){HideDialog("$ALERT_DIALOG$");AlertDialog("$ALLOW_HTTP_CHANGE_LIMIT_WARN$",true);},0);}}}function LoadLimitTODValues(asTODValues){var bDayOfWeekChanged=false;LimitApplyTODCheck.setControlValue(asTODValues[0]=="1");StartTimeCombo.setControlText(FormatTODTime(asTODValues[1]));EndTimeCombo.setControlText(FormatTODTime(asTODValues[2]));for(var nIndex=0;nIndex<asTODValues[3].length;nIndex++){g_aDaysChecks[nIndex].setControlValue(asTODValues[3].charAt(nIndex)=="1");if(asTODValues[3].charAt(nIndex)!="1")bDayOfWeekChanged=true;}if(asTODValues[0]=="1"||bDayOfWeekChanged)g_bAdvancedShown=false;else g_bAdvancedShown=true;setTimeout(function(){OnLimitAdvanced();});}function OnLimitAdvanced(){if(g_bAdvancedShown=(!g_bAdvancedShown)){document.getElementById("LimitAdvancedDiv").style.display="block";LimitsAdvancedButton.setControlText("$ADVANCED_BUTTON$ &lt;&lt;");}else{document.getElementById("LimitAdvancedDiv").style.display="none";LimitsAdvancedButton.setControlText("$ADVANCED_BUTTON$ &gt;&gt;");}}function OnChangeApplyTOD(CheckBox){var bDisable=(!CheckBox.getControlValue());StartTimeCombo.SetDisabled(bDisable);EndTimeCombo.SetDisabled(bDisable);}function GetLimitTODValue(AWCtrl){var sText=AWCtrl.getControlText(),sTemp="";var nRet=-1,nHours=-1,nMinutes=-1;while(sText.charAt(0)==" ")sText=sText.substring(1);while(sText.charAt(sText.length-1)==" ")sText=sText.substring(0,sText.length-1);sTemp=sText.substring(0,sText.indexOf(":"));if(sTemp.length){if((sTemp.length>1)&&(sTemp.charAt(0)=="0"))sTemp=sTemp.substring(1);nHours=parseInt(sTemp);}sTemp=sText.substr(sText.indexOf(":")+1,2);if(sTemp.length==2){if(sTemp.charAt(0)=="0")sTemp=sTemp.substring(1);nMinutes=parseInt(sTemp);}if((sText.indexOf("$TIME_PM$")>0)&&(nHours>=0))nHours+=12;else if(nHours==12)nHours=0;if((nHours>=0)&&(nMinutes>=0))nRet=((nHours*60)+nMinutes)*60000;return(nRet);}function LimitTODsOkay(){return((GetLimitTODValue(StartTimeCombo)>=0)&&(GetLimitTODValue(EndTimeCombo)>=0));}function OnSaveLimit(){var bApplyTOD=LimitApplyTODCheck.getControlValue();if((bApplyTOD)&&(!LimitTODsOkay()))AlertDialog("$LIMIT_INVALID_TOD$");else{var SaveLimitRequest=undefined;if(g_bEditLimit)SaveLimitRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CSessionAttrs."+g_EditObjectID+"."+g_aasAvailableLimits[g_nCurrentLimit][9]+"."+g_aasAvailableLimits[g_nCurrentLimit][8]);else SaveLimitRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%ADD_OBJECT_REF%CSessionAttrs."+g_EditObjectID+"."+g_aasAvailableLimits[g_nCurrentLimit][9]);if(SaveLimitRequest){SavingDialog(true);if(g_aasAvailableLimits[g_nCurrentLimit][1]=="0")SaveLimitRequest.setParameter("Value",(LimitCheckBox.getControlValue())?"1":"0");else if(g_aasAvailableLimits[g_nCurrentLimit][1]=="8")SaveLimitRequest.setParameter("Value",LimitCombo.getItemValue(LimitCombo.getSelectedItems()));else if(g_aasAvailableLimits[g_nCurrentLimit][1]=="9")SaveLimitRequest.setParameter("Value",LimitBrowse.getControlText());else if(g_aasAvailableLimits[g_nCurrentLimit][1]=="11"||g_aasAvailableLimits[g_nCurrentLimit][1]=="10")SaveLimitRequest.setParameter("Value",LimitEditBox.getControlText());else SaveLimitRequest.setParameter("Value",(parseInt(LimitEditBox.getControlText())*parseInt(g_aasAvailableLimits[g_nCurrentLimit][3])));for(var nIndex=0;nIndex<g_aDaysChecks.length;nIndex++)SaveLimitRequest.setParameter(g_aDaysChecks[nIndex].getAttribute("AttrName").replace("Info_",""),(g_aDaysChecks[nIndex].getControlValue())?"1":"0");SaveLimitRequest.setParameter("LimitToTimeOfDay",(bApplyTOD)?"1":"0");if(bApplyTOD){SaveLimitRequest.setParameter("StartTime",GetLimitTODValue(StartTimeCombo));SaveLimitRequest.setParameter("EndTime",GetLimitTODValue(EndTimeCombo));}SaveLimitRequest.response=function(){if(OnSaveComplete(this)==0){HideDialog('LimitsDialog');if(g_aasAvailableLimits[g_nCurrentLimit][9]=="PasswordType")setTimeout("OnOKPassWordChange()");if(g_aasAvailableLimits[g_nCurrentLimit][9]=="RequireEmailAddressSet")setTimeout("OnOKRequireEmailChange()");LimitsList.ForceUpdate();}};SaveLimitRequest.request(null);}}return(false);}function OnOKRequireEmailChange(){AlertDialog("$REQUIRE_CHANGE_EMAIL_WARN$");}function OnOKPassWordChange(){AlertDialog("$PASSWORD_INVALIDATED$");}function OnCancelLimit(){HideDialog('LimitsDialog');}function OnLimitHelp(){LaunchHelp("Help-Limits-Settings-Domain.htm","Item5_4");}</script><div id="EventsDialoginner" style="display:none;"><div style="padding:0 10px 0 10px;"><form method="post" name="EventsForm" onsubmit="return (false);"><span id="EventDialogTabs" style="-moz-user-select:-moz-none;"></span><div id="EventInfoTabsContent" class="tabs-content"><div id="EventInformation" style="display:none;"><span id="EventInfoGroup"><div style="padding:0 0 5px 5px;">$EVENT_TYPE$:<br /><span id="EventID"></span><br />$EVENTS_NAME_LABEL$:<br /><span id="EventNameInput"></span><br /><div style="margin-top:5px;"><span id="EventDisabled"></span></div><br />$DESCRIPTION$:<br /><div style="overflow:auto;"><textarea id="event_Description" name="event_Description" class="aw-border" style="width:370px;height:75px;"></textarea></div></div></span><div style="margin-top:10px;"><span id="EventActionGroup" ><div style="padding:0 0 5px 5px;">$EVENTS_ACTION_LABEL$:<br /><span id="Action"></span><div id="email-event" style="display:none;">$EVENTS_EMAIL_TO_LABEL$:<div style="overflow:auto"><span id="EmailToAddressInput" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"></span><span id="AddGroupsEmailToButton" alt="$GROUP_EMAIL_TO_NOTE$" title="$GROUP_EMAIL_TO_NOTE$"></span></div>$EVENTS_EMAIL_BCC_LABEL$ ($OPTIONAL$):<div style="overflow:auto"><span id="EmailToAddressBCCInput" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"></span><span id="AddGroupsEmailBCCButton" alt="$GROUP_EMAIL_BCC_NOTE$" title="$GROUP_EMAIL_BCC_NOTE$"></span></div></div><div id="exec-event" style="display:none;">$EVENTS_EXEC_PATH_LABEL$:<div style="overflow:auto"><span id="ExeFilePathInput"></span><span id="BrowseButtonExecPath"></span></div></div><div id="data1-event" style="display:none;"><span id="data1-text"></span>:<div style="overflow:auto"><span id="Data1Input"></span></div></div><div id="data2-event" style="display:none;"><span id="data2-text"></span>:<div style="overflow:auto;"><textarea id="event_Data2" name="event_Data2" class="aw-border" style="width:370px;height:75px;"></textarea></div></div><div id="exec-event-wait" style="display:none;">$EVENTS_EXEC_WAIT_LABEL$:<div style="overflow:auto"><span id="ExecWaitSecs"></span>($EVENTS_EXEC_WAIT_SEC$)</div></div></div></span></div></div><div id="EventFilters" style="display:none;height:410px;"><div id="EventRulesContent"><div class="layercontent"><div style="display:inline;"><img alt="$FILTER_RULE_EVENTS$" src="%ADMIN_FILE%Images/Filter32.png" width="32" height="32" class="header-icon" />$FILTER_EVENT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="width:440px;"><span id="EventFilterList"></span></div><div style="padding-top:5px;"><span id="AddEventFilterButton"></span><span id="EditEventFilterButton"></span><span id="DeleteEventFilterButton"></span></div></div></div></div></div><input type="hidden" id="ObjectID" name="ObjectID"/></form><div style="text-align:right;padding:10px 20px 0 0;"><span id="SaveEventButton"></span><span id="CancelEventButton"></span> &nbsp;&nbsp;&nbsp;<span id="HelpEventButton"></span></div></div></div><script type="text/javascript" language="javascript">var g_EventObjID;var g_sEventFilterRuleName="$NAME$";var g_sEventFilterDescr="$DESCRIPTION$";var g_sEventFilterLogic="$EVENT_RULE_LOGIC$";var g_EventRuleObjID;var nEventDialogWidth="510";BuildDialog("$EVENTS$","EventsDialog",nEventDialogWidth,"575","","$CLOSE_CANCEL$","cmd-16.png");var EventDialogTabs=CreateTabs(["$EVENTS$","$EVENTS_FILTERS$"],["EventInformation","EventFilters"],"EventDialogTabs","EventInfoTabsContent",1,OnChangeEventsTab,true);var EventFilterList=CreateEventFiltersGrid("EventFilterList","EventFilters.xml?ID=%OBJECT_EDIT_ID%",OnDelayLoadEditFilterDialog);var sOnDelayLoadAddFilterDialog=String("OnDelayLoadAddFilterDialog(");var sOnDelayLoadEditFilterDialog=String("OnDelayLoadEditFilterDialog(");var sOnRemoveEventFilter=String("OnRemoveEventFilter(");var sOnEnableFilter=String("OnEnableDisableFilter(1,");var sOnDisableFilter=String("OnEnableDisableFilter(0,");CreateContextMenu([sOnDelayLoadAddFilterDialog,sOnDelayLoadEditFilterDialog,sOnRemoveEventFilter,sOnEnableFilter,sOnDisableFilter],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(EventFilterList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(EventFilterList,"$DELETE_BUTTON$"))},OnEnableFilterContextMenu,OnDisableFilterContextMenu],["New","Edit","FileDelete",OnEnableFilterContextImage,OnDisableFilterContextImage],EventFilterList,"EventFilterListContext",true);EventFilterList.setStyle("height","330px");function OnChangeEventsTab(nOldTab,nNewTab){switch(nNewTab){case(0):break;case(1):EventFilterList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventObjID);break;}switch(nOldTab){case(0):break;case(1):EventFilterList.EnableUpdates(false);break;}}function OnEventLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("EventsDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}var nTotalEvents=parseInt(EventsList.getRowCount()+1);var sEventText="";if(g_bIsODBC){EventDialogTabs.setSelectedItems([0]);document.getElementById("AddGroupsEmailBCCButton").style.display="none";document.getElementById("AddGroupsEmailToButton").style.display="none";document.getElementById("EventDialogTabs-item-1").style.display="none";}else{document.getElementById("AddGroupsEmailBCCButton").style.display="";document.getElementById("AddGroupsEmailToButton").style.display="";document.getElementById("EventDialogTabs-item-1").style.display="";}EventsList.EnableUpdates(false);if(document.getElementById(EventNameInput.getContent("box/text").getId()).value==""){if(nTotalEvents<10){sEventText="$EVENT$ 0"+nTotalEvents;}else{sEventText="$EVENT$ "+nTotalEvents;}}else sEventText=document.getElementById(EventNameInput.getContent("box/text").getId()).value;EventNameInput.setControlText(sEventText);g_EventObjID=document.getElementById("ObjectID").value;if(EventDialogTabs.getSelectedItems()[0]==1)EventFilterList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventObjID);}function OnEventTypeLoad(sValue){EventIDComboBox.initValue(sValue);}function OnEventActionLoad(sValue){EventActionComboBox.initValue(sValue);OnEventActionChange(sValue);}function OnSetEventInputFocus(){EventNameInput.getContent("box/text").element().focus();}function OnYesSaveExec(){setTimeout(function(){SaveEvent();});}function OnNoSaveExec(){EventExecWaitMsec.setControlText("0");setTimeout(function(){SaveEvent();});}function IsUnderMaxCharsForColumn(sControlName,sTestStr,nMaxChars){var bIsUnderLimit=true;var sRCharLimitExceed="$WARN_MAX_CHAR_LIMIT$";if(sTestStr.length>nMaxChars){bIsUnderLimit=false;sRCharLimitExceed=sRCharLimitExceed.replace("$Limit",nMaxChars.toString());sRCharLimitExceed=sRCharLimitExceed.replace("$Field",sControlName);AlertDialog(sRCharLimitExceed,true);}return(bIsUnderLimit);}function PassesValidation(){var DB_COLUMN_LEN=255;var bPassed=true;var nCharBodyLimit=16384;if(g_bIsODBC){nCharBodyLimit=DB_COLUMN_LEN;}var nCharLimit=DB_COLUMN_LEN;var sText=EventNameInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventNameInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_NAME_LABEL$",sText,nCharLimit);if(bPassed){sText=document.getElementById("event_Description").value;bPassed=IsUnderMaxCharsForColumn("$DESCRIPTION$",sText,nCharBodyLimit);}if(bPassed){sText=Data1Input.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(Data1Input.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_SUBJECT_LABEL$",sText,nCharLimit);}if(bPassed){sText=document.getElementById("event_Data2").value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_BODY_LABEL$",sText,nCharBodyLimit);}if(bPassed){sText=EventEmailToInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventEmailToInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_TO_LABEL$",sText,nCharLimit);}if(bPassed){sText=EventEmailBCCInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventEmailBCCInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EMAIL_BCC_LABEL$",sText,nCharLimit);}if(bPassed){sText=EventExecPathInput.getControlText();if(sText===null||sText===undefined||sText==="")sText=document.getElementById(EventExecPathInput.getContent("box/text").getId()).value;bPassed=IsUnderMaxCharsForColumn("$EVENTS_EXEC_PATH_LABEL$",sText,nCharLimit);}return(bPassed);}function OnSaveEvent(){var nSelectedAction=EventActionComboBox.getItemValue(EventActionComboBox.getSelectedItems());if(EventNameInput.getControlText()!=""){if((nSelectedAction==2)&&parseInt(EventExecWaitMsec.getControlText())>0){ConfirmDialog("$CONFIRM_WAIT_DELAY_EXEC$",OnYesSaveExec,OnNoSaveExec);}else if((nSelectedAction==4)&&!g_bMSMQLicense){AlertDialog("$WARN_MSMQ_EVENT_NO_LICENSE$");}else if(PassesValidation()){if(g_bSysAdmin)SaveEvent();else if((nSelectedAction==1)||(nSelectedAction==2)||(nSelectedAction==4)||(nSelectedAction==3))AlertDialog("$WARN_DOMAIN_ADMIN_EVENTS$",true);else SaveEvent();}}else AlertDialog("$PLEASE_ENTER_EVENT_NAME$",true,OnSetEventInputFocus);return(false);}function SaveEvent(){g_bEventSavingObj=true;EventsList.OnSaveObject();}function OnHideEventsDialog(){document.getElementById("event_Description").scrollTop="0";document.getElementById("event_Data2").scrollTop="0";EventFilterList.EnableUpdates(false);ClearGrid(EventFilterList,true);EventsList.EnableUpdates(true);if(!g_bEventSavingObj){var objRequest=undefined;objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%CGroup."+g_EditObjectID+".SUEvent");if(objRequest){objRequest.setParameter("IDs",g_EditObjectID);objRequest.request(null);}}}function OnCancelEvent(){HideDialog('EventsDialog');}function OnEventHelp(){if(g_bDomainNav)sExpandNode="Item10_4";else sExpandNode="Item7_3";LaunchHelp("Help-Events.htm",sExpandNode);}function OnEventActionChange(sValue){var sEventActionGroupHeight="135px",sEvent_Data2Height="75px";switch(parseInt(sValue)){case 0:document.getElementById("data1-text").innerHTML="$EVENTS_EMAIL_SUBJECT_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_EMAIL_BODY_LABEL$";document.getElementById("email-event").style.display="block";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="265px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 1:document.getElementById("data1-text").innerHTML="$EVENTS_BALLOON_TITLE_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_BALLOON_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 2:document.getElementById("data1-text").innerHTML="$EVENTS_COMMAND_LINE_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="none";document.getElementById("exec-event").style.display="block";document.getElementById("exec-event-wait").style.display="block";sEventActionGroupHeight="170px";document.getElementById("EventActionGroupFS").style.height=sEventActionGroupHeight;document.getElementById("EventActionGroupFS").style.width="400px";break;case 4:document.getElementById("data1-text").innerHTML="$EVENTS_MSMQ_WRITE_TITLE_LABEL$";document.getElementById("data2-text").innerHTML="$EVENTS_MSMQ_WRITE_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="block";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";break;case 3:document.getElementById("data2-text").innerHTML="$SUEVENT_ACTION_WRITE_EVENT_LOG_INFO_LABEL$";document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="none";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="190px";document.getElementById("EventActionGroupFS").style.width="400px";sEvent_Data2Height="109px";break;default:document.getElementById("email-event").style.display="none";document.getElementById("data1-event").style.display="none";document.getElementById("data2-event").style.display="block";document.getElementById("exec-event").style.display="none";document.getElementById("exec-event-wait").style.display="none";document.getElementById("EventActionGroupFS").style.height="155px";break;}document.getElementById("event_Data2").style.height=sEvent_Data2Height;}CreateGroupBox("$EVENT_INFO_GROUP$","EventInfoGroup","400px","215px",true);CreateGroupBox("$EVENT_ACTION_GROUP$","EventActionGroup","400px","135px",true);var g_aServerEventIDs=[1,2,3];var g_aDomainServerEventIDs=[100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121];var g_aEventIDs=[200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,300,301,302,303,304,305,306,400,401,402,403,406,407,404,405,500,501,502,503,600,601];var g_aServerEventText=["$SUEVENT_ID_SERVER_START_TEXT$","$SUEVENT_ID_SERVER_STOP_TEXT$","$SUEVENT_ID_SECURITY_ALERT_TEXT$"];var g_aDomainServerEventText=["$SUEVENT_ID_DOMAIN_START_TEXT$","$SUEVENT_ID_DOMAIN_STOP_TEXT$","$SUEVENT_ID_SESSION_CONNECT_TEXT$","$SUEVENT_ID_SESSION_DISCONNECT_TEXT$","$SUEVENT_ID_SESSION_CONNECT_FAILURE_TEXT$","$SUEVENT_ID_LOG_DELETED_TEXT$","$SUEVENT_ID_LOG_ROTATED_TEXT$","$SUEVENT_ID_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_LISTENER_STOP_TEXT$","$SUEVENT_ID_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_STOP_TEXT$","$SUEVENT_ID_GATEWAY_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_STOP_TEXT$","$SUEVENT_ID_PERM_DATA_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_SUCCESS_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_STOP_TEXT$","$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_FAILURE_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_SUCCESS_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_ERROR_TEXT$","$SUEVENT_ID_FILE_MGMT_RULE_MOVE_FILE_TEXT$"];var g_aEventIDText=["$SUEVENT_ID_USER_LOGIN_TEXT$","$SUEVENT_ID_USER_LOGOUT_TEXT$","$SUEVENT_ID_USER_LOGIN_FAILURE_TEXT$","$SUEVENT_ID_USER_PASSWORD_CHANGE_TEXT$","$SUEVENT_ID_USER_PASSWORD_CHANGE_FAILURE_TEXT$","$SUEVENT_ID_USER_ENABLED_TEXT$","$SUEVENT_ID_USER_DISABLED_TEXT$","$SUEVENT_ID_USER_DELETED_TEXT$","$SUEVENT_ID_USER_ADDED_TEXT$","$SUEVENT_ID_USER_PASSWORD_RECOVERY_SENT_TEXT$","$SUEVENT_ID_USER_PASSWORD_RECOVERY_FAILED_TEXT$","$SUEVENT_ID_USER_PASSWORD_STALE_TEXT$","$SUEVENT_ID_USER_AUTOMATICALLY_DISABLED_TEXT$","$SUEVENT_ID_USER_AUTOMATICALLY_DELETED_TEXT$","$SUEVENT_ID_USER_PREDISABLE_TEXT$","$SUEVENT_ID_USER_PREDELETE_TEXT$","$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_TEXT$","$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_FAILURE_TEXT$","$SUEVENT_ID_IP_BLOCKED_TEXT$","$SUEVENT_ID_IP_BLOCKED_TIME_TEXT$","$SUEVENT_ID_TOO_MANY_SESSIONS_TEXT$","$SUEVENT_ID_TOO_MANY_SESSIONS_ON_IP_TEXT$","$SUEVENT_ID_IP_ADDR_AUTO_BLOCKED_TIME_TEXT$","$SUEVENT_ID_SESSION_IDLE_TIMEOUT_TEXT$","$SUEVENT_ID_SESSION_TIMEOUT_TEXT$","$SUEVENT_ID_FILE_UPLOAD_TEXT$","$SUEVENT_ID_FILE_UPLOAD_FAIL_TEXT$","$SUEVENT_ID_FILE_DOWNLOAD_TEXT$","$SUEVENT_ID_FILE_DOWNLOAD_FAIL_TEXT$","$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_TEXT$","$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_FAIL_TEXT$","$SUEVENT_ID_FILE_DELETE_TEXT$","$SUEVENT_ID_FILE_MOVE_TEXT$","$SUEVENT_ID_DIR_CREATE_TEXT$","$SUEVENT_ID_DIR_DELETE_TEXT$","$SUEVENT_ID_DIR_CHANGE_TEXT$","$SUEVENT_ID_DIR_MOVE_TEXT$","$SUEVENT_ID_QUOTA_OVERAGE_TEXT$","$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$"];var aEventActions=[0,1,2];var aEventActionText=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$","$SUEVENT_ACTION_EXEC_TEXT$"];if(g_bSupportWinEventLog){aEventActionText.push("$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$");aEventActions.push(3);}if(g_bSupportsMSMQ){aEventActionText.push("$SUEVENT_ACTION_MSMQ_WRITE_TEXT$");aEventActions.push(4);}var sEventObjectType="Group";var aJoinedEventIDs;var aJoinedEventText;switch(sEventObjectType.toLowerCase()){case"server":aJoinedEventIDs=g_aServerEventIDs.concat(g_aDomainServerEventIDs,g_aEventIDs);aJoinedEventText=g_aServerEventText.concat(g_aDomainServerEventText,g_aEventIDText);break;case"domain":aJoinedEventIDs=g_aDomainServerEventIDs.concat(g_aEventIDs);aJoinedEventText=g_aDomainServerEventText.concat(g_aEventIDText);break;default:aJoinedEventIDs=g_aEventIDs;aJoinedEventText=g_aEventIDText;break;}var EventIDComboBox=CreateComboBox(aJoinedEventText[0],aJoinedEventIDs[0],aJoinedEventText,aJoinedEventIDs,"EventID","EventID",undefined,"OnEventTypeLoad()",false,370,20,OnSaveEvent);EventIDComboBox.onCurrentItemChangedEvent=EventIDComboBox.onCurrentItemChangedDef;EventIDComboBox.onCurrentItemChanged=function(nNewIndex){var nNewValue;nNewValue=this.getItemValue(nNewIndex);document.getElementById(this.getContent("hidden").getId()).value=nNewValue;this.onCurrentItemChangedEvent(nNewIndex);};EventIDComboBox.initValue=function(value,defaultvalue){if(value!=0){this.setControlText(GetEventIDText(value));this.setControlValue(value);}else 
this.onCurrentItemChanged(0);};function OnLoadEventDisabled(sValue){EventEnabledCheck.setChecked(sValue=="1");}var EventActionComboBox=CreateComboBox(aEventActionText[0],aEventActions[0],aEventActionText,aEventActions,"Action","Action",OnEventActionChange,"OnEventActionLoad()",false,370,20,OnSaveEvent);var EventNameInput=CreateInputField("","EventNameInput","EventName",undefined,370,undefined,undefined,OnSaveEvent);var EventEmailToInput=CreateInputField("","EmailToAddressInput","EmailToAddress",undefined,337,undefined,undefined,OnSaveEvent);document.getElementById("EmailToAddress").title="$EVENTS_EMAIL_TO_NOTE$";var EventEmailBCCInput=CreateInputField("","EmailToAddressBCCInput","EmailToAddressBCC",undefined,337,undefined,undefined,OnSaveEvent);document.getElementById("EmailToAddressBCC").title="$EVENTS_EMAIL_TO_NOTE$";var AddGroupsEmailToButton=CreatePushButton("","AddGroupsEmailToButton",OnCreateGroupEmailDialog,undefined,undefined,["To"],"GroupEmail");document.getElementById("AddGroupsEmailToButton").firstChild.title="$GROUP_EMAIL_TO_NOTE$";var AddGroupsEmailBCCButton=CreatePushButton("","AddGroupsEmailBCCButton",OnCreateGroupEmailDialog,undefined,undefined,["BCC"],"GroupEmail");document.getElementById("AddGroupsEmailBCCButton").firstChild.title="$GROUP_EMAIL_BCC_NOTE$";var Data1Input=CreateInputField("","Data1Input","Data1",undefined,370,undefined,undefined,OnSaveEvent);var EventExecPathInput=CreateInputField("","ExeFilePathInput","ExeFilePath",undefined,338,undefined,undefined,OnSaveEvent);var EventEnabledCheck=CreateCheckBox("$ENABLE_EVENT$","EventDisabled","Enabled",false,undefined,true,"OnLoadEventDisabled()",false);var EventExecWaitMsec=CreateInputField("","ExecWaitSecs","ExecWaitSecs",undefined,50,undefined,undefined,OnSaveEvent);CreateDialogPushButton("$SAVE_BUTTON$","SaveEventButton",OnSaveEvent);CreateDialogPushButton("$CANCEL_BUTTON$","CancelEventButton",OnCancelEvent);var ExecPathBrowse=CreatePushButton("","BrowseButtonExecPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[EventExecPathInput,true,"0","0"]]);ExecPathBrowse.setControlImage("Browse");CreateDialogPushButton("$HELP_BUTTON$","HelpEventButton",OnEventHelp);function OnCreateGroupEmailDialog(aEmailType){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/GroupEmailDialogs.htm?ID=%ID%","GroupEmailDialogs",String("OnShowGroupEmailDialog("),aEmailType]);}CreatePushButton("$ADD_BUTTON$...","AddEventFilterButton",OnDelayLoadAddFilterDialog);CreatePushButton("$EDIT_BUTTON$...","EditEventFilterButton",OnDelayLoadEditFilterDialog);CreatePushButton("$DELETE_BUTTON$","DeleteEventFilterButton",OnRemoveEventFilter);function OnDelayLoadAddFilterDialog(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/EventRulesDialog.htm?ID=%ID%","FilterDialogDiv",OnAddEventFilter]);}function OnDelayLoadEditFilterDialog(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/EventRulesDialog.htm?ID=%ID%","FilterDialogDiv",OnEditEventFilter]);}function OnAddEventFilter(){EventFilterList.OnAddObject("EventFilter.xml%ADD_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule&Temp=1","Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule.",document.EventsFilterForm,"EventRulesDialog",[OnLoadFilterComp,OnHideFilterComp],g_bReadOnlyAccess,undefined,true);}function OnEditEventFilter(){EventFilterList.OnEditObject("EventFilter.xml","Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule.",document.EventsFilterForm,"EventRulesDialog","$SELECT_ONLY_ONE_EVENT_FILTER_EDIT$","$SELECT_ONLY_ONE_EVENT_FILTER_EDIT$",[OnLoadFilterComp,OnHideFilterComp],undefined,undefined,undefined,undefined,true);}function OnRemoveEventFilter(){EventFilterList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule&ID=%ID%","$ASK_DELETE_EVENT_FILTER$","$SELECT_ONE_EVENT_FILTER_DELETE$");}function OnLoadFilterComp(){var nLogicDefault;EventFilterList.EnableUpdates(false);g_EventRuleObjID=document.getElementById("RuleObjectID").value;EventFilterCompList.EnableUpdates(true,"%OBJECT_EDIT_ID%",g_EventRuleObjID);nLogicDefault=(isNaN(parseInt(EventFilterList.getCellValue(2,EventFilterList.getSelectedRows())))?0:(parseInt(EventFilterList.getCellValue(2,EventFilterList.getSelectedRows()))));EventRuleLogic.initValue(nLogicDefault);}function OnHideFilterComp(){EventFilterCompList.EnableUpdates(false);ClearGrid(EventFilterCompList,true);EventFilterList.EnableUpdates(true);}function OnEnableDisableFilter(bEnable){var EditCells=new Array();EditCells=EventFilterList.getSelectedRows().toString().split(",");var EventEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(EventFilterList.getCellData((EventFilterList.m_nNumColumns-1),EditCells[nIndex]));EventEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CSUEvent."+g_EventObjID+".VarRule."+nObjectID+"&StaticOnly=1");EventEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;EventEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;EventEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);EventEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};EventEnabledDisabledRequest[nIndex].request(null);}}function OnEnableFilterContextMenu(){if(FilterEnableOrDisable()[1]&&EventFilterList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_FILTER$";else sMenuItemName="";return(sMenuItemName);}function OnDisableFilterContextMenu(){if(FilterEnableOrDisable()[0]&&EventFilterList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_FILTER$";else sMenuItemName="";return(sMenuItemName);}function OnEnableFilterContextImage(){if(FilterEnableOrDisable()[1])sImageClass="FilterEnabled";else sImageClass="";return(sImageClass);}function OnDisableFilterContextImage(){if(FilterEnableOrDisable()[0])sImageClass="FilterDisabled";else sImageClass="";return(sImageClass);}function FilterEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=EventFilterList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(EventFilterList.getCellText(3,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}</script><div id="CommonEventsDialoginner" style="display:none;"><div style="display:inline;"><img alt="$COMMON_EVENTS$" src="%ADMIN_FILE%Images/Command32.png" width="32" height="32" class="header-icon" />$COMMON_EVENT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="CommonEventsForm" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="CommonEventGroup"><div id="CommonEventsRadioDiv" style="padding:0 0 5px 5px;"><span id="CommonEventActionRadio"></span></div><div style="padding:0 0 5px 5px;display:none;"id="CommonEventsEmailDiv">$SUEVENT_ACTION_EMAIL_TEXT$</div><div id="emailto-commonevent" style="display:none;padding:0 0 5px 5px;">$EVENTS_EMAIL_TO_LABEL$:<div style="overflow:auto" alt="$EVENTS_EMAIL_TO_NOTE$" title="$EVENTS_EMAIL_TO_NOTE$"><span id="CommonEventEmailToInput"></span></div></div><div id="MSMQPath-commonevent" style="display:none;padding:0 0 5px 5px;">$EVENTS_MSMQ_WRITE_TITLE_LABEL$:<div style="overflow:auto" ><span id="CommonEventMSMQPathInput"></span></div></div></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveCommonEventButton"></span><br /><span id="CancelCommonEventButton"></span><br /><br /><span id="HelpCommonEventButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$COMMON_EVENTS$","CommonEventsDialog","390","290","","$CLOSE_CANCEL$","cmd-16.png");function OnCreateCommonEvents(){ShowDialog("CommonEventsDialog");}function OnCancelCommonEvent(){HideDialog('CommonEventsDialog');}function OnCommonEventChange(nCommonEvent){if(parseInt(nCommonEvent)==0){document.getElementById("MSMQPath-commonevent").style.display="none";document.getElementById("emailto-commonevent").style.display="block";document.getElementById("CommonEventGroupFS").style.height="120px";}else if(parseInt(nCommonEvent)==3){if(!g_bMSMQLicense){AlertDialog("$WARN_MSMQ_EVENT_NO_LICENSE$");setTimeout(function(){CommonEventActionRadio.setSelectedItems([0]);},0);}else{document.getElementById("emailto-commonevent").style.display="none";document.getElementById("MSMQPath-commonevent").style.display="block";document.getElementById("CommonEventGroupFS").style.height="120px";}}else{document.getElementById("MSMQPath-commonevent").style.display="none";document.getElementById("emailto-commonevent").style.display="none";document.getElementById("CommonEventGroupFS").style.height="80px";}}function OnSaveCommonEvent(){var nActionValue=parseInt(document.getElementById(CommonEventActionRadio.getContent("hidden").getId()).value);var sActionEmailTo=CommonEventEmailToInput.getControlText();var sActionMSMQPath=CommonEventMSMQPathInput.getControlText();if(nActionValue==0)sCmd="CreateCommonEmailEvents&EmailAddress="+sActionEmailTo;else if(nActionValue==2)sCmd="CreateCommonWriteEventLogEvents";else if(nActionValue==3)sCmd="CreateCommonMSMQWriteEvents&MSMQPath="+sActionMSMQPath;else sCmd="CreateCommonBalloonTipEvents";var sCommonEventsCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CGroup."+g_EditObjectID+"."+sCmd;var CommonEventsRequest=CreatePostRequest(sCommonEventsCmd);CommonEventsRequest.setAsync(true);CommonEventsRequest.request();CommonEventsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else HideDialog("CommonEventsDialog");};}CreateGroupBox("$COMMON_EVENT_ACTION_GROUP$","CommonEventGroup","280px","125px",true);var asCommonEventRadioText=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$"];var anCommonEventRadioVals=[0,1];if(g_bSupportWinEventLog){asCommonEventRadioText.push("$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$");anCommonEventRadioVals.push(2);}if(g_bSupportsMSMQ){asCommonEventRadioText.push("$SUEVENT_ACTION_MSMQ_WRITE_TEXT$");anCommonEventRadioVals.push(3);}var CommonEventActionRadio=CreateRadioButtons(0,asCommonEventRadioText,"CommonEventActionRadio","CommonEventActionRadio","265px",OnCommonEventChange,anCommonEventRadioVals);if(g_bSafariBrowser)document.getElementById("CommonEventActionRadio-box").style.height="45px";var CommonEventEmailToInput=CreateInputField("","CommonEventEmailToInput","CommonEventEmailTo",undefined,250,undefined,undefined,OnSaveCommonEvent);var CommonEventMSMQPathInput=CreateInputField("","CommonEventMSMQPathInput","CommonEventMSMQPath",undefined,250,undefined,undefined,OnSaveCommonEvent);CreateDialogPushButton("$OK_BUTTON$","SaveCommonEventButton",OnSaveCommonEvent);CreateDialogPushButton("$CANCEL_BUTTON$","CancelCommonEventButton",OnCancelCommonEvent);CreateDialogPushButton("$HELP_BUTTON$","HelpCommonEventButton",OnEventHelp);</script><div id="RatioQuotaDialoginner" style="display:none;"><form method="post" name="RatioQuotaForm"><table border="0" class="DialogTable"><tr><td style="width:320px;"><div id="RatioGroup"><span id="EnableRatio"></span><br /><span id="RatioType"></span><br /><div style="float:left;width:60px;">$RATIO_UPLOADS$:<div style="overflow:auto"><span id="RatioUploads"></span></div></div><div style="float:left;width:35px;padding:15px 10px 0 10px;">/</div><div style="float:left;width:60px;">$RATIO_DOWNLOADS$:<div style="overflow:auto"><span id="RatioDownloads"></span></div></div><div style="clear:both;"><div>$RATIO_CREDIT$:</div><div style="clear:left;overflow:auto;line-height:16px;float:left;width:auto;"><span id="RatioCredit"></span>&nbsp;</div><div style="float:left;width:auto;line-height:18px;"><span id="RatioCreditLabel"></span></div></div></div><br /><div id="QuotaGroup"><div style="float:left;width:130px;"><div>$QUOTA_MAXIMUM$:</div><div style="clear:left;overflow:auto;line-height:16px;float:left;width:auto;"><span id="QuotaMaximum"></span>&nbsp;</div><div style="float:left;width:auto;line-height:18px;">$MAX_SIZE_LABEL$</div></div><div style="float:left;width:130px;" id="QuotaCurrentDiv"><div>$QUOTA_CURRENT$:</div><div style="clear:left;overflow:auto;line-height:16px;float:left;width:auto;"><span id="QuotaCurrent"></span>&nbsp;</div><div style="float:left;width:auto;line-height:18px;">$MAX_SIZE_LABEL$</div></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="3"><span id="SaveRatioQuotaButton"></span><span id="CancelRatioQuotaButton"></span><br /><br /><span id="HelpRatioQuotaButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var g_sRatioType="";var g_nRatioID=0,g_nCurrentRatio=-1;BuildDialog("$RATIO_QUOTA_DIALOG_TITLE$","RatioQuotaDialog","450","295","","$CLOSE_CANCEL$");CreateGroupBox("$RATIO_GROUP$","RatioGroup","300px","150px");var RatioEnableCheck=CreateCheckBox("$RATIO_ENABLE$","EnableRatio","EnableRatio",false,OnEnableDisableRatio);var RatioTypeCombo=CreateComboBox("","",["$RATIO_FPS$","$RATIO_BPS$","$RATIO_FAS$","$RATIO_BAS$"],["0","1","2","3"],"RatioType","RatioType",OnChangeRatioType,"",false,225);var RatioUploadInput=CreateInputField("","RatioUploads","RatioUploads",undefined,50,undefined,true);var RatioDownloadInput=CreateInputField("","RatioDownloads","RatioDownloads",undefined,50,undefined,true);var RatioCreditInput=CreateInputField("","RatioCredit","RatioCredit",undefined,100,undefined,true);CreateGroupBox("$QUOTA_GROUP$","QuotaGroup","300px","75px");var QuotaMaxInput=CreateInputField("","QuotaMaximum","QuotaMaximum",undefined,75,undefined,true);var QuotaCurrentInput=CreateInputField("","QuotaCurrent","QuotaCurrent",undefined,75,undefined,true);CreateDialogPushButton("$SAVE_BUTTON$","SaveRatioQuotaButton",OnSaveRatioQuota);CreateDialogPushButton("$CANCEL_BUTTON$","CancelRatioQuotaButton",OnCancelRatioQuota);CreateDialogPushButton("$HELP_BUTTON$","HelpRatioQuotaButton",OnRatioQuotaHelp);RatioTypeCombo.initValue("0");if("Group"=="Group")document.getElementById("QuotaCurrentDiv").style.display="none";function OnShowRatioQuota(){var RatioQuotaInfoRequest=createAWHttpRequest("GET",(g_sAdminXMLPath+"RatioSettings.xml?ID="+GetEditObjectID()),function(){var xmlDoc=this.getResponseXML();if(xmlDoc){g_nRatioID=GetXMLValue(xmlDoc,"ID");if(g_nRatioID){RatioTypeCombo.initValue(g_nCurrentRatio=GetXMLValueInt(xmlDoc,"ControlVal"));LoadRatio([GetXMLValue(xmlDoc,"UploadValue"),GetXMLValue(xmlDoc,"DownloadValue"),GetXMLValue(xmlDoc,"Credit")]);g_sRatioType=GetXMLValue(xmlDoc,"Name");}else{g_sRatioType="";g_nRatioID=0;g_nCurrentRatio=-1;LoadRatio(["1","1","0"]);}RatioEnableCheck.setControlValue((g_nRatioID)?true:false);OnEnableDisableRatio();QuotaMaxInput.setControlText(String(parseInt(document.UserForm.Quota.value)/1048576));QuotaCurrentInput.setControlText(String(parseInt(document.UserForm.QuotaBytes.value)/1048576));ReplaceDialog(g_sBusyDialog,"RatioQuotaDialog");}});LoadingDialog(true);if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(false);if(awSecondaryActiveGrid!=undefined)awSecondaryActiveGrid.EnableUpdates(false);RatioQuotaInfoRequest.request();}function LoadRatio(asVals){RatioUploadInput.setControlText(asVals[0]);RatioDownloadInput.setControlText(asVals[1]);if(g_nCurrentRatio % 2)RatioCreditInput.setControlText(String(parseInt(asVals[2])/1048576));OnChangeRatioType(g_nCurrentRatio);}function OnEnableDisableRatio(){var bDisabled=(!RatioEnableCheck.getControlValue());RatioTypeCombo.SetDisabled(bDisabled);RatioUploadInput.setControlDisabled(bDisabled);RatioDownloadInput.setControlDisabled(bDisabled);RatioCreditInput.setControlDisabled(bDisabled);}function OnChangeRatioType(sValue){var nValue=parseInt(sValue);if((isNaN(nValue))||(nValue<0)||(nValue>3)){RatioTypeCombo.initValue("0");nValue=0;}if(nValue % 2)document.getElementById("RatioCreditLabel").innerHTML="$MAX_SIZE_LABEL$";else document.getElementById("RatioCreditLabel").innerHTML="$ACTIVITY_FILES$";}function OnSaveRatioQuota(){if(g_nRatioID)DeleteRatio();else if(RatioEnableCheck.getControlValue())AddRatio(true);else SaveQuotaValues();}function DeleteRatio(){var objDeleteReq=undefined;if(objDeleteReq=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%DELETE_OBJECT_REF%CUser."+GetEditObjectID()+"."+g_sRatioType,OnDeleteRatioDone)){BusyDialog(true);objDeleteReq.setParameter("IDs",g_nRatioID);objDeleteReq.request();}}function OnDeleteRatioDone(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult==0){if(RatioEnableCheck.getControlValue())AddRatio();else{BusyDialog(false);SaveQuotaValues();}}else{BusyDialog(false);AlertDialog(GetResultText(0,"",sResultText));}}function AddRatio(bShowBusy){var objCreateReq=undefined;var nUpload=parseInt(RatioUploadInput.getControlText()),nDownload=parseInt(RatioDownloadInput.getControlText()),nCredit=RatioCreditInput.getControlText();var sRatioType="";var bScale=false;var bValidParams=false;switch(parseInt(RatioTypeCombo.getSelectedItems())){case(0):sRatioType="SessionFilesUlDlRatio";break;case(1):sRatioType="SessionBytesUlDlRatio";bScale=true;break;case(2):sRatioType="UserFilesUlDlRatio";break;case(3):sRatioType="UserBytesUlDlRatio";bScale=true;break;}nCredit=(Trim(nCredit)=="")?0:parseInt(nCredit);if(isNaN(nCredit))AlertDialog("$SESS_NOT_A_NUMBER_STR$");else{if(bScale)if(isNaN(parseFloat(nCredit)))AlertDialog("$SESS_NOT_A_DOUBLE_STR$");else{nCreditParamVal=(nCredit*(1024.0*1024.0));bValidParams=true;}else{nCreditParamVal=nCredit;bValidParams=true;}}if(bValidParams){if(objCreateReq=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%ADD_OBJECT_REF%CUser."+GetEditObjectID()+"."+sRatioType,OnAddRatioDone)){objCreateReq.setParameter("UploadValue",nUpload);objCreateReq.setParameter("DownloadValue",nDownload);objCreateReq.setParameter("Credit",nCreditParamVal);if(bShowBusy)BusyDialog(true);objCreateReq.request(null);}}}function OnAddRatioDone(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");BusyDialog(false);if(nResult==0)SaveQuotaValues();else AlertDialog(GetResultText(0,"",sResultText));}function SaveQuotaValues(){var nMaxQuota=parseInt(QuotaMaxInput.getControlText()),nCurrentQuota=parseInt(QuotaCurrentInput.getControlText());document.UserForm.Quota.value=(isNaN(nMaxQuota)?0:(nMaxQuota*1048576));document.UserForm.QuotaBytes.value=(isNaN(nCurrentQuota)?0:(nCurrentQuota*1048576));OnCancelRatioQuota();}function OnCancelRatioQuota(){if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(true);if(awSecondaryActiveGrid!=undefined)awSecondaryActiveGrid.EnableUpdates(true);HideDialog('RatioQuotaDialog');}function OnRatioQuotaHelp(){LaunchHelp("Help-User-Quotas-Ratios.htm","RootItem6");}</script><div id="RatioFreeFileDialoginner" style="display:none;"><div id="RatioFreeFileContent" style="width:500px"><div class="layercontent"><div style="display:inline;"><img alt="$RATIO_FREE_FILE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Database32.png" width="32" height="32" class="header-icon" />$RATIO_FREE_FILE_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><span id="RatioFreeFileList"></span><table style="padding-top:5px;width:100%"><tr><td><span id="AddFreeFileButton"></span><span id="EditFreeFileButton"></span><span id="RemoveFreeFileButton"></span></td><td style="text-align:right;"><span id="CloseFreeFileButton"></span><span id="HelpFreeFileButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$RATIO_FREE_FILE_DIALOG_TITLE$","RatioFreeFileDialog","520","442","","$CLOSE_CANCEL$");</script><div id="RatioFreeFileEditDialoginner" style="display:none;"><form name="RatioFreeFileForm" onsubmit="return (false);"><table border="0" class="DialogTable"><tr><td style="width:300px;vertical-align:top;">$FREE_FILE_PATH$:<div style="overflow:auto"><span id="Mask"></span> <span id="BrowseButtonFreeFileMask"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" ><span id="SaveRatioFreeFileButton"></span><br /><span id="CancelRatioFreeFileButton"></span><br /><br /><span id="RatioFreeFileHelpButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$RATIO_FREE_FILE_EDIT_DIALOG_TITLE$","RatioFreeFileEditDialog","410","140","","$CLOSE_CANCEL$");function OnEditRatioFreeFiles(){if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(false);RatioFreeFilesList.EnableUpdates(true,"%OBJECT_EDIT_ID%",GetEditObjectID());ShowDialog("RatioFreeFileDialog",undefined,function(){RatioFreeFilesList.EnableUpdates(false);if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(true);});}var RatioFreeFilesList=CreateAdminGrid("RatioFreeFileList",["$FREE_FILE_PATH$"],[475],"RatioFreeFiles.xml?ID=%OBJECT_EDIT_ID%","freefiles","freefile",2,OnEditRatioFreeFile);CreatePushButton("$ADD_BUTTON$...","AddFreeFileButton",OnAddRatioFreeFile);CreatePushButton("$EDIT_BUTTON$...","EditFreeFileButton",OnEditRatioFreeFile);CreatePushButton("$DELETE_BUTTON$","RemoveFreeFileButton",OnDeleteRatioFreeFile);CreatePushButton("$CLOSE_BUTTON$","CloseFreeFileButton",function(){HideDialog("RatioFreeFileDialog");});CreatePushButton("$HELP_BUTTON$","HelpFreeFileButton",OnRatioFreeFileHelp);function OnRatioFreeFileLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("RatioFreeFileEditDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);}}function OnAddRatioFreeFile(){RatioFreeFilesList.OnAddObject("RatioFreeFile.xml%DEFAULT_OBJECT_REF%CGroup."+GetEditObjectID()+".UlDlRatioFreeFile","Result.xml%ADD_OBJECT_REF%CGroup."+GetEditObjectID()+".UlDlRatioFreeFile",document.RatioFreeFileForm,"RatioFreeFileEditDialog",[OnRatioFreeFileLoad],g_bReadOnlyAccess);}function OnEditRatioFreeFile(){RatioFreeFilesList.OnEditObject("RatioFreeFile.xml","Result.xml%UPDATE_OBJECT_REF%CGroup."+GetEditObjectID()+".UlDlRatioFreeFile.",document.RatioFreeFileForm,"RatioFreeFileEditDialog","$SELECT_ONLY_ONE_RATIO_FREE_FILE_EDIT$","$SELECT_ONE_RATIO_FREE_FILE_EDIT$");}function OnDeleteRatioFreeFile(){RatioFreeFilesList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CGroup."+GetEditObjectID()+".UlDlRatioFreeFile&ID=%ID%","$ASK_DELETE_RATIO_FREE_FILE$","$SELECT_RATIO_FREE_FILE_DELETE$");}var FreeFileInput=CreateInputField("","Mask","Mask","",260,undefined,undefined,OnSaveRatioFreeFile);CreateDialogPushButton("$SAVE_BUTTON$","SaveRatioFreeFileButton",OnSaveRatioFreeFile);CreateDialogPushButton("$CANCEL_BUTTON$","CancelRatioFreeFileButton",OnCancelRatioFreeFile);CreateDialogPushButton("$HELP_BUTTON$","RatioFreeFileHelpButton",OnRatioFreeFileHelp);var FreeFileMaskBrowse=CreatePushButton("","BrowseButtonFreeFileMask",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[FreeFileInput,false,"0","0"]]);FreeFileMaskBrowse.setControlImage("Browse");function OnSaveRatioFreeFile(){if(FreeFileInput.getControlText()!="")RatioFreeFilesList.OnSaveObject();else AlertDialog("$FREE_FILE_MASK_EMPTY$");return(false);}function OnCancelRatioFreeFile(){HideDialog("RatioFreeFileEditDialog");}function OnRatioFreeFileHelp(){LaunchHelp("Help-User-Quotas-Ratios.htm",g_sHelpNode);}</script><div id="ManageSSHDialoginner" style="display:none;"><div id="RatioFreeFileContent" style="width:500px"><div class="layercontent"><div style="display:inline;"><img alt="$MANAGE_SSH_KEYS$" src="%ADMIN_FILE%Images/Certificate32.png" width="32" height="32" class="header-icon" />$MANAGE_SSH_KEYS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><span id="ManageSSHKeysList"></span><table style="padding-top:5px;width:100%"><tr><td><span id="AddSSHKeysButton"></span><span id="EditSSHKeysButton"></span><span id="RemoveSSHKeysButton"></span></td><td style="text-align:right;"><span id="CreateSSHKeyPairs"></span> <span id="CloseSSHKeysButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$MANAGE_SSH_KEYS$","ManageSSHDialog","520","442","","$CLOSE_CANCEL$");</script><div id="ManageSSHKeysEditDialoginner" style="display:none;"><form name="SSHKeysForm" onsubmit="return (false);"><table border="0" class="DialogTable"><tr><td style="width:300px;vertical-align:top;">$SSH_KEYS_NAME$:<div style="overflow:auto"><span id="SSHPublicKeyNameInput"></span></div>$SSH_KEYS_PATH$:<div style="overflow:auto"><span id="SSHPublicKeyFilePathInput"></span> <span id="BrowseButtonSSHKeyPath"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" ><span id="SaveSSHKeysButton"></span><br /><span id="CancelSSHKeysButton"></span><br /><br /><span id="SSHKeysHelpButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$MANAGE_SSH_KEYS$","ManageSSHKeysEditDialog","400","140","","$CLOSE_CANCEL$");function OnManageSSHKeys(){if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(false);SSHKeysList.EnableUpdates(true,"%OBJECT_EDIT_ID%",GetEditObjectID());ShowDialog("ManageSSHDialog",undefined,function(){SSHKeysList.EnableUpdates(false);if(awActiveGrid!=undefined)awActiveGrid.EnableUpdates(true);});}var SSHKeysList=CreateAdminGrid("ManageSSHKeysList",["$NAME$","$PATH$"],[100,375],"SSHKeys.xml?ID=%OBJECT_EDIT_ID%","SSHKeys","SSHKey",3,OnEditSSHKey);CreatePushButton("$ADD_KEY$...","AddSSHKeysButton",OnAddSSHKey);CreatePushButton("$EDIT_BUTTON$...","EditSSHKeysButton",OnEditSSHKey);CreatePushButton("$DELETE_BUTTON$","RemoveSSHKeysButton",OnDeleteSSHKey);CreatePushButton("$CLOSE_BUTTON$","CloseSSHKeysButton",function(){HideDialog("ManageSSHDialog");});CreatePushButton("$CREATE_SSH_KEY_PAIR$...","CreateSSHKeyPairs",OnAlertCreateKeyPair);function OnAddSSHKey(sPath,sName){SSHKeysList.OnAddObject("SSHKey.xml%DEFAULT_OBJECT_REF%CGroup."+GetEditObjectID()+".SSHPublicKeyFile","Result.xml%ADD_OBJECT_REF%CGroup."+GetEditObjectID()+".SSHPublicKeyFile",document.SSHKeysForm,"ManageSSHKeysEditDialog",[function(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("ManageSSHKeysEditDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}PopulateSSHPath(sPath,sName);}],g_bReadOnlyAccess);}function PopulateSSHPath(sPath,sName){if(sPath!=undefined)SSHKeyInput.setControlText(sPath);if(sName!=undefined)SSHKeyNameInput.setControlText(sName);SSHKeyNameInput.getContent("box/text").element().focus();}function OnEditSSHKey(){SSHKeysList.OnEditObject("SSHKey.xml","Result.xml%UPDATE_OBJECT_REF%CGroup."+GetEditObjectID()+".SSHPublicKeyFile.",document.SSHKeysForm,"ManageSSHKeysEditDialog","$SELECT_ONLY_ONE_SSH_KEY_EDIT$","$SELECT_ONE_SSH_KEY_EDIT$");}function OnDeleteSSHKey(){SSHKeysList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CGroup."+GetEditObjectID()+".SSHPublicKeyFile&ID=%ID%","$ASK_DELETE_SSH_KEY$","$SELECT_SSH_KEY_DELETE$");}var SSHKeyInput=CreateInputField("","SSHPublicKeyFilePathInput","SSHPublicKeyFilePath","",260,undefined,undefined,OnSaveSSHKey);var SSHKeyNameInput=CreateInputField("","SSHPublicKeyNameInput","SSHPublicKeyName","",260,undefined,undefined,OnSaveSSHKey);CreateDialogPushButton("$SAVE_BUTTON$","SaveSSHKeysButton",OnSaveSSHKey);CreateDialogPushButton("$CANCEL_BUTTON$","CancelSSHKeysButton",OnCancelSSHKey);CreateDialogPushButton("$HELP_BUTTON$","SSHKeysHelpButton",OnSSHKeyHelp);var SSHKeyBrowse=CreatePushButton("","BrowseButtonSSHKeyPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[SSHKeyInput,false,"0","0"]]);SSHKeyBrowse.setControlImage("Browse");function OnSaveSSHKey(){if(document.getElementById(SSHKeyInput.getContent("box/text").getId()).value!="")SSHKeysList.OnSaveObject();else AlertDialog("$SSH_KEY_PATH_EMPTY$");return(false);}function OnCancelSSHKey(){HideDialog("ManageSSHKeysEditDialog");}function OnAlertCreateKeyPair(){if(readCookie("balertkeypaircreate")=="1")OnCreateSSHKeyPair();else AlertDialog("$ALERT_SSH_KEY_PAIR_CREATE$",true,OnCreateSSHKeyPair,false,undefined,undefined,450,193,true,"balertkeypaircreate");}function OnCreateSSHKeyPair(){LoadDynamicContentAndRun(["%ADMIN_FILE%Include/NewSSHKeyPairDialog.htm?ID=%ID%","NewSSHKeyPairDialogDiv",String("OnShowNewSSHKeyPairDialog(")]);}function OnSSHKeyHelp(){if("$PAGE_OBJECT_TYPE$"=="User"){sExpandNode="RootItem6";sHelpFile="Help-SSH-Key-Pair.htm";}else{sExpandNode="RootItem5";sHelpFile="Help-SSH-Key-Pair.htm";}LaunchHelp(sHelpFile,sExpandNode);}</script><div id="LoginLimitDialoginner" style="display:none;"><form name="LoginLimitForm" onsubmit="return (false);"><div style="display:inline;"><img alt="$LIMIT_LABEL$" src="%COMMON_FILE%Images/LimitLogin32.png" width="32" height="32" class="header-icon" style="padding-left:5px;"/>$LOGIN_LIMIT_EDIT_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="float:left;width:420px;padding-left:5px;overflow:hidden;text-overflow:ellipsis;"><div id="LoginLimitAdvancedGroup"><span id="LoginLimitToTimeOfDay"></span><br /><div style="float:left;width:125px;">$LIMIT_START_TIME$:<br /><span id="LoginLimitStartTime"></span><input type="hidden" id="StartTime" /></div><div style="float:left;width:125;">$LIMIT_END_TIME$:<br /><span id="LoginLimitEndTime"></span><input type="hidden" id="EndTime" /></div></div><div id="LoginLimitTODGroup"><div style="float:left;width:100px;"><span id="LoginMonday"></span><br /><span id="LoginTuesday"></span><br /><span id="LoginWednesday"></span></div><div style="float:left;width:100px;"><span id="LoginThursday"></span><br /><span id="LoginFriday"></span></div><div style="float:left;width:100px;">
<span id="LoginSaturday"></span><br /><span id="LoginSunday"></span></div></div></div><div style="float:left;width:80px;"><span id="SaveLoginLimitButton"></span><span id="CancelLoginLimitButton"></span><br /><br /><span id="HelpLoginLimitButton"></span></div><div style="clear:both;"></div></form></div><script type="text/javascript" language="javascript">var g_aLoginDaysChecks=[];var g_bLoginInitTimes=false;var g_asLoginTimes=[];var LoginStartTimeCombo=undefined;var LoginEndTimeCombo=undefined;var g_bInitLoginTimes=false;var g_bUseXMLValues=true;BuildDialog("$LOGIN_LIMIT_DIALOG_TITLE$","LoginLimitDialog","520","285","","$CLOSE_CANCEL$","LoginLimit16.png");CreateGroupBox("$LIMIT_TIME_OF_DAY$","LoginLimitAdvancedGroup",325,95);var LoginLimitApplyTODCheck=CreateCheckBox("$LIMIT_APPLY_TOD$","LoginLimitToTimeOfDay","LoginLimitToTimeOfDay",false,OnChangeApplyLoginLimitTOD);CreateGroupBox("$LIMIT_DAYS_OF_WEEK$","LoginLimitTODGroup",325,95);g_aLoginDaysChecks.push(CreateCheckBox("$DAY_MONDAY$","LoginMonday","Login_Monday",true,undefined,true));g_aLoginDaysChecks.push(CreateCheckBox("$DAY_TUESDAY$","LoginTuesday","Login_Tuesday",true,undefined,true));g_aLoginDaysChecks.push(CreateCheckBox("$DAY_WEDNESDAY$","LoginWednesday","Login_Wednesday",true,undefined,true));g_aLoginDaysChecks.push(CreateCheckBox("$DAY_THURSDAY$","LoginThursday","Login_Thursday",true,undefined,true));g_aLoginDaysChecks.push(CreateCheckBox("$DAY_FRIDAY$","LoginFriday","Login_Friday",true,undefined,true));g_aLoginDaysChecks.push(CreateCheckBox("$DAY_SATURDAY$","LoginSaturday","Login_Saturday",true,undefined,true));g_aLoginDaysChecks.push(CreateCheckBox("$DAY_SUNDAY$","LoginSunday","Login_Sunday",true,undefined,true));var SaveLoginLimitButton=CreateDialogPushButton("$SAVE_BUTTON$","SaveLoginLimitButton",OnSaveLoginLimit);CreateDialogPushButton("$CANCEL_BUTTON$","CancelLoginLimitButton",OnCancelLoginLimit);CreateDialogPushButton("$HELP_BUTTON$","HelpLoginLimitButton",OnLoginLimitHelp);function OnShowLoginLimit(){if(g_bUseXMLValues){var LoginLimitRequest=createAWHttpRequest("GET",(g_sAdminXMLPath+g_sFormType+"LoginLimitSettings.xml?ID="+GetEditObjectID()),function(){var xmlDoc=this.getResponseXML();if(xmlDoc){bTODLimit=GetXMLValue(xmlDoc,"todLimit");bTODStart=GetXMLValue(xmlDoc,"todStart");bTODEnd=GetXMLValue(xmlDoc,"todEnd");bTODDays=GetXMLValue(xmlDoc,"todDays");OnLoginLimitLoad();LoadLoginLimitTODValues([bTODLimit,bTODStart,bTODEnd,bTODDays]);ReplaceDialog(g_sBusyDialog,"LoginLimitDialog");g_bUseXMLValues=false;}});LoadingDialog(true);LoginLimitRequest.request();}else ShowDialog("LoginLimitDialog");}function OnLoginLimitLoad(){if(!g_bInitLoginTimes){var nTemp=0;while(nTemp<86400000){g_asLoginTimes.push(FormatTODTime(nTemp));nTemp+=1800000;}LoginStartTimeCombo=CreateComboBox(g_asLoginTimes[0],"",g_asLoginTimes,[],"LoginLimitStartTime","LoginLimitStartTime",undefined,"",false,115,undefined,undefined,true);LoginEndTimeCombo=CreateComboBox(g_asLoginTimes[g_asLoginTimes.length-1],"",g_asLoginTimes,[],"LoginLimitEndTime","LoginLimitEndTime",undefined,"",false,115,undefined,undefined,true);g_bInitLoginTimes=true;}}function LoadLoginLimitTODValues(asTODValues){var bDayOfWeekChanged=false;LoginLimitApplyTODCheck.setControlValue(asTODValues[0]=="1");LoginStartTimeCombo.setControlText(FormatTODTime(asTODValues[1]));LoginEndTimeCombo.setControlText(FormatTODTime(asTODValues[2]));for(var nIndex=0;nIndex<asTODValues[3].length;nIndex++){g_aLoginDaysChecks[nIndex].setControlValue(asTODValues[3].charAt(nIndex)=="1");}}function OnChangeApplyLoginLimitTOD(CheckBox){var bDisable=(!CheckBox.getControlValue());LoginStartTimeCombo.SetDisabled(bDisable);LoginEndTimeCombo.SetDisabled(bDisable);}function GetLoginLimitTODValue(AWCtrl){var sText=AWCtrl.getControlText(),sTemp="";var nRet=-1,nHours=-1,nMinutes=-1;while(sText.charAt(0)==" ")sText=sText.substring(1);while(sText.charAt(sText.length-1)==" ")sText=sText.substring(0,sText.length-1);sTemp=sText.substring(0,sText.indexOf(":"));if(sTemp.length){if((sTemp.length>1)&&(sTemp.charAt(0)=="0"))sTemp=sTemp.substring(1);nHours=parseInt(sTemp);}sTemp=sText.substr(sText.indexOf(":")+1,2);if(sTemp.length==2){if(sTemp.charAt(0)=="0")sTemp=sTemp.substring(1);nMinutes=parseInt(sTemp);}if((sText.indexOf("$TIME_PM$")>0)&&(nHours>=0))nHours+=12;else if(nHours==12)nHours=0;if((nHours>=0)&&(nMinutes>=0))nRet=((nHours*60)+nMinutes)*60000;return(nRet);}function LoginLimitTODsOkay(){return((GetLimitTODValue(LoginStartTimeCombo)>=0)&&(GetLimitTODValue(LoginEndTimeCombo)>=0));}function OnSaveLoginLimit(){var bApplyTOD=LoginLimitApplyTODCheck.getControlValue();if((bApplyTOD)&&(!LoginLimitTODsOkay()))AlertDialog("$LIMIT_INVALID_TOD$");else{for(var nIndex=0;nIndex<g_aLoginDaysChecks.length;nIndex++){document.getElementById(g_sFormType+g_aLoginDaysChecks[nIndex].getAttribute("AttrName").replace("Login_","")).name=g_aLoginDaysChecks[nIndex].getAttribute("AttrName").replace("Login_","");document.getElementById(g_sFormType+g_aLoginDaysChecks[nIndex].getAttribute("AttrName").replace("Login_","")).value=(g_aLoginDaysChecks[nIndex].getControlValue())?"1":"0";}document.getElementById(g_sFormType+"LimitToTimeOfDay").name="LimitToTimeOfDay";document.getElementById(g_sFormType+"LimitToTimeOfDay").value=(bApplyTOD)?"1":"0";if(bApplyTOD){document.getElementById(g_sFormType+"StartTime").name="StartTime";document.getElementById(g_sFormType+"EndTime").name="EndTime";document.getElementById(g_sFormType+"StartTime").value=GetLimitTODValue(LoginStartTimeCombo);document.getElementById(g_sFormType+"EndTime").value=GetLimitTODValue(LoginEndTimeCombo);}HideDialog('LoginLimitDialog');}return(false);}function OnAddLoginLimitDone(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");BusyDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}function ClearLoginLimits(){g_bUseXMLValues=true;document.getElementById(g_sFormType+"LimitToTimeOfDay").value="";document.getElementById(g_sFormType+"StartTime").value="";document.getElementById(g_sFormType+"EndTime").value="";document.getElementById(g_sFormType+"Monday").value="";document.getElementById(g_sFormType+"Tuesday").value="";document.getElementById(g_sFormType+"Wednesday").value="";document.getElementById(g_sFormType+"Thursday").value="";document.getElementById(g_sFormType+"Friday").value="";document.getElementById(g_sFormType+"Saturday").value="";document.getElementById(g_sFormType+"Sunday").value="";}function OnCancelLoginLimit(){HideDialog('LoginLimitDialog');}function OnLoginLimitHelp(){if(g_sFormType=="User")sHelpFile="Help-User-Info-Domain.htm";else sHelpFile="Help-Group-Information.htm";LaunchHelp(sHelpFile);}</script><div id="MessageFileDialoginner" style="display:none;"><form name="MessageFileForm" onsubmit="return (false);"><div style="display:inline;"><img src="%ADMIN_FILE%Images/MessageFile32.png" width="32" height="32" class="header-icon" alt="$MSGFILE$"/>$MSGFILEINFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="padding-left:5px;overflow:hidden;text-overflow:ellipsis;"><div style="overflow:auto"><span id="DialogIncludeRespCodesInMsgFiles"></span></div><br />$MSGFILELABEL$:<br /><div style="overflow:auto"><span id="DialogSignOnMessageFilePath"></span> <span id="BrowseButtonMessageFile"></span></div><br />$WELCOME_MSG_TEXT_INFO$<br /><textarea id="DialogSignOnMessage" name="DialogSignOnMessage" style="display:none;" ></textarea><div style="overflow:auto"><textarea id="SignOnMessageText" name="SignOnMessageText" class="aw-border" style="width:400px" rows="5" onchange="javascript:OnChangeSignOnMessage();"></textarea></div><span id="OverrideSignOnMessage"></span></div><div style="text-align:right;padding:10px 20px 0 0;"><span id="SaveMessageFileButton"></span><span id="CancelMessageFileButton"></span></div><div style="clear:both;"></div></form></div><script type="text/javascript" language="javascript">var MessageFilePathObj=undefined,SignOnMessageOverrideCheck=undefined;var g_sSignOnMessageDefault="";var g_bIsUser=("Group"=="User");var g_bSignOnInitDone=false;if(g_bIsUser){MessageFilePathObj=CreateComboBox("","",[],[],"DialogSignOnMessageFilePath","DialogSignOnMessageFilePath",undefined,undefined,true,400,20,OnSaveMessageFile,true);SignOnMessageOverrideCheck=CreateCheckBox("$SIGNON_MESSAGE_OVERRIDE$","OverrideSignOnMessage","OverrideSignOnMessage",false,OnOverrideSignOnMessage);}else MessageFilePathObj=CreateInputField("","DialogSignOnMessageFilePath","DialogSignOnMessageFilePath","",400,undefined,undefined,OnSaveMessageFile);function OnGroupMessageFilePathLoad(sValue,sDefaultValue){MessageFilePathObj.setControlText(sValue);}function OnMessageFilePathLoad(sValue,sDefaultValue){MessageFilePathObj.initValue(sValue,sDefaultValue);if(sValue.length)MessageFilePathObj.setControlText(sValue);else MessageFilePathObj.setControlText(sDefaultValue);}function OnLoadSignOnMessage(sValue,sDefaultValue){g_bSignOnInitDone=false;g_sSignOnMessageDefault=sDefaultValue;if(sValue.length)InitSignOnMessage(sValue,false);else InitSignOnMessage(sDefaultValue,true);g_bSignOnInitDone=true;}function InitSignOnMessage(sText,bIsDefault){if(g_bIsUser)SignOnMessageOverrideCheck.setChecked(!bIsDefault);document.getElementById("SignOnMessageText").value=sText;if(!bIsDefault)document.getElementById("DialogSignOnMessage").value=sText;}function OnOverrideSignOnMessage(){var SignOnMessageTextArea=document.getElementById("SignOnMessageText");if(SignOnMessageOverrideCheck.getControlValue()){SignOnMessageTextArea.disabled=false;SignOnMessageTextArea.style.fontWeight="bold";document.getElementById("DialogSignOnMessage").value=g_sSignOnMessageDefault;}else{SignOnMessageTextArea.disabled=true;SignOnMessageTextArea.style.fontWeight="normal";document.getElementById("DialogSignOnMessage").value="";document.getElementById("SignOnMessageText").value=g_sSignOnMessageDefault;}}function OnChangeSignOnMessage(){if(g_bSignOnInitDone)document.getElementById("DialogSignOnMessage").value=document.getElementById("SignOnMessageText").value;}BuildDialog("$WELCOME_MSG$","MessageFileDialog","520","285","","$CLOSE_CANCEL$","MessageFile16.png");var SaveMessageFileButton=CreateDialogPushButton("$SAVE_BUTTON$","SaveMessageFileButton",OnSaveMessageFile);CreateDialogPushButton("$CANCEL_BUTTON$","CancelMessageFileButton",OnCancelMessageFile);var MessageFileBrowseButton=CreatePushButton("","BrowseButtonMessageFile",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[MessageFilePathObj,true,"0","0"]]);MessageFileBrowseButton.setControlImage("Browse");function OnShowMessageFile(){ShowDialog("MessageFileDialog");}function OnSaveMessageFile(){document.getElementById("IncludeRespCodesInMsgFiles-hidden").value=document.getElementById(g_IncludeRespCodeMsgFiles.getContent("hidden").getId()).value;document.getElementById("SignOnMessageFilePath-hidden").value=(g_bIsUser)?document.getElementById(MessageFilePathObj.getContent("hidden").getId()).value:MessageFilePathObj.getControlText();document.getElementById("SignOnMessage-hidden").value=document.getElementById("DialogSignOnMessage").value;HideDialog("MessageFileDialog");return(false);}function OnAddLoginLimitDone(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");BusyDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}function OnCancelMessageFile(){HideDialog('MessageFileDialog');}</script><div id="LogIPAccessDialoginner" style="display:none;"><form name="LogIPAccessForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div style="width:225px;float:left;"><div style="overflow:auto"><span id="LogIPAccessRule"></span></div></div><div style="width:135px;float:left;padding-left:5px;"><span id="ApplyToScreen"></span><br /><span id="ApplyToFile"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveLogIPAccessButton"></span><br /><span id="CancelLogIPAccessButton"></span><br /><br /><span id="HelpLogIPAccessButton"></span></td></tr><tr><td><div id="LogIPAccessTipsGroup"><div style="width:100px;float:left;margin-bottom:5px;padding-left:3px;">xxx = $IP_RULE_MATCH$<br />* = $IP_RULE_ANY$<br /></div><div style="width:235px;float:left;padding-left:5px;margin-bottom:5px;">| &nbsp; xxx-xxx = $IP_RULE_RANGE$<br />| &nbsp; ? = $IP_RULE_ANY_CHAR$</div></div></td></tr></table><input type="hidden" id="ApplyIPToFileCheck" value="1" /><input type="hidden" id="ApplyIPToScreenCheck" value="0" /></form></div><script type="text/javascript" language="javascript">BuildDialog("$LOG_IP_ACCESS_DIALOG_TITLE$","LogIPAccessDialog","475","182","","$CLOSE_CANCEL$");AW.Formats.IPAccessString=AW.Formats.XMLString.subclass();AW.Formats.IPAccessString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sTemp=Grid.getCellData(4,nRow);if(sTemp=="")sTemp=Grid.getCellData(5,nRow);if((sTemp!="")||((sTemp=Grid.getCellData(5,nRow))!=""))return(FormatClientString(data)+" ("+FormatClientString(sTemp)+")");else return(FormatClientString(data));};obj.dataToValue=function(data,Grid,nColumn,nRow){return(this.dataToText(data,Grid,nColumn,nRow));}};function OnLogIPAccessLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("LogIPAccessDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}var sLoggingID="-1";if(sLoggingID!="-1"){LogApplyScreenCheck.setControlValue(parseInt(document.LogIPAccessForm.Screen.value)?true:false);LogApplyFileCheck.setControlValue(parseInt(document.LogIPAccessForm.File.value)?true:false);}else{document.getElementById("ApplyIPToFileCheck").name="File";document.getElementById("ApplyIPToFileCheck").value="1";document.getElementById("ApplyIPToScreenCheck").name="Screen";document.getElementById("ApplyIPToScreenCheck").value="0";}LogIPRule.setControlText(document.getElementById(LogIPRule.getContent("box/text").getId()).value);}function OnSaveLogIPAccess(){if(LogIPRule.getControlText()!="")LogIPAccessList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_RULE$");return(false);}function OnCancelLogIPAccess(){HideDialog('LogIPAccessDialog');}function OnLogIPAccessHelp(){LaunchHelp("Help-IP-ACL.htm","Item2_2");}var LogIPRule=CreateInputField("","LogIPAccessRule","LogIPAccess_IP",undefined,225,undefined,undefined,OnSaveLogIPAccess);var sLoggingID="-1";if(sLoggingID!="-1"){var LogApplyScreenCheck=CreateCheckBox("$LOG_APPLY_SCREEN$","ApplyToScreen","Screen",false,undefined,true);var LogApplyFileCheck=CreateCheckBox("$LOG_APPLY_FILE$","ApplyToFile","File",false,undefined,true);}CreateGroupBox("$IP_ACCESS_TIPS$","LogIPAccessTipsGroup","360px","65px",true);CreateDialogPushButton("$SAVE_BUTTON$","SaveLogIPAccessButton",OnSaveLogIPAccess);CreateDialogPushButton("$CANCEL_BUTTON$","CancelLogIPAccessButton",OnCancelLogIPAccess);CreateDialogPushButton("$HELP_BUTTON$","HelpLogIPAccessButton",OnLogIPAccessHelp);</script><div id="LogIPAccessListDialoginner" style="display:none;"><div id="LogIPAccessListContent" style="padding-right:8px;><div class="layercontent"><div style="display:inline;"><img alt="$LOG_IP_ACCESS_LIST_DIALOG_TITLE$" src="%ADMIN_FILE%Images/IpAccess32.png" width="32" height="32" class="header-icon" />$USER_GROUP_LOG_IP_ACCESS_LIST_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><span id="LogIPAccessList"></span><table cellpadding="0" cellspacing="0" border="0" style="margin-top:5px;width:537px;"><tr><td style="text-align:left;"><span id="AddLogIPAccessButton"></span><span id="EditLogIPAccessButton"></span><span id="DeleteLogIPAccessButton"></span></td><td style="text-align:right;"><span id="LogIPAccessHelpButton"></span><span id="CloseLogIPAccessListButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$LOG_IP_ACCESS_LIST_DIALOG_TITLE$","LogIPAccessListDialog","550","320","","$CLOSE_CANCEL$","IpAccess16.png");var LogIPAccessList=CreateAdminGrid("LogIPAccessList",["$RULE_ADDRESS$","$APPLIES_TO$"],[450,75],"DomainLogIPAccess.xml?ID=-1","rules","rule",7,OnEditLogIPAccess);LogIPAccessList.setStyle("height","200px");LogIPAccessList.setCellFormat([new AW.Formats.IPAccessString,new AW.Formats.String]);LogIPAccessList.getCellImage=function(nCol,nRow){return(LogIPAccessFormat.call(this,nCol,nRow));};var sOnAddLogIPAccess=String("OnAddLogIPAccess(");var sOnEditLogIPAccess=String("OnEditLogIPAccess(");var sOnDeleteLogIPAccess=String("OnDeleteLogIPAccess(");CreateContextMenu([sOnEditLogIPAccess,"",sOnAddLogIPAccess,sOnDeleteLogIPAccess],[function(){return(OnEqualOneContextMenu(LogIPAccessList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(LogIPAccessList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(LogIPAccessList,"$DELETE_BUTTON$..."))}],["Edit","","New","FileDelete"],LogIPAccessList,"LogIPAccessListContext",true);CreatePushButton("$ADD_BUTTON$...","AddLogIPAccessButton",OnAddLogIPAccess);CreatePushButton("$EDIT_BUTTON$...","EditLogIPAccessButton",OnEditLogIPAccess);CreatePushButton("$DELETE_BUTTON$","DeleteLogIPAccessButton",OnDeleteLogIPAccess);CreateDialogPushButton("$HELP_BUTTON$","LogIPAccessHelpButton",OnLogIPAccessHelp);CreateDialogPushButton("$CLOSE_BUTTON$","CloseLogIPAccessListButton",OnCloseLogIPAccessListDialog);function LogIPAccessFormat(nCol,nRow){var bFile=(this.getCellText(2,nRow)!="0"),bScreen=(this.getCellText(3,nRow)!="0");var sAppliesTo="";if((bFile)&&(bScreen))sAppliesTo="$LOG_BOTH$";else if(bFile)sAppliesTo="$LOG_FILE$";else if(bScreen)sAppliesTo="$LOG_SCREEN$";else sAppliesTo="$LOG_NONE$";this.UpdateText(sAppliesTo,1,nRow);return("RuleDeny");}function EnableDisableUserGroupLogIPAccess(sDisableDialogStr){ClearGrid(LogIPAccessList,true);LogIPAccessList.EnableUpdates(sDisableDialogStr==undefined,"ID=-1","ID="+document.getElementById("LoggingID").value);}function EnableDisableLogIPAccess(sDisableDialogStr){LogIPAccessList.EnableUpdates(sDisableDialogStr==undefined);}function OnAddLogIPAccess(){var sLoggingID="-1";if(sLoggingID=="-1")sLoggingID=document.getElementById("LoggingID").value;LogIPAccessList.OnAddObject("LogIPAccess.xml%DEFAULT_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess","Result.xml%ADD_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess",document.LogIPAccessForm,"LogIPAccessDialog",[OnLogIPAccessLoad],g_bReadOnlyAccess);}function OnEditLogIPAccess(){var sLoggingID="-1";if(sLoggingID=="-1")sLoggingID=document.getElementById("LoggingID").value;LogIPAccessList.OnEditObject("LogIPAccess.xml","Result.xml%UPDATE_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess.",document.LogIPAccessForm,"LogIPAccessDialog","$SELECT_ONLY_ONE_IPACCESS_EDIT$","$SELECT_ONE_IPACCESS_EDIT$",[OnLogIPAccessLoad]);}function OnDeleteLogIPAccess(){var sLoggingID="-1";if(sLoggingID=="-1")sLoggingID=document.getElementById("LoggingID").value;LogIPAccessList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess&ID="+sLoggingID,"$ASK_DELETE_IPACCESS$","$SELECT_ONE_IPACCESS_DELETE$");}function OnCloseLogIPAccessListDialog(){HideDialog("LogIPAccessListDialog");}function OnLogIPAccessHelp(){LaunchHelp("Help-Configure-Logs.htm","Item16_4");}</script><div id="GroupDialoginner" style="display:none;"><div style="padding:0 10px 0 10px;"><form method="post" name="GroupForm" onsubmit="return (false);"><span id="DialogTabs"></span><div id="DialogTabsContent" class="tabs-content"><div id="GroupInfo" style="display:none"><div id="groupinfo" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$GROUPINFO$" src="%ADMIN_FILE%Images/Groups32.png" width="32" height="32" class="header-icon" /><div id="GroupInfoText">$GROUPINFOMSG$</div><div id="GroupTemplateInfoText">$GROUP_TEMPLATE_INFOMSG$</div><div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="width:$USER_INFO_LEFT_CONTAIN_WIDTH$px; float: left; ">$GROUPNAME$:<div style="overflow:auto"><span id="GroupName"></span></div></div><div style="width:$USER_INFO_RIGHT_CONTAIN_WIDTH$px; float: left;">$HOMEDIR$:<div style="overflow:auto"><span id="HomeDir"></span> <span id="BrowseButtonGroupHome"></span></div></div><div style="width:$USER_INFO_LEFT_CONTAIN_WIDTH$px;float:left;clear:left;">$ADMINPRIV$:<br /><span id="AdminType"></span>$WEB_CLIENT_STARTUP$:<br /><span id="WebClientStartupMode"></span><div style="clear:left;margin-top:5px;"><span id="AlwaysAllowLogin"></span></div><div style="clear:left;"><span id="Input_Enabled"></span></div></div><div style="width:$USER_INFO_RIGHT_PUBKEY_WIDTH$px; float: left;" ><div id="GroupSSHSettings" style="padding-bottom:5px;">$SSH_KEYS$: <br /><span id="ManageSSHKeys"></span></div><span id="LockInHomeDir"></span><br /><span id="ApplyDirAccessRulesAboveUser"></span><br /></div><br style="clear:left;" /><div>$DESCRIPTION$:<div style="vertical-align:bottom;"><div style="width:485px;float:left;"><div style="overflow:auto;"><textarea id="GroupDescription" name="Description" class="aw-border" style="width:480px;height:205px;"></textarea></div></div><div id="GroupButtonContain" style="width:135px;float:left;padding:161px 0px 0px 5px;vertical-align:bottom;"><span id="LoginLimitButton"></span><span id="WelcomeMessageButton"></span></div><div style="clear:both;height:1px;line-height:1px;"></div></div></div></div></div><script type="text/javascript" language="JavaScript">var GroupNameInput=CreateInputField("","GroupName","Invo__GroupName","",(180+$USER_INFO_INPUT_WIDTH_ADD$),undefined,undefined,OnSaveGroup);var GroupHomeDirInput=CreateInputField("","HomeDir","HomeDir","",280,undefined,undefined,OnSaveGroup);var g_bSSHLicense=("%CServer.%SERVER_ID%.SSHLicense%"!="0");if(!g_bSSHLicense)document.getElementById("GroupSSHSettings").style.visibility="hidden";GroupNameInput.onControlTextChanged=UpdateGroupWindowTitle;if(AW.ie){document.getElementById("GroupButtonContain").style.padding="152px 0px 0px 5px";document.getElementById("GroupDescription").style.height=(parseInt(document.getElementById("GroupDescription").style.height)-7)+"px";}var GroupDirAccessCheck=CreateCheckBox("$GROUP_APPLY_DIR_ACCESS$","ApplyDirAccessRulesAboveUser","ApplyDirAccessRulesAboveUser",0,undefined,true,"OnLoadApplyDirAccess()");var AlwaysLoginCheck=CreateCheckBox("$ALWAYS_ALLOW_LOGIN$","AlwaysAllowLogin","AlwaysAllowLogin",0,undefined,true,"OnLoadAlwaysLogin()");var PrivilegeCombo=CreateComboBox("$PRIV_NONE_DESC$","0",["$PRIV_NONE_DESC$","$PRIV_GROUP_DESC$","$PRIV_DOMAIN_DESC$","$PRIV_SYSTEM_DESC$","$PRIV_GROUP_RO_DESC$","$PRIV_DOMAIN_RO_DESC$","$PRIV_SYSTEM_RO_DESC$"],["0","5","1","2","6","3","4"],"AdminType","AdminType",undefined,"OnPrivilegeLoad()",true,(180+$USER_INFO_INPUT_WIDTH_ADD$),20,OnSaveGroup,false,false,true);var nPrivilegeComboCnt=PrivilegeCombo.getItemCount();var PopUpPrivilegeComboCombo=PrivilegeCombo.getPopupTemplate();PopUpPrivilegeComboCombo.setStyle("height",parseInt(17*nPrivilegeComboCnt)+"px");var WebClientCombo=CreateComboBox("$WEB_CLIENT_ASK_DESC$","2",["$WEB_CLIENT_BASIC_DESC$","$WEB_CLIENT_FVJV_DESC$","$WEB_CLIENT_SHARE_DESC$","$WEB_CLIENT_ASK_DESC$","$WEB_CLIENT_NEW_DESC$","$WEB_CLIENT_SHARE_NEW_DESC$"],["0","1","3","2","5","6"],"WebClientStartupMode","WebClientStartupMode",OnChangeWebClient,"OnWebClientLoad()",true,(180+$USER_INFO_INPUT_WIDTH_ADD$),20,OnSaveGroup,undefined,undefined,true);var nWebClientComboCnt=WebClientCombo.getItemCount();var PopUpWebClientComboCombo=WebClientCombo.getPopupTemplate();PopUpWebClientComboCombo.setStyle("height",parseInt(17*nWebClientComboCnt)+"px");var BrowseGroupHome=CreatePushButton("","BrowseButtonGroupHome",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[GroupHomeDirInput,false,"0","1"]]);BrowseGroupHome.setControlImage("Browse");CreatePushButton("$AVAILABILITY$...","LoginLimitButton",OnShowLoginLimit,undefined,undefined,undefined,"LoginLimit");CreatePushButton("$WELCOME_MSG$...","WelcomeMessageButton",OnShowMessageFile,undefined,undefined,undefined,"MessageFile");CreatePushButton("$MANAGE_SSH_KEYS$...","ManageSSHKeys",OnManageSSHKeys);function OnLoadApplyDirAccess(sValue){GroupDirAccessCheck.setControlValue(parseInt(sValue)?true:false);}function OnLoadAlwaysLogin(sValue){AlwaysLoginCheck.setControlValue(parseInt(sValue)?true:false);}function OnPrivilegeLoad(sValue,sDefaultValue){if(!g_bSysAdmin)PrivilegeCombo.initValue("0");else PrivilegeCombo.initValue(sValue,sDefaultValue);PrivilegeCombo.SetDisabled(!g_bSysAdmin);}function OnWebClientLoad(sValue,sDefaultValue){WebClientCombo.initValue(sValue,sDefaultValue);}function OnChangeWebClient(sValue){var nValue=parseInt(sValue);if(!g_bFVJVLicense&&(sValue==1||sValue==2))ConfirmDialog(g_sFVJVLicenseInfo,OnMoreFVJVInfo);else if((!g_bFileSharingLicense)&&((sValue==3)||(sValue==2)))ConfirmDialog(g_sAdhocFileShareLicenseInfo,OnMoreFVJVInfo);}function InitGroupWindowTitle(){GroupNameInput.setControlText(GroupNameInput.getContent("box/text").element().value);LogFilePathInput.setControlText(LogFilePathInput.getContent("box/text").element().value);MaxLogFilesInput.setControlText(MaxLogFilesInput.getContent("box/text").element().value);nMaxLogMB=parseFloat(parseInt(MaxLogFilesBytesInput.getContent("box/text").element().value)/(1024*1024));MaxLogFilesBytesInput.setControlText(nMaxLogMB);UpdateGroupWindowTitle(GroupNameInput.getControlText());}function UpdateGroupWindowTitle(sGroupName){var sTitle="$GROUP_PROPERTIES$";var nFullNameLen=sGroupName.length;if(nFullNameLen)sTitle+=" - "+sGroupName;document.getElementById("GroupDialogTitleText").innerHTML=SanitizeString(sTitle);}</script></div><div id="DirAccess" style="display:none"><div id="diraccess"style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$DIRACCESS$" src="%ADMIN_FILE%Images/DirAccess32.png" width="32" height="32" class="header-icon" />$GROUP_DIR_ACCESS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><table border="0" cellpadding="0" cellspacing="0"><tr><td style="width:100%;"><span id="DirAccessList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span></td><td style="width:auto;padding-left:10px;text-align:center;"><span id="DirAccessTopArrow"></span><br /><span id="DirAccessUpArrow"></span><br /><br /><span id="DirAccessDownArrow"></span><br /><span id="DirAccessBottomArrow"></span></td></tr></table><div style="padding:5px 0 0 0;"><span id="AddDirButton"></span><span id="EditDirButton"></span><span id="RemoveDirButton"></span></div></div></div><script type="text/javascript" language="JavaScript">var g_sPathColumn="$PATH$";var g_sAccessColumn="$ACCESS$";var g_sMaxSizeColumn="$MAX_SIZE$";var DirAccessList=CreateDirAccessGrid("DirAccessList","GroupDirAccess.xml?ID=%OBJECT_EDIT_ID%",OnEditDirAccess);DirAccessList.onKeyDelete=OnRemoveDirAccess;var sOnEditDirAccess=String("OnEditDirAccess(");var sOnAddDirAccess=String("OnAddDirAccess(");var sOnRemoveDirAccess=String("OnRemoveDirAccess(");CreateContextMenu([sOnEditDirAccess,"",sOnAddDirAccess,sOnRemoveDirAccess],[function(){return(OnEqualOneContextMenu(DirAccessList,"$EDIT_BUTTON$..."))},function(){return(OnEqualOneContextMenu(DirAccessList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(DirAccessList,"$DELETE_BUTTON$..."))}],["Edit","","New","FileDelete"],DirAccessList,"DirAccessListContext",true);var nDirAccessListHeight=345;if(AW.unix)nDirAccessListHeight=(nDirAccessListHeight-12);DirAccessList.setStyle("height",nDirAccessListHeight+"px");aGridCtrls[1]=DirAccessList;CreatePushButton("$ADD_BUTTON$...","AddDirButton",OnAddDirAccess);CreatePushButton("$EDIT_BUTTON$...","EditDirButton",OnEditDirAccess);CreatePushButton("$DELETE_BUTTON$","RemoveDirButton",OnRemoveDirAccess);DirAccessList.InitObjectMove(["DirAccessTopArrow","DirAccessUpArrow","DirAccessDownArrow","DirAccessBottomArrow"],"CGroup.$EDIT_OBJECT_ID$.DirAccess",GetEditObjectID);function OnAddDirAccess(){DirAccessList.OnAddObject("DirAccess.xml%DEFAULT_OBJECT_REF%CGroup."+g_EditObjectID+".DirAccess","Result.xml%ADD_OBJECT_REF%CGroup."+g_EditObjectID+".DirAccess",document.DirAccessForm,"DirAccessDialog",[OnDirAccessLoad],g_bReadOnlyAccess);}function OnEditDirAccess(){DirAccessList.OnEditObject("DirAccess.xml","Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".DirAccess.",document.DirAccessForm,"DirAccessDialog","$SELECT_ONLY_ONE_DIRACCESS_EDIT$","$SELECT_ONE_DIRACCESS_EDIT$",[OnDirAccessLoad]);}function OnRemoveDirAccess(){DirAccessList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CGroup."+g_EditObjectID+".DirAccess&ID=%ID%","$ASK_DELETE_DIRACCESS$","$SELECT_ONE_DIRACCESS_DELETE$");}</script></div><div id="VirtualPaths" style="display:none"><div id="virtualpaths" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$VIRPATHS$" src="%ADMIN_FILE%Images/VirtualPaths32.png" width="32" height="32" class="header-icon" />$VIRTUALPATHINFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="VirPathsTabContent"><span id="VirPathsList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="AddVirPathButton"></span><span id="EditVirPathButton"></span><span id="RemoveVirPathButton"></span></div></div><div style="text-align:center;" id="VirPathsTabContentContainer"><div id="VirPathsTabContentNone" class="UpgradeLicenseMsg"><img id="VirPathsTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="VirPathsTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><script type="text/javascript" language="JavaScript">var VirPathsList=CreateAdminGrid("VirPathsList",["$VIRPATH_PHYSICAL$","$VIRPATH_MAPPED_TO$"],[210,210],"GroupVirtualPaths.xml?ID=%OBJECT_EDIT_ID%","virtualpaths","virpath",3,OnEditVirPath);VirPathsList.onKeyDelete=OnRemoveVirPath;var sOnEditVirPath=String("OnEditVirPath(");var sOnAddVirPath=String("OnAddVirPath(");var sOnRemoveVirPath=String("OnRemoveVirPath(");
CreateContextMenu([sOnEditVirPath,"",sOnAddVirPath,sOnRemoveVirPath],[function(){return(OnEqualOneContextMenu(VirPathsList,"$EDIT_BUTTON$..."))},function(){return(OnEqualOneContextMenu(VirPathsList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(VirPathsList,"$DELETE_BUTTON$..."))}],["Edit","","New","FileDelete"],VirPathsList,"VirPathsListContext",true);var nVirPathsListHeight=345;if(AW.unix)nVirPathsListHeight=(nVirPathsListHeight-5);VirPathsList.setStyle("height",nVirPathsListHeight+"px");aGridCtrls[2]=VirPathsList;CreatePushButton("$ADD_BUTTON$...","AddVirPathButton",OnAddVirPath);CreatePushButton("$EDIT_BUTTON$","EditVirPathButton",OnEditVirPath);CreatePushButton("$DELETE_BUTTON$","RemoveVirPathButton",OnRemoveVirPath);if("%CServer.%SERVER_ID%.VirtualPathsLicense%"!="1")DisableTab("VirPathsTabContent",VirPathsList);function OnAddVirPath(){VirPathsList.OnAddObject("VirtualPath.xml%DEFAULT_OBJECT_REF%CGroup."+g_EditObjectID+".VirtualPath","Result.xml%ADD_OBJECT_REF%CGroup."+g_EditObjectID+".VirtualPath",document.VirPathForm,"VirtualPathDialog",[OnVirPathLoad],g_bReadOnlyAccess);}function OnEditVirPath(){VirPathsList.OnEditObject("VirtualPath.xml","Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".VirtualPath.",document.VirPathForm,"VirtualPathDialog","$SELECT_ONLY_ONE_VIRPATH_EDIT$","$SELECT_ONE_VIRPATH_EDIT$",[OnVirPathLoad]);}function OnRemoveVirPath(){VirPathsList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CGroup."+g_EditObjectID+".VirtualPath&ID=%ID%","$ASK_DELETE_VIRPATH$","$SELECT_ONE_VIRPATH_DELETE$");}</script></div><div id="Logging" style="display:none"><div class="layercontent" ><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32"/></td><td style="vertical-align:top;">$LOG_SETTINGS_INFO_USER_GROUP$</td></tr></table><div style="margin:0 0 5px 0;width:100%;"><div style="margin:5px 0 5px 0;"><div id="LoggingToFileSettingsGroup"><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><span id="SecurityMessages"/></td><td><span id="FileDeletes"/></td><td><span id="FTPCommands"/></td><td><span id="SSHDetailedCommands"/></td></tr><tr><td><span id="IPNames"/></td><td><span id="FileDirRenames"/></td><td><span id="FTPReplies"/></td><td><span id="SSHDetailedReplies"/></td></tr><tr><td><span id="Downloads"/></td><td><span id="DirCreates"/></td><td><span id="SSHCommands"/></td><td><span id="HTTPCommands"/></td></tr><tr><td><span id="ZippedDownloads"/></td><td><span id="DirDeletes"/></td><td><span id="SSHReplies"/></td><td><span id="HTTPReplies"/></td></tr><tr><td><span id="Uploads"/></td></tr></table><div class="low-performance-warning warning-group Hidden"><img src="Images/Warn16.png" alt="warning"><span>$PERFORMANCE_AFFECTING_SETTINGS_WARNING$</span></div></div></div><div style="margin-top:10px;clear:both;"><div id="LoggingToFileGroup"><div id="LogFileDiv" style="float:left;max-width: 54%; border-right:1px solid black;"><div style="margin-top: 5px; padding-right: 5px;"><img src="%COMMON_FILE%Images/Warn.png" width="24" height="24" class="tab-header" alt="warning" />$USING_SLOW_NETWORK_WARNING$</div><br />$LOG_FILE_PATH$:<br/><div style="overflow:auto"><span id="LogFilePath"></span> <span id="BrowseButtonLogPath"></span></div><span id="LogToFile"></span><br /><div style="padding-right:5px;">$LOG_FILE_PARAMETERS_LABEL$:<hr style="height:1px;" /><div style="float:left;width:auto;height:70px;">%H = $HOURLY_LOG_LABEL$<br />%D = $DAY_OF_MONTH_LABEL$<br />%M = $MONTH_TEXT_LABEL$<br />%N = $MONTH_NUMBER_LABEL$<br />%Y = $4_DIGIT_YEAR_LABEL$</div><div style="float:left;width:auto;height:70px;padding:0 0 0 10px;">%X = $2_DIGIT_YEAR_LABEL$<br />%S = $DOMAIN_NAME_LABEL$<br /><span id="LoginLabel" style="display:none;">%L = $LOGIN_LABEL$<br /></span><span id="UserFullNameLabel" style="display:none;">%U = $USER_FULL_NAME_LABEL$</span><span id="GroupNameLabel" style="display:none;">%G = $GROUP_NAME_LABEL$</span></div></div></div><div id="LogFileRotateDiv" style="float:left;max-width: 44%; padding-left:5px;">$LOG_ROTATE_SETTING$:<br /><span id="LogFileArchiveMode"></span><div style="clear:left;text-align:center;padding-right:5px;"><hr style="height:1px;" /></div><div style="overflow:auto">$KEEP_UP_TO$ <span id="MaxLogFiles"></span>&nbsp;$LOG_EXCEED_FILES$	($ZERO_NO_DELETE$)</div><div style="padding-top:5px;"><div style="overflow:auto">$KEEP_UP_TO$ <span id="MaxLogFilesBytes"></span>&nbsp;$LOG_EXCEED_BYTES$	($ZERO_NO_DELETE$)</div></div></div><!--div style="clear:both;"><span id="SaveButton" style="float:right;"></span></div--></div><div style="padding-top:5px;"><span id="DoNotLogButton"></span><span id="DownloadLog"></span></div></div></div><input type="hidden" name="CurrentLogFilePath" id="CurrentLogFilePath"/><input type="hidden" name="LoggingID" id="LoggingID"/><input type="hidden" name="UserLoggingID" id="UserLoggingID"/></div><script type="text/javascript" language="JavaScript">var PERFORMANCE_AFFECTING_CHECKBOXES=[];var SecurityMessages=CreateCheckBox("$SECURITY_MESSAGES_LABEL$","SecurityMessages","SecurityMessages",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxSecurityMessages()");function OnLoadFileCheckBoxSecurityMessages(sValue,sDefault){SecurityMessages.m_InitialLoadDone=false;SecurityMessages.setControlValue(parseInt(sValue)?true:false);};var IPNames=CreateCheckBox("$IP_NAMES_LABEL$","IPNames","IPNames",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxIPNames()");function OnLoadFileCheckBoxIPNames(sValue,sDefault){IPNames.m_InitialLoadDone=false;IPNames.setControlValue(parseInt(sValue)?true:false);};var Downloads=CreateCheckBox("$DOWNLOADS_LABEL$","Downloads","Downloads",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxDownloads()");function OnLoadFileCheckBoxDownloads(sValue,sDefault){Downloads.m_InitialLoadDone=false;Downloads.setControlValue(parseInt(sValue)?true:false);};var ZippedDownloads=CreateCheckBox("$ZIPPEDDOWNLOADS_LABEL$","ZippedDownloads","ZippedDownloads",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxZippedDownloads()");function OnLoadFileCheckBoxZippedDownloads(sValue,sDefault){ZippedDownloads.m_InitialLoadDone=false;ZippedDownloads.setControlValue(parseInt(sValue)?true:false);};var Uploads=CreateCheckBox("$UPLOADS_LABEL$","Uploads","Uploads",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxUploads()");function OnLoadFileCheckBoxUploads(sValue,sDefault){Uploads.m_InitialLoadDone=false;Uploads.setControlValue(parseInt(sValue)?true:false);};var FileDeletes=CreateCheckBox("$FILE_DELETIONS_LABEL$","FileDeletes","FileDeletes",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxFileDeletes()");function OnLoadFileCheckBoxFileDeletes(sValue,sDefault){FileDeletes.m_InitialLoadDone=false;FileDeletes.setControlValue(parseInt(sValue)?true:false);};var FileDirRenames=CreateCheckBox("$FILE_AND_DIRECTORY_RENAMES_LABEL$","FileDirRenames","FileDirRenames",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxFileDirRenames()");function OnLoadFileCheckBoxFileDirRenames(sValue,sDefault){FileDirRenames.m_InitialLoadDone=false;FileDirRenames.setControlValue(parseInt(sValue)?true:false);};var DirCreates=CreateCheckBox("$DIRECTORY_CREATIONS_LABEL$","DirCreates","DirCreates",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxDirCreates()");function OnLoadFileCheckBoxDirCreates(sValue,sDefault){DirCreates.m_InitialLoadDone=false;DirCreates.setControlValue(parseInt(sValue)?true:false);};var DirDeletes=CreateCheckBox("$DIRECTORY_DELETIONS_LABEL$","DirDeletes","DirDeletes",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxDirDeletes()");function OnLoadFileCheckBoxDirDeletes(sValue,sDefault){DirDeletes.m_InitialLoadDone=false;DirDeletes.setControlValue(parseInt(sValue)?true:false);};var FTPCommands=CreateCheckBox("$FTP_COMMANDS_LABEL$","FTPCommands","FTPCommands",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxFTPCommands()");function OnLoadFileCheckBoxFTPCommands(sValue,sDefault){FTPCommands.m_InitialLoadDone=false;FTPCommands.setControlValue(parseInt(sValue)?true:false);};var FTPReplies=CreateCheckBox("$FTP_REPLIES_LABEL$","FTPReplies","FTPReplies",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxFTPReplies()");function OnLoadFileCheckBoxFTPReplies(sValue,sDefault){FTPReplies.m_InitialLoadDone=false;FTPReplies.setControlValue(parseInt(sValue)?true:false);};var SSHCommands=CreateCheckBox("$SSH_COMMANDS_LABEL$","SSHCommands","SSHCommands",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxSSHCommands()");function OnLoadFileCheckBoxSSHCommands(sValue,sDefault){SSHCommands.m_InitialLoadDone=false;SSHCommands.setControlValue(parseInt(sValue)?true:false);};PERFORMANCE_AFFECTING_CHECKBOXES.push(SSHCommands);var SSHReplies=CreateCheckBox("$SSH_REPLIES_LABEL$","SSHReplies","SSHReplies",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxSSHReplies()");function OnLoadFileCheckBoxSSHReplies(sValue,sDefault){SSHReplies.m_InitialLoadDone=false;SSHReplies.setControlValue(parseInt(sValue)?true:false);};PERFORMANCE_AFFECTING_CHECKBOXES.push(SSHReplies);var SSHDetailedCommands=CreateCheckBox("$SSH_DETAILED_COMMANDS_LABEL$","SSHDetailedCommands","SSHDetailedCommands",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxSSHDetailedCommands()");function OnLoadFileCheckBoxSSHDetailedCommands(sValue,sDefault){SSHDetailedCommands.m_InitialLoadDone=false;SSHDetailedCommands.setControlValue(parseInt(sValue)?true:false);};PERFORMANCE_AFFECTING_CHECKBOXES.push(SSHDetailedCommands);var SSHDetailedReplies=CreateCheckBox("$SSH_DETAILED_REPLIES_LABEL$","SSHDetailedReplies","SSHDetailedReplies",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxSSHDetailedReplies()");function OnLoadFileCheckBoxSSHDetailedReplies(sValue,sDefault){SSHDetailedReplies.m_InitialLoadDone=false;SSHDetailedReplies.setControlValue(parseInt(sValue)?true:false);};PERFORMANCE_AFFECTING_CHECKBOXES.push(SSHDetailedReplies);var HTTPCommands=CreateCheckBox("$HTTP_COMMANDS_LABEL$","HTTPCommands","HTTPCommands",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxHTTPCommands()");function OnLoadFileCheckBoxHTTPCommands(sValue,sDefault){HTTPCommands.m_InitialLoadDone=false;HTTPCommands.setControlValue(parseInt(sValue)?true:false);};var HTTPReplies=CreateCheckBox("$HTTP_REPLIES_LABEL$","HTTPReplies","HTTPReplies",0,OnFileCheckBoxValueChanged,true,"OnLoadFileCheckBoxHTTPReplies()");function OnLoadFileCheckBoxHTTPReplies(sValue,sDefault){HTTPReplies.m_InitialLoadDone=false;HTTPReplies.setControlValue(parseInt(sValue)?true:false);};var g_bShowLogFilePathAlert=true;var nLogFileGroupHeight="$USER_LOG_FILE_GROUP_HEIGHT$px";if(bIsOpera)nLogFileGroupHeight="$OPERA_USER_LOG_FILE_GROUP_HEIGHT$px";else nLogFileGroupHeight="$USER_LOG_FILE_GROUP_HEIGHT$px";if(AW.ie){document.getElementById("LogFileDiv").style.width="312px";}if(g_bIsUser){document.getElementById("LoginLabel").style.display="block";document.getElementById("UserFullNameLabel").style.display="block";}else document.getElementById("GroupNameLabel").style.display="block";CreateGroupBox("$LOG_MESSAGE_SETTINGS_LABEL$","LoggingToFileSettingsGroup","100%","$LOG_MESSAGE_OPTIONS_GROUP_HEIGHT$px");CreateGroupBox("$LOG_FILE_SETTINGS$","LoggingToFileGroup","100%",nLogFileGroupHeight);var LogFilePathInput=CreateInputField("","LogFilePath","LogFilePath",undefined,270);LogFilePathInput.onControlTextChangedDef=LogFilePathInput.onControlTextChanged;LogFilePathInput.onControlTextChanged=function(sText){setTimeout(function(){if(!g_bIsFileNameSelected&&g_bShowLogFilePathAlert){AlertDialog("$PLEASE_ENTER_LOG_FILE_NAME$<br><br>$LOG_FILE_NAMING_EXAMPLES$",false,SetLogFileFocus);g_bShowLogFilePathAlert=false;}if(LogFilePathInput.onControlTextChangedDef)LogFilePathInput.onControlTextChangedDef(sText);});};var LogPathBrowse=CreatePushButton("","BrowseButtonLogPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[LogFilePathInput,false,"0","0"]]);LogPathBrowse.setControlImage("Browse");var LogToFile=CreateCheckBox("$ENABLE_LOG_TO_FILE$","LogToFile","LogToFile",0,undefined,true,"OnLoadLogToFile()");var MaxLogFilesBytesInput=CreateInputField("","MaxLogFilesBytes","MaxLogFilesBytes",undefined,50);var MaxLogFilesInput=CreateInputField("","MaxLogFiles","MaxLogFiles",undefined,50);var LogFileArchiveMode=CreateComboBox("$LOG_ROTATE_NEVER_DESC$","0",["$LOG_ROTATE_NEVER_DESC$","$LOG_ROTATE_HOURLY_DESC$","$LOG_ROTATE_DAILY_DESC$","$LOG_ROTATE_WEEKLY_DESC$","$LOG_ROTATE_MONTHLY_DESC$","$LOG_ROTATE_YEARLY_DESC$"],["0","5","1","2","3","4"],"LogFileArchiveMode","LogFileArchiveMode",undefined,"OnLoggingArchiveLoad()",false,100,undefined,undefined,undefined,undefined,true);CreatePushButton("$LOG_IP_ACCESS_BUTTON$...","DoNotLogButton",OnLogIPAccess);CreatePushButton("$DOWNLOAD_LOG_BUTTON$","DownloadLog",OnDownloadLog,undefined,undefined,undefined,"log");updatePerformanceWarning();function OnFormatMaxLogBytes(sValue){nMaxLogMB=parseFloat(parseInt(sValue)/(1024*1024));MaxLogFilesBytesInput.setControlText(nMaxLogMB);}function OnLoadLogToFile(sValue,sDefault){LogToFile.setControlValue(parseInt(sValue)?true:false);}function toggleWarn(isVisible){var lowPerformanceWarn=document.querySelector(".low-performance-warning");if(!lowPerformanceWarn)return;if(isVisible)lowPerformanceWarn.classList.remove("Hidden");else lowPerformanceWarn.classList.add("Hidden");}function updatePerformanceWarning(){var isCheckboxEnabled=false;for(var i=0;i<PERFORMANCE_AFFECTING_CHECKBOXES.length;i++){var checkboxVal=PERFORMANCE_AFFECTING_CHECKBOXES[i].getControlValue();if(checkboxVal){isCheckboxEnabled=checkboxVal;break;}}toggleWarn(isCheckboxEnabled);}function OnFileCheckBoxValueChanged(CheckBox){if(CheckBox.m_InitialLoadDone)CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CSessionAttrsLogging."+document.getElementById("LoggingID").value+".FileLogging."+document.getElementById("UserLoggingID").value,updatePerformanceWarning);CheckBox.m_InitialLoadDone=true;}function OnLoggingArchiveLoad(sValue){LogFileArchiveMode.initValue(sValue);}function OnSaveFileLogging(bEnableLogging,CheckBox,bSaveUserorGroup){var SaveFileLogRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".SessionAttrsLogging."+document.getElementById("LoggingID").value);SavingDialog(true);SaveFileLogRequest.setParameter("LogFilePath",LogFilePathInput.getControlValue());SaveFileLogRequest.setParameter("LogFileArchiveMode",LogFileArchiveMode.getItemValue(LogFileArchiveMode.getSelectedItems()[0]));SaveFileLogRequest.setParameter("MaxLogFiles",MaxLogFilesInput.getControlText());SaveFileLogRequest.setParameter("MaxLogFilesBytes",parseInt(parseFloat(MaxLogFilesBytesInput.getControlText())*(1024*1024)));SaveFileLogRequest.setParameter("LogToFile",(LogToFile.getControlValue())?"1":"0");SaveFileLogRequest.setAsync(true);SaveFileLogRequest.response=function(obj,bLeaveSave){nResult=OnSaveComplete(obj,bLeaveSave);if(nResult==g_nSessionOkay&&bSaveUserorGroup){if("Group"=="User"){if(IsValidUser())SaveUser();}else{ValidateSaveGroup();}}};SaveFileLogRequest.request(null);return(false);}function OnLogIPAccess(){EnableDisableUserGroupLogIPAccess();ShowDialog("LogIPAccessListDialog",undefined,EnableDisableUserGroupLogIPAccess);}function OnSaveActivitySettings(){var SaveFileActivityLogRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CSessionAttrsLogging."+document.getElementById("LoggingID").value+".FileLogging."+document.getElementById("UserLoggingID").value);SaveFileActivityLogRequest.setParameter("SecurityMessages",(SecurityMessages.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("IPNames",(IPNames.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("Downloads",(Downloads.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("ZippedDownloads",(ZippedDownloads.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("Uploads",(Uploads.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("FileDeletes",(FileDeletes.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("FileDirRenames",(FileDirRenames.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("DirCreates",(DirCreates.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("DirDeletes",(DirDeletes.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("FTPCommands",(FTPCommands.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("FTPReplies",(FTPReplies.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("SSHCommands",(SSHCommands.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("SSHReplies",(SSHReplies.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("SSHDetailedCommands",(SSHDetailedCommands.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("SSHDetailedReplies",(SSHDetailedReplies.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("HTTPCommands",(HTTPCommands.getControlValue())?"1":"0");SaveFileActivityLogRequest.setParameter("HTTPReplies",(HTTPReplies.getControlValue())?"1":"0");SaveFileActivityLogRequest.setAsync(true);SaveFileActivityLogRequest.response=function(obj,bLeaveSave){OnSaveComplete(obj,bLeaveSave);};SaveFileActivityLogRequest.request(null);return(false);}function OnDownloadLog(){var sLogFile=document.getElementById("CurrentLogFilePath").value;nPos=sLogFile.lastIndexOf("\\");sDir="";if(nPos<0)nPos=sLogFile.lastIndexOf("%5C");if(nPos<0)nPos=sLogFile.lastIndexOf("/");if(nPos<0)nPos=sLogFile.lastIndexOf("%2F");if(nPos<0)sFile=sLogFile;else{if(nPos==0)sFile=sLogFile;else{sDir=sLogFile.substring(0,nPos);sFile=sLogFile.substring(nPos+1);}}var sFileCheckCmd="/?Command=List&Dir="+sDir+"&File="+sFile+'&CsrfToken='+g_sEncXsrfToken;var FileCheckTable=new AW.XML.Table;FileCheckTable.setURL(sFileCheckCmd);FileCheckTable.setRows("//file");FileCheckTable.setColumns(["FileName"]);FileCheckTable.response1=FileCheckTable.response;FileCheckTable.response=function(data){this.response1(data);sFileCheck=this.getData(0,0);if(sFileCheck!=undefined&&Trim(sFileCheck)!="")location.href="/?Command=Download&File="+sLogFile+'&CsrfToken='+"%ENC_CSRF_TOKEN%";else AlertDialog("$SESS_NO_FILES_FOUND_STR$");};if(sDir!="")FileCheckTable.request();else AlertDialog("$SESS_NO_FILES_FOUND_STR$");}function SetLogFileFocus(){LogFilePathInput.getContent("box/text").element().focus();}</script></div><div id="Members" style="display:none"><div id="Members"style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$GROUP_MEMBERS$" src="%ADMIN_FILE%Images/User2-32.png" width="32" height="32" class="header-icon" />$GROUP_MEMBERS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="MembersLayerContent"><span id="MembersList"></span></div><div style="text-align:center;" id="MembersLayerContentContainer"><div id="MembersLayerContentNone" class="UpgradeLicenseMsg"><img id="MembersLayerContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="MembersLayerContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><script type="text/javascript" language="JavaScript">var MembersList=CreateUserGrid("MembersList",undefined,"GroupMembers.xml?ID=%OBJECT_EDIT_ID%","373");var MemberListColumns=[$MEMBERS_LIST_COL_SIZES$];for(var nIndex=0;nIndex<MemberListColumns.length;nIndex++){MembersList.setColumnWidth(parseInt(MemberListColumns[nIndex]),nIndex);}MembersList.setVirtualMode(false);MembersList.EnableUpdates=function(bEnable,sFmtStr,sNewVal){if(bEnable){MembersList.ForceUpdate(sFmtStr,sNewVal);}};aGridCtrls[4]=MembersList;function EnableDisableMembersTab(bDisable,sType){var sDisableMemberText="$GROUP_MEMBERS_WINDOWS_GROUP$";if(sType=="LDAPGroups")sDisableMemberText="$GROUP_MEMBERS_LDAP_GROUP$";if(bDisable)DisableTab("MembersLayerContent",MembersList,sDisableMemberText,true);else EnableTab("MembersLayerContent",MembersList);}</script></div><div id="Events" style="display:none"><div id="EventsLayer" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$EVENTS$" src="%ADMIN_FILE%Images/Command32.png" width="32" height="32" class="header-icon" />$EVENTS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><div id="EventsTabContent"><span id="EventsList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div style="padding:5px 0 0 0;"><span id="ConfigSMTPButton" style="float:right;"></span><span id="AddEventButton"></span><span id="EditEventButton"></span><span id="RemoveEventButton"></span>&nbsp;&nbsp;&nbsp;<span id="CommonEventButton"></span><span id="TestEventButton"></span></div></div><div style="text-align:center;" id="EventsTabContentContainer"><div id="EventsTabContentNone" class="UpgradeLicenseMsg"><img id="EventsTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="EventsTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><script type="text/javascript" language="JavaScript">var g_sEventNameColumn="$NAME$";var g_sEventDescriptionColumn="$DESCRIPTION$";var g_sEventTypeColumn="$EVENT_TYPE$";var g_sEventActionColumn="$EVENTS_ACTION_LABEL$";var g_asEventColWidth=[180,180,180,180];var g_bEventSavingObj=false;var g_sEventRuleVar="$EVENTS_RULE_VAR$";var g_sEventRuleConstant="$EVENTS_RULE_CONSTANT$";var g_sEventRuleComp="$EVENTS_RULE_COMP$";var g_sEventRuleDataType="$EVENTS_RULE_DATA_TYPE$";var g_sRuleIf="$IF$";var g_sAND="$AND$";var g_sOR="$OR$";function GetEventIDText(nEventType){var asEvents={1:"$SUEVENT_ID_SERVER_START_TEXT$",2:"$SUEVENT_ID_SERVER_STOP_TEXT$",3:"$SUEVENT_ID_SECURITY_ALERT_TEXT$",100:"$SUEVENT_ID_DOMAIN_START_TEXT$",101:"$SUEVENT_ID_DOMAIN_STOP_TEXT$",102:"$SUEVENT_ID_SESSION_CONNECT_TEXT$",103:"$SUEVENT_ID_SESSION_DISCONNECT_TEXT$",104:"$SUEVENT_ID_SESSION_CONNECT_FAILURE_TEXT$",200:"$SUEVENT_ID_USER_LOGIN_TEXT$",201:"$SUEVENT_ID_USER_LOGOUT_TEXT$",202:"$SUEVENT_ID_USER_LOGIN_FAILURE_TEXT$",203:"$SUEVENT_ID_USER_PASSWORD_CHANGE_TEXT$",204:"$SUEVENT_ID_USER_PASSWORD_CHANGE_FAILURE_TEXT$",304:"$SUEVENT_ID_IP_ADDR_AUTO_BLOCKED_TIME_TEXT$",305:"$SUEVENT_ID_SESSION_IDLE_TIMEOUT_TEXT$",306:"$SUEVENT_ID_SESSION_TIMEOUT_TEXT$",205:"$SUEVENT_ID_USER_ENABLED_TEXT$",206:"$SUEVENT_ID_USER_DISABLED_TEXT$",207:"$SUEVENT_ID_USER_DELETED_TEXT$",208:"$SUEVENT_ID_USER_ADDED_TEXT$",209:"$SUEVENT_ID_USER_PASSWORD_RECOVERY_SENT_TEXT$",210:"$SUEVENT_ID_USER_PASSWORD_RECOVERY_FAILED_TEXT$",211:"$SUEVENT_ID_USER_PASSWORD_STALE_TEXT$",212:"$SUEVENT_ID_USER_AUTOMATICALLY_DISABLED_TEXT$",213:"$SUEVENT_ID_USER_AUTOMATICALLY_DELETED_TEXT$",214:"$SUEVENT_ID_USER_PREDISABLE_TEXT$",215:"$SUEVENT_ID_USER_PREDELETE_TEXT$",216:"$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_TEXT$",217:"$SUEVENT_ID_USER_EMAIL_ADDRESS_SET_FAILURE_TEXT$",105:"$SUEVENT_ID_LOG_DELETED_TEXT$",106:"$SUEVENT_ID_LOG_ROTATED_TEXT$",107:"$SUEVENT_ID_LISTENER_SUCCESS_TEXT$",109:"$SUEVENT_ID_LISTENER_FAILURE_TEXT$",108:"$SUEVENT_ID_LISTENER_STOP_TEXT$",110:"$SUEVENT_ID_GATEWAY_LISTENER_SUCCESS_TEXT$",112:"$SUEVENT_ID_GATEWAY_LISTENER_FAILURE_TEXT$",111:"$SUEVENT_ID_GATEWAY_LISTENER_STOP_TEXT$",113:"$SUEVENT_ID_PERM_DATA_LISTENER_SUCCESS_TEXT$",115:"$SUEVENT_ID_PERM_DATA_LISTENER_FAILURE_TEXT$",114:"$SUEVENT_ID_PERM_DATA_LISTENER_STOP_TEXT$",116:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_SUCCESS_TEXT$",118:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_FAILURE_TEXT$",117:"$SUEVENT_ID_PERM_DATA_GATEWAY_LISTENER_STOP_TEXT$",300:"$SUEVENT_ID_IP_BLOCKED_TEXT$",301:"$SUEVENT_ID_IP_BLOCKED_TIME_TEXT$",302:"$SUEVENT_ID_TOO_MANY_SESSIONS_TEXT$",303:"$SUEVENT_ID_TOO_MANY_SESSIONS_ON_IP_TEXT$",400:"$SUEVENT_ID_FILE_UPLOAD_TEXT$",401:"$SUEVENT_ID_FILE_UPLOAD_FAIL_TEXT$",402:"$SUEVENT_ID_FILE_DOWNLOAD_TEXT$",403:"$SUEVENT_ID_FILE_DOWNLOAD_FAIL_TEXT$",406:"$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_TEXT$",407:"$SUEVENT_ID_ZIPPED_FILE_DOWNLOAD_FAIL_TEXT$",404:"$SUEVENT_ID_FILE_DELETE_TEXT$",405:"$SUEVENT_ID_FILE_MOVE_TEXT$",500:"$SUEVENT_ID_DIR_CREATE_TEXT$",501:"$SUEVENT_ID_DIR_DELETE_TEXT$",502:"$SUEVENT_ID_DIR_CHANGE_TEXT$",503:"$SUEVENT_ID_DIR_MOVE_TEXT$",600:"$SUEVENT_ID_QUOTA_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",601:"$SUEVENT_ID_DISK_SPACE_OVERAGE_TEXT$",119:"$SUEVENT_ID_FILE_MGMT_RULE_SUCCESS_TEXT$",120:"$SUEVENT_ID_FILE_MGMT_RULE_ERROR_TEXT$",121:"$SUEVENT_ID_FILE_MGMT_RULE_MOVE_FILE_TEXT$"};if(asEvents[nEventType])return(asEvents[nEventType]);else return(nEventType);}function GetEventActionText(nActionType){var asActions=["$SUEVENT_ACTION_EMAIL_TEXT$","$SUEVENT_ACTION_BALLOON_TIP_TEXT$","$SUEVENT_ACTION_EXEC_TEXT$","$SUEVENT_ACTION_WRITE_EVENT_LOG_TEXT$","$SUEVENT_ACTION_MSMQ_WRITE_TEXT$"];if(asActions[nActionType])return(asActions[nActionType]);else return(nActionType);}function OnSMTPConfigAlert(){AlertDialog("$SMTP_CONFIG_WARN$");}var bSetEventGridHeight=true;var g_bServerDomain=false;switch(sEventObjectType.toLowerCase()){case"server":case"domain":g_asEventColWidth=[180,180,180,180];bSetEventGridHeight=false;g_bServerDomain=true;break;default:g_asEventColWidth=[120,170,120,130];bSetEventGridHeight=true;break;}var EventsList=CreateEventsGrid("EventsList","GroupEvents.xml?ID=%OBJECT_EDIT_ID%",OnEditEvent,g_asEventColWidth);var sOnEditEvent=String("OnEditEvent(");var sOnAddEvent=String("OnAddEvent(");var sOnDeleteEvent=String("OnRemoveEvent(");var sOnEnableEvent=String("OnEnableDisableEvent(1,");var sOnDisableEvent=String("OnEnableDisableEvent(0,");CreateContextMenu([sOnAddEvent,sOnEditEvent,sOnDeleteEvent,sOnEnableEvent,sOnDisableEvent],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(EventsList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(EventsList,"$DELETE_BUTTON$"))},OnEnableEventContextMenu,OnDisableEventContextMenu],["New","Edit","FileDelete",OnEnableEventContextImage,OnDisableEventContextImage],EventsList,"EventsListContext",true);EventsList.onKeyDelete=OnRemoveEvent;if(bSetEventGridHeight){var nEventsListHeight=345;if(AW.unix)nEventsListHeight=(nEventsListHeight-5);EventsList.setStyle("height",nEventsListHeight+"px");}CreatePushButton("$ADD_BUTTON$...","AddEventButton",OnAddEvent);CreatePushButton("$EDIT_BUTTON$...","EditEventButton",OnEditEvent);CreatePushButton("$DELETE_BUTTON$","RemoveEventButton",OnRemoveEvent);CreatePushButton("$CREATE_COMMON_EVENTS_BUTTON$...","CommonEventButton",OnCreateCommonEvents);CreatePushButton("$TEST_EVENTS_BUTTON$","TestEventButton",OnTestEvent);var fnSMTPConfig=(g_bServerDomain)?OnSMTPConfig:OnSMTPConfigAlert;var SMTPButton=CreatePushButton("$CONFIG_SMTP_BUTTON$...","ConfigSMTPButton",fnSMTPConfig);SMTPButton.setControlImage("SMTP_Icon");if(!g_bServerDomain)SMTPButton.setStyle("display","none");if((parseInt("%CServer.%SERVER_ID%.EventLicense%")!=1)&&(sEventObjectType.toLowerCase()!="server"))DisableTab("EventsTabContent",EventsList);function OnEnableDisableEvent(bEnable){var EditCells=new Array();EditCells=EventsList.getSelectedRows().toString().split(",");var EventEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(EventsList.getCellData((EventsList.m_nNumColumns-1),EditCells[nIndex]));EventEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".SUEvent."+nObjectID+"&StaticOnly=1");EventEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;EventEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;EventEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);EventEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};EventEnabledDisabledRequest[nIndex].request(null);}}function OnEnableEventContextMenu(){if(EventEnableOrDisable()[1]&&EventsList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_EVENT$";else sMenuItemName="";return(sMenuItemName);}function OnDisableEventContextMenu(){if(EventEnableOrDisable()[0]&&EventsList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_EVENT$";else sMenuItemName="";return(sMenuItemName);}function OnEnableEventContextImage(){if(EventEnableOrDisable()[1])sImageClass="LSTNEnabled";else sImageClass="";return(sImageClass);}function OnDisableEventContextImage(){if(EventEnableOrDisable()[0])sImageClass="LSTNDisabled";else sImageClass="";return(sImageClass);}function EventEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=EventsList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(EventsList.getCellText(9,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}function OnAddEvent(){g_bEventSavingObj=false;EventsList.OnAddObject("Event.xml%ADD_OBJECT_REF%CGroup."+g_EditObjectID+".SUEvent&Temp=1","Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".SUEvent.",document.EventsForm,"EventsDialog",[OnEventLoad,OnHideEventsDialog],g_bReadOnlyAccess);}function OnEditEvent(){g_bEventSavingObj=false;EventsList.OnEditObject("Event.xml?Command=CreateTempObject&Object=CGroup."+g_EditObjectID+".SUEvent.","Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".SUEvent.",document.EventsForm,"EventsDialog","$SELECT_ONLY_ONE_EVENT_EDIT$","$SELECT_ONE_EVENT_EDIT$",[OnEventLoad,OnHideEventsDialog],true);}function OnRemoveEvent(){EventsList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CGroup."+g_EditObjectID+".SUEvent&ID=%ID%","$ASK_DELETE_EVENT$","$SELECT_ONE_EVENT_DELETE$");}function OnViewLog(){OnShowLogDialog();}function OnTestEvent(){if((EventsList.getSelectedRows()!="")&&(EventsList.getSelectedRows()!=-1)){var TestCells=new Array();TestCells=EventsList.getSelectedRows().toString().split(",");if(TestCells.length==1){nTestObjectID=parseInt(EventsList.getCellData((EventsList.m_nNumColumns-1),TestCells[0]));var sTestEventsCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CSUEvent."+nTestObjectID+".Test";var TestEventsRequest=CreatePostRequest(sTestEventsCmd);TestEventsRequest.setAsync(true);TestEventsRequest.request();TestEventsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");
var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else{AlertDialog("$EVENT_DISPATCHED_SUCCESS$",undefined,undefined,undefined,"$VIEW_LOG$",OnViewLog);}};}else WarnDialog("$SELECT_ONLY_ONE_EVENT_TEST$");}else WarnDialog("$SELECT_ONE_EVENT_TEST$");}</script></div><div id="IPAccess" style="display:none"><div id="ipaccess" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$IPACCESS$" src="%ADMIN_FILE%Images/IpAccess32.png" width="32" height="32" class="header-icon" />$GROUP_IP_ACCESS_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><table border="0" cellpadding="0" cellspacing="0"><tr><td style="width:100%;"><span id="IPAccessList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span></td><td style="width:auto;padding-left:10px;"><span id="IPAccessTopArrow"></span><br /><span id="IPAccessUpArrow"></span><br /><br /><span id="IPAccessDownArrow"></span><br /><span id="IPAccessBottomArrow"></span></td></tr></table><div style="padding:5px 28px 0 0;"><span id="ExportIPButton" style="float:right;"></span><span id="ImportIPButton" style="float:right;"></span><span id="AddIPButton"></span><span id="EditIPButton"></span><span id="RemoveIPButton"></span>&nbsp;&nbsp;&nbsp;<span id="IPSortCheckbox"></span></div></div></div><script type="text/javascript" language="JavaScript">var sConfirmSortIpMsg="$CONFIRM_SORT_IP$";var IPAccessList=CreateIPAccessGrid("IPAccessList","GroupIPAccess.xml?ID=%OBJECT_EDIT_ID%",OnEditIPAccess);IPAccessList.onKeyDelete=OnRemoveIPAccess;var sOnEditIPAccess=String("OnEditIPAccess(");var sOnAddIPAccess=String("OnAddIPAccess(");var sOnRemoveIPAccess=String("OnRemoveIPAccess(");CreateContextMenu([sOnEditIPAccess,"",sOnAddIPAccess,sOnRemoveIPAccess],[function(){return(OnEqualOneContextMenu(IPAccessList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(IPAccessList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(IPAccessList,"$DELETE_BUTTON$"))}],["Edit","","New","FileDelete"],IPAccessList,"IPAccessListContext",true);var nIPAccessListHeight=345;if(AW.unix)nIPAccessListHeight=(nIPAccessListHeight-5);IPAccessList.setStyle("height",nIPAccessListHeight+"px");aGridCtrls[6]=IPAccessList;var SortCheckbox=CreateCheckBox("$ENABLE_SORT_VIEW$","IPSortCheckbox","IPSort",false,OnSortCheckBoxValueChanged);CreatePushButton("$ADD_BUTTON$...","AddIPButton",OnAddIPAccess);CreatePushButton("$EDIT_BUTTON$","EditIPButton",OnEditIPAccess);CreatePushButton("$DELETE_BUTTON$","RemoveIPButton",OnRemoveIPAccess);IPAccessList.InitObjectMove(["IPAccessTopArrow","IPAccessUpArrow","IPAccessDownArrow","IPAccessBottomArrow"],"CGroup.$EDIT_OBJECT_ID$.IPAccess",GetEditObjectID);function OnAddIPAccess(){IPAccessList.OnAddObject("IPAccess.xml%DEFAULT_OBJECT_REF%CGroup."+g_EditObjectID+".IPAccess","Result.xml%ADD_OBJECT_REF%CGroup."+g_EditObjectID+".IPAccess",document.IPAccessForm,"IPAccessDialog",[OnIPAccessLoad],g_bReadOnlyAccess);}function OnEditIPAccess(){IPAccessList.OnEditObject("IPAccess.xml","Result.xml%UPDATE_OBJECT_REF%CGroup."+g_EditObjectID+".IPAccess.",document.IPAccessForm,"IPAccessDialog","$SELECT_ONLY_ONE_IPACCESS_EDIT$","$SELECT_ONE_IPACCESS_EDIT$",[OnIPAccessLoad]);}function OnRemoveIPAccess(){IPAccessList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CGroup."+g_EditObjectID+".IPAccess&ID=%ID%","$ASK_DELETE_IPACCESS$","$SELECT_ONE_IPACCESS_DELETE$");}function OnExportIPDone(sFilePath){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();nLen=nCountFormatted.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));AlertDialog(nCountFormatted+" $IP_EXPORT_MSG$<br><br>"+this.FilePathName);}else{AlertDialog(GetResultText(nResult,"",sResultText));}}function OnImportIPDone(){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){var nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();var nLen=nCountFormatted.length;var nTotalUsersInFile=new Number(parseInt(nCountFormatted)).toLocaleString();var nTotalUsersInFileLen=nTotalUsersInFile.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));if(nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==".00"||nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==",00")nTotalUsersInFile=nTotalUsersInFile.substr(0,(nTotalUsersInFileLen-3));sImportStr=nCountFormatted+" $OF$ "+nTotalUsersInFile+" $IP_IMPORT_MSG$<br><br>"+this.FilePathName;AlertDialog(sImportStr);}else AlertDialog(GetResultText(0,"",sResultText));}function OnImportIPAccess(sFilePath){var ImportIPObj=undefined;var sImportFile=sFilePath;if(Trim(sImportFile)!=""){if(ImportIPObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CGroup."+g_EditObjectID+".ImportIPAccess"),OnImportIPDone)){ImportIPObj.setParameter("File",sImportFile);ImportIPObj.FilePathName=sImportFile;SavingDialog(true);ImportIPObj.request();}}}function OnExportIPAccess(sFilePath){CloseConfirmDialog();var ExportUsersObj=undefined;var sExportFile=sFilePath;sExportType=g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CGroup."+g_EditObjectID+".ExportIPAccess";if(Trim(sExportFile)!=""){if(ExportUsersObj=createAWHttpRequest("POST",(sExportType),OnExportIPDone)){ExportUsersObj.setParameter("File",sExportFile);ExportUsersObj.FilePathName=sExportFile;SavingDialog(true);ExportUsersObj.request();}}}var ImportIPButton=CreatePushButton("$IMPORT_BUTTON$...","ImportIPButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnImportIPAccess]],"ImportDB");var ExportIPButton=CreatePushButton("$EXPORT_BUTTON$...","ExportIPButton",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnExportIPAccess]],"ExportDB");</script></div><div id="Limits" style="display:none">
<!--#include "..\Strings\LimitsStrings.strings"-->
<div id="limits" style="width:100%"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$LIMIT_LABEL$" src="%ADMIN_FILE%Images/Limits32.png" width="32" height="32"/></td><td style="vertical-align:top;">$GROUP_LIMITS_TAB_INFO$</td></tr></table><div style="clear:both;padding-bottom:5px;">$LIMIT_TYPE$:<div style="overflow:auto"><span id="LimitType"></span></div></div><div id="LimitsListContain"><span id="LimitsList"></span></div><div style="padding-top:5px;width:100%"><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><span id="AddLimitButton"></span><span id="EditLimitButton"></span><span id="DeleteLimitButton"></span></td><td style="text-align:right;"><span id="RatioQuotasButton"></span><span id="RatioFreeFilesButton" ></span></td></tr></table></div></div></div><script type="text/javascript" language="JavaScript">var g_bAllowWindowsDrives=("%WINDOWS_DRIVES%"!="0");var g_bWindowsDirListingMask=("%WINDOWS_DIR_LISTING_MASK%"!="0");var g_bWindowsShortcutStrings=("%WINDOWS_SHORTCUTS%"!="0");var g_bSupportsChangeOwner=("%SUPPORTS_CHOWN%"!="0");var g_bSupportsInterpretLFASEOL=("%SUPPORTS_INTERPRET_LF_AS_EOL%"!="0");var g_bPauseRefresh=false;AW.Formats.LimitName=AW.Formats.String.subclass();AW.Formats.LimitName.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(g_asLimitStrings[String(data)]);};obj.dataToValue=function(data){return(this.dataToText(data));};};AW.Formats.LimitValue=AW.Formats.String.subclass();AW.Formats.LimitValue.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nCol,nRow){var nScale=parseInt(Grid.getCellData(7,nRow));if((isNaN(nScale))||(nScale<1))nScale=1;return(FormatLimitValue(data,Grid.getCellData(6,nRow),nScale,Grid.getCellData(0,nRow)));};obj.dataToValue=function(data,Grid,nCol,nRow){return(this.dataToText(data,Grid,nCol,nRow));};};AW.Formats.LimitTOD=AW.Formats.String.subclass();AW.Formats.LimitTOD.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nCol,nRow){return(FormatAppliedDayTime(String(data),Grid.getCellData(3,nRow),Grid.getCellData(4,nRow),Grid.getCellData(5,nRow)));};obj.dataToValue=function(data,Grid,nCol,nRow){return(this.dataToText(data,Grid,nCol,nRow));};};var g_sCurrentLimitCat="";var g_asLangVals=["en,US","de,DE","it,IT","fr,FR","es,ES","pt,PT","sr,SR","se,SE","fi,FI","no,NO","ru,RU","dk,DK","zh,CN","zh,TW","jp,JP"];;var g_asLangStrings=["$ENGLISH$","$GERMAN$","$ITALIAN$","$FRENCH$","$SPANISH$","$PORTUGUESE$","$SERBIAN$","$SWEDISH$","$FINISH$","$NORWEGIAN$","$RUSSIAN$","$DANISH$","$SIMPLIFIED_CHINESE$","$TRADITIONAL_CHINESE$","$JAPANESE$"];var sLimitTargetTxt="$LIMIT_DL_SCASTARGET$";var sLimitShrtCtLinkTxt="$LIMIT_DL_SCLINKS$";if(!g_bWindowsShortcutStrings){sLimitTargetTxt="$LIMIT_DL_SCASTARGET_NON_WIN_OS$";sLimitShrtCtLinkTxt="$LIMIT_DL_SCLINKS_NON_WIN_OS$";}var g_asLimitStrings={"AllowNonRFCSSHProtoVersionExchange":"$ALLOW_NON_RFC_SSH_PROTOCOL_VERSION_EXCHANGE_ID$","ConvertURLChars":"$LIMIT_ADV_CONVERTURLCHARS$","CheckDirSizePeriodically":"$LIMIT_ADV_CHECKDIRSIZE$","InlineOutOfBand":"$LIMIT_ADV_INLINEOOB$","SendKeepAlive":"$LIMIT_ADV_KEEPALIVE$","DisableNagle":"$LIMIT_ADV_NAGLE$","UploadAdaptiveTimeout":"$LIMIT_ADV_ADAPTIVETO$","MaxServerSessions":"$LIMIT_CONN_MAXSERVERSESS$","MaxServerSessionsIP":"$LIMIT_CONN_MAXSERVERSESSIP$","MaxDomainSessions":"$LIMIT_CONN_MAXDOMAINSESS$","MaxDomainSessionsIP":"$LIMIT_CONN_MAXDOMAINSESSIP$","MaxGroupSessions":"$LIMIT_CONN_MAXGROUPSESS$","MaxGroupSessionsIP":"$LIMIT_CONN_MAXGROUPSESSIP$","MaxSessionsPerUser":"$LIMIT_CONN_MAXSESSUSER$","MaxSessionsIPPerUser":"$LIMIT_CONN_MAXSESSIPUSER$","RequireSecure":"$LIMIT_CONN_REQUIRESECURE$","IdleTimeSeconds":"$LIMIT_CONN_IDLETO$","SessTimeoutSeconds":"$LIMIT_CONN_SESSTO$","BlockAntiTimeout":"$LIMIT_CONN_BLOCKANTITO$","AutoCreateHomeDir":"$LIMIT_CONN_AUTOCREATE$","NaturalSort":"$LIMIT_DL_NATURALSORT$","HideHidden":"$LIMIT_DL_HIDEHIDDEN$","LowerCaseFileNames":"$LIMIT_DL_LOWERCASE$","WindowsShortCutsAsLinks":sLimitShrtCtLinkTxt,"TreatWindowsShortCutsAsTarget":sLimitTargetTxt,"LockInHomeDir":"$LIMIT_DL_LOCK$","RootIsDrives":"$LIMIT_DL_ROOT$","HideCompressedState":"$LIMIT_DL_COMP_STATE$","HideEncryptedState":"$LIMIT_DL_ENCRYPT_STATE$","DirMessage":"$LIMIT_DL_DIR_MSG$","HTTPLoginPageDefaultLanguage":"$LIMIT_ADV_DEFAULT_LANG$","CheckAnonymousPassword":"$LIMIT_PW_CHECKANON$","RequireComplexPasswords":"$LIMIT_PW_REQCOMPLEX$","MinPasswordLen":"$LIMIT_PW_MINLENGTH$","PasswordExpiresDays":"$LIMIT_PW_EXPIRES$","PasswordChange":"$LIMIT_PW_CHANGE$","EncryptPasswords":"$LIMIT_PW_ENCRYPT$","HidePasswordInLog":"$LIMIT_PW_HIDEINLOG$","SSHAuthType":"$LIMIT_PW_SSHAUTHTYPE$","PasswordType":"$LIMIT_PW_TYPE$","ServerDomainDirAccessFirst":"$LIMIT_ADV_SERV_DOM_DIR_ACCESS$","EnablePasswordRecovery":"$LIMIT_PW_ENABLE_RECOVERY$","AllowRenameOverwrite":"$LIMIT_ADV_ALLOWRENAMEOVERWRITE$","WarnOldBrowser":"$LIMIT_ADV_WARNOLDBROWSER$","RequireReverseDNSName":"$LIMIT_CONN_REQ_REV_DNS$","SFTPMaxVersion":"$LIMIT_ADV_SFTPMAXVERSION$","MaxServerUploadRate":"$LIMIT_TRAN_SERVERUP$","MaxServerDownloadRate":"$LIMIT_TRAN_SERVERDN$","MaxDomainUploadRate":"$LIMIT_TRAN_DOMAINUP$","MaxDomainDownloadRate":"$LIMIT_TRAN_DOMAINDN$","MaxGroupUploadRate":"$LIMIT_TRAN_GROUPUP$","MaxGroupDownloadRate":"$LIMIT_TRAN_GROUPDN$","MaxUserUploadRate":"$LIMIT_TRAN_USERUP$","MaxUserDownloadRate":"$LIMIT_TRAN_USERDN$","MaxSessionUploadRate":"$LIMIT_TRAN_SESSUP$","MaxSessionDownloadRate":"$LIMIT_TRAN_SESSDN$","MaxUploadFileSize":"$LIMIT_TRAN_MAX_FILE_SIZE$","DeletePartiallyUploaded":"$LIMIT_TRAN_DELETEPARTIAL$","InterpretLFasEOL":"$LIMIT_TRAN_INTERPRETLFASEOL$","AllowHTTPMediaPlayback":"$LIMIT_TRAN_ALLOWMEDIAPLAY$","AllowRememberMe":"$LIMIT_HTTP_ALLOW_REMEMBER_ME$","ShowLanguage":"$LIMIT_HTTP_ALLOW_SHOW_LANG$","MaintainHTTPUploadTimes":"$LIMIT_HTTP_MAINTAIN_UL_TIMES$","AllowHTTPIPAddressChange":"$LIMIT_HTTP_ALLOW_IP_CHANGE$","TimeoutBlockIPSeconds":"$LIMIT_CONN_TIMEOUTBLOCKIP$","FTP":"$LIMIT_CONN_FTP$","SSH":"$LIMIT_CONN_SSH$","HTTP":"$LIMIT_CONN_HTTP$","AllowXForwardedFor":"$LIMIT_CONN_ALLOWXFORWARD$","HideVersionInHeader":"$LIMIT_HTTP_HIDE_VERSION_IN_HEADER$","AllowAutoCompleteForLoginFields":"$LIMIT_HTTP_ALLOW_AUTOCOMPLETE_IN_LOGIN_FIELDS$","UseHTTPStrictTransportSecurity":"$LIMIT_HTTP_USE_HSTS$","DisableHTTPCompression":"$LIMIT_HTTP_DISABLE_COMPRESSION$","SSHFileFlushFrequency":"$LIMIT_UPLOADED_FILE_FLUSH_PERIOD$","AllowPermittedCrossDomainPolicies":"$LIMIT_ALLOW_PERMITTED_CROSS_DOMAIN_POLICIES$","UploadFileMode":"$LIMIT_TRAN_UPLOAD_FILE_MODE$","DownloadFileMode":"$LIMIT_TRAN_DOWNLOAD_FILE_MODE$","MaxSimulThumbnails":"$LIMIT_TRAN_MAX_SIMUL_THUMBS$","DirListingMask":"$LIMIT_DL_DIR_LIST_MASK$","FileOwner":"$LIMIT_ADV_FILE_OWNER$","FileGroup":"$LIMIT_ADV_FILE_GROUP$","ResetUserStatsAfterRestart":"$LIMIT_ADV_RESET_USER_STATS_RESTART$","ResetGroupStatsAfterRestart":"$LIMIT_ADV_RESET_GROUP_STATS_RESTART$","AllowWebClient":"$LIMIT_HTTP_ALLOW_WEB_CLIENT$","AllowWebClientPro":"$LIMIT_HTTP_ALLOW_WEB_CLIENT_PRO$","AllowFTPVoyagerJV":"$LIMIT_HTTP_ALLOW_FVJV$","PasswordStaleDays":"$LIMIT_PW_STALE_DAYS$","DisablePasswordGenerators":"$LIMIT_PW_DISABLE_GENERATORS$","PreDisableDays":"$LIMIT_ADV_PRE_DISABLE_DAYS$","PreDeleteDays":"$LIMIT_ADV_PRE_DELETE_DAYS$","DisableBranding":"$LIMIT_HTTP_DISABLE_BRANDING$","EmailAddressSet":"$LIMIT_EMAIL_ALLOW_SET$","RequireEmailAddressSet":"$LIMIT_EMAIL_REQUIRE_SET$","RequirePasswordForGuests":"$LIMIT_ADHOC_REQUIRE_PWORD_FOR_GUESTS$","InsertPasswordInEmailInvite":"$LIMIT_ADHOC_INSERT_PWORD_IN_EMAIL$","MaxGuestUploadFileSize":"$LIMIT_ADHOC_MAX_GUEST_UPLOAD_FILE_SIZE$","AllowUserDefinedGuestAccess":"$LIMIT_ADHOC_ALLOW_USER_DEF_GUEST_LINK_EXPIRATION$","RestrictGuestAccessDays":"$LIMIT_ADHOC_MAX_GUEST_LINK_EXPIRATION$","NotifyAfterGuestDownload":"$LIMIT_ADHOC_NOTIFY_AFTER_GUEST_DOWNLOAD$","NotifyAfterGuestUpload":"$LIMIT_ADHOC_NOTIFY_AFTER_GUEST_UPLOAD$","SendAccessLinkToRecipients":"$LIMIT_ADHOC_SEND_LINK_TO_RECIPIENTS$","SendAccessLinkToSender":"$LIMIT_ADHOC_SEND_LINK_TO_SENDER$","AllowFileSharing":"$LIMIT_ADHOC_ALLOW_FILE_SHARING$","AllowCustomContactInfo":"$LIMIT_ADHOC_ALLOW_CUSTOM_CONTACT_INFO$","AdHocMaxNumOfFilesInSentShare":"$LIMIT_ADHOC_MAX_FILES_IN_SENT_SHARE$","AdHocMaxNumOfFilesInRequestedShare":"$LIMIT_ADHOC_MAX_FILES_IN_REQUESTED_SHARE$","AdHocAllowedOutgoingSource":"$LIMIT_ADHOC_ALLOWED_OUTGOING_SOURCE$"};var g_asLimitComboStrings={"SSHAuthType":["$SSH_AUTH_TYPE_PWD_AND_PUB$","$SSH_AUTH_TYPE_PWD_OR_PUB$","$SSH_AUTH_TYPE_PUB$","$SSH_AUTH_TYPE_PWD$"],"PasswordType":["$PASSWORD_REGULAR_DESC$","$PASSWORD_MD4_DESC$","$PASSWORD_MD5_DESC$"],"HTTPLoginPageDefaultLanguage":g_asLangStrings,"UploadFileMode":["$FILE_MODE_READ$","$FILE_MODE_DENY$","$FILE_MODE_FULL$"],"DownloadFileMode":["$FILE_MODE_READ$","$FILE_MODE_DENY$","$FILE_MODE_FULL$"],"RequirePasswordForGuests":["$ADHOC_LIMIT_OPTIONAL$","$ADHOC_LIMIT_ALWAYS$","$ADHOC_LIMIT_NEVER$"],"InsertPasswordInEmailInvite":["$ADHOC_LIMIT_OPTIONAL$","$ADHOC_LIMIT_ALWAYS$","$ADHOC_LIMIT_NEVER$"],"NotifyAfterGuestDownload":["$ADHOC_LIMIT_OPTIONAL$","$ADHOC_LIMIT_ALWAYS$","$ADHOC_LIMIT_NEVER$"],"NotifyAfterGuestUpload":["$ADHOC_LIMIT_OPTIONAL$","$ADHOC_LIMIT_ALWAYS$","$ADHOC_LIMIT_NEVER$"],"SendAccessLinkToRecipients":["$ADHOC_LIMIT_OPTIONAL$","$ADHOC_LIMIT_ALWAYS$","$ADHOC_LIMIT_NEVER$"],"SendAccessLinkToSender":["$ADHOC_LIMIT_OPTIONAL$","$ADHOC_LIMIT_ALWAYS$","$ADHOC_LIMIT_NEVER$"],"AdHocAllowedOutgoingSource":["$ADHOC_ADHOC_ALLOWED_OUTGOING_SOURCE_0$","$ADHOC_ADHOC_ALLOWED_OUTGOING_SOURCE_1$","$ADHOC_ADHOC_ALLOWED_OUTGOING_SOURCE_2$"]};CreatePushButton("$ADD_BUTTON$...","AddLimitButton",OnAddLimit);CreatePushButton("$EDIT_BUTTON$...","EditLimitButton",OnEditLimit);CreatePushButton("$DELETE_BUTTON$","DeleteLimitButton",OnDeleteLimit);if("Group"=="Group")CreatePushButton("$EDIT_RATIO_FREE_FILES$...","RatioFreeFilesButton",OnEditRatioFreeFiles);else if("Group"=="User"){CreatePushButton("$EDIT_RATIO_FREE_FILES$...","RatioFreeFilesButton",OnEditRatioFreeFiles);CreatePushButton("$RATIOS_QUOTAS_BUTTON$...","RatioQuotasButton",OnShowRatioQuota);}var aLimitTypeStr=[];var aLimitTypeName=[];aLimitTypeStr=["$CONNECTION_LIMIT$","$PASSWORD_LIMIT$","$DIR_LIST_LIMIT$","$TRANSFER_LIMIT$","$LISTENER_TYPE_HTTP_DESC$","$EMAIL_LIMIT$","$FILE_SHARING$","$ADVANCED_LIMIT$"];aLimitTypeName=["Connection","Password","DirList","Transfer","HTTP","Email","FileSharing","Advanced"];var LimitCatCombo=CreateComboBox("$CONNECTION_LIMIT$","Connection",aLimitTypeStr,aLimitTypeName,"LimitType","LimitType",OnChangeLimitType,undefined,false,200);LimitCatCombo.getPopupTemplate().setStyle("height",(aLimitTypeName.length<=10)?((16*aLimitTypeName.length)+((AW.ie)?3:0))+"px":"163px");LimitCatCombo.onControlActivated=function(event){g_bPauseRefresh=true;};LimitCatCombo.onControlDeactivating=function(event){g_bPauseRefresh=false;};var LimitsList=CreateAdminGrid("LimitsList",["$NAME$","$VALUE$","$LIMIT_APPLIED_TOD$"],[$LIMITS_LIST_COL_SIZES$],"","limits","var",10,OnEditLimit);LimitsList.m_nTimerMS=5000;LimitsList.onKeyDelete=OnDeleteLimit;LimitsList.setCellFormat([new AW.Formats.LimitName,new AW.Formats.LimitValue,new AW.Formats.LimitTOD]);LimitsFilterGrid();function LimitsFilterGrid(){var sFilterServerAdminLimits="";var sFilterServerWindowAdminLimits="";var sFilterChangeOwnerLimits="";var sFilterWinLDAP="";if(!g_bSysAdmin){sFilterServerAdminLimits="*0";sFilterServerWindowAdminLimits=",3";}if(!g_bSupportsChangeOwner)sFilterChangeOwnerLimits=",4";if(!g_bSupportsInterpretLFASEOL)sFilterChangeOwnerLimits=sFilterChangeOwnerLimits+",5";if(!g_bAllowWindowsDrives&&!g_bWindowsDirListingMask){LimitsList.FilterGrid("[^1,2"+sFilterChangeOwnerLimits+sFilterServerWindowAdminLimits+"]",11,true,true);}else if(!g_bAllowWindowsDrives){LimitsList.FilterGrid("[^1"+sFilterChangeOwnerLimits+sFilterServerWindowAdminLimits+"]",11,true,true);}else if(!g_bWindowsDirListingMask){LimitsList.FilterGrid("[^2"+sFilterChangeOwnerLimits+sFilterServerWindowAdminLimits+"]",11,true,true);}else if(!g_bSupportsChangeOwner){LimitsList.FilterGrid("[^4"+sFilterServerWindowAdminLimits+"]",11,true,true);}else if(!g_bSupportsInterpretLFASEOL){LimitsList.FilterGrid("[^5"+sFilterServerWindowAdminLimits+"]",11,true,true);}else LimitsList.FilterGrid(sFilterServerAdminLimits,10,true,true);}LimitsList.getCellImage=function(nCol,nRow){return("Limit");};LimitsList.m_XMLTable.setColumns(["@name","@val","@todLimit","@todStart","@todEnd","@todDays","@type","@scale","@inherited","@ID","@admintype","@OStype"]);LimitsList.EnableUpdatesDef=LimitsList.EnableUpdates;LimitsList.EnableUpdates=function(bEnable,sFmtStr,sNewVal,bReplaceOrigURL){if(bEnable)UpdateLimitsURL();LimitsList.EnableUpdatesDef(bEnable,sFmtStr,sNewVal,bReplaceOrigURL);};LimitsList.setSelectionMode("single-row");LimitsList.setSelectionMultiple(false);LimitsList.defineRowProperty("row-color",function(nRow){return(this.getCellData(8,nRow)=="1")?"#e9f1f5":"white"});LimitsList.getRowTemplate().setStyle("background",function(){return(this.getRowProperty("row-color"))});LimitsList.onSelectedRowsChanging=function(array){if(this.getSelectedRows().length)this.getRowTemplate(this.getSelectedRows()[0]).setStyle("background",function(){return(this.getRowProperty("row-color"))});};LimitsList.onSelectedRowsChanged=function(anSelectedRows){if(anSelectedRows.length)this.getRowTemplate(anSelectedRows[0]).setStyle("background","#316ac5");};function SetLimitListFocus(){g_bPauseRefresh=false;}if(document.attachEvent)document.getElementById("LimitsListContain").attachEvent("onmousedown",SetLimitListFocus);else document.getElementById("LimitsListContain").addEventListener("mousedown",SetLimitListFocus,false);LimitsList.RestoreRowState=function(){this.m_bRestoredCurrent=false;if((this.m_anSelectedObjects!=undefined)&&(this.m_anSelectedObjects.length)){var nSelID=this.m_anSelectedObjects[0];for(var nIndex=0;nIndex<this.getRowCount();nIndex++){if(parseInt(this.getCellData((this.m_nNumColumns-1),nIndex))==nSelID){this.setRowSelected(true,nIndex);this.setSelectedRows([nIndex]);this.setCurrentRow(nIndex);this.m_nCurrentObj=-1;this.m_bRestoredCurrent=true;}else this.getRowTemplate(nIndex).setStyle("background",function(){return(this.getRowProperty("row-color"))});}this.m_anSelectedObjects=undefined;}if(!g_bPauseRefresh){try{this.element().focus();}catch(ex){}}};var sOnAddLimit=String("OnAddLimit(");var sOnEditLimit=String("OnEditLimit(");var sOnDeleteLimit=String("OnDeleteLimit(");var g_bDefaultLimitAdd=false;CreateContextMenu([sOnAddLimit,sOnEditLimit,sOnDeleteLimit],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(LimitsList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(LimitsList,"$DELETE_BUTTON$"))}],["Add","Edit","FileDelete"],LimitsList,"LimitsListContext",true);function OnChangeLimitType(sValue,bSkipLoading,bForce){if((bForce)||(sValue!=g_sCurrentLimitCat)){LoadingDialog(true);LimitsList.setSelectedRows([]);ClearGrid(LimitsList);UpdateLimitsURL(sValue);LimitsList.m_bSaving=true;g_sCurrentLimitCat=sValue;LimitsList.ForceUpdate();}}function UpdateLimitsURL(sValue){if((sValue==undefined)||(sValue=="")){var nSelectedItem=LimitCatCombo.getSelectedItems();sValue=LimitCatCombo.getItemValue(nSelectedItem);LimitCatCombo.setControlText(LimitCatCombo.getItemText(nSelectedItem));}if("Group"=="Group"&&((g_sActiveGroupType=="OUGroups"||g_sActiveGroupType=="LDAPGroups")&&sValue=="Password"))sValue="WinLDAPPassword";LimitsList.ChangeURL("Limits/Group"+sValue+"Limits.xml?ID="+GetEditObjectID());}function FormatAppliedDayTime(sLimited,sStart,sEnd,sDays){var asDayAbbrevs=["$MONDAY_ABBREV$","$TUESDAY_ABBREV$","$WEDNESDAY_ABBREV$","$THURSDAY_ABBREV$","$FRIDAY_ABBREV$","$SATURDAY_ABBREV$","$SUNDAY_ABBREV$"];var sLimitedStr="";if(sLimited=="1"){sLimitedStr=FormatTODTime(sStart)+" - "+FormatTODTime(sEnd);}else{sLimitedStr="$LIMIT_NOT_LIMITED$";}for(var nIndex=0;nIndex<sDays.length;nIndex++){if(sDays.charAt(nIndex)=="1")sLimitedStr+=", "+asDayAbbrevs[nIndex];}return(sLimitedStr);}function FormatTODTime(sMilliseconds){var nTotalMinutes=(parseInt(sMilliseconds)/1000/60);var nHours=parseInt(nTotalMinutes/60),nMinutes=parseInt(nTotalMinutes % 60);var sTime="$LOCALE_TIME_FORMAT$",sTemp="";if(sTime.indexOf("%I")>=0){if(sTime.indexOf("%p")>=0)sTime=sTime.replace(eval("/%p/g"),((nHours>=12)?"$TIME_PM$":"$TIME_AM$"));if(nHours>12)sTemp=(nHours-12);else if(nHours==0)sTemp=12;else sTemp=nHours;sTime=sTime.replace(eval("/%I/g"),sTemp);}else if(sTime.indexOf("%H")>=0){if(nHours<10)sTemp="0"+nHours;else sTemp=nHours;sTime=sTime.replace(eval("/%H/g"),sTemp);}if(sTime.indexOf("%M")>=0){if(nMinutes>10)sTemp=nMinutes;else sTemp="0"+nMinutes;sTime=sTime.replace(eval("/%M/g"),sTemp);}return(sTime);}function FormatLimitValue(sValue,sType,sScale,sName){var sRet=decodeURIComponent(sValue);var nValue=parseInt(sValue);var nScale=parseInt(sScale);var sLimitName=sName;if(isNaN(nValue))nValue=0;switch(parseInt(sType)){case(0):sRet=(sValue=="1")?"$YES_BUTTON$":"$NO_BUTTON$";break;case(1):var fValue=parseFloat(sValue);if(fValue==0)sRet="$LIMIT_UNLIMITED$";else sRet=FormatFileSize((fValue*1024),true)+"/$ACTIVITY_SEC_ABBREV$";break;case(2):nValue=parseInt(nValue/nScale);if(nValue==0)sRet="$LIMIT_NO_TIMEOUT$";else sRet=nValue+((nValue==1)?" $LIMIT_MINUTE$":" $LIMIT_MINUTES$");break;case(3):if(nValue==0)sRet="$LIMIT_UNLIMITED$";else sRet=nValue+((nValue==1)?" $LIMIT_SESSION$":" $LIMIT_SESSIONS$");break;case(4):nValue=parseInt(nValue/nScale);if(nValue==0)sRet="$LIMIT_NEVER_EXPIRES$";else sRet=nValue+((nValue==1)?" $DAY$":" $DAYS$");break;case(5):if(sRet==0)sRet="$LIMIT_NO_MINIMUM$";else sRet=nValue+((nValue==1)?" $LIMIT_CHARACTER$":" $LIMIT_CHARACTERS$");break;case(6):sRet="$LIMIT_VERSION$ "+nValue;break;case(7):case(12):var fValue=parseFloat(sValue);if(fValue==0)sRet="$LIMIT_UNLIMITED$";else{sRet=FormatFileSize((fValue),true);}break;case(8):if(sLimitName=="HTTPLoginPageDefaultLanguage"){var asComboValues=g_asLangVals;if(sValue=="")sRet="$NONE$";else{for(var nIndex=0;nIndex<asComboValues.length;nIndex++){if(asComboValues[nIndex]==decodeURIComponent(sValue)){sRet=g_asLimitComboStrings[sLimitName][nIndex];break;}}}}else sRet=g_asLimitComboStrings[sLimitName][nValue];break;case(13):if(nValue==0)sRet="$LIMIT_NEVER$";else sRet=nValue+((nValue==1)?" $LIMIT_SECOND$":" $LIMIT_SECONDS$");break;}return(sRet);}function GetLimitInfo(nRow){var asLimitInfo=[];var nScale=parseInt(LimitsList.getCellData(7,nRow));if((isNaN(nScale))||(nScale<1))nScale=1;asLimitInfo[0]=LimitsList.getCellText(0,nRow);asLimitInfo[1]=LimitsList.getCellData(6,nRow);asLimitInfo[2]=LimitsList.getCellData(1,nRow);asLimitInfo[3]=nScale;asLimitInfo[4]=LimitsList.getCellData(2,nRow);asLimitInfo[5]=LimitsList.getCellData(3,nRow);asLimitInfo[6]=LimitsList.getCellData(4,nRow);asLimitInfo[7]=LimitsList.getCellData(5,nRow);asLimitInfo[8]=LimitsList.getCellData(9,nRow);asLimitInfo[9]=LimitsList.getCellData(0,nRow);return(asLimitInfo);}function OnAddLimit(bReplaceLoad,bReplaceConfirm){g_bPauseRefresh=true;if(LimitsList.getRowCount()==0){LoadingDialog(true);LimitsList.m_fnPostUpdate=function(nError){if(!nError)AddLimit(true);else{var xmlDoc=this.m_XMLTable.getResponseXML();var sResultText=GetXMLValue(xmlDoc,"ResultText");LoadingDialog(false);AlertDialog(GetResultText(0,"",sResultText));}this.m_fnPostUpdate=undefined;};}else AddLimit(bReplaceLoad,bReplaceConfirm);}function AddLimit(bReplaceLoad,bReplaceConfirm){var aasLimits=[];var sLastLimit="";var anIndices=LimitsList.getRowIndices();for(var nIndex=0;nIndex<LimitsList.getRowCount();nIndex++){bSkipWindowsLimits=false;bSkipNonWindowsLimits=false;if((LimitsList.getCellData(8,anIndices[nIndex])=="1")&&(LimitsList.getCellText(0,anIndices[nIndex])!=sLastLimit)){if((!g_bAllowWindowsDrives&&(parseInt(LimitsList.getCellData(11,anIndices[nIndex]))==1))||(!g_bWindowsDirListingMask&&(parseInt(LimitsList.getCellData(11,anIndices[nIndex]))==2))||(!g_bSupportsInterpretLFASEOL&&(parseInt(LimitsList.getCellData(11,anIndices[nIndex]))==5)))bSkipWindowsLimits=true;if((!g_bSupportsChangeOwner&&(parseInt(LimitsList.getCellData(11,anIndices[nIndex]))==4)))bSkipNonWindowsLimits=true;if((g_bSysAdmin||(parseInt(LimitsList.getCellData(10,anIndices[nIndex]))!=1))&&!bSkipWindowsLimits&&!bSkipNonWindowsLimits){aasLimits.push(GetLimitInfo(anIndices[nIndex]));sLastLimit=aasLimits[aasLimits.length-1][0];}}}OnLimitLoad(aasLimits);if(bReplaceLoad)ReplaceDialog(g_sBusyDialog,"LimitsDialog");else if(bReplaceConfirm){ReplaceDialog("ConfirmDialog","LimitsDialog");SaveLimitsButton.focus();}else{ShowDialog("LimitsDialog");SaveLimitsButton.focus();}g_bDefaultLimitAdd=false;}function AddLimitConfirm(){g_bDefaultLimitAdd=true;OnAddLimit(false,true);}function OnEditLimit(){var anSelectedRows=LimitsList.getSelectedRows();g_bDefaultLimitAdd=false;g_bPauseRefresh=true;if(anSelectedRows.length==1){if(!g_bWebClientProLicense&&LimitsList.getCellData(0,anSelectedRows[0])=="AllowWebClientPro")AlertDialog("$NO_WEB_CLIENT_PRO_LICENSE$");else if(!g_bFVJVLicense&&LimitsList.getCellData(0,anSelectedRows[0])=="AllowFTPVoyagerJV")AlertDialog("$NO_FVJV_LICENSE$");else if(!g_bBrandingRemovalLicense&&LimitsList.getCellData(0,anSelectedRows[0])=="DisableBranding")AlertDialog("$NO_BRAND_REMOVAL_LICENSE$");else{if(LimitsList.getCellData(8,anSelectedRows[0])=="1"){ConfirmDialog("$LIMIT_CANT_EDIT_INHERITED$<br><br>$LIMIT_CREATE_NEW$",AddLimitConfirm,undefined,undefined,undefined,undefined,undefined,undefined,true);}else{aasLimits=[];aasLimits.push(GetLimitInfo(anSelectedRows[0]));OnLimitLoad(aasLimits,true);ShowDialog("LimitsDialog");}}}else AlertDialog("$SELECT_A_LIMIT_TO_EDIT$");}function LimitDeleteDone(){LimitsList.ForceUpdate();}function OnDeleteLimit(){var anSelectedRows=LimitsList.getSelectedRows();g_bPauseRefresh=true;if(anSelectedRows.length==1){if(LimitsList.getCellData(8,anSelectedRows[0])=="1")AlertDialog("$LIMIT_CANT_DELETE_INHERITED$");else{LimitsList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSessionAttrs."+g_EditObjectID+"."+LimitsList.getCellData(0,anSelectedRows[0]),"$ASK_DELETE_LIMIT$","$SELECT_A_LIMIT_TO_DELETE$",LimitDeleteDone);}}else AlertDialog("$SELECT_A_LIMIT_TO_DELETE$");}</script></div><div id="GroupMFA" style="display:none">
<!--#include "..\Strings\Strings.strings"-->
<div id="groupmfa" class="mfa-tab"><div class="layercontent mfa-tab__content"><div class="mfa-tab__description mfa-row"><img alt="$WINDOWS_AUTH_TAB_NAME$" src="%ADMIN_FILE%Images/shield.png" width="32" height="32" /><span>$MFA_TAB_INFO$</span></div><div id="groupmfaContent"><div class="mfa-tab__state mfa-row"><label><strong>$MFA_AUTHENTICATOR$</strong></label><br><span id="TOTPProvisioning"></span><span class="mfa-tab__warning warning-group Hidden"><img src="Images/Warn16.png" alt="warning"><span>$MFA_GROUPS_DISABLED_WARNING$</span></span></div><div class="mfa-tab__company-name mfa-row"><label for="mfa-company-name"><strong class="company-name">$MFA_COMPANY_NAME$</strong></label><br><span id="TOTPCompanyName"></span></div></div><div style="text-align:center;" id="groupmfaContentContainer"><div id="groupmfaContentNone" class="UpgradeLicenseMsg"><img id="groupmfaContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="groupmfaContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><script type="text/javascript" language="JavaScript">var TOTPProvisioningCombo;var TOTPCompanyNameCombo;initMfaStateControls();function initMfaStateControls(){var isWithInherit=true;var mfaSelectedValue="";var mfaDefaultValue="";var mfaValues=["0","1","2",""];TOTPProvisioningCombo=CreateComboBox("","",["$TOTP_MFA_DISABLED$","$TOTP_MFA_ENABLED$","$TOTP_MFA_ENFORCED$"],mfaValues,"TOTPProvisioning","TOTPProvisioning",onGroupTotpPtovisioningChange,undefined,isWithInherit,200,20,undefined,undefined,undefined,true);TOTPCompanyNameCombo=CreateComboBox("","",[],[],"TOTPCompanyName","TOTPCompanyName",undefined,undefined,isWithInherit,200,20,undefined,true);}function onGroupTotpPtovisioningChange(val){var isDefaultDisabled=g_GroupMfaConfig.TOTPProvisioningDefault==="0";var isCurrentDisabled=g_GroupMfaConfig.TOTPProvisioning==="0";var isShowWarning=(val==="0"&&!isCurrentDisabled)||(val===""&&isDefaultDisabled&&!isCurrentDisabled);if(isShowWarning){showMfaStatusWarning();return;}hideMfaStatusWarning();}function showMfaStatusWarning(){document.querySelector(".mfa-tab__warning").classList.remove("Hidden");}function hideMfaStatusWarning(){document.querySelector(".mfa-tab__warning").classList.add("Hidden");}function updateGroupMfaState(config){hideMfaStatusWarning();var totpProvisioningValues=getTotpProvisioningValues(config);var totpCompanyNameValues=getTotpCompanyNameValues(config);TOTPProvisioningCombo.initValue(totpProvisioningValues.currentVal,totpProvisioningValues.defaultVal);TOTPCompanyNameCombo.initValue(totpCompanyNameValues.currentVal,totpCompanyNameValues.defaultVal);if(totpCompanyNameValues.currentVal.length){TOTPCompanyNameCombo.setControlText(totpCompanyNameValues.currentVal);}else{TOTPCompanyNameCombo.setControlText(totpCompanyNameValues.defaultVal);}}function EnableDisableMFATab(isDisable,groupType){var text="$MFA_WINDOWS_GROUPS_NOT_AVAILABLE$";if(groupType=="LDAPGroups"){text="$MFA_LDAP_GROUPS_NOT_AVAILABLE$";}if(groupType=="ODBCGroups"){text="$MFA_DB_GROUPS_NOT_AVAILABLE$";}if(isDisable)DisableTab("groupmfaContent",undefined,text,true);else EnableTab("groupmfaContent",undefined);}</script></div><input type="hidden" name="Quota" /><input type="hidden" id="GroupLimitToTimeOfDay" /><input type="hidden" id="GroupStartTime" /><input type="hidden" id="GroupEndTime" /><input type="hidden" id="GroupMonday" /><input type="hidden" id="GroupTuesday"/><input type="hidden" id="GroupWednesday"/><input type="hidden" id="GroupThursday" /><input type="hidden" id="GroupFriday" /><input type="hidden" id="GroupSaturday" /><input type="hidden" id="GroupSunday"/><input type="hidden" id="GroupName-Hidden" name="GroupName"/><input type="hidden" name="IncludeRespCodesInMsgFiles" /--><input id="IncludeRespCodesInMsgFiles-hidden" type="text" value="" name="IncludeRespCodesInMsgFiles" style="display:none;"><input id="SignOnMessageFilePath-hidden" type="text" onchange="javascript:OnGroupMessageFilePathLoad(this.value, this.defaultValue);" value="" name="SignOnMessageFilePath" style="display:none;"><textarea id="SignOnMessage-hidden" onchange="javascript:OnLoadSignOnMessage(this.value, this.defaultValue);" name="SignOnMessage" style="display:none;"></textarea></div></form><div style="text-align:right;padding:10px 20px 0 0;"><span id="SaveGroupButton"></span><span id="CancelGroupButton"></span>&nbsp;&nbsp;&nbsp;<span id="HelpGroupButton"></span></div></div></div><script type="text/javascript" language="JavaScript">CreatePushButton("$SAVE_BUTTON$","SaveGroupButton",OnSaveGroup);CreatePushButton("$CANCEL_BUTTON$","CancelGroupButton",OnCancelGroupDialogButton);CreatePushButton("$HELP_BUTTON$","HelpGroupButton",OnGroupHelp);var nLimitsListHeight=301;if(AW.unix)nLimitsListHeight=(nLimitsListHeight-1);else if(AW.ie)nLimitsListHeight=(nLimitsListHeight-2);LimitsList.setStyle("height",nLimitsListHeight+"px");aGridCtrls[7]=LimitsList;aGridCtrls[5]=EventsList;</script>