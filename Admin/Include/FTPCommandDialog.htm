<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
%PRIV_DOMAIN_ADMIN%<div id="FTPCommandDialoginner" style="display:none;"><div style="padding:0 10px 0 10px;"><form name="FTPCommandForm" onsubmit="return (false);"><span id="FTPCommandTabs"></span><div id="FTPCommandTabsContent" class="tabs-content"><div id="Information" style="display:none;width:100%;"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$INFORMATION$" src="%ADMIN_FILE%Images/InformationBubble.png" width="32" height="32" class="header-icon" /></td><td style="vertical-align:top;">$COMMAND_GENERAL_INFO$</td></tr></table><div style="clear:both;">$FTP_COMMAND$:<span id="Command" style="font-weight:bold;position:absolute;left:100px;"></span><br />$NAME$:<span id="CommandName" style="font-weight:bold;position:absolute;left:100px;"></span><br />$DESCRIPTION$:<div id="CommandDescription" style="font-weight:bold;margin-left:10px;"></div><br />$ADDTL_INFO$:<br /><a style="margin-left:10px;" href="javascript:OnCommandAddtlInfo();">$CLICK_ADDTL_INFO$</a><br /><br /><span id="CommandEnabled"></span></div></div></div><div id="Responses" style="display:none;width:100%;"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$FTP_COMMAND_DIALOG_TITLE$" src="%ADMIN_FILE%Images/FTPResponse32.png" width="32" height="32" /></td><td style="vertical-align:top;">$COMMAND_RESPONSE_INFO$</td></tr></table><div style="clear:both;"><span id="CommandResponseList"></span><div style="padding:5px 0 0 0;"><span id="EditResponseButton"></span></div></div></div></div><div id="MessageFile" style="display:none;width:100%;"><div class="layercontent"><div style="display:inline;"><img src="%ADMIN_FILE%Images/MessageFile32.png" width="32" height="32" class="header-icon" alt="$MSGFILE$"/><div id="MsgFileInfo"></div><div style='clear:both;height:5px;overflow:hidden;'></div></div><div style="overflow:auto"><span id="IncludeRespCodesInMsgFiles"></span></div><br />$MSGFILELABEL$:<br /><div style="overflow:auto"><span id="PrimaryMessageFilePath"></span> <span id="BrowseMsgFile"></span></div><br /><div id="SecondMsgFileDiv" style="display:none;">$SECOND_MSG_FILE_INFO$<br /><br />$SECOND_MSG_FILE$:<div style="overflow:auto"><span id="SecondaryMessageFilePath"></span> <span id="BrowseSecondMsgFile"></span></div></div></div></div><div id="LISTAdvanced" style="display:none;width:100%;"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$ADVANCED_OPTIONS$" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32" class="header-icon" /></td><td style="vertical-align:top;">$LIST_ADVANCED_INFO$</td></tr></table><div style="clear:both;">$DIR_LIST_STYLE$:<br /><span id="Style"></span><br /><span id="AllowStyleChange"></span><br /><span id="FullPathWithFileParam"></span><br /><span id="AllowRecurseDirs"></span></div></div></div><div id="MKDAdvanced" style="display:none;width:100%;"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$ADVANCED_OPTIONS$" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32" class="header-icon" /></td><td style="vertical-align:top;">$MKD_ADVANCED_INFO$</td></tr></table><div style="clear:both;"><span id="CreateParent"></span></div></div></div><div id="XMKDAdvanced" style="display:none;width:100%;"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$ADVANCED_OPTIONS$" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32" class="header-icon" /></td><td style="vertical-align:top;">$MKD_ADVANCED_INFO$</td></tr></table><div style="clear:both;"><span id="XMKD_CreateParent"></span></div></div></div><div id="MDTMAdvanced" style="display:none;width:100%;"><div class="layercontent"><div style="display:inline;"><img alt="$ADVANCED_OPTIONS$" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32" class="header-icon" />$MDTM_ADVANCED_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><br /><span id="AllowMDTMChangeTime"></span><br /><span id="BlockFutureTime"></span></div></div><div id="NLSTAdvanced" style="display:none;width:100%;"><div class="layercontent"><div style="display:inline;"><img alt="$ADVANCED_OPTIONS$" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32" class="header-icon" />$NLST_ADVANCED_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><br /><span id="NLST_ListDirs"></span><br /><span id="ListEmptyDir"></span><br /><span id="NLST_FullPathWithFileParam"></span><br /><span id="NLST_AllowRecurseDirs"></span></div></div><div id="FTPCPAdvanced" style="display:none;width:100%;"><div class="layercontent"><div style="display:inline;"><img alt="$ADVANCED_OPTIONS$" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32" class="header-icon" />$FTPCP_ADVANCED_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><br /><span id="BlockFXP"></span><br /><span id="IncRespCodeAllLines"></span><br /><span id="UTF8Default"></span></div></div></div></form><div style="text-align:right;padding:10px 20px 0 0;"><span id="SaveFTPCommandButton"></span><span id="CancelFTPCommandButton"></span><span id="HelpFTPCommandButton"></span></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$FTP_COMMAND_DIALOG_TITLE$","FTPCommandDialog","550","505","","$CLOSE_CANCEL$","cmd-16.png");</script><div id="FTPResponseDialoginner" style="display:none;"><form name="FTPResponseForm" onsubmit="return (false);"><div style="display:inline;"><img alt="$FTP_RESPONSE_DIALOG_TITLE$" src="%ADMIN_FILE%Images/FTPResponse32.png" width="32" height="32" class="header-icon" />$EDIT_RESPONSE_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><br /><div style="padding-left:10px;overflow:auto;"><textarea style="font-family:Lucida Console, Monospace;font-size:1em;width:97%;height:84px;" id="Response_Value" name="Response_Value" class="aw-border"></textarea></div><br /><div style="text-align:right;padding:5px 10px 0 0;"><span id="SaveFTPResponseButton"></span><span id="CancelFTPResponseButton"></span><span id="HelpFTPResponseButton"></span></div></form></div><script type="text/javascript" language="javascript">BuildDialog("$FTP_RESPONSE_DIALOG_TITLE$","FTPResponseDialog","400","240","","$CLOSE_CANCEL$");AW.Formats.FTPResponse=AW.Formats.XMLString.subclass();AW.Formats.FTPResponse.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nCol,nRow){var sData=_super.dataToText(data);Grid.UpdateText(sData.substr(0,3),0,nRow);return(sData.substring(4));};obj.dataToValue=function(data){return(_super.dataToValue(data).substring(4));};obj.DefaultCompareDir;};AW.Formats.ResponseCode=AW.Formats.Number.subclass();AW.Formats.ResponseCode.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(data);};};function OnEditResponse(){ResponseGrid.OnEditObject("FTPResponse.xml","Result.xml%UPDATE_OBJECT_REF%CFTPCommand."+g_nEditObjID+".FTPRespAttr.",document.FTPResponseForm,"FTPResponseDialog","","$SELECT_ONE_RESPONSE_EDIT$",[OnLoadFTPResponse]);}function OnLoadCommandDisabled(sValue){CommandDisabledCheck.setChecked((sValue!="0")?false:true,true);}function OnLoadIncludeRespCode(sValue){IncludeRespCodeCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowListStyleChange(sValue){AllowListStyleChangeCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowCreateParent(sValue){AllowCreateParentDirCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowCreateParentXMKD(sValue){XMKDAllowCreateParentDirCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowListFullPath(sValue){AllowListFullPathCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowListFullPathNLST(sValue){NLSTAllowListFullPathCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowRecurseDirs(sValue){AllowRecurseDirs.setChecked((sValue!="0")?true:false,true);}function OnLoadAllowRecurseDirsNLST(sValue){NLSTAllowRecurseDirs.setChecked((sValue!="0")?true:false,true);}function OnLoadMDTMAllow(sValue){MDTMAllowCheck.setChecked((sValue!="0")?true:false,true);OnAllowMDTMChangeTime();}function OnLoadMDTMFuture(sValue){MDTMFutureCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadNLSTDirs(sValue){NLSTDirsCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadNLSTEmptyDir(sValue){NLSTEmptyDirCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadBlockFXP(sValue){BlockFXPCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadUTF8Default(sValue){UTF8DefaultCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadIncludeAllRespCode(sValue){IncludeAllRespCodeCheck.setChecked((sValue!="0")?true:false,true);}function OnLoadLISTStyle(sValue){LISTStyleCombo.initValue(sValue);}function OnAllowMDTMChangeTime(){MDTMFutureCheck.setControlDisabled(MDTMAllowCheck.getControlValue()=="0");}function OnChangeCommandTab(nOldTab,nNewTab){var nFTPResponseTab=1;if(g_bEditFTPCP)nFTPResponseTab=0;switch(nNewTab){case(nFTPResponseTab):setTimeout(function(){ResponseGrid.raiseEvent("adjustScrollHeight");nSearchSortCol=ResponseGrid.getSortColumn();sSearchSortDir=ResponseGrid.getSortDirection(nSearchSortCol);if(nSearchSortCol>=0)ResponseGrid.sort(nSearchSortCol,sSearchSortDir);else ResponseGrid.sort(0,"ascending");ResponseGrid.refresh();},500);break;}}function PrepareFTPCommandDialog(sCmd,nSelRow){ClearGrid(ResponseGrid,false);var asMsgFileCmds=["FTPCP","CDUP","CWD","QUIT","XCWD","XCUP"];var asMsgFileTxt=["$MSG_FILE_FTPCP$","$MSG_FILE_CDUP$","$MSG_FILE_CWD$","$MSG_FILE_QUIT$","$MSG_FILE_CWD$","$MSG_FILE_CDUP$"];var sAdvCmds=["LIST","MDTM","NLST","FTPCP","MKD","XMKD"];var asTabNames=[],asTabDivs=[];var nPos=-1;if(!sCmd.length)sCmd=FTPCommandGrid.getCellText(0,nSelRow);document.getElementById("FTPCommandTabs").innertHTML="";document.getElementById("Information").style.display="none";document.getElementById("Responses").style.display="none";document.getElementById("MessageFile").style.display="none";for(var nIndex in sAdvCmds)document.getElementById(sAdvCmds[nIndex]+"Advanced").style.display="none";if(sCmd!="FTPCP"){asTabNames.push("$INFORMATION$");asTabDivs.push("Information");document.getElementById("Command").innerHTML=sCmd;document.getElementById("CommandName").innerHTML=FTPCommandGrid.getCellText(1,nSelRow);document.getElementById("CommandDescription").innerHTML=FTPCommandGrid.getCellText(2,nSelRow);}asTabNames.push("$FTP_RESPONSES$");asTabDivs.push("Responses");if((nPos=asMsgFileCmds.join().indexOf(sCmd))>=0){asTabNames.push("$MSGFILE$");asTabDivs.push("MessageFile");document.getElementById("MsgFileInfo").innerHTML=asMsgFileTxt[parseInt(nPos/5)];document.getElementById("SecondMsgFileDiv").style.display=((sCmd=="CWD")||(sCmd=="XCWD")||(sCmd=="CDUP")||(sCmd=="XCUP"))?"block":"none";}if(sAdvCmds.join().indexOf(sCmd)>=0){asTabNames.push("$ADVANCED_OPTIONS$");asTabDivs.push(sCmd+"Advanced");}g_sCurrentCmd=sCmd;g_bInitialLoad=true;CommandTabs=CreateTabs(asTabNames,asTabDivs,"FTPCommandTabs","FTPCommandTabsContent",1,OnChangeCommandTab);}function OnCommandAddtlInfo(){var sURL="http://www.RhinoSoft.com/respcode.asp?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&prod=su&cmd=";var asVals=g_sCurrentCmd.split(' ');sURL+=asVals[0];if(asVals.length>1)sURL+="&params="+asVals[1];var windowPopup=window.open(sURL,"SUCommandInfo","noopener");if((windowPopup)&&(windowPopup.focus))windowPopup.focus();}function OnSaveFTPCommand(){SaveFTPCommand();return(false);}function OnCancelFTPCommand(){HideDialog('FTPCommandDialog');}function OnFTPCommandHelp(){if(g_bDomainNav)sExpandNode="Item5_4";else sExpandNode="Item2_3";LaunchHelp("Help-Custom-FTP.htm",sExpandNode);}var g_bInitialLoad=false;var CommandTabs=undefined;var g_sCurrentCmd="";var ResponseGrid=CreateAdminGrid("CommandResponseList",["$RESPONSE_CODE$","$RESPONSE_TEXT$"],[50,400],"FTPCommandResponses.xml?ID=%OBJECT_EDIT_ID%","ftpresponses","ftpresponse",3,OnEditResponse);ResponseGrid.setCellFormat([new AW.Formats.Number,new AW.Formats.FTPResponse]);ResponseGrid.setSelectionMode("single-row");ResponseGrid.m_fnPostUpdate=function(){setTimeout(function(){ResponseGrid.refresh();ResponseGrid.raiseEvent("adjustScrollHeight");setTimeout(function(){nSearchSortCol=ResponseGrid.getSortColumn();sSearchSortDir=ResponseGrid.getSortDirection(nSearchSortCol);if(nSearchSortCol>=0)ResponseGrid.sort(nSearchSortCol,sSearchSortDir);else ResponseGrid.sort(0,"ascending");ResponseGrid.refresh();},0);},100);g_bInitialLoad=false;};CreatePushButton("$EDIT_BUTTON$...","EditResponseButton",OnEditResponse);var CommandDisabledCheck=CreateCheckBox("$DISABLE_COMMAND$","CommandEnabled","Enabled",false,undefined,true,"OnLoadCommandDisabled()",true);var IncludeRespCodeCheck=CreateCheckBox("$MSGFILECHKLABEL$","IncludeRespCodesInMsgFiles","IncludeRespCodesInMsgFiles",true,undefined,true,"OnLoadIncludeRespCode()");var PrimaryMsgFileInput=CreateInputField("","PrimaryMessageFilePath","PrimaryMessageFilePath",undefined,400);var MsgFileBrowse=CreatePushButton("","BrowseMsgFile",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[PrimaryMsgFileInput,true,"0","0"]]);MsgFileBrowse.setControlImage("Browse");var SecondMsgFileInput=CreateInputField("","SecondaryMessageFilePath","SecondaryMessageFilePath",undefined,400);var SecondMsgFileBrowse=CreatePushButton("","BrowseSecondMsgFile",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[SecondMsgFileInput,true,"0","0"]]);SecondMsgFileBrowse.setControlImage("Browse");var LISTStyleCombo=CreateComboBox("$LIST_STYLE_UNIX$","0",["$LIST_STYLE_UNIX$","$LIST_STYLE_IIS$","$LIST_STYLE_DOS$"],["0","1","2"],"Style","Style",undefined,"OnLoadLISTStyle()",false,200);var AllowListStyleChangeCheck=CreateCheckBox("$ALLOW_LIST_STYLE_CHANGE$","AllowStyleChange","AllowStyleChange",true,undefined,true,"OnLoadAllowListStyleChange()");AllowListFullPathCheck=CreateCheckBox("$ALLOW_LIST_FULL_PATH$","FullPathWithFileParam","FullPathWithFileParam",true,undefined,true,"OnLoadAllowListFullPath()");NLSTAllowListFullPathCheck=CreateCheckBox("$ALLOW_LIST_FULL_PATH$","NLST_FullPathWithFileParam","NLST_FullPathWithFileParam",true,undefined,true,"OnLoadAllowListFullPathNLST()");AllowRecurseDirs=CreateCheckBox("$ALLOW_RECURSE_DIRS$","AllowRecurseDirs","AllowRecurseDirs",true,undefined,true,"OnLoadAllowRecurseDirs()");NLSTAllowRecurseDirs=CreateCheckBox("$ALLOW_RECURSE_DIRS$","NLST_AllowRecurseDirs","NLST_AllowRecurseDirs",true,undefined,true,"OnLoadAllowRecurseDirsNLST()");AllowCreateParentDirCheck=CreateCheckBox("$ALLOW_CREATE_PARENT_DIR$","CreateParent","CreateParent",true,undefined,true,"OnLoadAllowCreateParent()");XMKDAllowCreateParentDirCheck=CreateCheckBox("$ALLOW_CREATE_PARENT_DIR$","XMKD_CreateParent","XMKD_CreateParent",true,undefined,true,"OnLoadAllowCreateParentXMKD()");var MDTMAllowCheck=CreateCheckBox("$MDTM_CHANGE_TIME$","AllowMDTMChangeTime","AllowMDTMChangeTime",true,OnAllowMDTMChangeTime,true,"OnLoadMDTMAllow()");var MDTMFutureCheck=CreateCheckBox("$MDTM_BLOCK_FUTURE$","BlockFutureTime","BlockFutureTime",false,undefined,true,"OnLoadMDTMFuture()");var NLSTDirsCheck=CreateCheckBox("$NLST_LIST_DIRS$","NLST_ListDirs","NLST_ListDirs",false,undefined,true,"OnLoadNLSTDirs()");var NLSTEmptyDirCheck=CreateCheckBox("$NLST_LIST_EMPTY$","ListEmptyDir","ListEmptyDir",false,undefined,true,"OnLoadNLSTEmptyDir()");var BlockFXPCheck=CreateCheckBox("$FTPCP_BLOCK_FXP$","BlockFXP","BlockFXP",false,undefined,true,"OnLoadBlockFXP()");var IncludeAllRespCodeCheck=CreateCheckBox("$FTPCP_INC_RESP_CODE$","IncRespCodeAllLines","IncRespCodeAllLines",false,undefined,true,"OnLoadIncludeAllRespCode()");var UTF8DefaultCheck=CreateCheckBox("$FTPCP_UTF8_DEFAULT$","UTF8Default","UTF8Default",false,undefined,true,"OnLoadUTF8Default()");CreateDialogPushButton("$SAVE_BUTTON$","SaveFTPCommandButton",OnSaveFTPCommand);CreateDialogPushButton("$CANCEL_BUTTON$","CancelFTPCommandButton",OnCancelFTPCommand);CreateDialogPushButton("$HELP_BUTTON$","HelpFTPCommandButton",OnFTPCommandHelp);function OnLoadFTPResponse(){var Element=document.getElementById("Response_Value");if(Element)Element.value=String(Element.value).substring(4);}function OnSaveFTPResponse(){ResponseGrid.OnSaveObject();return(false);}function OnCancelFTPResponse(){HideDialog("FTPResponseDialog");}function OnFTPResponseHelp(){if(g_bDomainNav)sExpandNode="Item5_4";else sExpandNode="Item2_3";LaunchHelp("Help-Custom-FTP.htm",sExpandNode);}CreateDialogPushButton("$SAVE_BUTTON$","SaveFTPResponseButton",OnSaveFTPResponse);CreateDialogPushButton("$CANCEL_BUTTON$","CancelFTPResponseButton",OnCancelFTPResponse);CreateDialogPushButton("$HELP_BUTTON$","HelpFTPResponseButton",OnFTPResponseHelp);</script>