AW.Formats.EventType=AW.Formats.Number.subclass();AW.Formats.EventType.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if(parseInt(data))return(GetEventIDText(parseInt(data)));};};AW.Formats.EventAction=AW.Formats.Number.subclass();AW.Formats.EventAction.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(GetEventActionText(parseInt(data)));};};AW.Formats.RuleLogic=AW.Formats.XMLString.subclass();AW.Formats.RuleLogic.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if(parseInt(data)==0)return(g_sAND);else return(g_sOR);};obj.dataToValue=function(data){return(data);};};AW.Formats.RuleIf=AW.Formats.XMLString.subclass();AW.Formats.RuleIf.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(g_sRuleIf);};};AW.Formats.RuleComp=AW.Formats.Number.subclass();AW.Formats.RuleComp.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(GetRuleCompText(parseInt(data)));};};AW.Formats.RuleDataType=AW.Formats.Number.subclass();AW.Formats.RuleDataType.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(GetRuleDataTypeText(parseInt(data)));};};function CreateEventsGrid(sHtmlId,sXMLFile,fnOnDoubleClick,anColWidths){if(anColWidths==undefined)anColWidths=[180,180,180,180];var nXMLCols=13;var Grid=CreateAdminGrid(sHtmlId,[g_sEventNameColumn,g_sEventTypeColumn,g_sEventActionColumn,g_sEventDescriptionColumn],anColWidths,sXMLFile,"events","event",nXMLCols,fnOnDoubleClick);Grid.setCellFormat([new AW.Formats.XMLString,new AW.Formats.EventType,new AW.Formats.EventAction,new AW.Formats.XMLString]);Grid.getCellImage=function(nCol,nRow){var sDisableEnable="Enabled",sActionType;if(this.getCellData(9,nRow)=="0"){sDisableEnable="Disabled";}else if(this.getCellData(6,nRow)=="0"){sDisableEnable="NoFire";}else sDisableEnable="Enabled";switch(parseInt(this.getCellData(2,nRow))){case(0):sActionType="Email-Action-";break;case(1):sActionType="Balloon-Action-";break;case(2):sActionType="Exec-Action-";break;case(3):sActionType="WinLog-Action-";break;case(4):sActionType="MSMQ-Action-";break;}return(sActionType+sDisableEnable);};return(Grid);}function CreateEventFiltersGrid(sHtmlId,sXMLFile,fnOnDoubleClick,anColWidths){if(anColWidths==undefined)anColWidths=[145,145,145];var nXMLCols=5;var Grid=CreateAdminGrid(sHtmlId,[g_sEventFilterRuleName,g_sEventFilterDescr,g_sEventFilterLogic],anColWidths,sXMLFile,"filters","filter",nXMLCols,fnOnDoubleClick);Grid.setCellFormat([new AW.Formats.XMLString,new AW.Formats.XMLString,new AW.Formats.RuleLogic]);Grid.getCellImage=function(nCol,nRow){var sDisableEnable="enabled";if(this.getCellData(3,nRow)=="0"){sDisableEnable="disabled";}return("Filter-"+sDisableEnable);};return(Grid);}function CreateFiltersCompGrid(sHtmlId,sXMLFile,fnOnDoubleClick,anColWidths){if(anColWidths==undefined)anColWidths=[15,95,95,95,180];var nXMLCols=6;var Grid=CreateAdminGrid(sHtmlId,["",g_sEventRuleVar,g_sEventRuleComp,g_sEventRuleConstant,g_sEventRuleDataType],anColWidths,sXMLFile,"VarComparisons","VarComparison",nXMLCols,fnOnDoubleClick,1);Grid.onHeaderClicked=function(event,index){if(index==0)return'disabled'};Grid.setColumnResizable(false,0);Grid.setCellFormat([new AW.Formats.RuleIf,new AW.Formats.XMLString,new AW.Formats.RuleComp,new AW.Formats.XMLString,new AW.Formats.RuleDataType]);return(Grid);}