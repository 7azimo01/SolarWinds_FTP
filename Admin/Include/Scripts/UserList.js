function CreateUserGrid(sHtmlId,fnOnDoubleClick,sXMLFile,sHeight){AW.Formats.UserLoginString=AW.Formats.XMLString.subclass();AW.Formats.UserLoginString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var nExpireDate="",sExpireLabel="";var nAutoDisable=parseInt(Grid.getCellData(8,nRow));var nDisableType=parseInt(Grid.getCellData(5,nRow));var sTextClass="User-Expired-Grid-Txt";if((Grid!=undefined)&&(nDisableType>=1)&&((nExpireDate=Grid.getCellData(11,nRow))!="0")){if(nDisableType==1){if(nAutoDisable==1){sExpireLabel=g_sExpireLabelExpired;sTextClass="User-Expiring-Grid-Txt";}else sExpireLabel=g_sExpireLabelDisable;}else if(nDisableType==2)sExpireLabel=g_sExpireLabelDelete;var sDate=new Date(parseInt(nExpireDate)*1000);return(FormatClientString(data)+"<span class='"+sTextClass+"'> ("+sExpireLabel+" "+sDate.getFullYear()+'/'+FormatShortDates(sDate.getMonth()+1)+'/'+FormatShortDates(sDate.getDate())+")</span>");}else return(FormatClientString(data));};obj.dataToValue=function(data){return(FormatClientString(data));};obj.comparator=DefaultCompareDir;};function FormatShortDates(n){if(isNaN(n))return(n);else return(n>9?n:'0'+n);}AW.Formats.UsersGridLocaleDate=AW.System.Format.subclass();AW.Formats.UsersGridLocaleDate.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if((typeof(data)=="undefined")||(data=="")||(data.toString()=="0"))return("");else{if((AW.ie)&&(parseInt(navigator.appVersion)>=4))return(VBDateFormat(data,nTimeZoneOffset));else{return(FormatFileDate(data));}}};obj.dataToValue=function(data){var nVal=parseInt(data);if(isNaN(nVal))return(0);else return(nVal);};};var nUserListCols=13;var Grid=CreateAdminGrid(sHtmlId,[g_sUserNameLoginIdColumn,g_sFullNameColumn,g_sDescriptionColumn,g_sLastLoginColumn,g_sHomeDirColumn],[160,160,190,100,100],sXMLFile,"users","user",nUserListCols,fnOnDoubleClick);var DefaultXMLFormat=new AW.Formats.XMLString;Grid.setCellFormat([new AW.Formats.UserLoginString,DefaultXMLFormat,DefaultXMLFormat,new AW.Formats.UsersGridLocaleDate,DefaultXMLFormat]);Grid.m_nDeleteColumn=0;Grid.m_nIDCol=0;Grid.m_sIDCol="LoginID";Grid.getCellImage=function(nCol,nRow){var sAdminIconType="";if(this.getCellData(10,nRow)=="1")sAdminIconType="-Domain";else if(this.getCellData(10,nRow)=="2")sAdminIconType="-Sys";else if(this.getCellData(10,nRow)=="3")sAdminIconType="-DomainRO";else if(this.getCellData(10,nRow)=="4")sAdminIconType="-SysRO";else if(this.getCellData(10,nRow)=="5")sAdminIconType="-Group";else if(this.getCellData(10,nRow)=="6")sAdminIconType="-GroupRO";if(this.getCellData(7,nRow)=="0")return("UserDisabled"+sAdminIconType);else if(this.getCellData(8,nRow)=="1")return("UserAutoDisabled"+sAdminIconType);else if(this.getCellData(6,nRow)=="0")return("UserWarn"+sAdminIconType);else if(parseInt(this.getCellData(5,nRow))>0)return("UserTemp"+sAdminIconType);else return("User"+sAdminIconType);};if(sHeight!=undefined)Grid.setStyle("height",sHeight+"px");return(Grid);}