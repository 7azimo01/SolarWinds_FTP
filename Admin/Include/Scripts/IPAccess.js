AW.Formats.IPAccessRule=AW.Formats.XMLString.subclass();AW.Formats.IPAccessRule.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sLabel="";if((Grid!=undefined)&&(((sLabel=Grid.getCellData(4,nRow))!="")||((sLabel=Grid.getCellData(5,nRow))!="")))return(_super.dataToText(data)+" ("+_super.dataToText(sLabel)+")");else return(_super.dataToText(data));};};AW.Formats.IPAccessAllow=AW.Formats.Number.subclass();AW.Formats.IPAccessAllow.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if(parseInt(data))return(g_sRuleAllow);else return(g_sRuleDeny);};};AW.Formats.IPAccessDuration=AW.System.Format.subclass();AW.Formats.IPAccessDuration.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){data=parseInt(data);if(data==0)return("");else if(data==g_nULLMax)return(g_sRuleExpired);else if(data>0)return(FormatDurationString(data*1000));};};function CreateIPAccessGrid(sHtmlId,sXMLFile,fnOnDoubleClick,anColWidths){if(anColWidths==undefined)anColWidths=[325,60,70,100];var nIPRulCols=7;var Grid=CreateAdminGrid(sHtmlId,[g_sRuleAddressColumn,g_sAccessColumn,g_sExpiresInColumn,g_sIPDescriptionColumn],anColWidths,sXMLFile,"rules","rule",nIPRulCols,fnOnDoubleClick);Grid.setCellFormat([new AW.Formats.IPAccessRule,new AW.Formats.IPAccessAllow,new AW.Formats.IPAccessDuration,new AW.Formats.XMLString]);Grid.getCellImage=function(nColumn,nRow){return((this.getCellValue(1,nRow))?"RuleAllow":"RuleDeny");};Grid.DisableSorting(OnSortHeaderClick);Grid.setVirtualMode(false);return(Grid);}function OnEnableSorting(nSortCol){if(nSortCol==undefined)nSortCol=0;SortCheckbox.setChecked(true,true);IPAccessList.EnableSorting();IPAccessList.sort(nSortCol,"ascending");}function OnCancelSorting(){setTimeout(function(){SortCheckbox.setChecked(false,true);});}function OnSortHeaderClick(nSortCol){ConfirmDialog(sConfirmSortIpMsg,OnEnableSorting,OnCancelSorting,nSortCol);}function OnSortCheckBoxValueChanged(Checkbox){if(Checkbox.getControlValue())OnSortHeaderClick();else{anIPSelectedRows=IPAccessList.getSelectedRows();IPAccessList.DisableSorting(OnSortHeaderClick);IPAccessList.Reset(true);if(parseInt(anIPSelectedRows.length)>0)IPAccessList.setSelectedRows([parseInt(anIPSelectedRows)]);}}