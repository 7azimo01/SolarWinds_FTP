var g_SessionLogRequest=undefined;var g_SessionLogTimer=undefined;var g_SessionDivScroll=new logscroll.Pane("SpyContainer");var g_sSessionDisconnect="";var g_nSessionType=undefined;function GetSessionLog(){g_SessionLogRequest=GetLog("SessionLog",g_SessionID,OnSessionLogRequest);}function OnSessionLogRequest(){if(g_SessionLogRequest!=undefined){var nRet=OutputLogRequest(g_SessionLogRequest,g_SessionDivScroll,"SpyLog",GetSessionLineColor,true);if(!nRet){FreezeSessionLog(true);if(g_SessionLogRequest.status==404){UpdateLogFrame(g_SessionDivScroll,"SpyLog","<div style='color:blue;'>"+g_sSessionDisconnect+"</div>");g_SessionLogRequest=undefined;}}else if(nRet==1)g_SessionLogRequest=undefined;}}function InitSessionLog(sDisconnectStr,sSessionType){g_sSessionDisconnect=sDisconnectStr;if(sSessionType=="CFTPSession")g_nSessionType=0;else if(sSessionType=="CSSHSession")g_nSessionType=1;else if(sSessionType=="CHTTPSession")g_nSessionType=2;InitLog("SpyLog","InitSessionLog",g_SessionID);}function CheckSessionLogTimer(){if(g_SessionLogRequest==undefined)GetSessionLog();}function FreezeSessionLog(bWasChecked){if(bWasChecked)clearInterval(g_SessionLogTimer);else g_SessionLogTimer=setInterval(CheckSessionLogTimer,500);}