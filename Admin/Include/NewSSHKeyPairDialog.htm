<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
%PRIV_GROUP_ADMIN%<div id="NewSSHKeyPairDialoginner" style="display:none;"><div id="NewSSHPublicKeyContent" style="width:100%"><div class="layercontent"><div style="display:inline;"><img alt="$NEW_SSH_PUBLIC_KEY_DIALOG_TITLE$" src="%ADMIN_FILE%Images/Certificate32.png" width="32" height="32" class="header-icon" />$NEW_SSH_KEY_PAIR_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><form name="NewSSHPublicKeyForm"><span style="float:left;width:385px;"><span id="NewSSHKeyOutputGroup">$SSH_KEY_PAIR_NAME$:<div style="overflow:auto"><span id="NewSSHKeyPairSetName"></span></div>$PRIVATE_KEY_OUTPUT_PATH$:<div style="overflow:auto"><span id="NewSSHKeyOutputPath"></span> <span id="NewSSHKeyOutputPathBrowse"></span></div></span><div id="NewSSHPublicKeyInfoGroup" style="padding-bottom:10px;">$PRIVATE_KEY_TYPE$:<div style="overflow:auto"><span id="NewSSHPublicKeyType"></span></div>$PRIVATE_KEY_LENGTH$:<div style="overflow:auto"><span id="NewSSHPublicKeyLength"></span></div>$PRIVATE_KEY_PASSWORD$:<div style="overflow:auto"><span id="NewSSHPublicKeyPassword"></span></div></div></span><span style="float:left;width:95px;text-align:right;vertical-align:top;padding:5px 5px 0 0;"><span id="CreateNewSSHPublicKeyButton"></span><br /><span id="CancelNewSSHPublicKeyButton"></span><br /><br /><span id="HelpNewSSHPublicKeyButton"></span></span></form><div style="clear:both;"></div></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$NEW_SSH_KEY_PAIR_DIALOG_TITLE$","NewSSHKeyPairDialog","500","370","","$CLOSE_CANCEL$");CreateGroupBox("$SSH_KEY_PAIR_OUTPUT_GROUP$","NewSSHKeyOutputGroup",380,112);var SSHPublicKeyNameInput=CreateInputField("","NewSSHKeyPairSetName","NewSSHKeyPairSetName",undefined,320);var SSHPublicKeyOutputPathInput=CreateInputField("","NewSSHKeyOutputPath","NewSSHKeyOutputPath",undefined,320);var SSHOutputPathBrowse=CreatePushButton("","NewSSHKeyOutputPathBrowse",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[SSHPublicKeyOutputPathInput,false,"0","1"]]);SSHOutputPathBrowse.setControlImage("Browse");var SSHPublicKeyType=["$PRIVATE_KEY_TYPE_DSA$","$PRIVATE_KEY_TYPE_RSA$","$PRIVATE_KEY_TYPE_ECDSA$"];var SSHPublicKeyTypeVal=["0","1","2"];var SSHPublicKeyLength=["$PRIVATE_KEY_LEN_1024$","2048","$PRIVATE_KEY_LEN_4096$"];var SSHPublicECDSAKeyLength=["$PRIVATE_ECDSA_KEY_LEN_256$","$PRIVATE_ECDSA_KEY_LEN_384$","$PRIVATE_ECDSA_KEY_LEN_521$"];var SSHPublicKeyLengthVal=["1024","2048","4096"];var SSHPublicECDSAKeyLengthVal=["256","384","521"];CreateGroupBox("$SSH_PUBLIC_KEY_INFORMATION$","NewSSHPublicKeyInfoGroup",380,140);var SSHPublicKeyTypeCombo=CreateComboBox(SSHPublicKeyType[1],SSHPublicKeyTypeVal[1],SSHPublicKeyType,SSHPublicKeyTypeVal,"NewSSHPublicKeyType","NewSSHPublicKeyType",OnSSHPublicKeyTypeChange,"OnSSHPublicKeyTypeLoad()",false,320,undefined,OnCreateNewSSHPublicKey);var SSHPublicKeyLengthCombo=CreateComboBox(SSHPublicKeyLength[0],SSHPublicKeyLengthVal[0],SSHPublicKeyLength,SSHPublicKeyLengthVal,"NewSSHPublicKeyLength","NewSSHPublicKeyLength",undefined,"",false,320,undefined,OnCreateNewSSHPublicKey);function OnSSHPublicKeyTypeLoad(sValue){SSHPublicKeyTypeCombo.initValue(sValue);OnSSHPublicKeyTypeChange(sValue);}function OnSSHPublicKeyTypeChange(sValue){switch(parseInt(sValue)){case 0:SSHPublicKeyLengthCombo.setItemText(SSHPublicKeyLength.slice(0,1));SSHPublicKeyLengthCombo.setItemValue(SSHPublicKeyLengthVal.slice(0,1));SSHPublicKeyLengthCombo.setItemCount(SSHPublicKeyLength.slice(0,1).length);SSHPublicKeyLengthCombo.setSelectedItems([0]);SSHPublicKeyLengthCombo.setControlText(SSHPublicKeyLengthCombo.getItemText([0]));break;case 1:if(g_bUsingFIPS){SSHPublicKeyLengthCombo.setItemText(SSHPublicKeyLength.slice(1));SSHPublicKeyLengthCombo.setItemValue(SSHPublicKeyLengthVal.slice(1));SSHPublicKeyLengthCombo.setItemCount(SSHPublicKeyLength.slice(1).length);}else{SSHPublicKeyLengthCombo.setItemText(SSHPublicKeyLength);SSHPublicKeyLengthCombo.setItemValue(SSHPublicKeyLengthVal);SSHPublicKeyLengthCombo.setItemCount(SSHPublicKeyLength.length);}SSHPublicKeyLengthCombo.setSelectedItems([0]);SSHPublicKeyLengthCombo.setControlText(SSHPublicKeyLengthCombo.getItemText([0]));break;case 2:SSHPublicKeyLengthCombo.setItemText(SSHPublicECDSAKeyLength);SSHPublicKeyLengthCombo.setItemValue(SSHPublicECDSAKeyLengthVal);SSHPublicKeyLengthCombo.setItemCount(SSHPublicECDSAKeyLength.length);SSHPublicKeyLengthCombo.setSelectedItems([0]);SSHPublicKeyLengthCombo.setControlText(SSHPublicKeyLengthCombo.getItemText([0]));break;}}CreatePasswordField("","NewSSHPublicKeyPassword","NewSSHPublicKeyPassword",undefined,320);CreateDialogPushButton("$CREATE_BUTTON$","CreateNewSSHPublicKeyButton",OnCreateNewSSHPublicKey);CreateDialogPushButton("$CANCEL_BUTTON$","CancelNewSSHPublicKeyButton",OnCancelNewSSHPublicKey);CreateDialogPushButton("$HELP_BUTTON$","HelpNewSSHPublicKeyButton",OnNewSSHPublicKeyHelp);function OnCreateNewSSHPublicKey(){if((!SSHPublicKeyNameInput.getControlText().length)||(!SSHPublicKeyOutputPathInput.getControlText().length))AlertDialog("$NEW_PRIVATE_KEY_EMPTY_FIELD$");else{var CreateSSHPublicKeyRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+g_sPageObjectType+"."+g_sPageObjectID+".CreatePrivateKey");SavingDialog(true);sNewPrivateKeyName=document.NewSSHPublicKeyForm.NewSSHKeyPairSetName.value;CreateSSHPublicKeyRequest.setParameter("PrivateKeyName",sNewPrivateKeyName);CreateSSHPublicKeyRequest.setParameter("PrivateKeyPath",document.NewSSHPublicKeyForm.NewSSHKeyOutputPath.value);CreateSSHPublicKeyRequest.setParameter("PrivateKeyType",SSHPublicKeyTypeCombo.getItemValue(SSHPublicKeyTypeCombo.getSelectedItems()[0]));CreateSSHPublicKeyRequest.setParameter("CreatePublicKey","true");CreateSSHPublicKeyRequest.setParameter("NewSSHPublicKeyLength",SSHPublicKeyLengthCombo.getItemValue(SSHPublicKeyLengthCombo.getSelectedItems()[0]));CreateSSHPublicKeyRequest.setParameter("PrivateKeyLength",SSHPublicKeyLengthCombo.getItemValue(SSHPublicKeyLengthCombo.getSelectedItems()[0]));CreateSSHPublicKeyRequest.setParameter("Password",document.NewSSHPublicKeyForm.NewSSHPublicKeyPassword.value);CreateSSHPublicKeyRequest.response=function(){var nResult=OnSaveComplete(this);if(!nResult)ConfirmDialog("$SU_GEN_FILES$ <br><br> "+sNewPrivateKeyName+".pub : $PUBLIC_KEY_ON_SERVER$ <br>"+sNewPrivateKeyName+".key : $PRIVATE_KEY_ON_CLIENT$<br><br>$KEY_INSTRUCTION_INFO_PART1$ \""+sNewPrivateKeyName+".key\" $KEY_INSTRUCTION_INFO_PART2$<br><br>$NEW_PUBLIC_KEY_USE_NOW$",OnUseNewSSHPublicKey,function(){CloseConfirmDialog();OnCancelNewSSHPublicKey();},undefined,450);};CreateSSHPublicKeyRequest.request(null);}}function OnUseNewSSHPublicKey(){var sSSHPublicKeyPath=document.NewSSHPublicKeyForm.NewSSHKeyOutputPath.value;var sSSHPublicKeyName=document.NewSSHPublicKeyForm.NewSSHKeyPairSetName.value;var sSlash=(sSSHPublicKeyPath.indexOf('/')>=0)?"/":"\\";if(sSSHPublicKeyPath.substr(sSSHPublicKeyPath.length-1)!=sSlash)sSSHPublicKeyPath+=sSlash;CloseConfirmDialog();OnCancelNewSSHPublicKey();OnAddSSHKey(sSSHPublicKeyPath+sSSHPublicKeyName+".pub",sSSHPublicKeyName);}function OnShowNewSSHKeyPairDialog(){if(g_bUsingFIPS){SSHPublicKeyTypeCombo.setItemText(SSHPublicKeyType.slice(1));SSHPublicKeyTypeCombo.setItemValue(SSHPublicKeyTypeVal.slice(1));SSHPublicKeyTypeCombo.setItemCount(SSHPublicKeyType.slice(1).length);SSHPublicKeyTypeCombo.setSelectedItems([0]);SSHPublicKeyTypeCombo.setControlText(SSHPublicKeyTypeCombo.getItemText([0]));SSHPublicKeyLengthCombo.setItemText(SSHPublicKeyLength.slice(1));SSHPublicKeyLengthCombo.setItemValue(SSHPublicKeyLengthVal.slice(1));SSHPublicKeyLengthCombo.setItemCount(SSHPublicKeyLength.slice(1).length);SSHPublicKeyLengthCombo.setSelectedItems([0]);SSHPublicKeyLengthCombo.setControlText(SSHPublicKeyLengthCombo.getItemText([0]));}else{SSHPublicKeyTypeCombo.setItemText(SSHPublicKeyType);SSHPublicKeyTypeCombo.setItemValue(SSHPublicKeyTypeVal);SSHPublicKeyTypeCombo.setItemCount(SSHPublicKeyType.length);SSHPublicKeyTypeCombo.setSelectedItems([1]);SSHPublicKeyTypeCombo.setControlText(SSHPublicKeyTypeCombo.getItemText([1]));SSHPublicKeyLengthCombo.setItemText(SSHPublicKeyLength);SSHPublicKeyLengthCombo.setItemValue(SSHPublicKeyLengthVal);SSHPublicKeyLengthCombo.setItemCount(SSHPublicKeyLength.length);SSHPublicKeyLengthCombo.setSelectedItems([0]);SSHPublicKeyLengthCombo.setControlText(SSHPublicKeyLengthCombo.getItemText([0]));}ReplaceDialog(g_sBusyDialog,"NewSSHKeyPairDialog");}function OnCancelNewSSHPublicKey(){HideDialog("NewSSHKeyPairDialog");}function OnNewSSHPublicKeyHelp(){if("$PAGE_OBJECT_TYPE$"=="User"){sExpandNode="RootItem6";sHelpFile="Help-SSH-Key-Pair.htm";}else{sExpandNode="RootItem5";sHelpFile="Help-SSH-Key-Pair.htm";}LaunchHelp(sHelpFile,sExpandNode);}</script>