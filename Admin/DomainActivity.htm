<!--#include "Strings\Strings.strings"-->
<!--#include "..\Common\Strings\Strings.strings"-->
<!--#include "..\Common\Strings\Result.strings"-->
%PRIV_GROUP_ADMIN%<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"/><script type="text/javascript" language="javascript">if(%IS_LOCAL_ADMIN%)sTitleText="$DOMAIN_ACTIVITY$";else sTitleText="%PRODUCT% - $DOMAIN_ACTIVITY$";document.write("<title>"+sTitleText+"</title>");</script>%PAGE_CHANGE%<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script type="text/javascript" language="javascript">var g_bSecurityAlertTriggered=%SECURITY_ALERT_TRIGGERED%;var g_bServerIdentityAlertTriggered=%SERVER_IDENTITY_ALERT_TRIGGERED%;var g_bIsWebClient=false;var g_nShowList;var g_bLinkRequested=false;var g_sFontOverride="$FONT_OVERRIDE$";var g_bTreeNavVisible=false;var bTreeLoaded=false;var NavigationTree;var g_nServerSection="";var g_sTreeURL;var g_nTreeHeight=350;var g_bTreeRoot=false;var tree=new Array();var g_aHistory=new Array();var g_aHistoryNames=new Array();var g_aHistoryIcon=new Array();var g_aHistoryActive=new Array();var g_HistoryPointer=0;var g_sLastIcon="";var g_bHistoryButtonUsed=false;var g_bIslocalAdminBrowser=false;var g_sCannotMoveFile="$DRAG_DROP_CANNOT_MOVE_FILE$";var g_sConfirmMoveFileFrom="$CONFIRM_MOVE_FILE_FROM$ ";var g_sTo=" $TO$ ";var g_bCaseSensitiveOS=(%CASE_SENSITIVE_OS%==1);var g_bIsiPad=false;var sUserAgentCheck=navigator.userAgent.toLowerCase();var g_bSupportsMSMQ=("%SUPPORTS_MSMQ%"!="0");var g_bMSMQLicense=("%CServer.%SERVER_ID%.MSMQLicense%"!="0");var g_bSupportWinEventLog=("%SUPPORTS_WINDOWS_EVENT_LOG%"!="0");var g_bIsDemo=(%IS_DEMO%==1);var g_bLoginUser=false;var g_nDaysRemaining=parseInt("%CServer.%SERVER_ID%.LicenseDaysRemaining%");var g_bLicenseIsTemp=(%CServer.%SERVER_ID%.LicenseIsTemp%==1);var g_bLicenseIsPastTrial=(%CServer.%SERVER_ID%.LicenseIsPastTrial%==1);var g_bIsModEvalExp=(%IS_MODIFIED_EVAL_EXP%==1);var g_sTrialExpiredTxt="$TRIAL_IS_EXPIRED$";var g_sTrialExpiresInTxt="$TRIAL_EXPIRES_IN$";var g_sTrialExpiresDaysTxt="$DAYS$";var g_sBuyNow="$BUY_NOW$";var g_bIsAdminAllowedToAddUsers=(parseInt("%IS_ADMIN_ALLOWED_TO_ADD_USERS%")!=0);var g_sDomainName="%CDomain.%ID%.DomainName%";var g_JumpToPage=0;if(%IS_LOCAL_ADMIN%){g_bIslocalAdminBrowser=true;}if(sUserAgentCheck.indexOf('ipad')!=-1)g_bIsiPad=true;var g_sEncXsrfToken="%ENC_CSRF_TOKEN%";</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BrowserCheckAW.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-ui.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-contextMenu.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mousewheel.min.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mCustomScrollbar.min.js"></script><link type="text/css" href="%COMMON_FILE%Style/Fonts.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Dialog.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Common.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/global.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery.mCustomScrollbar.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-ui.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-contextMenu.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/nav.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonHeader.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonUI.css" rel="stylesheet" /><script type="text/javascript" language="javascript">if(AW.ff3){AW.getLeft=function(element){return element.getBoundingClientRect().left-document.documentElement.getBoundingClientRect().left;};AW.getTop=function(element){return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(g_bSafariBrowser){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top-4;};}if(AW.chrome){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top+4;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1){document.write('<style type="text/css">');document.write('body,table{');document.write(' font-size:11px;font-family: Helvetica Arial sans-serif;');document.write('}');document.write('</style>');}var g_sMenuDividers="--***--";var g_sImagePath="%COMMON_FILE%Images/";var g_sCommonPath="%COMMON_FILE%";var g_sFilePath="%ADMIN_FILE%";var g_sHelpPath="%HELP_BASE_URL%";var g_sConsoleInclude="0";var g_bDomainNav=true;var g_sAdminXMLPath="%ADMIN_FILE%XML/";var g_sUseInherited="$USE_INHERITED$";var g_bIE7=true;var g_bIEDomainCheck=true;var g_sLoading="$LOADING_DIALOG_TITLE$";var g_sSelectDomainMsg='$SELECT_DOMAIN_MSG$';var g_nDomainID;var g_sHelpPage="Help-Overview.htm";var g_sHelpNode="none";var g_sCurrentURLFileName="%INTERNAL_FILE%";var g_nSessionOkay=0;var g_nPermissionDenied=3;var g_nULLMax=18446744073709551615;var g_sGB="$FS_ABBREV_GIGABYTE$";var g_sMB="$FS_ABBREV_MEGABYTE$";var g_sKB="$FS_ABBREV_KILOBYTE$";var g_sBytes="$FS_BYTES$";var g_bFVJVLaunchPage=false;var g_sUnknownError="$UNKNOWN_ERROR$";var g_sHomeStr="$HOME$";var g_ActiveTab;var g_ActivePage;var g_bODBC64BitWarn=(%CServer.%SERVER_ID%.WarnODBC64BitUpgrade%==1);var g_bAllowChangePassword=%CAN_CHANGE_PASSWORD%;var g_bAllowChangeEmail=%USER_CAN_SET_EMAIL_ADDRESS%;var g_sUserEmail=HTMLDecode("%USER_EMAIL_ADDRESS%");var g_bSysAdmin=(%CUser.%USER_ID%.AdminType%==2||%CUser.%USER_ID%.AdminType%==4);var g_bGroupAdmin=(%CUser.%USER_ID%.AdminType%==5||%CUser.%USER_ID%.AdminType%==6);var g_bDomainAdmin=((%CUser.%USER_ID%.AdminType%==1)||(%CUser.%USER_ID%.AdminType%==3));var g_bReadOnlyAccess=(%CUser.%USER_ID%.AdminType%==3||%CUser.%USER_ID%.AdminType%==4||%CUser.%USER_ID%.AdminType%==6);var g_bAllowWebClient=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bFVJVLicense=(%CServer.%SERVER_ID%.AllowFVJV%==1);var g_bAllowFVJV=(%ALLOW_FTP_VOYAGER_JV%==1);var g_bWebClientLicense=(%CServer.%SERVER_ID%.WebClientLicense%==1);var g_sFVJVLicenseInfo="$FVJV_LICENSE_INFO$";var g_sWebClienLicenseInfo="$WEB_CLIENT_LICENSE_INFO$";var g_sLicenseEmail="%CServer.%SERVER_ID%.LicenseEMail%";var g_bUsingFIPS=(%CServer.%SERVER_ID%.UsingFIPS%==1);var g_sWebFilePath=%FILE%;var g_bAllowAdhocFileSharing=(%ALLOW_ADHOC_FILE_SHARING%==1);var g_bFileSharingLicense=(%CServer.%SERVER_ID%.FileSharingLicense%==1);var g_sAdhocFileShareLicenseInfo="$ADHOC_LICENSE_INFO$";if(!g_bSysAdmin)g_nDomainID=%DOMAIN_ID%;setTimeout("OnSendNOOP()",55000);</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Menus.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/InitialScript.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/utility.js"></script><script type="text/javascript" language="javascript">function RecommendAdminIEUpgrade(){if(g_bIslocalAdminBrowser){var bRecommendIEUpgrade=false;var nVersion=0;if(navigator.appVersion.indexOf("MSIE")!=-1){aTemp=navigator.appVersion.split("MSIE");nVersion=parseFloat(aTemp[1]);}if(nVersion>5.5&&nVersion<8)bRecommendIEUpgrade=(%WARN_OLD_BROWSER%!=0);if(navigator.userAgent.indexOf("MSIE")!=-1){var nVersionIndex=(navigator.userAgent.indexOf("MSIE")+5);var nVersionIE=parseInt(navigator.userAgent.charAt(nVersionIndex));if(nVersionIE>=8)bRecommendIEUpgrade=false;else if((navigator.userAgent.indexOf("compatible")!=-1)&&(nVersionIE>=8))bRecommendIEUpgrade=false;}if(bRecommendIEUpgrade)window.location.href="%FILE%AdminIEWarning.htm";}}</script><div id="ChangePasswordDialoginner" style="display:none;"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;"><div>$OLD_PASSWORD$:<div style="overflow:auto"><span id="OldPasswordChange"></span></div></div><div>$NEW_PASSWORD$:<br /><div style="overflow:auto"><span id="NewPasswordChange"></span></div></div><div>$VERIFY_PASSWORD$:<div style="overflow:auto"><span id="VerifyNewPasswordChange"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"></span><br /><span id="CancelChangePasswordButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var sWebClientChangePWord=undefined;var sChangePWordImg=undefined;try{if(g_bIsWebClient){sWebClientChangePWord="WC-Icon-ChangePassword";}else{sChangePWordImg="Change_Password16.png";}}catch(e){sChangePWordImg="Change_Password16.png";}BuildDialog("$CHANGE_PASSWORD_TITLE$","ChangePasswordDialog","300","155","","$CLOSE_CANCEL$",sChangePWordImg,undefined,sWebClientChangePWord);function OnChangePasswordSubmit(){var sChangePasswordCmd="%FILE%Login.xml?Command=LoginChangePassword";var ChangePasswordRequest=CreatePostRequest(sChangePasswordCmd);var sOldPassWord,sNewPassWord,sVerifyPassWord;sOldPassWord=OldPasswordInput.getControlText();sNewPassWord=NewPasswordInput.getControlText();sVerifyPassWord=VerifyNewPasswordInput.getControlText();if(sNewPassWord==sVerifyPassWord){ChangePasswordRequest.setParameter("old_password",sOldPassWord);ChangePasswordRequest.setParameter("new_password",sNewPassWord);ChangePasswordRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);ChangePasswordRequest.setAsync(true);ChangePasswordRequest.request();ChangePasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sWelcomeMsg=GetXMLValue(XMLDoc,"welcomemsg");if(nResult!=0){if(nResult==1)sResultText="$ERROR_PASSWORD_CHANGE_FAIL$";AlertDialog(GetResultText(0,"",sResultText));}else if(g_bLoginUser){ReplaceDialog("ChangePasswordDialog","LoggingInDialog");OnLoginOK(false,nResult,XMLDoc);}else{HideDialog('ChangePasswordDialog');AlertDialog("$PASSWORD_CHANGED$");}};}else{AlertDialog("$PASSWORDS_DONT_MATCH$",true);}}function OnCancelChangePassword(){HideDialog('ChangePasswordDialog');location.href="%LOGOUT%";}function ClearPasswordDialog(){OldPasswordInput.setControlText("");NewPasswordInput.setControlText("");VerifyNewPasswordInput.setControlText("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");OldPasswordInput.getContent("box/text").element().focus();if(bLogin){CancelPasswordButton.setControlText("$LOGOUT$");document.getElementById("ChangePasswordDialogCloseIcon").onmousedown=OnCancelChangePassword;}}CreateDialogPushButton("$OK_BUTTON$","ChangePasswordButton",OnChangePasswordSubmit);var CancelPasswordButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelChangePasswordButton",OnCancelChangePassword);var OldPasswordInput=CreatePasswordField("","OldPasswordChange","OldPasswordChange",undefined,200);var NewPasswordInput=CreatePasswordField("","NewPasswordChange","NewPasswordChange",undefined,200);var VerifyNewPasswordInput=CreatePasswordField("","VerifyNewPasswordChange","VerifyNewPasswordChange",undefined,200);</script><div id="UserEmailDialoginner" style="display:none;"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;">$EMAIL_DESCR$ <br /><div style="margin-top:5px;">$EMAIL$:<br /><div style="overflow:auto"><span id="CurrentUserEmail"></span></div></div><div>$VERIFY_EMAIL$:<br /><div style="overflow:auto"><span id="UserEmail"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"></span><br /><span id="LogoutUserEmailButton"></span><span id="CancelUserEmailButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sWebClientChangeEmail=undefined;var sChangeEmailImg=undefined;try{if(g_bIsWebClient){sWebClientChangeEmail="WC-Icon-ChangeEmail";}else{sChangeEmailImg="ChangeEmail.png";}}catch(e){sChangeEmailImg="ChangeEmail.png";}BuildDialog("$USER_EMAIL_TITLE$","UserEmailDialog","300","160","","$CLOSE_CANCEL$",sChangeEmailImg,undefined,sWebClientChangeEmail);function OnSetEmailAddressSubmit(){var sSetEmailCmd="%FILE%Result.xml?Command=SetEmailAddress";var SetEmailRequest=CreatePostRequest(sSetEmailCmd);var sEmailAddrs,CurrentEmailAddr;sEmailAddr=UserEmailInput.getControlText();sCurrentEmailAddr=CurrentUserEmail.getControlText();SetEmailRequest.setParameter("emailaddress",sEmailAddr);SetEmailRequest.setAsync(true);if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.request();else AlertDialog("$EMAIL_VALS_NO_MATCH$");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{HideDialog('UserEmailDialog');if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnCancelSetEmail(){HideDialog('UserEmailDialog');}function ClearSetEmailDialog(){UserEmailInput.setControlText("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(bNoCloseButton){var DialogCloseContainer=document.getElementById("UserEmailDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("UserEmailDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";CancelEmailButton.setStyle("display","none");LogoutUserEmailButton.setStyle("display","");}else{LogoutUserEmailButton.setStyle("display","none");}if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)CurrentUserEmail.setControlText(sEmail);else ClearSetEmailDialog();ShowDialog("UserEmailDialog");CurrentUserEmail.getContent("box/text").element().focus();}function OnLogoutEmailSet(){location.href="%LOGOUT%";}CreateDialogPushButton("$OK_BUTTON$","SaveUserEmailButton",OnSetEmailAddressSubmit);var CancelEmailButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelUserEmailButton",OnCancelSetEmail);var LogoutUserEmailButton=CreateDialogPushButton("$LOGOUT$","LogoutUserEmailButton",OnLogoutEmailSet);var UserEmailInput=CreateInputField("","UserEmail","UserEmail",undefined,200,undefined,undefined,OnSetEmailAddressSubmit);var CurrentUserEmail=CreateInputField("","CurrentUserEmail","CurrentUserEmail",undefined,200,undefined,undefined);</script>
<script type="text/vbScript" language="vbscript">
<!--
Function VBDateFormat(sDateSeconds,nTimeZoneOffset)
sDate=DateAdd("s", sDateSeconds, "1/1/1970 00:00:00 AM")
sDate=DateAdd("n", -nTimeZoneOffset, sDate)
VBDateFormat = FormatDateTime(sDate,0)
End Function
-->
</script>
<style type="text/css">#SelectUserGroupStatsRadio {height: 50px;}#SelectUserGroupStatsRadio .aw-list-item {height: 20px;}.aw-item-template{height:18px;}#ChangeTheme-popup-box .aw-item-template{height:16px;}#Info_GroupStats-popup-box .aw-item-template,#Info_UserStats-popup-box .aw-item-template{height:16px !important;}.progressbar{width:243px;height:100%;background-image: url(/Web%20Client/Images/ProgressFill.png);background-repeat: no-repeat;background-position: 100% 0px;margin:0px auto 0px auto;}.progresscontainer{margin:0px auto 0px auto;width:246px;height:15px;background-image: url(/Web%20Client/Images/ProgressBar.png);background-repeat: no-repeat;text-align:center;}/*.aw-ie #GroupStats .aw-combo-box .aw-item-text, .aw-ie #UserStats .aw-combo-box .aw-item-text {position:relative;top:0px;left:0px;width:100%;margin:-3px -1px;}*/.aw-ie #GroupStats .aw-combo-box .aw-item-image, .aw-ie #UserStats .aw-combo-box .aw-item-image {margin-top:-7px;}</style><div id="AlertDialoginner" style="display:none;"><table border="0"><tr><td style="vertical-align:top;"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px"></td><td style="text-align:left; padding-right: 10px"><span id="AlertDialogText" style="word-break: break-word; -ms-word-break: break-word; display: inline-block"></span><div id="AlertNoShowContainer" style="display:none;padding-top:10px;"><span id="AlertNoShowDialogCheckBox"></span></div></td></tr></table><div style="width:100%;text-align:center;"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></div><!--tr><td colspan="2" style="text-align:center"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></td></tr></table--></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var ExtraButton,g_bAlertNoShow,g_sAlertNoShowCookie;InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";BuildDialog("%PRODUCT%","AlertDialog","250","115","text-align:center","$CLOSE_CANCEL$");function AlertDialog(sText,bWarn,fn_OKCallback,bWebClientIcon,sExtraButtonText,fn_ExtraCallback,nWidth,nHeight,bAlertNoShow,sAlertNoShowCookie){WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";g_bAlertNoShow=false;g_sAlertNoShowCookie="";document.getElementById("AlertNoShowContainer").style.display="none";if(bWebClientIcon){document.getElementById("AlertDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("AlertDialogTitleIcon").height="16";document.getElementById("AlertDialogTitleIcon").width="16";}if((sExtraButtonText!=undefined)&&(fn_ExtraCallback!=undefined)){ExtraButton=CreatePushButton(sExtraButtonText,"ExtraButton",function(){HideDialog("AlertDialog");fn_ExtraCallback();});document.getElementById("ExtraButton").style.display="";}else{document.getElementById("ExtraButton").style.display="none";ExtraButton=undefined;fn_ExtraCallback=undefined;}if(nWidth!=undefined){document.getElementById("AlertDialog").style.width=nWidth+"px";}else document.getElementById("AlertDialog").style.width="250px";if(bAlertNoShow&&sAlertNoShowCookie!=undefined){g_bAlertNoShow=true;g_sAlertNoShowCookie=sAlertNoShowCookie;document.getElementById("AlertNoShowContainer").style.display="block";}g_fnAlertOKCallback=fn_OKCallback;if(document.getElementById("AlertImage")!=undefined){if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;document.getElementById("AlertImage").src=sImage;}if((document.getElementById("AlertDialogText")!=undefined)&&(sText!=undefined))document.getElementById("AlertDialogText").innerHTML=sText;ShowDialog("AlertDialog");OKAlertButton.focus();}function WarnDialog(sText,bWebClientIcon){AlertDialog(sText,true,undefined,bWebClientIcon);}function OnAlertDialogOkay(){HideDialog("AlertDialog");if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();document.getElementById("AlertImage").src=BlankImg.src;g_fnAlertOKCallback=undefined;if(g_bAlertNoShow){if(AlertNoShowCheckBox.getControlValue())createCookie(g_sAlertNoShowCookie,"1",60);}}var OKAlertButton=CreatePushButton("$OK_BUTTON$","AlertDialogOkButton",OnAlertDialogOkay);var AlertNoShowCheckBox=CreateCheckBox("$DONT_SHOW_AGAIN$","AlertNoShowDialogCheckBox","AlertNoShowCheckBox");</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_sBusyDialog="BusyDialog";function BusyDialog(bShow,sTitle,bWebClientIcon,bFromApplet){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top!="-5000px")bSkip=true;if(!bSkip){if(bShow)ShowDialog(g_sBusyDialog,undefined,undefined,bFromApplet);else{HideDialog(g_sBusyDialog,undefined,bFromApplet);sTitle="$BUSY_DIALOG_TITLE$";}SetupBusyDialog(sTitle,bWebClientIcon);}}function SetupBusyDialog(sTitle,bWebClientIcon){var TitleText=document.getElementById("BusyDialogTitleText");var sBusyDialogImage="su16x16.png";MCBusyDialogImage=new Image();MCBusyDialogImage.src="%COMMON_FILE%Images/su16x16.png";WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bWebClientIcon)document.getElementById("BusyDialogTitleIcon").src=WCBusyDialogImage.src;else document.getElementById("BusyDialogTitleIcon").src=MCBusyDialogImage.src;if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML="<strong>"+sTitle+"</strong>";var DialogCloseContainer=document.getElementById("BusyDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("BusyDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";}function SavingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$SAVING_DIALOG_TITLE$",bWebClientIcon);}function LoadingDialog(bShow,bWebClientIcon){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top=="-5000px")bSkip=true;if(!bSkip)BusyDialog(bShow,"$LOADING_DIALOG_TITLE$",bWebClientIcon);}function DeletingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$DELETING_DIALOG_TITLE$",bWebClientIcon);}</script><div id="BusyDialoginner" style="display:none;text-align:center;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" style="margin:0px auto 0px auto;"></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("$BUSY_DIALOG_TITLE$","BusyDialog","200","50","text-align:center","$CLOSE_CANCEL$");</script><div id="ConfirmDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"><table border="0" id="ConfirmDialogtable"><tr><td><img src="%COMMON_FILE%Images/QuestionMark.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div id="ConfirmDialogText" style="width:200px;overflow-y:visible;overflow-x:auto;text-align:left;padding-left:2px;"></div></td></tr><tr><td colspan="2" style="text-align:center" id="ConfirmDialogbuttons"><span id="ConfirmDialogYesButton"></span><span id="ConfirmDialogNoButton"></span></td></tr></table></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("%PRODUCT%","ConfirmDialog","250","115","text-align:center","$CLOSE_CANCEL$");var g_sDeletingDialogTitle="$DELETING_DIALOG_TITLE$";var g_sConfirmDialog="ConfirmDialog";var g_fnYes=undefined,g_fnNo=undefined;var g_YesNoData=undefined;var g_bNoCloseDialog=false;var DEFAULT_CONFIRM_DIALOG_SIZE={WIDTH:"250px",HEIGHT:"115px"};function ConfirmDialog(sText,fnYes,fnNo,YesNoData,nWidth,nHeight,bDelete,bWebClientIcon,bNoCloseDialog,fnClose){var confirmDialog=document.getElementById("ConfirmDialog");var confirmDialogText=document.getElementById("ConfirmDialogText");var confirmDialogIcon=document.getElementById("ConfirmDialogTitleIcon");var dialogSize=getDialogSize(nWidth,nHeight);g_fnYes=g_fnNo=undefined;WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bNoCloseDialog)g_bNoCloseDialog=true;else g_bNoCloseDialog=false;if(bWebClientIcon){confirmDialogIcon.src=WCBusyDialogImage.src;confirmDialogIcon.height="16";confirmDialogIcon.width="16";}if((confirmDialogText!=undefined)&&(sText!=undefined)){confirmDialogText.innerHTML=sText;}g_fnYes=fnYes;g_fnNo=fnNo;g_YesNoData=YesNoData;confirmDialog.style.width=dialogSize.width;confirmDialogText.style.width=(parseInt(dialogSize.width)-50)+"px";document.getElementById("ConfirmDialogBody").style.overflow="hidden";document.getElementById("ConfirmDialogBody").style.textOverflow="ellipsis";ShowDialog("ConfirmDialog",undefined,fnClose);if(bDelete)ConfirmDialogNoButton.focus();else ConfirmDialogYesButton.focus();}function getDialogSize(customWidth,customHeight){var dialogWidth=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;var dialogHeight=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;if(!!customWidth){dialogWidth=isWithUnits(customWidth)?customWidth:customWidth+"px";}if(!!customHeight){dialogHeight=isWithUnits(customHeight)?customHeight:customHeight+"px";}return{width:dialogWidth,height:dialogHeight};}function isWithUnits(size){return size.toString().match(/px|%|vh|vw|em|rem/);}function CloseConfirmDialog(){HideDialog("ConfirmDialog");}function OnConfirmDialogYes(){if(g_fnYes!=undefined){setTimeout(function(){g_fnYes(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}if(!g_bNoCloseDialog)CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined){setTimeout(function(){g_fnNo(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}CloseConfirmDialog();}var ConfirmDialogYesButton=CreatePushButton("$YES_BUTTON$","ConfirmDialogYesButton",OnConfirmDialogYes);ConfirmDialogYesButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogYesButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogNoButton.focus();}});var ConfirmDialogNoButton=CreatePushButton("$NO_BUTTON$","ConfirmDialogNoButton",OnConfirmDialogNo);ConfirmDialogNoButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogNoButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogYesButton.focus();}});</script><div id="TopPntToolTipDialog" style="width:220px;height:180px;" class="DialogLayer"><table id="TopPntToolTipDialogTitleBar" class="ToolTipDialogTitle" cellpadding="0" cellspacing="0"><tr><td colspan="3" class="TopPointer">&nbsp;</td></tr><tr><td class="ToolTipLeftCorner"><img src="%COMMON_FILE%Images/tooltip-left-top.png" width="27" height="23" border="0"></td><td class="TopPntToolTipHeadContainer"><div id="TopPntToolTipDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:5px;"><span id="TopPntToolTipDialogTitleText" style="font-weight:bold;">&nbsp;</span></div></td><td class="ToolTipRightCorner"><a href="javascript:HideDialog('TopPntToolTipDialog', true);"><img src="%COMMON_FILE%Images/tooltip-right-top.png" width="27" height="23" alt="$CLOSE_CANCEL$" border="0" onmouseover="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top-over.png'" onmouseout="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top.png'"></a></td></tr></table><div id="TopPntToolTipDialogBody" style="width:2px;" class="ToolTipDialogBody"><div style="padding:0 5px 0 5px;"><span id="TopPntToolTipDialogText"></span></div></div><table class="ToolTipFooter" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCornerBottom">&nbsp;</td><td class="ToolTipFooterFill">&nbsp;</td><td class="ToolTipRightCornerBottom">&nbsp;</td></tr></table></div><script type="text/javascript" language="JavaScript">var g_fnToolTipCallback=undefined;TPBubbleLoadingImg1=new Image();TPBubbleLoadingImg1.src="%COMMON_FILE%Images/tooltip-left-top.png";TPBubbleLoadingImg2=new Image();TPBubbleLoadingImg2.src="%COMMON_FILE%Images/tooltip-right-top.png";TPBubbleLoadingImg3=new Image();TPBubbleLoadingImg3.src="%COMMON_FILE%Images/tooltip-right-top-over.png";TPBubbleLoadingImg4=new Image();TPBubbleLoadingImg4.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";TPBubbleLoadingImg5=new Image();TPBubbleLoadingImg5.src="%COMMON_FILE%Images/Tooltip-fill.png";function TopToolTipDialog(sTitle,sText,fn_CloseCallback,ToolTipPosObj,nWidth,nHeight,sCheckboxFunc,sResetId,xPointOffSet,yPointOffSet){if(fn_CloseCallback!=undefined)g_fnToolTipCallback=fn_CloseCallback;if((document.getElementById("TopPntToolTipDialogText")!=undefined)&&(sText!=undefined))document.getElementById("TopPntToolTipDialogText").innerHTML=sText;if((document.getElementById("TopPntToolTipDialogTitleText")!=undefined)&&(sTitle!=undefined))document.getElementById("TopPntToolTipDialogTitleText").innerHTML=sTitle;if(sCheckboxFunc!=undefined){sHideDialogFunction=String("HideDialog(");document.getElementById("TopPntToolTipDialogText").innerHTML+="<div style='padding-top:5px;'><input type='checkbox' value='noshow' onclick='"+sCheckboxFunc+sHideDialogFunction+"\"TopPntToolTipDialog\", true);'/> $DONT_SHOW_AGAIN$</div>";}ShowToolTipDialog('TopPntToolTipDialog',false,g_fnToolTipCallback,ToolTipPosObj,nWidth,nHeight,true,50,30,sResetId,xPointOffSet,yPointOffSet);var nWidthAdjust;nWidthAdjust=parseInt(document.getElementById("TopPntToolTipDialogBody").style.width);if(bIsOpera)document.getElementById("TopPntToolTipDialogBody").style.width=(nWidthAdjust).toString()+"px";}</script><script type="text/javascript" language="JavaScript">var g_sAttrLogObjectType="Domain";var g_nAttrLogObjectId=%ID%;var g_sAjaxNotSupported="$AJAX_NOT_SUPPORTED$";var g_nDefaultOrgID=%CDomain.%ID%.GeneralUsers.ID%;var g_nCookieOrgID=readCookie("%ID%StatsID");var g_nCookieUserID=readCookie("%ID%UserID");var g_nCookieGroupID=readCookie("%ID%GroupID");var g_nUserGroupRadioSave=readCookie("%ID%UserGroupRadio");var g_nActiveGroupID=%CDomain.%ID%.Groups.ID%;var g_nODBCGroupID=parseInt("%CDomain.%ID%.ODBCGroups.ID%");var g_bOrgNotLoaded=true;var g_nODBCUserOrg=parseInt("%CDomain.%ID%.ODBCUsers.ID%");var g_nNTGroupID=parseInt("%CDomain.%ID%.NTGroup.ID%");var g_bDomainActivity=true;var g_ActiveRezizeGrid;var g_nGridOffSet=490;var g_sLogFile="%CDomain.%ID%.CurrentLogFilePath%";g_ActivePage=6;</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/XMLHTTPRequest.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/ObjectTable.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BasicGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/AdminGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Dialog.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/commonlogscripts.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/DomainAttrLogScripts.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/SessionLogScripts.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/NaturalSort.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/FileList.js"></script><div id="BrowseDialogDiv" style="display:none;"></div><div id="LogIPAccessDialoginner" style="display:none;"><form name="LogIPAccessForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div style="width:225px;float:left;"><div style="overflow:auto"><span id="LogIPAccessRule"></span></div></div><div style="width:135px;float:left;padding-left:5px;"><span id="ApplyToScreen"></span><br /><span id="ApplyToFile"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;" rowspan="2"><span id="SaveLogIPAccessButton"></span><br /><span id="CancelLogIPAccessButton"></span><br /><br /><span id="HelpLogIPAccessButton"></span></td></tr><tr><td><div id="LogIPAccessTipsGroup"><div style="width:100px;float:left;margin-bottom:5px;padding-left:3px;">xxx = $IP_RULE_MATCH$<br />* = $IP_RULE_ANY$<br /></div><div style="width:235px;float:left;padding-left:5px;margin-bottom:5px;">| &nbsp; xxx-xxx = $IP_RULE_RANGE$<br />| &nbsp; ? = $IP_RULE_ANY_CHAR$</div></div></td></tr></table><input type="hidden" id="ApplyIPToFileCheck" value="1" /><input type="hidden" id="ApplyIPToScreenCheck" value="0" /></form></div><script type="text/javascript" language="javascript">BuildDialog("$LOG_IP_ACCESS_DIALOG_TITLE$","LogIPAccessDialog","475","182","","$CLOSE_CANCEL$");AW.Formats.IPAccessString=AW.Formats.XMLString.subclass();AW.Formats.IPAccessString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sTemp=Grid.getCellData(4,nRow);if(sTemp=="")sTemp=Grid.getCellData(5,nRow);if((sTemp!="")||((sTemp=Grid.getCellData(5,nRow))!=""))return(FormatClientString(data)+" ("+FormatClientString(sTemp)+")");else return(FormatClientString(data));};obj.dataToValue=function(data,Grid,nColumn,nRow){return(this.dataToText(data,Grid,nColumn,nRow));}};function OnLogIPAccessLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("LogIPAccessDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}var sLoggingID="%CDomain.%ID%.Logging.ID%";if(sLoggingID!="-1"){LogApplyScreenCheck.setControlValue(parseInt(document.LogIPAccessForm.Screen.value)?true:false);LogApplyFileCheck.setControlValue(parseInt(document.LogIPAccessForm.File.value)?true:false);}else{document.getElementById("ApplyIPToFileCheck").name="File";document.getElementById("ApplyIPToFileCheck").value="1";document.getElementById("ApplyIPToScreenCheck").name="Screen";document.getElementById("ApplyIPToScreenCheck").value="0";}LogIPRule.setControlText(document.getElementById(LogIPRule.getContent("box/text").getId()).value);}function OnSaveLogIPAccess(){if(LogIPRule.getControlText()!="")LogIPAccessList.OnSaveObject();else AlertDialog("$PLEASE_ENTER_RULE$");return(false);}function OnCancelLogIPAccess(){HideDialog('LogIPAccessDialog');}function OnLogIPAccessHelp(){LaunchHelp("Help-IP-ACL.htm","Item2_2");}var LogIPRule=CreateInputField("","LogIPAccessRule","LogIPAccess_IP",undefined,225,undefined,undefined,OnSaveLogIPAccess);var sLoggingID="%CDomain.%ID%.Logging.ID%";if(sLoggingID!="-1"){var LogApplyScreenCheck=CreateCheckBox("$LOG_APPLY_SCREEN$","ApplyToScreen","Screen",false,undefined,true);var LogApplyFileCheck=CreateCheckBox("$LOG_APPLY_FILE$","ApplyToFile","File",false,undefined,true);}CreateGroupBox("$IP_ACCESS_TIPS$","LogIPAccessTipsGroup","360px","65px",true);CreateDialogPushButton("$SAVE_BUTTON$","SaveLogIPAccessButton",OnSaveLogIPAccess);CreateDialogPushButton("$CANCEL_BUTTON$","CancelLogIPAccessButton",OnCancelLogIPAccess);CreateDialogPushButton("$HELP_BUTTON$","HelpLogIPAccessButton",OnLogIPAccessHelp);</script><div id="LogIPAccessListDialoginner" style="display:none;"><div id="LogIPAccessListContent" style="padding-right:8px;><div class="layercontent"><div style="display:inline;"><img alt="$LOG_IP_ACCESS_LIST_DIALOG_TITLE$" src="%ADMIN_FILE%Images/IpAccess32.png" width="32" height="32" class="header-icon" />$LOG_IP_ACCESS_LIST_INFO$<div style='clear:both;height:5px;overflow:hidden;'></div></div><span id="LogIPAccessList"></span><table cellpadding="0" cellspacing="0" border="0" style="margin-top:5px;width:537px;"><tr><td style="text-align:left;"><span id="AddLogIPAccessButton"></span><span id="EditLogIPAccessButton"></span><span id="DeleteLogIPAccessButton"></span></td><td style="text-align:right;"><span id="LogIPAccessHelpButton"></span><span id="CloseLogIPAccessListButton"></span></td></tr></table></div></div></div><script type="text/javascript" language="javascript">BuildDialog("$LOG_IP_ACCESS_LIST_DIALOG_TITLE$","LogIPAccessListDialog","550","320","","$CLOSE_CANCEL$","IpAccess16.png");var LogIPAccessList=CreateAdminGrid("LogIPAccessList",["$RULE_ADDRESS$","$APPLIES_TO$"],[450,75],"DomainLogIPAccess.xml?ID=%CDomain.%ID%.Logging.ID%","rules","rule",7,OnEditLogIPAccess);LogIPAccessList.setStyle("height","200px");LogIPAccessList.setCellFormat([new AW.Formats.IPAccessString,new AW.Formats.String]);LogIPAccessList.getCellImage=function(nCol,nRow){return(LogIPAccessFormat.call(this,nCol,nRow));};var sOnAddLogIPAccess=String("OnAddLogIPAccess(");var sOnEditLogIPAccess=String("OnEditLogIPAccess(");var sOnDeleteLogIPAccess=String("OnDeleteLogIPAccess(");CreateContextMenu([sOnEditLogIPAccess,"",sOnAddLogIPAccess,sOnDeleteLogIPAccess],[function(){return(OnEqualOneContextMenu(LogIPAccessList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(LogIPAccessList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(LogIPAccessList,"$DELETE_BUTTON$..."))}],["Edit","","New","FileDelete"],LogIPAccessList,"LogIPAccessListContext",true);CreatePushButton("$ADD_BUTTON$...","AddLogIPAccessButton",OnAddLogIPAccess);CreatePushButton("$EDIT_BUTTON$...","EditLogIPAccessButton",OnEditLogIPAccess);CreatePushButton("$DELETE_BUTTON$","DeleteLogIPAccessButton",OnDeleteLogIPAccess);CreateDialogPushButton("$HELP_BUTTON$","LogIPAccessHelpButton",OnLogIPAccessHelp);CreateDialogPushButton("$CLOSE_BUTTON$","CloseLogIPAccessListButton",OnCloseLogIPAccessListDialog);function LogIPAccessFormat(nCol,nRow){var bFile=(this.getCellText(2,nRow)!="0"),bScreen=(this.getCellText(3,nRow)!="0");var sAppliesTo="";if((bFile)&&(bScreen))sAppliesTo="$LOG_BOTH$";else if(bFile)sAppliesTo="$LOG_FILE$";else if(bScreen)sAppliesTo="$LOG_SCREEN$";else sAppliesTo="$LOG_NONE$";this.UpdateText(sAppliesTo,1,nRow);return("RuleDeny");}function EnableDisableUserGroupLogIPAccess(sDisableDialogStr){ClearGrid(LogIPAccessList,true);LogIPAccessList.EnableUpdates(sDisableDialogStr==undefined,"ID=%CDomain.%ID%.Logging.ID%","ID="+document.getElementById("LoggingID").value);}function EnableDisableLogIPAccess(sDisableDialogStr){LogIPAccessList.EnableUpdates(sDisableDialogStr==undefined);}function OnAddLogIPAccess(){var sLoggingID="%CDomain.%ID%.Logging.ID%";if(sLoggingID=="-1")sLoggingID=document.getElementById("LoggingID").value;LogIPAccessList.OnAddObject("LogIPAccess.xml%DEFAULT_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess","Result.xml%ADD_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess",document.LogIPAccessForm,"LogIPAccessDialog",[OnLogIPAccessLoad],g_bReadOnlyAccess);}function OnEditLogIPAccess(){var sLoggingID="%CDomain.%ID%.Logging.ID%";if(sLoggingID=="-1")sLoggingID=document.getElementById("LoggingID").value;LogIPAccessList.OnEditObject("LogIPAccess.xml","Result.xml%UPDATE_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess.",document.LogIPAccessForm,"LogIPAccessDialog","$SELECT_ONLY_ONE_IPACCESS_EDIT$","$SELECT_ONE_IPACCESS_EDIT$",[OnLogIPAccessLoad]);}function OnDeleteLogIPAccess(){var sLoggingID="%CDomain.%ID%.Logging.ID%";if(sLoggingID=="-1")sLoggingID=document.getElementById("LoggingID").value;LogIPAccessList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CSessionAttrsLogging."+sLoggingID+".LoggingIPAccess&ID="+sLoggingID,"$ASK_DELETE_IPACCESS$","$SELECT_ONE_IPACCESS_DELETE$");}function OnCloseLogIPAccessListDialog(){HideDialog("LogIPAccessListDialog");}function OnLogIPAccessHelp(){LaunchHelp("Help-Configure-Logs.htm","Item16_4");}</script><div id="LogFilterDialoginner" style="display:none;"><form name="LogFilterForm" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:top;">$LOG_FILTER_INFO$<div style="overflow:auto"><span id="FilterText"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="FilterLogButton"></span><br /><span id="CancelFilterLogButton"></span><br /><br /><span id="ResetFilterLogButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$FILTER_DIALOG_TITLE$","LogFilterDialog","325","138","","$CLOSE_CANCEL$");var g_sFilterLogText="";function OnShowLogFilter(){ShowDialog("LogFilterDialog");document.getElementById("FilterText-box-text").focus();}function OnFilterLog(){g_sFilterLogText=FilterTextInput.getControlText();g_bFirstLogRequest=true;InitDomainAttrLog();HideDialog("LogFilterDialog");}function OnCancelFilterLog(){g_sFilterLogText="";FilterTextInput.setControlText("");HideDialog("LogFilterDialog");}function OnFilterLogReset(){g_bFirstLogRequest=true;g_sFilterLogText="";FilterTextInput.setControlText("");InitDomainAttrLog();HideDialog("LogFilterDialog");}var FilterTextInput=CreateInputField("","FilterText","FilterText",undefined,200,undefined,false,OnFilterLog);CreateDialogPushButton("$FILTER_BUTTON$","FilterLogButton",OnFilterLog);CreateDialogPushButton("$CANCEL_BUTTON$","CancelFilterLogButton",OnCancelFilterLog);CreateDialogPushButton("$RESET_BUTTON$","ResetFilterLogButton",OnFilterLogReset);</script><div id="ResetAllStatsDialoginner" style="display:none;"><form name="ConfirmResetAllStatsForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><img src="%COMMON_FILE%Images/QuestionMark.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;"><span id="ResetAllStatsDialogInfo"></span></td></tr><tr><td colspan="2" style="text-align:center"><span id="ResetAllOrgButton"></span>&nbsp;&nbsp;<span id="ResetThisOrgButton"></span>&nbsp;&nbsp;<span id="ResetAllCloseButton"></span></td></tr></table></form></div><div id="ResetAllProgressDialoginner" style="display:none;"><table class="DialogTable"><tr><td style="width:42px;"><img src="%COMMON_FILE%Images/ResetAll-32.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;text-align:left;"><span id="ResetAllProgressDialogInfo"></span> <span id="progressname" style="font-weight:bold;"></span></td></tr><tr><td colspan="2" style="text-align:center"><div id="progressblock" style="text-align:center;margin:10px 0 10px 0;visibility:hidden;"><table cellpadding="0" cellspacing="0" style="vertical-align:top;margin:0 auto 0 auto;"><tr><td><div class="progresscontainer"><div id="ProgressDiv" class="progressbar"></div></div></td><td style="width:55px;text-align:right;"><span id="percentcomplete">&nbsp;</span></td></tr></table></div><span id="ResetAllProgressCancelButton"></span></td></tr></table></div><script type="text/javascript" language="javascript">var g_ResetAllCanceled=false;BuildDialog("$CONFIRM_RESET_ALL_DIALOG_TITLE$","ResetAllStatsDialog","325","138","","$CLOSE_CANCEL$","ResetAll.png");BuildDialog("$RESET_ALL_PROGRESS_DIALOG_TITLE$","ResetAllProgressDialog","325","138","","$CLOSE_CANCEL$","ResetAll.png");function OnShowResetAllStats(){if(g_bGroupStats){document.getElementById("ResetAllStatsDialogInfo").innerHTML="$RESET_ALL_GROUP_STATS_INFO$";ResetThisOrgButton.setControlText("$YES_BUTTON$");ResetAllCloseButton.setControlText("$NO_BUTTON$");document.getElementById("ResetAllOrgButton").style.display="none";}else{document.getElementById("ResetAllStatsDialogInfo").innerHTML="$RESET_ALL_STATS_INFO$";ResetThisOrgButton.setControlText("$RESET_THIS_ORG_BUTTON$");ResetAllCloseButton.setControlText("$CANCEL_BUTTON$");document.getElementById("ResetAllOrgButton").style.display="";}ShowDialog("ResetAllStatsDialog");}function OnResetAllOrgs(){OnResetAllOrgStats(1);}function OnResetThisOrg(){if(g_bGroupStats)OnResetAllGroupStats();else OnResetAllOrgStats(0);}function OnCloseConfirmResetAll(){HideDialog("ResetAllStatsDialog");}function OnCloseProgressResetAll(){HideDialog("ResetAllProgressDialog");}function OnCloseProgressResetAllDialog(){g_ResetAllCanceled=true;ProgressFill(-1);}function OnShowProgressProgressResetAll(){if(g_bGroupStats)document.getElementById("ResetAllProgressDialogInfo").innerHTML="$RESETTING_GROUP_STATS_PROGRESS$:";else document.getElementById("ResetAllProgressDialogInfo").innerHTML="$RESETTING_USER_STATS_PROGRESS$:";ReplaceDialog("ResetAllStatsDialog","ResetAllProgressDialog",OnCloseProgressResetAllDialog);}function OnResetAllGroupStats(){var anGroupStatsID=[];var anGroupStatsName=[];g_ResetAllCanceled=false;for(var nIndex=0;nIndex<GroupStatsCombo.getItemCount();nIndex++){anGroupStatsID.push(GroupStatsCombo.getItemValue(nIndex));anGroupStatsName.push(GroupStatsCombo.getItemText(nIndex));}var nLength=anGroupStatsID.length;OnShowProgressProgressResetAll();SendResetAllGroupStats(anGroupStatsID,anGroupStatsName,nLength);}function SendResetAllGroupStats(anGroupStatsID,anGroupStatsName,nLength){if(anGroupStatsID.length>0&&!g_ResetAllCanceled){var objGroupResetCommand=CreatePostRequest("%ADMIN_FILE%XML/Result.xml?Command=ObjectCommand&Object=CGroup."+anGroupStatsID.pop()+".ResetStats");var sGroupName=anGroupStatsName.pop();if(anGroupStatsID.length==(nLength-1))ProgressFill(0,sGroupName);objGroupResetCommand.response=function(){var xmlDoc=this.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"result");var sResultText=GetXMLValue(xmlDoc,"ResultText");if((nResult!=undefined)&&(nResult!=g_nSessionOkay)){if(nResult==g_nPermissionDenied)AlertDialog("$SESS_GROUP_NO_RESET_PERM$");else AlertDialog(GetResultText(0,"",sResultText));}else{ProgressFill(parseInt(((nLength-anGroupStatsID.length)/nLength)*100),sGroupName);if(anGroupStatsID.length>0)SendResetAllGroupStats(anGroupStatsID,anGroupStatsName,nLength);else{setTimeout(function(){OnCloseProgressResetAll();},500);}}};objGroupResetCommand.request(null);}else ProgressFill(-1);}function OnResetAllOrgStats(bAllStats){var anOrgStatsID=[];var anOrgStatsName=[];g_ResetAllCanceled=false;if(bAllStats){for(var nIndex=0;nIndex<CollectionCombo.getItemCount();nIndex++){anOrgStatsID.push(CollectionCombo.getItemValue(nIndex));
anOrgStatsName.push(CollectionCombo.getItemText(nIndex));}}else{anOrgStatsID.push(CollectionCombo.getItemValue(CollectionCombo.getSelectedItems()));anOrgStatsName.push(CollectionCombo.getItemText(CollectionCombo.getSelectedItems()));}var nLength=anOrgStatsID.length;OnShowProgressProgressResetAll();SendResetAllUserStats(anOrgStatsID,anOrgStatsName,nLength);}function SendResetAllUserStats(anOrgStatsID,anOrgStatsName,nLength){if(anOrgStatsID.length>0&&!g_ResetAllCanceled){var objUserResetCommand=CreatePostRequest("%ADMIN_FILE%XML/Result.xml?Command=ObjectCommand&Object=COrganization."+anOrgStatsID.pop()+".ResetUserStats");var sOrgName=anOrgStatsName.pop();if(anOrgStatsID.length==(nLength-1))ProgressFill(0,sOrgName);objUserResetCommand.response=function(){var xmlDoc=this.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"result");var sResultText=GetXMLValue(xmlDoc,"ResultText");if((nResult!=undefined)&&(nResult!=g_nSessionOkay)){if(nResult==g_nPermissionDenied)AlertDialog("$SESS_USER_NO_RESET_PERM$");else AlertDialog(GetResultText(0,"",sResultText));}else{ProgressFill(parseInt(((nLength-anOrgStatsID.length)/nLength)*100),sOrgName);if(anOrgStatsID.length>0)SendResetAllUserStats(anOrgStatsID,anOrgStatsName,nLength);else{setTimeout(function(){OnCloseProgressResetAll();},500);}}};objUserResetCommand.request(null);}else ProgressFill(-1);}function ProgressFill(nUploadPercent,sName){var nPercent=(100-nUploadPercent);sFillPercentage=nPercent.toString();if(sName==undefined)sName="";if(nUploadPercent>=0){document.getElementById("progressblock").style.visibility="visible";}else{document.getElementById("progressblock").style.visibility="hidden";document.getElementById("progressname").innerHTML="";}if(nUploadPercent<=100){document.getElementById("ProgressDiv").style.backgroundPosition=sFillPercentage+"% 0px";document.getElementById("percentcomplete").innerHTML=nUploadPercent+"%";document.getElementById("progressname").innerHTML=sName;}}var ResetAllOrgButton=CreatePushButton("$RESET_ALL_ORGS_BUTTON$","ResetAllOrgButton",OnResetAllOrgs);var ResetThisOrgButton=CreatePushButton("$RESET_THIS_ORG_BUTTON$","ResetThisOrgButton",OnResetThisOrg);var ResetAllCloseButton=CreatePushButton("$CANCEL_BUTTON$","ResetAllCloseButton",OnCloseConfirmResetAll);CreateDialogPushButton("$CANCEL_BUTTON$","ResetAllProgressCancelButton",OnCloseProgressResetAll);</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--></head><body><script type="text/javascript" language="JavaScript">document.addEventListener('DOMContentLoaded',function(){var createServerIdentityContainer=document.getElementById("CreateServerIdentity");if(g_bSysAdmin&&g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY_FOR_READONLY_SYSADMIN$</a></div>';}if(g_bSysAdmin&&!g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a onclick="javascript:navigateToServerIdentityTab(); return false;" target="_blank" id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY$</a></div>';}});</script><div id="container"><div id="MC-logo" style="overflow:visible;"><div id="sulogo-div"><div class="header-logo-container"><a href="javascript:LoadConsolePage('%ADMIN_FILE%', true)"><img src="%COMMON_FILE%Images/swlogo.png" id="SWLOGO" style="border:none;" alt="$CONSOLE_TITLE$"/></a></div><div class="sulogo-prodname"><strong style="font-size:12pt; margin-right: 8px;">%PRODUCT%</strong><span style="font-size:10pt;">$MANAGEMENT_CONSOLE$</span></div></div><div id="TrialExpire" style="display:none;"><div><a href="https://ecomm.solarwinds.com/onepagecheckout/Servu?sku=7205&CMPSource=SERVUSITE#/" target="_blank" id="TrialExpireTxt" class="DaysExpireTxt"><span id="TrialExpireDays"></span>$DAYS$ $TRIAL_EXPIRES_IN$. $BUY_NOW$</a></div></div><div id="CreateServerIdentity" style="display:none;"></div><div class="header-user-block"><span class="head-item head-user"><span id="UserOptBtn" class="menu-toggle"><span class="head-icon"></span><span id="CurrentlyLoggedIn" style="font-weight:bold;"></span></span></span><span class="head-item head-help"><a href="javascript:MainHelp();"><span class="head-icon"></span></a></span><span class="head-item head-menu"><span id="ManConNavBarJumpToList" class="menu-toggle"><span class="head-icon"></span></span></span></div></div><noscript><center><p>$NO_SCRIPT_TEXT$</p></center></noscript><div class="maincontent" ><div id="leftCol-Contain"><div id="leftCol-Nav"><div class="menu-nav" id="MenuListNav"><ul id="nav"><li id="navmenuserver-global" style="display:none;"><a id="navmenuserver-global-href" href="#"><div><span class="navDomain icon"></span><span class="navDomain text">$GLOBAL$</span></div></a><ul><li data-active='6' class='activetab'><a id="navmenuserver-global-dashboard-href" href="javascript:LoadConsolePage('%ADMIN_FILE%')"><span></span>$DASHBOARD$</a></li><li data-active='0' class='activetab'><a id="navmenuserver-global-details-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%Server.htm', 1,0,true);">$SERVERDETAILS$</a></li><li data-active='1' class='activetab'><a id="navmenuserver-global-users-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerUsers.htm', 1,1,true);">$USERS$</a></li><li data-active='2' class='activetab'><a id="navmenuserver-global-groups-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerGroups.htm', 1,2,true);">$GROUPS$</a></li><li data-active='3' class='activetab'><a id="navmenuserver-global-dirs-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerDir.htm', 1,3,true);">$DIRECTORIES$</a></li><li data-active='4' class='activetab'><a id="navmenuserver-global-limits-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerLimits.htm', 1,4,true);">$LIMITS$</a></li><li data-active='5' class='activetab'><a id="navmenuserver-global-activity-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerActivity.htm', 1,5,true);">$SERVERACTIVITY$</a></li></ul></li><li id="navmenuserver-DomainStart" class="NavDomainStart"><span class="navHeadTxtWhite">$DOMAINS$ <span id="DomainStart-Count"></span></span></li><div class="nav-add-domain"><a id="AddDomain-btn" href="javascript:OnShowDomainWizard();" style="align-items: center;"><img src="%COMMON_FILE%Images/add_domain_icon.png" width="20px" height="20px" alt="$NEW_DOMAIN_BUTTON$" title="$NEW_DOMAIN_BUTTON$" border="0" /><span id="brdcrumb-main" class="navHeadTxtWhite">$NEW_DOMAIN$</span></a></div></ul><div id="nav-loading" style="width:230px;text-align:center;"><img src='%COMMON_FILE%Images/domain-load.gif' alt='$LOADING_DOMAINS$' border='0' style="margin:0 auto;"/></div></div><div class="TreeInfoBox"><div style="min-height:400px; display: flex; flex-direction: column; flex-grow: 1; justify-content: flex-end"><div id="MaintContainUpdate" class="MaintInfoBox"><span class="TreeInfoBox__text-panel">$LATEST_UPDATE$</span><div id="SU-UpdateInfo" style="margin-top:10px;color:#333333;">$NO_UPDATE$</div></div><div id="MaintContain" class="MaintInfoBox"><div class="TreeInfoBox__text-secondary">$MAINTENANCE_ENDS$:</div><div class="TreeInfoBox__text-default" id="MaintDaybox"><span id="MaintDays"></span> $DAYS$, <span id="MaintDate"></span></div></div></div></div></div><div class="content-container"><div class="breadcrumb-container"><div style="display:inline-block;padding-left:15px"><span id="breadcrumb"></span></div></div><div id="TreeCol"><div class="MainHeaderInfo" style="vertical-align:top"><img src="%ADMIN_FILE%Images/log32.png" width="32" height="32" class="tab-header" alt="$DOMAIN_ACTIVITY_INFO$"/><strong>$DOMAIN_ACTIVITY$</strong> - $DOMAIN_ACTIVITY_INFO$</div><br style="clear:both" /><span id="PageTabs"></span><div id="TabsContent" class="tabs-content"><div id="SessionsTab" style="display:none"><div class="layercontent">
<!--#include "Include\..\Strings\Strings.strings"-->
<!--#include "Include\..\..\Common\Strings\Strings.strings"-->
<div class="ie6positionfix"><div class="LogHeader"><div class="LogHeader-infotxt">$SESSIONS_INFO$</div></div><div><span id="ActivityMonitor"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span><div id="StatsGroup" style="width:100%"><div style="overflow-y : hidden;overflow : auto;width : 100%; "><table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 0 10px;"><tr><td style="width: auto; min-width: 85px"><span style="white-space:nowrap;">$USER$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveUser" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_SPEED$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveSpeed" class="StatInfo"></span></td><td style="width:60px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_TIME_ON$:</span></td><td style="width:300px;padding-left:10px;"><span id="DetailActiveTimeOn" class="StatInfo"></span></td></tr><tr><td><span style="white-space:nowrap;">$ACTIVTY_ACCESS$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveAccess" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_AVG_DL_SPEED$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveAvgDL" class="StatInfo"></span></td><td style="width:60px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_IDLE$:</span></td><td style="width:300px;padding-left:10px;"><span id="DetailActiveIdle" class="StatInfo"></span></td></tr><tr valign="top"><td><span style="white-space:nowrap;">$IP_ADDRESS$:</span></td><td style="width:auto;min-width:50px;height:32px;padding-left:10px;"><span id="DetailActiveIP" class="StatInfo"></span></td><td style="width:90px;height:32px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_AVG_UL_SPEED$:</span></td><td style="width:auto;min-width:50px;height:32px;padding-left:10px;"><span id="DetailActiveAvgUL" class="StatInfo"></span></td><td style="width:60px;height:32px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_SINCE$:</span></td><td style="width:300px;height:32px;padding-left:10px;"><span id="DetailActiveSince" class="StatInfo"></span></td></tr><tr><td><span style="white-space:nowrap;">$ACTIVITY_DL$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveDownloaded" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$LOCATION$:</span></td><td colspan="3" style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveLocation" class="StatInfo"></span></td></tr><tr><td><span style="white-space:nowrap;">$ACTIVITY_UL$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="DetailActiveUploaded" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$LAST_COMMAND$:</span></td><td colspan="3" style="width:auto;min-width:50px;overflow:hidden;padding-left:10px;"><div style="width:0;white-space:nowrap;"><span id="DetailActiveCommand" class="StatInfo" title=""></span></div></td></tr><tr><td style="padding-top:10px; vertical-align:top;"><span id="DetailEncryption-Text" style="white-space:nowrap;"></span></td><td style="width:auto;min-width:50px;padding-top:10px;padding-left:10px;vertical-align:top;"><span id="DetailEncryption" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;padding-top:10px;vertical-align:top;"><span style="visibility:hidden;white-space:nowrap;" id="DetailPublicKeyProtocolLabel">$SELECTED_PUBLIC_KEY_PROTOCOL$:</span></td><td colspan="3" style="width:auto;min-width:50px;padding-top:10px;overflow:hidden;padding-left:10px;vertical-align:top;"><div style="width:0;white-space:nowrap;"><span id="DetailPublicKeyProtocol" class="StatInfo" title=""></span></div></td></tr></table><div style="clear:both;height:18px;overflow:hidden;"></div></div></div><div style="padding-top:5px;"><span id="KillUserButton" style="margin-right: 15px;"></span><span id="AbortButton"></span><div style="float:right;"><span id="BroadcastButton" style="margin-right: 15px;"></span><span id="SessionMessageButton"></span></div></div></div></div><div id="DisconnectDialoginner" style="display:none;"><form name="DisconnectForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><span id="DisconnectActionGroup"><span id="DisconnectActionRadio"></span><span id="DisconnectMinutesContainer"><span id="DisconnectMinutes"></span><span id="DisconnectDurationLabel" style="white-space:nowrap;">$DISCONNECT_BAN_LABEL$</span></span><div style="clear:both;margin-top:5px;"><span id="DisconnectLevelLabel" style="padding:8px 5px 0 0;white-space:nowrap;"></span><span id="DisconnectLevel"></span></div></span><div style="margin-top:5px;"><span id="DisconnectDisableAct"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="DisconnectButton"></span><br /><span id="CancelDisconnectButton"></span><br /><br /><span id="HelpDisconnectButton"></span></td></tr><tr><td colspan="2"><span id="DisconnectMessageLabel">$DISCONNECT_MESSAGE$:</span><div style="overflow:auto"><span id="DisconnectMessage"></span></div></td></tr></table></form></div><script type="text/javascript" language="javascript">var g_aDisconnectItems=new Array();var DisconnectMinutes,sDefLevelLabel,sDefLevel,DisconnectLevel;var DisconnectAction,DetachDisconnectMinutes,DisconnectDisableAcct,DisconnectMessage;$(document).ready(function(){BuildDialog("$DISCONNECT_DIALOG_TITLE$","DisconnectDialog","495","215","","$CLOSE_CANCEL$");CreateGroupBox("$DISCONNECT_ACTION$","DisconnectActionGroup",365,(g_bSysAdmin)?95:75,true);DisconnectMinutes=CreateInputField("15","DisconnectMinutes","DisconnectMinutes",undefined,35,12,true,OnSaveDisconnect);DisconnectMinutes.setStyle("position","relative");if(AW.ff)DisconnectMinutes.setStyle("top","-2px");else if(AW.chrome||AW.safari)DisconnectMinutes.setStyle("top","-4px");else DisconnectMinutes.setStyle("top","-3px");DisconnectMinutes.setControlSize(35,12);DisconnectMinutes.setStyle("height","12px");$("#DisconnectMinutes .aw-input-box ").css("height","12px");if(g_bSysAdmin){document.getElementById("DisconnectLevelLabel").innerHTML="$DISCONNECT_LEVEL_LABEL$";sDefLevelLabel=("Domain"=="CDomain")?"$DISCONNECT_LEVEL_DOMAIN$":"$DISCONNECT_LEVEL_SERVER$";sDefLevel=("Domain"=="CDomain")?"1":"0";DisconnectLevel=CreateComboBox(sDefLevelLabel,sDefLevel,["$DISCONNECT_LEVEL_SERVER$","$DISCONNECT_LEVEL_DOMAIN$"],["0","1"],"DisconnectLevel","DisconnectLevel",undefined,undefined,false,110,20,OnSaveDisconnect);}DisconnectAction=CreateRadioButtons(0,["$DISCONNECT_KICK$","$DISCONNECT_BAN$ ","$DISCONNECT_BLOCK$"],"DisconnectActionRadio","DisconnectAction",225,OnChangeDisconnectAction);if(g_bFireFox3Browser)document.getElementById("DisconnectActionRadio-box").style.height="50px";if(AW.chrome||AW.safari){document.getElementById("DisconnectActionRadio-box").style.height="55px";}DetachDisconnectMinutes=$('#DisconnectMinutesContainer').detach();DetachDisconnectMinutes.appendTo('#DisconnectActionRadio-item-1-box');DisconnectDisableAcct=CreateCheckBox("$DISCONNECT_DISABLE_ACCT$","DisconnectDisableAct","DisconnectDisableAct",false);DisconnectMessage=CreateInputField("","DisconnectMessage","DisconnectMessage",undefined,350,undefined,false,OnSaveDisconnect);CreateDialogPushButton("$OK_BUTTON$","DisconnectButton",OnSaveDisconnect);CreateDialogPushButton("$CANCEL_BUTTON$","CancelDisconnectButton",OnCancelDisconnect);CreateDialogPushButton("$HELP_BUTTON$","HelpDisconnectButton",OnDisconnectHelp);});function OnChangeDisconnectAction(anSelectedItems){DisconnectMinutes.setControlDisabled(anSelectedItems[0]!=1);if(g_bSysAdmin)DisconnectLevel.SetDisabled(anSelectedItems[0]==0);}function OnSaveDisconnect(){var nCurrentItem=g_aDisconnectItems.pop();var nItemID=ActiveSessions.getCellText((ActiveSessions.m_nNumColumns-1),nCurrentItem);if((nItemID!=undefined)&&(nItemID>0)){var sAddtlParams="",sMsg=DisconnectMessage.getControlText();var nDuration=(parseInt(DisconnectMinutes.getControlText())*(1000*60)),nAction=DisconnectAction.getSelectedItems()[0];var objRequest=null;if(nAction>0){if((nAction==1)&&((isNaN(nDuration))||(nDuration<=0))){AlertDialog("$DISCONNECT_NO_DURATION$");DisconnectMinutes.getContent("box/text").element().focus();return;}else if(nAction==2)nDuration=0;sAddtlParams+="&Ban=1&Milliseconds="+nDuration;}else sAddtlParams+="&Ban=0";if(sMsg!="")sAddtlParams+="&Message="+encodeURIComponent(sMsg);if(DisconnectDisableAcct.getControlValue())sAddtlParams+="&Disable=1";if(g_bSysAdmin)sAddtlParams+="&Level="+document.getElementById(DisconnectLevel.getContent("hidden").getId()).value;if(objRequest=createAWHttpRequest("GET",("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CSession."+nItemID+".Disconnect"+sAddtlParams),OnSentCommandDone)){if(!g_aDisconnectItems.length){ReplaceDialog("DisconnectDialog",g_sBusyDialog);ActiveSessions.setSelectedRows([-1]);ResetActiveSessionInfo("Detail");}objRequest.request();}}}function OnShowDisconnectDialog(bDisableChat,anDisconnectItems){g_aDisconnectItems=anDisconnectItems;if(bDisableChat)DisconnectMessage.setControlText("$SEND_MESSAGE_ONLY_FTP$");else DisconnectMessage.setControlText("");DisconnectMessage.setControlDisabled(bDisableChat);document.getElementById("DisconnectMessageLabel").style.color=(bDisableChat)?"Gray":"";}function ResetDisconnectDialog(){DisconnectAction.initValue(0);DisconnectMinutes.setControlText("15");DisconnectDisableAcct.setControlValue(false);DisconnectMessage.setControlText("");if(g_bSysAdmin)DisconnectLevel.initValue(parseInt(sDefLevel));}function OnCancelDisconnect(){HideDialog('DisconnectDialog');}function OnDisconnectHelp(){LaunchHelp("Help-Domain-Server-Activity.htm","Item12_3");}</script><div id="SendMessageDialoginner" style="display:none;"><form name="SendMessageForm" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="SendMessageLabel"></span><div style="overflow:auto"><span id="SendMessageText"></span></div><span id="SendMessageNote"></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="SendMessageButton"></span><span id="CancelSendMessageButton"></span><br /><br /><span id="HelpSendMessageButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">g_aSendMessageDlgParams=new Array();var SendMessageText;$(document).ready(function(){BuildDialog("","SendMessageDialog","400","138","","$CLOSE_CANCEL$");SendMessageText=CreateInputField("","SendMessageText","SendMessageText",undefined,250,undefined,false,OnSendMessage);CreateDialogPushButton("$SEND_BUTTON$","SendMessageButton",OnSendMessage);CreateDialogPushButton("$CANCEL_BUTTON$","CancelSendMessageButton",OnCancelSendMessage);CreateDialogPushButton("$HELP_BUTTON$","HelpSendMessageButton",OnSendMessageHelp);});function OnSendMessage(){var nItemID=g_aSendMessageDlgParams[2];if((nItemID!=undefined)&&(!isNaN(nItemID))&&(nItemID>0)){var sMsg=SendMessageText.getControlText();var objRequest=null;if(sMsg==""){AlertDialog(g_aSendMessageDlgParams[4]);SendMessageText.getContent("box/text").element().focus();return;}if(objRequest=createXMLHttpRequest("GET",("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+g_aSendMessageDlgParams[1]+"."+nItemID+"."+g_aSendMessageDlgParams[3]+"&Message="+encodeURIComponent(sMsg))))objRequest.send(null);}HideDialog('SendMessageDialog');}function ResetSendMessageDialog(){SendMessageText.setControlText("");}function OnCancelSendMessage(){HideDialog('SendMessageDialog');}function OnSendMessageHelp(){if(g_bDomainNav)sExpandNode="Item16_4";else sExpandNode="Item12_3";LaunchHelp("Help-Domain-Server-Activity.htm",sExpandNode);}function OnUpdateSendMessageDialog(){if(g_aSendMessageDlgParams[0]){document.getElementById("SendMessageDialogTitleText").innerHTML="$SESSION_MESSAGE_DIALOG_TITLE$";document.getElementById("SendMessageLabel").innerHTML="$SESSION_MESSAGE_LABEL$:";document.getElementById("SendMessageNote").innerHTML="$SESSION_MESSAGE_NOTE$";}else{document.getElementById("SendMessageDialogTitleText").innerHTML="$BROADCAST_MESSAGE_DIALOG_TITLE$";document.getElementById("SendMessageLabel").innerHTML="$BROADCAST_MESSAGE_LABEL$:";document.getElementById("SendMessageNote").innerHTML="$BROADCAST_MESSAGE_NOTE$";}}</script><div id="SpyChatDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div style="padding-right:12px;">$SESSION_LOG$:<div id="SpyContainer" class="SpyLogScroll"><div id="SpyLog"></div></div></div><span id="ClearSessionLog"></span>&nbsp;&nbsp;<span id="CopySpyLog"></span><div id="SpyStatsGroup" style="padding-right:5px;overflow-y:auto;"><div style="overflow-y : hidden;overflow : auto;width : 100%; "><table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 0 10px;"><tr><td style="width: auto; min-width: 85px"><span style="white-space:nowrap;">$USER$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveUser" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_SPEED$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveSpeed" class="StatInfo"></span></td><td style="width:60px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_TIME_ON$:</span></td><td style="width:300px;padding-left:10px;"><span id="SpyChatActiveTimeOn" class="StatInfo"></span></td></tr><tr><td><span style="white-space:nowrap;">$ACTIVTY_ACCESS$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveAccess" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_AVG_DL_SPEED$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveAvgDL" class="StatInfo"></span></td><td style="width:60px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_IDLE$:</span></td><td style="width:300px;padding-left:10px;"><span id="SpyChatActiveIdle" class="StatInfo"></span></td></tr><tr valign="top"><td><span style="white-space:nowrap;">$IP_ADDRESS$:</span></td><td style="width:auto;min-width:50px;height:32px;padding-left:10px;"><span id="SpyChatActiveIP" class="StatInfo"></span></td><td style="width:90px;height:32px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_AVG_UL_SPEED$:</span></td><td style="width:auto;min-width:50px;height:32px;padding-left:10px;"><span id="SpyChatActiveAvgUL" class="StatInfo"></span></td><td style="width:60px;height:32px;padding-left:10px;"><span style="white-space:nowrap;">$ACTIVITY_SINCE$:</span></td><td style="width:300px;height:32px;padding-left:10px;"><span id="SpyChatActiveSince" class="StatInfo"></span></td></tr><tr><td><span style="white-space:nowrap;">$ACTIVITY_DL$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveDownloaded" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$LOCATION$:</span></td><td colspan="3" style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveLocation" class="StatInfo"></span></td></tr><tr><td><span style="white-space:nowrap;">$ACTIVITY_UL$:</span></td><td style="width:auto;min-width:50px;padding-left:10px;"><span id="SpyChatActiveUploaded" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;"><span style="white-space:nowrap;">$LAST_COMMAND$:</span></td><td colspan="3" style="width:auto;min-width:50px;overflow:hidden;padding-left:10px;"><div style="width:0;white-space:nowrap;"><span id="SpyChatActiveCommand" class="StatInfo" title=""></span></div></td></tr><tr><td style="padding-top:10px; vertical-align:top;"><span id="SpyChatEncryption-Text" style="white-space:nowrap;"></span></td><td style="width:auto;min-width:50px;padding-top:10px;padding-left:10px;vertical-align:top;"><span id="SpyChatEncryption" class="StatInfo"></span></td><td style="width:90px;padding-left:10px;padding-top:10px;vertical-align:top;"><span style="visibility:hidden;white-space:nowrap;" id="SpyChatPublicKeyProtocolLabel">$SELECTED_PUBLIC_KEY_PROTOCOL$:</span></td><td colspan="3" style="width:auto;min-width:50px;padding-top:10px;overflow:hidden;padding-left:10px;vertical-align:top;"><div style="width:0;white-space:nowrap;"><span id="SpyChatPublicKeyProtocol" class="StatInfo" title=""></span></div></td></tr></table><div style="clear:both;height:18px;overflow:hidden;"></div></div></div><div id="SpyChatGroup" style="padding-right:5px; padding-top:5px;"><div id="ChatContainer" class="SpyLogScroll" style="height:110px;width:auto;margin:5px;"><div id="ChatLog"></div></div><form name="ChatForm" onsubmit="return (false);"><div style="vertical-align:baseline;"><span id="ChatMessageLabel">$SESSION_MESSAGE_LABEL$:</span><div style="overflow:auto"><span id="ChatMessage"></span> <span id="SendChatMessage"></span></div></div></form></div><div style="margin-top:5px;"><span id="OkSpyChatButton"></span>&nbsp;&nbsp;<span id="HelpSpyChatButton"></span></div></div></div><script type="text/javascript" language="javascript">var ChatMessageText,SendMessageBtn;$(document).ready(function(){BuildDialog("$SPY_CHAT_DIALOG_TITLE$","SpyChatDialog","800","622","","$CLOSE_CANCEL$");CreateGroupBox("$SPY_STATS$","SpyStatsGroup","auto","150px",true);CreateGroupBox("$SPY_CHAT$","SpyChatGroup","auto","180px",true);ChatMessageText=CreateInputField("","ChatMessage","ChatMessage",undefined,350,undefined,false,OnChatSendMessage);SendMessageBtn=CreateDialogPushButton("$SEND_BUTTON$","SendChatMessage",OnChatSendMessage);CreateDialogPushButton("$CLOSE_BUTTON$","OkSpyChatButton",OnOkSpyChat);CreateDialogPushButton("$HELP_BUTTON$","HelpSpyChatButton",OnSpyChatHelp);CreatePushButton("$CLEAR_LOG$","ClearSessionLog",OnClearLog,undefined,undefined,"SpyLog");if(AW.ie){CreatePushButton("$COPY_CLIPBOARD$","CopySpyLog",OnCopySpyLog);}InitLog("SpyLog","",0);InitLog("ChatLog","",0);});var g_SessionID=undefined;var g_SpyChatRequest=undefined;var g_tSpyChatTimer=undefined;var g_ChatDivScroll=new logscroll.Pane("ChatContainer");function OnChatSendMessage(){var sMsg=ChatMessageText.getControlText();if(sMsg!=""){var objRequest=null;if(objRequest=createXMLHttpRequest("GET",("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CSession."+g_SessionID+".SendMessage&Message="+encodeURIComponent(sMsg)))){objRequest.send(null);ProcessChatMessages(sMsg,FormatClientString("%CUser.%USER_ID%.LoginID%"),false);}ChatMessageText.setControlText("");ChatMessageText.getContent("box/text").element().focus();}}function OnShowSpyChatDialog(nSessionID,sSessionType){g_SessionID=nSessionID;if((g_SessionID!=undefined)&&(!isNaN(g_SessionID))&&(g_SessionID>0)){InitSessionLog("$SESSION_DISCONNECT$",sSessionType);FreezeSessionLog(false);SpyChatQueryInfo(false);}EnableDisableChat((sSessionType!="CFTPSession"),"$SEND_MESSAGE_ONLY_FTP$");}function EnableDisableChat(bDisableChat,sMessage){if(bDisableChat)document.getElementById("SpyChatGroup").style.display="none";else document.getElementById("SpyChatGroup").style.display="block";}function SpyChatQueryInfo(bAbort){g_SpyChatRequest=SessionInfoQuery(bAbort,g_SpyChatRequest,g_tSpyChatTimer,"ActiveSessionInfoChat.xml",g_SessionID,OnSpyChatSessionInfo);}function OnSpyChatSessionInfo(){if((g_SpyChatRequest!=undefined)&&(g_SpyChatRequest.readyState==4)){if((g_SpyChatRequest.status==200)&&(ProcessDetailedSessionInfo(g_SpyChatRequest.responseXML,"SpyChat"))){ProcessChatMessages(GetXMLValue(g_SpyChatRequest.responseXML,"LastSysOpMessage"),GetXMLValue(g_SpyChatRequest.responseXML,"User"),true);g_tSpyChatTimer=setTimeout("SpyChatQueryInfo()",1000);}else EnableDisableChat(true,"$SESSION_DISCONNECT$");g_SpyChatRequest=undefined;}}function ProcessChatMessages(sMessages,sSender,bIncoming){if((sMessages!=undefined)&&(sMessages!="")){var dateNow=new Date();var asMessages=new Array();var sMsgColor=(bIncoming)?"blue":"red";var sTime=dateNow.toLocaleTimeString();var sOutput="";if(sMessages.indexOf('\n')>=0)asMessages=sMessages.split('\n');else asMessages[0]=sMessages;if((sSender==undefined)||(sSender=="")){if(bIncoming)sSender="*$UNKNOWN_USER$*";else sSender="$LOCAL_ADMIN$";}for(var nIndex=0;nIndex<asMessages.length;nIndex++)sOutput+="<div style='color:"+sMsgColor+";'>["+sTime+"] "+sSender+": "+FormatClientString(asMessages[nIndex],true)+"</div>";UpdateLogFrame(g_ChatDivScroll,"ChatLog",sOutput);}}function ResetSpyChatDialog(){SpyChatQueryInfo(true);FreezeSessionLog(true);ChatMessageText.setControlText("");document.getElementById("SpyLog").innerHTML="";document.getElementById("ChatLog").innerHTML="";ResetActiveSessionInfo("SpyChat");}function OnOkSpyChat(){HideDialog('SpyChatDialog');}function OnSpyChatHelp(){if(g_bDomainNav)sExpandNode="Item16_4";else sExpandNode="Item12_3";LaunchHelp("Help-Domain-Server-Activity.htm",sExpandNode);}function OnCopySpyLog(){fnSelect('SpyLog',true);}</script><script type="text/javascript" language="JavaScript">var g_InfoRequest=undefined;var g_tInfoTimer=undefined;AW.Formats.ActivityInfo=AW.Formats.XMLString.subclass();AW.Formats.ActivityInfo.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sTemp="";if(nColumn==4){var sIP=_super.dataToText(data);if(sIP.indexOf(":")>=0)sIP="["+sIP+"]";return(sIP+":"+_super.dataToText(Grid.getCellData(11,nRow)));}else if((sTemp=Grid.getCellData(12,nRow))!="")return(_super.dataToText(data)+" ("+_super.dataToText(sTemp)+")");else return(_super.dataToText(data));};obj.dataToValue=function(data,Grid,nColumn,nRow){return(this.dataToText(data,Grid,nColumn,nRow));};};function InitActivityMonitor(sHtmlId,sXMLFile,sKillId,sMsgId,sBroadcastId,sAbortId){var Grid=CreateAdminGrid(sHtmlId,["$ID$","$CONN_TYPE$","$USER$","$IP_ADDR_OR_HOST$","$SERVER_ADDRESS$","$LOCATION$","$LAST_COMMAND$","$CLIENT_SOFTWARE$"],[65,65,90,145,95,140,120,120],sXMLFile,"sessions","session",15,OnSpyChat);Grid.m_nTimerMS=2000;Grid.setSelectionMode("multi-row");var fmtXMLString=new AW.Formats.XMLString;var fmtActivityInfo=new AW.Formats.ActivityInfo;Grid.setCellFormat([new AW.Formats.Number,fmtXMLString,fmtXMLString,fmtActivityInfo,fmtActivityInfo,fmtXMLString,fmtXMLString,fmtXMLString]);Grid.onRowClicked=function(){OnChangeActiveSession(false);};Grid.getCellImage=function(nCol,nRow){return(ActivityMonitorFormat.call(this,nCol,nRow));};var KillUserBtn;if(g_bIsDemo){KillUserBtn=CreatePushButton("$KILL_USER_BUTTON$...",sKillId,OnKillUserDisabled,undefined,undefined,undefined,undefined,"customButton-disabled");}else{KillUserBtn=CreatePushButton("$KILL_USER_BUTTON$...",sKillId,OnKillUser,undefined,undefined,undefined,undefined,"customButton");}var SpyChatBtn=CreatePushButton("$SPY_CHAT_BUTTON$...",sMsgId,OnSpyChat,undefined,undefined,undefined,undefined,"customButton");var BroadcastBtn=CreatePushButton("$BROADCAST_MESSAGE_BUTTON$...",sBroadcastId,OnBroadcastMessage,undefined,undefined,undefined,undefined,"customButton");var AbortBtn=CreatePushButton("$ABORT_BUTTON$...",sAbortId,OnAbortCommand,undefined,undefined,undefined,undefined,"customButton");ResetActiveSessionInfo("Detail");return(Grid);}function ActivityMonitorFormat(nColumn,nRowIndex){var sImage="Session",sTemp="";switch(this.getCellData(10,nRowIndex)){case("CHTTPSession"):this.UpdateText(FormatBrowserClient(this.getCellText(7,nRowIndex)),7,nRowIndex);this.UpdateText((this.getCellData(8,nRowIndex)!="0")?"HTTPS":"HTTP",1,nRowIndex);break;case("CSSHSession"):this.UpdateText("SFTP",1,nRowIndex);break;case("CFTPSession"):var sType=this.getCellData(9,nRowIndex);switch(sType){case("1"):sType="FTPS (TLS)";break;case("2"):sType="FTPS (SSL)";break;default:sType="FTP";break;}this.UpdateText(sType,1,nRowIndex);break;}if(this.getCellData(13,nRowIndex)!="0")return("SessionMsg");else if(this.getCellData(8,nRowIndex)!="0")return("SessionSecure");else return("Session");}function ActivityMonitorEnableDisable(bUpdate){ActiveSessions.EnableUpdates(bUpdate);OnChangeActiveSession(bUpdate!=true);}function FormatBrowserClient(sClient){sClient=HTMLDecode(sClient);if(sClient.indexOf('/')===-1){return sClient;}var ua=sClient,version,match=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d.]+)/i)||[];if(/trident/i.test(match[1])){version=/\brv[:]+([\d.]+)/g.exec(ua)||[];return'IE '+(version[1]||'');}if(match[1]==='Chrome'){version=ua.match(/\bEdg\/([\d.]+)/);if(version!=null){return'Edge '+version[1];}version=ua.match(/\bOPR\/([\d.]+)/);if(version!=null){return'Opera '+version[1];}}match=match[2]?[match[1],match[2]]:['','',''];if((version=ua.match(/version\/([\d.]+)/i))!=null){match.splice(1,1,version[1]);}return match[0]+' '+match[1];}function OnChangeActiveSession(bAbort){var anSelectedRows=ActiveSessions.getSelectedRows();if(anSelectedRows.length==1){var nItemID=ActiveSessions.getCellData(14,anSelectedRows[0]);g_InfoRequest=SessionInfoQuery(bAbort,g_InfoRequest,g_tInfoTimer,"ActiveSessionInfo.xml",nItemID,OnActiveSessionInfo);}else ResetActiveSessionInfo("Detail");}function SessionInfoQuery(bAbort,httpRequest,tRequestTimer,sXMLFile,nItemID,fnCallback){clearTimeout(tRequestTimer);if(httpRequest!=undefined)httpRequest=undefined;if((!bAbort)&&(nItemID!=undefined)&&(nItemID>0)){var theDate=new Date();httpRequest=createXMLHttpRequest();httpRequest.open("GET",("%ADMIN_FILE%XML/"+sXMLFile+"&ID="+nItemID+"&sync="+theDate.getTime()),true);httpRequest.onreadystatechange=fnCallback;httpRequest.send(null);}return(httpRequest);}function OnActiveSessionInfo(){if((g_InfoRequest!=undefined)&&(g_InfoRequest.readyState==4)){if((g_InfoRequest.status==200)&&(ProcessDetailedSessionInfo(g_InfoRequest.responseXML,"Detail")))g_tInfoTimer=setTimeout("OnChangeActiveSession(false)",1000);g_InfoRequest=undefined;}}function FormatUserAccess(nType){var sRet="";switch(parseInt(nType)){case(0):sRet="$ACCESS_NONE$";break;case(1):sRet="$ACCESS_DOMADMIN$";break;case(2):sRet="$ACCESS_SYSADMIN$";break;}return(sRet);}function ProcessDetailedSessionInfo(XMLDoc,sElementID){var bRet=false;var nConnTime=GetXMLValueInt(XMLDoc,"ConnectionTime");if(isNaN(nConnTime))ResetActiveSessionInfo(sElementID);else{var dateNow=new Date(),dateTemp=new Date();var sUser=new String(),sLocation=new String();if((sUser=GetXMLValue(XMLDoc,"User"))==undefined)sUser="$NOT_LOGGED_IN$";document.getElementById(sElementID+"ActiveUser").innerHTML="("+GetXMLValue(XMLDoc,"SessionNumber")+") "+sUser;document.getElementById(sElementID+"ActiveSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"SpeedDown")+GetXMLValueInt(XMLDoc,"SpeedUp"),true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById(sElementID+"ActiveTimeOn").innerHTML=FormatDurationString(nConnTime);dateTemp.setTime(dateNow.getTime()-nConnTime);document.getElementById(sElementID+"ActiveAccess").innerHTML=FormatUserAccess(GetXMLValue(XMLDoc,"UserType"));document.getElementById(sElementID+"ActiveAvgDL").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"AvgDl")*1024,true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById(sElementID+"ActiveIdle").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"IdleMilliseconds"));document.getElementById(sElementID+"ActiveIP").innerHTML=GetXMLValue(XMLDoc,"ClientIPAddress");document.getElementById(sElementID+"ActiveAvgUL").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"AvgUl")*1024,true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById(sElementID+"ActiveSince").innerHTML=dateTemp.toLocaleDateString()+"<br />"+dateTemp.toLocaleTimeString();if((sLocation=GetXMLValue(XMLDoc,"Location"))==undefined)sLocation="";document.getElementById(sElementID+"ActiveDownloaded").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"BytesDown"),true)+" ("+FormatXMLIntValue(XMLDoc,"FilesDown")+" $ACTIVITY_FILES$)";document.getElementById(sElementID+"ActiveLocation").innerHTML=sLocation;document.getElementById(sElementID+"Encryption").innerHTML=GetEncryptionInfo(XMLDoc,sElementID);document.getElementById(sElementID+"ActiveUploaded").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"BytesUp"),true)+" ("+FormatXMLIntValue(XMLDoc,"FilesUp")+" $ACTIVITY_FILES$)";document.getElementById(sElementID+"ActiveCommand").innerHTML=GetXMLValue(XMLDoc,"LastCommand");document.getElementById(sElementID+"ActiveCommand").title=GetXMLValue(XMLDoc,"LastCommand");bRet=true;}return(bRet);}function ResetActiveSessionInfo(sElementID){document.getElementById(sElementID+"ActiveUser").innerHTML="";document.getElementById(sElementID+"ActiveSpeed").innerHTML="";document.getElementById(sElementID+"ActiveTimeOn").innerHTML="";document.getElementById(sElementID+"ActiveAccess").innerHTML="";document.getElementById(sElementID+"ActiveAvgDL").innerHTML="";document.getElementById(sElementID+"ActiveIdle").innerHTML="";document.getElementById(sElementID+"ActiveIP").innerHTML="";document.getElementById(sElementID+"ActiveAvgUL").innerHTML="";document.getElementById(sElementID+"ActiveSince").innerHTML="";document.getElementById(sElementID+"ActiveDownloaded").innerHTML="";document.getElementById(sElementID+"ActiveLocation").innerHTML="";document.getElementById(sElementID+"Encryption").innerHTML="";document.getElementById(sElementID+"Encryption-Text").innerHTML="";document.getElementById(sElementID+"PublicKeyProtocolLabel").style.visibility="hidden";document.getElementById(sElementID+"PublicKeyProtocol").style.visibility="hidden";document.getElementById(sElementID+"PublicKeyProtocol").innerHTML="";document.getElementById(sElementID+"ActiveCommand").innerHTML="";document.getElementById(sElementID+"ActiveCommand").title="";document.getElementById(sElementID+"ActiveUploaded").innerHTML="";}function OnKillUser(){var anSelectedDisconnectItems=ActiveSessions.getSelectedRows().toString().split(",");var nItemID=ActiveSessions.getCellData(14,ActiveSessions.getSelectedRows()[0]);var bDisableChat=true;if(anSelectedDisconnectItems!=""&&anSelectedDisconnectItems.length>0){for(var nIndex in anSelectedDisconnectItems){var sSessionType=ActiveSessions.getCellData(10,anSelectedDisconnectItems[nIndex]);if(sSessionType=="CFTPSession"){bDisableChat=false;break;}}OnShowDisconnectDialog(bDisableChat,anSelectedDisconnectItems);ShowDialog("DisconnectDialog",undefined,ResetDisconnectDialog);}else AlertDialog("$DISCONNECT_SELECT$");}function OnKillUserDisabled(){return true;}function OnSpyChat(){var anSelectedRows=ActiveSessions.getSelectedRows();if(anSelectedRows.length==1){var nItemID=ActiveSessions.getCellData(14,anSelectedRows[0]);
if((nItemID!=undefined)&&(nItemID>0)){var sSessionType=ActiveSessions.getCellData(10,anSelectedRows[0]);ActivityMonitorEnableDisable(false);OnShowSpyChatDialog(nItemID,sSessionType);ShowDialog("SpyChatDialog",undefined,OnCloseSpyChatDialog);}else AlertDialog("$SPY_CHAT_SELECT$");}else AlertDialog("$SPY_CHAT_SELECT$");}function OnCloseSpyChatDialog(){ActivityMonitorEnableDisable(true);ResetSpyChatDialog();}function OnBroadcastMessage(){var bContainsFTP=false;for(var nIndex=0;nIndex<ActiveSessions.getRowCount();nIndex++){if(ActiveSessions.getCellData(10,nIndex)=="CFTPSession"){bContainsFTP=true;break;}}if(bContainsFTP){g_aSendMessageDlgParams=[false,"Domain",%ID%,"BroadcastMessage","$BROADCAST_MESSAGE_NO_TEXT$"];OnUpdateSendMessageDialog();ShowDialog("SendMessageDialog",undefined,ResetSendMessageDialog);SendMessageText.getContent("box/text").element().focus();}else AlertDialog("$BROADCAST_NO_FTP_SESSIONS$");}function OnAbortCommand(){var anSelectedRows=ActiveSessions.getSelectedRows(),anItemIDs=[];for(var nIndex in anSelectedRows)anItemIDs[nIndex]=ActiveSessions.getCellData(14,anSelectedRows[nIndex]);if((anItemIDs[0]!=undefined)&&(anItemIDs[0]>0))ConfirmDialog("$ABORT_CONFIRM_SESSION$",OnConfirmAbort,undefined,anItemIDs);else AlertDialog("$ABORT_SELECT_ITEM$");}function OnConfirmAbort(anItemIDs){for(var nIndex in anItemIDs){var Request=createAWHttpRequest("GET",("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CSession."+anItemIDs[nIndex]+".Abort"+"&sync="+Math.random()),OnSentCommandDone);if(Request){ReplaceDialog(g_sConfirmDialog,g_sBusyDialog);Request.request();}}}function OnSentCommandDone(){var xmlDoc=this.getResponseXML();var nResult=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");BusyDialog(false);if((nResult=GetXMLValueInt(xmlDoc,"result"))!=0){if(nResult==3)AlertDialog("$COMMAND_DENIED$");else AlertDialog(GetResultText(0,"",sResultText));}else{if(g_aDisconnectItems.length)OnSaveDisconnect();}}function GetEncryptionInfo(XMLDoc,sID){var sEncryptionInfo="";document.getElementById(sID+"PublicKeyProtocolLabel").style.visibility="hidden";document.getElementById(sID+"PublicKeyProtocol").style.visibility="hidden";document.getElementById(sID+"PublicKeyProtocol").innerHTML="";if(GetXMLValue(XMLDoc,"SSLCipherName")){if(document.getElementById("StatsGroupFS")){document.getElementById("StatsGroupFS").style.height="150px";}document.getElementById("SpyStatsGroupFS").style.height="150px";document.getElementById(sID+"Encryption-Text").innerHTML="SSL $ENCRYPTION$:";sSSLCipherName=(GetXMLValue(XMLDoc,"SSLCipherName")==""||GetXMLValue(XMLDoc,"SSLCipherName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSLCipherName");sSSLCipherVersion=(GetXMLValue(XMLDoc,"SSLCipherVersion")==""||GetXMLValue(XMLDoc,"SSLCipherVersion")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSLCipherVersion");sSSLCipherDescription=(GetXMLValue(XMLDoc,"SSLCipherDescription")==""||GetXMLValue(XMLDoc,"SSLCipherDescription")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSLCipherDescription");sSSLCipherBits=(GetXMLValue(XMLDoc,"SSLCipherBits")==""||GetXMLValue(XMLDoc,"SSLCipherBits")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSLCipherBits");sEncryptionInfo=sSSLCipherBits+"-$BITS$ "+sSSLCipherName+" ("+sSSLCipherVersion+")";}else if(GetXMLValue(XMLDoc,"SSHSCCipherName")){if(document.getElementById("StatsGroupFS")){document.getElementById("StatsGroupFS").style.height="150px";}document.getElementById("SpyStatsGroupFS").style.height="150px";document.getElementById(sID+"Encryption-Text").innerHTML="SSH $ENCRYPTION$:";sSSHSCCipherName=(GetXMLValue(XMLDoc,"SSHSCCipherName")==""||GetXMLValue(XMLDoc,"SSHSCCipherName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSHSCCipherName");sSSHCSCipherName=(GetXMLValue(XMLDoc,"SSHCSCipherName")==""||GetXMLValue(XMLDoc,"SSHCSCipherName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSHCSCipherName");sSSHSCMACName=(GetXMLValue(XMLDoc,"SSHSCMACName")==""||GetXMLValue(XMLDoc,"SSHSCMACName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSHSCMACName");sSSHCSMACName=(GetXMLValue(XMLDoc,"SSHCSMACName")==""||GetXMLValue(XMLDoc,"SSHCSMACName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSHCSMACName");sSSHSCCompressionName=(GetXMLValue(XMLDoc,"SSHSCCompressionName")==""||GetXMLValue(XMLDoc,"SSHSCCompressionName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSHSCCompressionName");sSSHCSCompressionName=(GetXMLValue(XMLDoc,"SSHCSCompressionName")==""||GetXMLValue(XMLDoc,"SSHCSCompressionName")==undefined)?"$NONE$":GetXMLValue(XMLDoc,"SSHCSCompressionName");sEncryptionInfo="$SERVER_TO_CLIENT$: "+sSSHSCCipherName+", "+sSSHSCMACName+", "+sSSHSCCompressionName+"<br>$CLIENT_TO_SERVER$: "+sSSHCSCipherName+", "+sSSHCSMACName+", "+sSSHCSCompressionName;document.getElementById(sID+"PublicKeyProtocolLabel").style.visibility="visible";document.getElementById(sID+"PublicKeyProtocol").style.visibility="visible";document.getElementById(sID+"PublicKeyProtocol").innerHTML=(GetXMLValue(XMLDoc,"SSHPublicKeyProtocol")==""||GetXMLValue(XMLDoc,"SSHPublicKeyProtocol")==undefined)?"":GetXMLValue(XMLDoc,"SSHPublicKeyProtocol");}else document.getElementById(sID+"Encryption-Text").innerHTML="";return(sEncryptionInfo);}</script><script type="text/javascript" language="JavaScript">var ActiveSessions=InitActivityMonitor("ActivityMonitor",g_sAttrLogObjectType+"ActiveSessions.xml?ID="+g_nAttrLogObjectId,"KillUserButton","SessionMessageButton","BroadcastButton","AbortButton");</script></div></div><div id="StatsTab" style="display:none;"><div class="layercontent"><div><div class="LogHeader"><h2 class="LogHeader-title">$SESSION_STATS$</h2><div class="LogHeader-infotxt">$DOMAIN_STATS_INFO$</div></div><div id="statsscroll" class="statcontain"><table class="statcontain__table"><tr class="statcontain__row"><th class="statcontain__cell head" colspan="2">$STATS_START_TIME$</th><th class="statcontain__cell head" colspan="2">$SESSION_STATS$</th><th class="statcontain__cell head" colspan="2">$LOGIN_STATS$</th><th class="statcontain__cell head" colspan="2">$TRANSFER_STATS$</th></tr><tr class="statcontain__row"><td class="statcontain__cell name">$DATE$:</td><td class="statcontain__cell value" id="StatsStartDate"></td><td class="statcontain__cell name">$SESSIONS_CURRENT$:</td><td class="statcontain__cell value" id="SessionCount"></td><td class="statcontain__cell name">$LOGIN_STATS_LOGINS$:</td><td class="statcontain__cell value" id="DomainLogins"></td><td class="statcontain__cell name">$TRANSFER_DL_SPEED$:</td><td class="statcontain__cell value" id="TransferDLSpeed"></td></tr><tr class="statcontain__row"><td class="statcontain__cell name">$TIME$:</td><td class="statcontain__cell value" id="StatsStartTime"></td><td class="statcontain__cell name">$SESSIONS_TOTAL$:</td><td class="statcontain__cell value" id="SessionTotal"></td><td class="statcontain__cell name">$LOGIN_STATS_AVERAGE_LOGIN_SEC$:</td><td class="statcontain__cell value" id="DomainAverageLoginSeconds"></td><td class="statcontain__cell name">$TRANSFER_UL_SPEED$:</td><td class="statcontain__cell value" id="TransferULSpeed"></td></tr><tr class="statcontain__row small"><td class="statcontain__cell name">$DOMAIN_ACTIVE_FOR$:</td><td class="statcontain__cell value" id="UpTime"></td><td class="statcontain__cell name">$SESSIONS_LAST_DAY$:</td><td class="statcontain__cell value" id="SessionsInPast24Hours"></td><td class="statcontain__cell name">$LOGIN_STATS_LAST_LOGIN$:</td><td class="statcontain__cell value" id="DomainLastLoginTime"></td><td class="statcontain__cell name">$TRANSFER_DOWNLOADED$:</td><td class="statcontain__cell value" id="TransferDownloaded"></td></tr><tr class="statcontain__row small"><td class="statcontain__cell name"></td><td class="statcontain__cell value"></td><td class="statcontain__cell name">$SESSIONS_MAX$:</td><td class="statcontain__cell value" id="MostConcurrentSessions"></td><td class="statcontain__cell name">$LOGIN_STATS_LAST_LOGOUT$:</td><td class="statcontain__cell value" id="DomainLastLogoutTime"></td><td class="statcontain__cell name">$TRANSFER_UPLOADED$:</td><td class="statcontain__cell value" id="TransferUploaded"></td></tr><tr class="statcontain__row small"><td class="statcontain__cell name"></td><td class="statcontain__cell value"></td><td class="statcontain__cell name">$SESSIONS_AVG_TIME$</td><td class="statcontain__cell value" id="SessionAvgTime"></td><td class="statcontain__cell name">$LOGIN_STATS_MOST_CURRENT_LOGINS$:</td><td class="statcontain__cell value" id="DomainMostConcurrentLogins"></td><td class="statcontain__cell name">$TRANSFER_AVG_DL_SPEED$:</td><td class="statcontain__cell value" id="TransferAvgDLSpeed"></td></tr><tr class="statcontain__row small"><td class="statcontain__cell name"></td><td class="statcontain__cell value"></td><td class="statcontain__cell name">$SESSIONS_LONGEST$:</td><td class="statcontain__cell value" id="SessionLongest"></td><td class="statcontain__cell name">$LOGIN_STATS_CURRENT_LOGINS$:</td><td class="statcontain__cell value" id="DomainCurrentLogins"></td><td class="statcontain__cell name">$TRANSFER_AVG_UL_SPEED$:</td><td class="statcontain__cell value" id="TransferAvgULSpeed"></td></tr></table></div><script type="text/javascript" language="JavaScript">var g_tStatsTimer;var g_objStatsReq;var g_SessionStatsRefresh=10000;var g_bFirstRequest=true;function StatsEnableDisable(bEnable){if(bEnable){if(g_objStatsReq=createXMLHttpRequest("GET","%ADMIN_FILE%XML/DomainStats.xml?ID=%ID%",OnStatsCallback))g_objStatsReq.send(null);}else{clearTimeout(g_tStatsTimer);g_tStatsTimer=undefined;g_objStatsReq=undefined;}}function OnStatsCallback(){if((g_objStatsReq!=undefined)&&(g_objStatsReq.readyState==4)){if(g_objStatsReq.status==200){var XMLDoc=g_objStatsReq.responseXML;document.getElementById("UpTime").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"RunningSeconds")*1000,true,"$DAY$","$DAYS$");var ServerStartDate=new Date();ServerStartDate.setSeconds(ServerStartDate.getSeconds()-GetXMLValueInt(XMLDoc,"RunningSeconds"));document.getElementById("StatsStartDate").innerHTML=$.datepicker.formatDate("MM d, yy",ServerStartDate);document.getElementById("StatsStartTime").innerHTML=ServerStartDate.toLocaleTimeString();document.getElementById("SessionCount").innerHTML=FormatXMLIntValue(XMLDoc,"SessionCount");document.getElementById("MostConcurrentSessions").innerHTML=FormatXMLIntValue(XMLDoc,"MostConcurrentSessions");document.getElementById("SessionsInPast24Hours").innerHTML=FormatXMLIntValue(XMLDoc,"SessionsInPast24Hours");document.getElementById("SessionAvgTime").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"AverageConnectSeconds")*1000);document.getElementById("SessionTotal").innerHTML=FormatXMLIntValue(XMLDoc,"SessionTotal");document.getElementById("SessionLongest").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"MaxConnectSeconds")*1000);document.getElementById("TransferDLSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"DownloadTransferRateBytesSec"),true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("TransferULSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"UploadTransferRateBytesSec"),true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("TransferDownloaded").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"BytesDownloaded"),true)+" ("+FormatXMLIntValue(XMLDoc,"FilesDownloaded")+" $ACTIVITY_FILES$)";document.getElementById("TransferUploaded").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"BytesUploaded"),true)+" ("+FormatXMLIntValue(XMLDoc,"FilesUploaded")+" $ACTIVITY_FILES$)";document.getElementById("TransferAvgDLSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"AverageDownloadRate")*1024,true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("TransferAvgULSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"AverageUploadRate")*1024,true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("DomainLogins").innerHTML=FormatXMLIntValue(XMLDoc,"Logins");document.getElementById("DomainCurrentLogins").innerHTML=FormatXMLIntValue(XMLDoc,"CurrentLogins");document.getElementById("DomainMostConcurrentLogins").innerHTML=FormatXMLIntValue(XMLDoc,"MostConcurrentLogins");document.getElementById("DomainLastLoginTime").innerHTML=GetJqueryStatsDateTimeFormat(GetXMLValueInt(XMLDoc,"LastLoginTime"),"MM d, yy",true);document.getElementById("DomainLastLogoutTime").innerHTML=GetJqueryStatsDateTimeFormat(GetXMLValueInt(XMLDoc,"LastLogoutTime"),"MM d, yy",true);document.getElementById("DomainAverageLoginSeconds").innerHTML=(FormatXMLIntValue(XMLDoc,"AverageLoginSeconds")==0)?"":FormatDurationString(GetXMLValueInt(XMLDoc,"AverageLoginSeconds")*1000);if(g_bFirstRequest){$("#statsscroll").mCustomScrollbar({set_width:"100%",horizontalScroll:true,scrollInertia:0,scrollButtons:{enable:true },theme:"dark",advanced:{updateOnBrowserResize:true }});g_bFirstRequest=false;}else{$("#statsscroll").mCustomScrollbar("update");}g_tStatsTimer=setTimeout("StatsEnableDisable(true)",g_SessionStatsRefresh);}g_objStatsReq=undefined;}}function GetJqueryStatsDateTimeFormat(data,sFormatting,bAddTime){if((typeof(data)=="undefined")||(data=="")||(data.toString()=="0"))return("");else{var dDate=new Date(data*1000);if(bAddTime)return($.datepicker.formatDate(sFormatting,dDate)+" "+dDate.toLocaleTimeString());else return($.datepicker.formatDate(sFormatting,dDate));}}$(document).ready(function(){if(!g_bGroupAdmin&&(parseInt(g_sConsoleInclude)?true:false))StatsEnableDisable(true);});</script></div></div></div><div id="UserGroupsStatsTab" style="display:none;"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="" src="%ADMIN_FILE%Images/UserGroupStats32.png" width="32" height="32"/></td><td style="vertical-align:top;">$USER_GROUP_STATS_INFO$</td></tr></table><div id="UsersGroupsStatsTabContent" style="clear:both;padding-bottom:5px;"><div class="ie6positionfix"><div style="width:275px; float:left;padding-bottom:10px;margin-right:10px;"><span id="UserGroupSelectionGroup"><span id="SelectUserGroupStatsRadio"></span></span></div><div style="width:480px; float:left; padding-bottom:10px;"><span id="UserStatsSelectionGroup"><div style="width:240px;float:left;padding-left:5px;">$SELECT_COLLECTION$:<br /><span id="UserCollection"></span></div><div style="width:210px;float:left;">$SELECT_USER_STATS$:<br /><span id="UserStats"></span></div></span><span id="GroupStatsSelectionGroup" style="display:none;"><div style="padding-left:5px;">$SELECT_GROUP_STATS$:<br /><span id="GroupStats"></span></div></span></div><div style="clear:both;"><div id="PassChangeOnTxt" style="display:none;">$SESSIONS_PASSWORD_CHANGED_ON$: <span id="PasswordChangeOn" class="StatInfo"></span><br /></div><br /><div>$STATS_START_TIME$: <span id="StatsDuration" class="StatInfo"></span></div><br /><div id="StatUserScrollContain" style="width:100%;"><span id="UserSessionGroup"><div style="overflow-y:hidden;overflow:auto;width:100%;"><table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 0 10px;" ><tr><td style="width:100px;"><span style="white-space:nowrap;">$SESSIONS_CURRENT$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserSessionCount" class="StatInfo"></span></td><td style="width:140px;padding-left:10px;"><span style="white-space:nowrap;">$SESSIONS_MAX$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserMostConcurrentSessions" class="StatInfo"></span></td></tr><tr><td style="width:100px;"><span style="white-space:nowrap;">$SESSIONS_LAST_DAY$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserSessionsInPast24Hours" class="StatInfo"></span></td><td style="width:140px;padding-left:10px;"><span style="white-space:nowrap;">$SESSIONS_AVG_TIME$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserSessionAvgTime" class="StatInfo"></span></td></tr><tr><td style="width:100px;"><span style="white-space:nowrap;">$SESSIONS_TOTAL$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserSessionTotal" class="StatInfo"></span></td><td style="width:140px;padding-left:10px;"><span style="white-space:nowrap;">$SESSIONS_LONGEST$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserSessionLongest" class="StatInfo"></span></td></tr></table><div style="clear:both;height:18px;overflow:hidden;"></div></div></span><br /><span id="LoginStatsGroup"><div style="overflow-y:hidden;overflow :auto;width :100%;"><table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 0 10px;" ><tr><td style="width:100px;"><span style="white-space:nowrap;">$LOGIN_STATS_LOGINS$:</span></td><td style="width:100px;padding-left:10px;"><span id="Logins" class="StatInfo"></span></td><td style="width:100px;padding-left:10px;"><span style="white-space:nowrap;">$LOGIN_STATS_LOGOUTS$:</span></td><td style="width:100px;padding-left:10px;"><span id="Logouts" class="StatInfo"></span></td><td style="width:100px;padding-left:10px;"><span style="white-space:nowrap;">$LOGIN_STATS_CURRENT_LOGINS$:</span></td><td style="width:100px;padding-left:10px;"><span id="CurrentLogins" class="StatInfo"></span></td></tr><tr><td style="width:100px;"><span style="white-space:nowrap;">$LOGIN_STATS_LAST_LOGIN$:</span></td><td style="width:140px;padding-left:10px;"><span id="LastLoginTime" class="StatInfo"></span></td><td style="width:100px;padding-left:10px;"><span style="white-space:nowrap;">$LOGIN_STATS_MOST_CURRENT_LOGINS$:</span></td><td style="width:100px;padding-left:10px;"><span id="MostConcurrentLogins" class="StatInfo"></span></td><td style="width:100px;padding-left:10px;"><span style="white-space:nowrap;">$LOGIN_STATS_AVERAGE_LOGIN_SEC$:</span></td><td style="width:100px;padding-left:10px;"><span id="AverageLoginSeconds" class="StatInfo"></span></td></tr><tr><td style="width:100px;"><span style="white-space:nowrap;">$LOGIN_STATS_LAST_LOGOUT$:</span></td><td style="width:140px;padding-left:10px;"><span id="LastLogoutTime" class="StatInfo"></span></td><td style="width:100px;padding-left:10px;"><span style="white-space:nowrap;">$LOGIN_STATS_LONG_LOGIN_SEC$:</span></td><td style="width:100px;padding-left:10px;"><span id="LongestLoginDurationSeconds" class="StatInfo"></span></td><td style="width:100px;padding-left:10px;"><span style="white-space:nowrap;">$LOGIN_STATS_SHORT_LOGIN_SEC$:</span></td><td style="width:100px;padding-left:10px;"><span id="ShortestLoginDurationSeconds" class="StatInfo"></span></td></tr></table><div style="clear:both;height:18px;overflow:hidden;"></div></div></span><br /><span id="UserTransferGroup"><div style="overflow-y:hidden;overflow :auto;width :100%;"><table cellpadding="0" cellspacing="0" border="0" style="margin:0 0 0 10px;" ><tr><td style="width:100px;"><span style="white-space:nowrap;">$TRANSFER_DL_SPEED$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserTransferDLSpeed" class="StatInfo"></span></td><td style="width:140px;padding-left:10px;"><span style="white-space:nowrap;">$TRANSFER_AVG_DL_SPEED$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserTransferAvgDLSpeed" class="StatInfo"></span></td><td style="width:80px;padding-left:10px;"><span style="white-space:nowrap;">$TRANSFER_DOWNLOADED$:</span></td><td style="width:150px;padding-left:10px;"><span id="UserTransferDownloaded" class="StatInfo"></span></td></tr><tr><td style="width:100px;"><span style="white-space:nowrap;">$TRANSFER_UL_SPEED$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserTransferULSpeed" class="StatInfo"></span></td><td style="width:140px;padding-left:10px;"><span style="white-space:nowrap;">$TRANSFER_AVG_UL_SPEED$:</span></td><td style="width:100px;padding-left:10px;"><span id="UserTransferAvgULSpeed" class="StatInfo"></span></td><td style="width:80px;padding-left:10px;"><span style="white-space:nowrap;">$TRANSFER_UPLOADED$:</span></td><td style="width:150px;padding-left:10px;"><span id="UserTransferUploaded" class="StatInfo"></span></td></tr></table><div style="clear:both;height:18px;overflow:hidden;"></div></div></span></div><script type="text/javascript" language="JavaScript">var g_tUserGroupStatsTimer;if(!AW.ie){document.getElementById("StatUserScrollContain").style.overflow="auto";document.getElementById("StatUserScrollContain").style.paddingRight="15px";}CreateGroupBox("$SESSION_STATS$","UserSessionGroup","100%",(AW.opera)?"100px":"80px",true);CreateGroupBox("$LOGIN_STATS$","LoginStatsGroup","100%",(AW.opera)?"100px":"80px",true);CreateGroupBox("$TRANSFER_STATS$","UserTransferGroup","100%",(AW.opera)?"90px":"70px",true);function OnGroupUserStatsCallback(XMLDoc,nID){if(g_UserStatsRequest!=undefined){document.getElementById("StatsDuration").innerHTML=FormatFileDate(GetXMLValueInt(XMLDoc,"StatisticsStartTime"))+" ("+FormatDurationString(GetXMLValueInt(XMLDoc,"RunningSeconds")*1000,true,"$DAY$","$DAYS$")+")";document.getElementById("UserSessionCount").innerHTML=FormatXMLIntValue(XMLDoc,"SessionCount");document.getElementById("UserMostConcurrentSessions").innerHTML=FormatXMLIntValue(XMLDoc,"MostConcurrentSessions");document.getElementById("UserSessionsInPast24Hours").innerHTML=FormatXMLIntValue(XMLDoc,"SessionsInPast24Hours");document.getElementById("UserSessionAvgTime").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"AverageConnectSeconds")*1000);document.getElementById("UserSessionTotal").innerHTML=FormatXMLIntValue(XMLDoc,"SessionTotal");document.getElementById("UserSessionLongest").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"MaxConnectSeconds")*1000);if(g_bGroupStats){document.getElementById("PassChangeOnTxt").style.display="none";}else{PassWordExpireDate=new Date(GetXMLValueInt(XMLDoc,"PasswordChangedOn")*1000);document.getElementById("PasswordChangeOn").innerHTML=FormatDurationString(PassWordExpireDate,true,"$DAY$","$DAYS$");}document.getElementById("UserTransferDLSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"DownloadTransferRateBytesSec"),true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("UserTransferULSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"UploadTransferRateBytesSec"),true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("UserTransferDownloaded").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"BytesDownloaded"),true)+" ("+FormatXMLIntValue(XMLDoc,"FilesDownloaded")+" $ACTIVITY_FILES$)";document.getElementById("UserTransferUploaded").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"BytesUploaded"),true)+" ("+FormatXMLIntValue(XMLDoc,"FilesUploaded")+" $ACTIVITY_FILES$)";document.getElementById("UserTransferAvgDLSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"AverageDownloadRate")*1024,true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("UserTransferAvgULSpeed").innerHTML=FormatFileSize(GetXMLValueInt(XMLDoc,"AverageUploadRate")*1024,true)+"/$ACTIVITY_SEC_ABBREV$";document.getElementById("Logins").innerHTML=FormatXMLIntValue(XMLDoc,"Logins");document.getElementById("Logouts").innerHTML=FormatXMLIntValue(XMLDoc,"Logouts");document.getElementById("CurrentLogins").innerHTML=FormatXMLIntValue(XMLDoc,"CurrentLogins");document.getElementById("MostConcurrentLogins").innerHTML=FormatXMLIntValue(XMLDoc,"MostConcurrentLogins");document.getElementById("LastLoginTime").innerHTML=GetStatsDateTimeFormat(GetXMLValueInt(XMLDoc,"LastLoginTime"));document.getElementById("LastLogoutTime").innerHTML=GetStatsDateTimeFormat(GetXMLValueInt(XMLDoc,"LastLogoutTime"));document.getElementById("AverageLoginSeconds").innerHTML=(FormatXMLIntValue(XMLDoc,"AverageLoginSeconds")==0)?"":FormatDurationString(GetXMLValueInt(XMLDoc,"AverageLoginSeconds")*1000);document.getElementById("LongestLoginDurationSeconds").innerHTML=(FormatXMLIntValue(XMLDoc,"LongestLoginDurationSeconds")==0)?"":FormatDurationString(GetXMLValueInt(XMLDoc,"LongestLoginDurationSeconds")*1000);if(GetXMLValueInt(XMLDoc,"ShortestLoginDurationSeconds")==parseInt("0xffffffffffffffffui64",16))document.getElementById("ShortestLoginDurationSeconds").innerHTML="";else document.getElementById("ShortestLoginDurationSeconds").innerHTML=FormatDurationString(GetXMLValueInt(XMLDoc,"ShortestLoginDurationSeconds")*1000);g_tUserGroupStatsTimer=setTimeout(function(){OnChangeStats(nID);},1000);g_UserStatsRequest=undefined;}else OnGroupUserStatsReset();}function OnGroupUserStatsReset(){document.getElementById("StatsDuration").innerHTML="";document.getElementById("UserSessionCount").innerHTML="";document.getElementById("UserMostConcurrentSessions").innerHTML="";document.getElementById("UserSessionsInPast24Hours").innerHTML="";document.getElementById("UserSessionAvgTime").innerHTML="";document.getElementById("UserSessionTotal").innerHTML="";document.getElementById("UserSessionLongest").innerHTML="";if(g_bGroupStats){document.getElementById("PassChangeOnTxt").style.display="none";}else{document.getElementById("PasswordChangeOn").innerHTML="";}document.getElementById("UserTransferDLSpeed").innerHTML="";document.getElementById("UserTransferULSpeed").innerHTML="";document.getElementById("UserTransferDownloaded").innerHTML="";document.getElementById("UserTransferUploaded").innerHTML="";document.getElementById("UserTransferAvgDLSpeed").innerHTML="";document.getElementById("UserTransferAvgULSpeed").innerHTML="";document.getElementById("Logins").innerHTML="";document.getElementById("Logouts").innerHTML="";document.getElementById("CurrentLogins").innerHTML="";document.getElementById("MostConcurrentLogins").innerHTML="";document.getElementById("LastLoginTime").innerHTML="";document.getElementById("LastLogoutTime").innerHTML="";document.getElementById("AverageLoginSeconds").innerHTML="";document.getElementById("LongestLoginDurationSeconds").innerHTML="";document.getElementById("ShortestLoginDurationSeconds").innerHTML="";}</script></div><div style="padding:5px 0 5px 0;"><span id="ResetAllStats" style="float:right;"></span><span id="ResetUserGroupStats" style="float:right;"></span><span id="SaveUserGroupStats"></span></div></div></div><div style="text-align:center;" id="UsersGroupsStatsTabContentContainer"><div id="UsersGroupsStatsTabContentNone" class="UpgradeLicenseMsg"><img id="UsersGroupsStatsTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="UsersGroupsStatsTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><div id="LogTab" style="display:none;"><div class="layercontent"><div class="LogHeader"><div class="LogHeader-infotxt">$LOG_DISPLAY_INFO$</div></div><div style="padding-right:10px;"><div id="logwindow" style="margin-top:10px;"><div id="log"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></div></div><div style="clear:both;overflow:hidden;height:1px;">&nbsp;</div><div style="clear:both;"><span id="FreezeLog"></span>&nbsp;&nbsp;<span id="SelectLog"></span>&nbsp;&nbsp;<span id="CopyLogCont" style="display:none;"><span id="CopyLog"></span>&nbsp;&nbsp;</span><span id="ClearLog"></span>&nbsp;&nbsp;<span id="LogLegendCont" style="display:none;"><span id="LogLegend"></span>&nbsp;&nbsp;</span><span id="ServerLogFilterButton"></span>&nbsp;&nbsp;<span id="DownloadLog"></span></div></div><div id="LegendDialoginner" style="display:none;"><div class="loglegend"><div style="color:#009900;">$SYSTEM_MESSAGES_LABEL$</div><div style="color:#0000ff;">$SECURITY_MESSAGES_LABEL$</div><div style="color:#ca6500;">$IP_NAMES_LABEL$</div><div style="color:#640986;">$ODBC_CALLS_LABEL$</div><div style="color:#fff;background:#ff0000;">$ODBC_ERRORS_LABEL$</div><div style="color:#fff;background:#870487;">$TRIGGERED_EVENT_LABEL$</div><div style="color:#000;background:#e8e8e8;">$DOWNLOADS_LABEL$</div><div style="color:#000;background:#e8e8e8;">$UPLOADS_LABEL$</div><div style="color:#000;background:#e8e8e8;">$FILE_DELETIONS_LABEL$</div><div style="color:#000;background:#e8e8e8;">$FILE_AND_DIRECTORY_RENAMES_LABEL$</div><div style="color:#000;background:#e8e8e8;">$DIRECTORY_CREATIONS_LABEL$</div><div style="color:#000;background:#e8e8e8;">$DIRECTORY_DELETIONS_LABEL$</div><div style="color:#000;background:#ffffd9;">$FTP_COMMANDS_LABEL$</div><div style="color:#000;background:#ffffd9;">$FTP_REPLIES_LABEL$</div><div style="color:#000;background:#ff6600;">$SSH_COMMANDS_LABEL$</div><div style="color:#000;background:#ff6600;">$SSH_REPLIES_LABEL$</div><div style="color:#000;background:#afd9ee;">$HTTP_COMMANDS_LABEL$</div><div style="color:#000;background:#afd9ee;">$HTTP_REPLIES_LABEL$</div></div><div style="text-align:center;"><span id="CloseLegend"></span></div></div><script type="text/javascript" language="javascript">var g_bShowLogLegend=true;$(document).ready(function(){BuildDialog("$LOG_LEGEND$","LegendDialog","400","315","","$CLOSE_CANCEL$");CreatePushButton("$CLOSE_BUTTON$","CloseLegend",OnHideLegend);});function OnShowLegend(){if(g_bShowLogLegend){ShowDialog("LegendDialog",false);g_bShowLogLegend=false;}else{HideDialog("LegendDialog");g_bShowLogLegend=true;}}function OnHideLegend(){OnShowLegend();}</script><script type="text/javascript" language="JavaScript">function OnFreezeServerLog(Checkbox){FreezeDomainAttrLog(Checkbox.getControlValue());}function OnCopyLog(){FreezeBox.setChecked(true,false);fnSelect('log',true);}var FreezeBox=CreateCheckBox("$FREEZE_LOG$","FreezeLog","FreezeLog",0,OnFreezeServerLog);if(!AW.ie)FreezeBox.setStyle('margin-top','10px');else FreezeBox.setStyle('margin-top','3px');document.getElementById('FreezeLog').getElementsByClassName('aw-item-marker')[0].classList.add('customCheckBox');CreatePushButton("$CLEAR_LOG$","ClearLog",OnClearLog,undefined,undefined,"log",'','customButton');CreatePushButton("$SELECT_ALL$","SelectLog",OnSelectAllLog,undefined,undefined,null,'','customButton');if((AW.ie)||(AW.ms11)){CreatePushButton("$COPY_CLIPBOARD$","CopyLog",OnCopyLog,undefined,undefined,null,'','customButton');document.getElementById("CopyLogCont").style.display="inline";}CreatePushButton("$FILTER_LOG_BUTTON$...","ServerLogFilterButton",OnShowLogFilter,undefined,undefined,null,'','customButton');if("Domain"!="Server"){document.getElementById("LogLegendCont").style.display="inline";CreatePushButton("$LEGEND_BUTTON$...","LogLegend",OnShowLegend,undefined,undefined,null,'','customButton');}</script></div></div><div id="SettingsTab" style="display:none"><div class="layercontent" ><div class="ie6positionfix"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="" src="%ADMIN_FILE%Images/Properties.png" width="32" height="32"/></td><td style="vertical-align:top;">$LOG_SETTINGS_INFO$</td></tr></table><br style="clear:both" /><div style="margin:5px 0 5px 0;width:100%;"><form name="LogSettings"><table cellpadding="0" cellspacing="0" style="float:left;"><tr><td><strong>$LOG_FILE_LABEL$</strong><br />
<span id="FileSystemMessages"></span><br /><span id="FileSecurityMessages"></span><br /><span id="FileIPNames"></span><br /><span id="FileODBCErrors"></span><br /><span id="FileODBCCalls"></span><br /><span id="FileTriggeredEvents"></span><br /><span id="FileDownloads"></span><br /><span id="FileZippedDownloads"></span><br /><span id="FileUploads"></span><br /><span id="FileFileDeletes"></span><br /><span id="FileFileDirRenames"></span><br /><span id="FileDirCreates"></span><br /><span id="FileDirDeletes"></span><br /><span id="FileFTPCommands"></span><br /><span id="FileFTPReplies"></span><br /><span id="FileSSHCommands"></span><br /><span id="FileSSHReplies"></span><br /><span id="FileSSHDetailedCommands"></span><br /><span id="FileSSHDetailedReplies"></span><br /><span id="FileHTTPCommands"></span><br /><span id="FileHTTPReplies"></span><br /></td><td style="padding-left:5px;"><strong>$LOG_SCREEN_LABEL$</strong><br /><span id="ScreenSystemMessages"></span><br /><span id="ScreenSecurityMessages"></span><br /><span id="ScreenIPNames"></span><br /><span id="ScreenODBCErrors"></span><br /><span id="ScreenODBCCalls"></span><br /><span id="ScreenTriggeredEvents"></span><br /><span id="ScreenDownloads"></span><br /><span id="ScreenZippedDownloads"></span><br /><span id="ScreenUploads"></span><br /><span id="ScreenFileDeletes"></span><br /><span id="ScreenFileDirRenames"></span><br /><span id="ScreenDirCreates"></span><br /><span id="ScreenDirDeletes"></span><br /><span id="ScreenFTPCommands"></span><br /><span id="ScreenFTPReplies"></span><br /><span id="ScreenSSHCommands"></span><br /><span id="ScreenSSHReplies"></span><br /><span id="ScreenSSHDetailedCommands"></span><br /><span id="ScreenSSHDetailedReplies"></span><br /><span id="ScreenHTTPCommands"></span><br /><span id="ScreenHTTPReplies"></span><br /></td></tr></table><div style="float:left;width:360px;margin-left:10px;"><div id="LoggingToFileGroup"><div style="margin-top: 5px;"><img src="%COMMON_FILE%Images/Warn.png" width="24" height="24" class="tab-header" alt="warning" />$USING_SLOW_NETWORK_WARNING$</div><br />$LOG_FILE_PATH$:<br/><div style="overflow:auto"><span id="LogFilePath"></span> <span id="BrowseButtonLogPath"></span></div><span id="LogToFile"></span><div style="margin-top:5px"><div style="padding-right:5px;">$LOG_FILE_PARAMETERS_LABEL$:<hr style="height:1px;" /></div><div style="float:left;width:155px;">%H = $HOURLY_LOG_LABEL$<br />%D = $DAY_OF_MONTH_LABEL$<br />%M = $MONTH_TEXT_LABEL$<br />%N = $MONTH_NUMBER_LABEL$<br /></div><div style="float:left;width:155px;padding:0 0 4px 10px;">%Y = $4_DIGIT_YEAR_LABEL$<br />%X = $2_DIGIT_YEAR_LABEL$<br />%S = $DOMAIN_NAME_LABEL$<br /></div><div style="clear:left;text-align:center;padding-right:5px;"><hr style="height:1px;" /></div>$LOG_ROTATE_SETTING$:<br /><span id="LogFileArchiveMode"></span><div style="clear:left;text-align:center;padding-right:5px;"><hr style="height:1px;" /></div><div style="overflow:auto">$KEEP_UP_TO$ <span id="MaxLogFiles"></span>&nbsp;$LOG_EXCEED_FILES$	($ZERO_NO_DELETE$)</div><span id="SaveButton" style="float:right;"></span><div style="padding-top:5px;"><div style="overflow:auto">$KEEP_UP_TO$ <span id="MaxLogFilesBytes"></span>&nbsp;$LOG_EXCEED_BYTES$	($ZERO_NO_DELETE$)</div></div></div></div><div style="padding-top:5px;"><span id="DoNotLogButton"></span></div><div class="low-performance-warning warning-group Hidden" style="padding-top:10px;"><img src="Images/Warn16.png" alt="warning"><span>$PERFORMANCE_AFFECTING_SETTINGS_WARNING$</span></div></div><br /><br /><div style="clear:both;height:5px;"></div></form></div></div></div></div></div><script type="text/javascript" language="JavaScript">var DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES=[];var FileSystemMessagesChecbox=CreateCheckBox("","FileSystemMessages","SystemMessages",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.SystemMessages%,OnFileCheckBoxValueChanged);var ScreenSystemMessagesChecbox=CreateCheckBox("$SYSTEM_MESSAGES_LABEL$","ScreenSystemMessages","SystemMessages",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.SystemMessages%,OnScreenCheckBoxValueChanged);var FileSecurityMessagesChecbox=CreateCheckBox("","FileSecurityMessages","SecurityMessages",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.SecurityMessages%,OnFileCheckBoxValueChanged);var ScreenSecurityMessagesChecbox=CreateCheckBox("$SECURITY_MESSAGES_LABEL$","ScreenSecurityMessages","SecurityMessages",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.SecurityMessages%,OnScreenCheckBoxValueChanged);var FileIPNamesChecbox=CreateCheckBox("","FileIPNames","IPNames",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.IPNames%,OnFileCheckBoxValueChanged);var ScreenIPNamesChecbox=CreateCheckBox("$IP_NAMES_LABEL$","ScreenIPNames","IPNames",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.IPNames%,OnScreenCheckBoxValueChanged);var FileODBCErrorsChecbox=CreateCheckBox("","FileODBCErrors","ODBCErrors",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.ODBCErrors%,OnFileCheckBoxValueChanged);var ScreenODBCErrorsChecbox=CreateCheckBox("$ODBC_ERRORS_LABEL$","ScreenODBCErrors","ODBCErrors",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.ODBCErrors%,OnScreenCheckBoxValueChanged);var FileODBCCallsChecbox=CreateCheckBox("","FileODBCCalls","ODBCCalls",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.ODBCCalls%,OnFileCheckBoxValueChanged);var ScreenODBCCallsChecbox=CreateCheckBox("$ODBC_CALLS_LABEL$","ScreenODBCCalls","ODBCCalls",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.ODBCCalls%,OnScreenCheckBoxValueChanged);var FileTriggeredEventsChecbox=CreateCheckBox("","FileTriggeredEvents","TriggeredEvents",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.TriggeredEvents%,OnFileCheckBoxValueChanged);var ScreenTriggeredEventsChecbox=CreateCheckBox("$TRIGGERED_EVENT_LABEL$","ScreenTriggeredEvents","TriggeredEvents",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.TriggeredEvents%,OnScreenCheckBoxValueChanged);var FileDownloadsChecbox=CreateCheckBox("","FileDownloads","Downloads",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.Downloads%,OnFileCheckBoxValueChanged);var ScreenDownloadsChecbox=CreateCheckBox("$DOWNLOADS_LABEL$","ScreenDownloads","Downloads",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.Downloads%,OnScreenCheckBoxValueChanged);var FileZippedDownloadsChecbox=CreateCheckBox("","FileZippedDownloads","ZippedDownloads",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.ZippedDownloads%,OnFileCheckBoxValueChanged);var ScreenZippedDownloadsChecbox=CreateCheckBox("$ZIPPEDDOWNLOADS_LABEL$","ScreenZippedDownloads","ZippedDownloads",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.ZippedDownloads%,OnScreenCheckBoxValueChanged);var FileUploadsChecbox=CreateCheckBox("","FileUploads","Uploads",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.Uploads%,OnFileCheckBoxValueChanged);var ScreenUploadsChecbox=CreateCheckBox("$UPLOADS_LABEL$","ScreenUploads","Uploads",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.Uploads%,OnScreenCheckBoxValueChanged);var FileFileDeletesChecbox=CreateCheckBox("","FileFileDeletes","FileDeletes",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.FileDeletes%,OnFileCheckBoxValueChanged);var ScreenFileDeletesChecbox=CreateCheckBox("$FILE_DELETIONS_LABEL$","ScreenFileDeletes","FileDeletes",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.FileDeletes%,OnScreenCheckBoxValueChanged);var FileFileDirRenamesChecbox=CreateCheckBox("","FileFileDirRenames","FileDirRenames",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.FileDirRenames%,OnFileCheckBoxValueChanged);var ScreenFileDirRenamesChecbox=CreateCheckBox("$FILE_AND_DIRECTORY_RENAMES_LABEL$","ScreenFileDirRenames","FileDirRenames",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.FileDirRenames%,OnScreenCheckBoxValueChanged);var FileDirCreatesChecbox=CreateCheckBox("","FileDirCreates","DirCreates",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.DirCreates%,OnFileCheckBoxValueChanged);var ScreenDirCreatesChecbox=CreateCheckBox("$DIRECTORY_CREATIONS_LABEL$","ScreenDirCreates","DirCreates",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.DirCreates%,OnScreenCheckBoxValueChanged);var FileDirDeletesChecbox=CreateCheckBox("","FileDirDeletes","DirDeletes",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.DirDeletes%,OnFileCheckBoxValueChanged);var ScreenDirDeletesChecbox=CreateCheckBox("$DIRECTORY_DELETIONS_LABEL$","ScreenDirDeletes","DirDeletes",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.DirDeletes%,OnScreenCheckBoxValueChanged);var FileFTPCommandsChecbox=CreateCheckBox("","FileFTPCommands","FTPCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.FTPCommands%,OnFileCheckBoxValueChanged);var ScreenFTPCommandsChecbox=CreateCheckBox("$FTP_COMMANDS_LABEL$","ScreenFTPCommands","FTPCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.FTPCommands%,OnScreenCheckBoxValueChanged);var FileFTPRepliesChecbox=CreateCheckBox("","FileFTPReplies","FTPReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.FTPReplies%,OnFileCheckBoxValueChanged);var ScreenFTPRepliesChecbox=CreateCheckBox("$FTP_REPLIES_LABEL$","ScreenFTPReplies","FTPReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.FTPReplies%,OnScreenCheckBoxValueChanged);var FileSSHCommandsChecbox=CreateCheckBox("","FileSSHCommands","SSHCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.SSHCommands%,OnFileCheckBoxValueChanged);var ScreenSSHCommandsChecbox=CreateCheckBox("$SSH_COMMANDS_LABEL$","ScreenSSHCommands","SSHCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.SSHCommands%,OnScreenCheckBoxValueChanged);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(FileSSHCommandsChecbox);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(ScreenSSHCommandsChecbox);var FileSSHRepliesChecbox=CreateCheckBox("","FileSSHReplies","SSHReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.SSHReplies%,OnFileCheckBoxValueChanged);var ScreenSSHRepliesChecbox=CreateCheckBox("$SSH_REPLIES_LABEL$","ScreenSSHReplies","SSHReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.SSHReplies%,OnScreenCheckBoxValueChanged);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(FileSSHRepliesChecbox);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(ScreenSSHRepliesChecbox);var FileSSHDetailedCommandsChecbox=CreateCheckBox("","FileSSHDetailedCommands","SSHDetailedCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.SSHDetailedCommands%,OnFileCheckBoxValueChanged);var ScreenSSHDetailedCommandsChecbox=CreateCheckBox("$SSH_DETAILED_COMMANDS_LABEL$","ScreenSSHDetailedCommands","SSHDetailedCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.SSHDetailedCommands%,OnScreenCheckBoxValueChanged);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(FileSSHDetailedCommandsChecbox);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(ScreenSSHDetailedCommandsChecbox);var FileSSHDetailedRepliesChecbox=CreateCheckBox("","FileSSHDetailedReplies","SSHDetailedReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.SSHDetailedReplies%,OnFileCheckBoxValueChanged);var ScreenSSHDetailedRepliesChecbox=CreateCheckBox("$SSH_DETAILED_REPLIES_LABEL$","ScreenSSHDetailedReplies","SSHDetailedReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.SSHDetailedReplies%,OnScreenCheckBoxValueChanged);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(FileSSHDetailedRepliesChecbox);DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.push(ScreenSSHDetailedRepliesChecbox);var FileHTTPCommandsChecbox=CreateCheckBox("","FileHTTPCommands","HTTPCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.HTTPCommands%,OnFileCheckBoxValueChanged);var ScreenHTTPCommandsChecbox=CreateCheckBox("$HTTP_COMMANDS_LABEL$","ScreenHTTPCommands","HTTPCommands",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.HTTPCommands%,OnScreenCheckBoxValueChanged);var FileHTTPRepliesChecbox=CreateCheckBox("","FileHTTPReplies","HTTPReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%.HTTPReplies%,OnFileCheckBoxValueChanged);var ScreenHTTPRepliesChecbox=CreateCheckBox("$HTTP_REPLIES_LABEL$","ScreenHTTPReplies","HTTPReplies",%CLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%.HTTPReplies%,OnScreenCheckBoxValueChanged);CreateGroupBox("$ACTIVITY_SESS_INFO$","StatsGroup","100%","150px",true);var sOnKillUser=String("OnKillUser(");var sOnSpyChat=String("OnSpyChat(");var sOnAbortCommand=String("OnAbortCommand(");var g_bShowLogFilePathAlert=true;g_sHelpPage="Help-Domain-Server-Activity.htm";g_sHelpNode="Item16_4";var aTabMainHelpPages=["Help-Domain-Server-Activity.htm","Help-Domain-Server-Stats.htm","Help-User-Group-Stats.htm","Help-Domain-Server-Log.htm","Help-Configure-Logs.htm"];updatePerformanceWarning();CreateContextMenu([sOnKillUser,sOnSpyChat,sOnAbortCommand],["$KILL_USER_BUTTON$","$SPY_CHAT_BUTTON$","$ABORT_BUTTON$"],["Disconnect","Chat","Abort"],ActiveSessions,undefined,true);var nLogFileGroupHeight="$LOG_FILE_GROUP_HEIGHT$px";if(bIsOpera)nLogFileGroupHeight="$OPERA_LOG_FILE_GROUP_HEIGHT$px";else nLogFileGroupHeight="$LOG_FILE_GROUP_HEIGHT$px";CreateGroupBox("$LOG_FILE_SETTINGS$","LoggingToFileGroup","350px",nLogFileGroupHeight);var LogFilePathInput=CreateInputField("%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.LogFilePath%","LogFilePath","LogFilePath",undefined,290,undefined,undefined,OnSaveFileLogging);LogFilePathInput.onControlTextChangedDef=LogFilePathInput.onControlTextChanged;LogFilePathInput.onControlTextChanged=function(sText){setTimeout(function(){if(!g_bIsFileNameSelected&&g_bShowLogFilePathAlert){AlertDialog("$PLEASE_ENTER_LOG_FILE_NAME$<br><br>$LOG_FILE_NAMING_EXAMPLES$",false,SetLogFileFocus);g_bShowLogFilePathAlert=false;}if(LogFilePathInput.onControlTextChangedDef)LogFilePathInput.onControlTextChangedDef(sText);});};CreateCheckBox("$ENABLE_LOG_TO_FILE$","LogToFile","LogToFile",%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.LogToFile%,OnCheckBoxValueChanged);if(g_sLogFile!="")CreatePushButton("$DOWNLOAD_LOG_BUTTON$","DownloadLog",OnDownloadLog,undefined,undefined,undefined,"log");nMaxLogMB=parseFloat(parseInt("%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.MaxLogFilesBytes%")/(1024*1024));var MaxLogFilesBytesInput=CreateInputField(nMaxLogMB.toString(),"MaxLogFilesBytes","MaxLogFilesBytes",undefined,50,undefined,undefined,OnSaveFileLogging);var MaxLogFilesInput=CreateInputField("%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.MaxLogFiles%","MaxLogFiles","MaxLogFiles",undefined,50,undefined,undefined,OnSaveFileLogging);var LogFileRotationCombo=CreateComboBox("","%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.LogFileArchiveMode%",["$LOG_ROTATE_NEVER_DESC$","$LOG_ROTATE_HOURLY_DESC$","$LOG_ROTATE_DAILY_DESC$","$LOG_ROTATE_WEEKLY_DESC$","$LOG_ROTATE_MONTHLY_DESC$","$LOG_ROTATE_YEARLY_DESC$"],["0","5","1","2","3","4"],"LogFileArchiveMode","LogFileArchiveMode",undefined,undefined,false,100,undefined,undefined,undefined,undefined,true);var nLogFileRotationComboCnt=parseInt(LogFileRotationCombo.getItemCount());LogFileRotationCombo.getPopupTemplate().setStyle("height",(nLogFileRotationComboCnt<=10)?((16*nLogFileRotationComboCnt)+((AW.ie)?3:0))+"px":"163px");CreatePushButton("$SAVE_BUTTON$","SaveButton",OnSaveFileLogging);CreatePushButton("$LOG_IP_ACCESS_BUTTON$...","DoNotLogButton",OnLogIPAccess);if(!g_bGroupAdmin)InitDomainAttrLog();if(g_bGroupAdmin)g_ActiveTab=CreateTabs(["$SESSIONS_TAB$","$USER_GROUP_STATS_TAB$"],["SessionsTab","UserGroupsStatsTab"],"PageTabs","TabsContent",1,OnChangeTab);else g_ActiveTab=CreateTabs(["$SESSIONS_TAB$","$STATS_TAB$","$USER_GROUP_STATS_TAB$","$LOG_TAB$","$SETTINGS_TAB$"],["SessionsTab","StatsTab","UserGroupsStatsTab","LogTab","SettingsTab"],"PageTabs","TabsContent",1,OnChangeTab);var g_bDomain=true;var g_bGroupStats=false;var g_bReloadStats=false;var g_bFirstStatsLoad=true;var g_bFirstGroupStatsLoad=true;var g_nCurrUserGroupID;var g_UserStatsRequest;var g_GroupStatsCombo;var g_asODBCGroupsAdd;var g_asODBCGroupIDsAdd;var g_asODBCGroupsIconAdd;var g_asUserStatsInfo=[];var g_bUseStatsCookie=true;var g_tLoadStatsTimer;var g_tLoadODBCStatsTimer;var g_bShowWindowsGroups=(%WINDOWS_AUTH_SUPPORT%==1);function OnUserGroupStatsChange(nValue){clearTimeout(g_tUserGroupStatsTimer);g_tUserGroupStatsTimer=undefined;g_UserStatsRequest=undefined;createCookie("%ID%UserGroupRadio",nValue,100);if(nValue==1){document.getElementById("UserStatsSelectionGroup").style.display="none";document.getElementById("GroupStatsSelectionGroup").style.display="block";g_bGroupStats=true;if(g_bFirstGroupStatsLoad){GetGroupStatsXML();}else{setTimeout(function(){var nGroupIndex=0;if(g_nCookieGroupID!=""){for(var nIndex=0;nIndex<GroupStatsCombo.getItemCount();nIndex++){if(GroupStatsCombo.getItemText(nIndex)==g_nCookieGroupID){nGroupIndex=nIndex;break;}}}GroupStatsCombo.setSelectedItems([nGroupIndex]);GroupStatsCombo.setControlText(GroupStatsCombo.getItemText(nGroupIndex));if(!AW.opera)GroupStatsCombo.setControlImage(GroupStatsCombo.getItemImage(nGroupIndex));},0);}g_bFirstGroupStatsLoad=false;}else{document.getElementById("GroupStatsSelectionGroup").style.display="none";document.getElementById("UserStatsSelectionGroup").style.display="block";g_bGroupStats=false;if(!g_bFirstStatsLoad){setTimeout(function(){var nUserIndex=0;if(g_nCookieUserID!=""&&!g_bGroupStats){for(var nIndex=0;nIndex<UserStatsCombo.getItemCount();nIndex++){if(UserStatsCombo.getItemValue(nIndex)==g_nCookieUserID){nUserIndex=nIndex;break;}}}UserStatsCombo.setSelectedItems([nUserIndex]);UserStatsCombo.setControlText(UserStatsCombo.getItemText(nUserIndex));if(!AW.opera)UserStatsCombo.setControlImage(UserStatsCombo.getItemImage(nUserIndex));},0);}g_bFirstStatsLoad=false;}}CreateGroupBox("$USER_GROUP_STATS_SELECTION$","UserGroupSelectionGroup","265px","75px",true);CreateGroupBox("$USER_STATS$","UserStatsSelectionGroup","470px","75px",true);CreateGroupBox("$GROUP_STATS$","GroupStatsSelectionGroup","310px","75px",true);var UserGroupRadioButtons=CreateRadioButtons(0,["$USER_STATS$","$GROUP_STATS$"],"SelectUserGroupStatsRadio","SelectUserGroupStats",200,OnUserGroupStatsChange,undefined,["User","Group"]);if(g_nUserGroupRadioSave=="1"){UserGroupRadioButtons.setControlValue("Group");UserGroupRadioButtons.initValue(g_nUserGroupRadioSave);}if(g_bFireFox3Browser)document.getElementById("SelectUserGroupStatsRadio-box").style.height="60px";var g_nCurrentUserOrg=g_nDefaultOrgID;var UserStatsCombo=CreateComboBox("","",[],[],"UserStats","Info_UserStats",OnChangeUserStats,undefined,false,200,24);var GroupStatsCombo=CreateComboBox("","",[],[],"GroupStats","Info_GroupStats",OnChangeGroupStats,undefined,false,290,24);if("%CDomain.%ID%.ODBCAvailable%"!="1")var CollectionCombo=CreateComboBox("$GENERAL_USERS_NAME$",g_nDefaultOrgID,["$GENERAL_USERS_NAME$"],[g_nDefaultOrgID],"UserCollection","Info_UserCollection",OnChangeCollection,undefined,false,205,24);else var CollectionCombo=CreateComboBox("$GENERAL_USERS_NAME$",g_nDefaultOrgID,["$GENERAL_USERS_NAME$","$GENERAL_ODBC_USERS$"],[g_nDefaultOrgID,g_nODBCUserOrg],"UserCollection","Info_UserCollection",OnChangeCollection,undefined,false,205,24);if("%CDomain.%ID%.UserGroupStatsLicense%"!="1")DisableTab("UsersGroupsStatsTabContent");function GetOrganizationsXML(){var g_OrgTable=new AW.XML.SUObjectTable("DomainOrganizations.xml","%ID%",["@name","@ID"]);if(g_OrgTable&&g_bOrgNotLoaded){g_OrgTable.responseDef=g_OrgTable.response;g_OrgTable.response=OnLoadOrganizations;g_OrgTable.request();g_tLoadStatsTimer=setTimeout(function(){LoadingDialog(true);},2000);g_bOrgNotLoaded=false;}}function GetUserStatsXML(){var g_UserStatsTable=new AW.XML.SUObjectTable("OrganizationUsers.xml",g_nCurrentUserOrg,["LoginID","FullName"]);g_UserStatsTable.setRows("//user");if(g_UserStatsTable){g_UserStatsTable.responseDef=g_UserStatsTable.response;g_UserStatsTable.response=OnLoadUsersStatList;g_UserStatsTable.request();}}function GetGroupStatsXML(bODBC){var nGroupID=g_nActiveGroupID;if(bODBC)nGroupID=g_nODBCGroupID;var g_GroupStatsTable=new AW.XML.SUObjectTable("Groups.xml",nGroupID,["GroupID","ID"]);g_GroupStatsTable.setRows("//group");if(g_GroupStatsTable){g_GroupStatsTable.responseDef=g_GroupStatsTable.response;if(bODBC)g_GroupStatsTable.response=OnLoadODBCGroupStatList;else g_GroupStatsTable.response=OnLoadGroupStatList;g_GroupStatsTable.request();}}function OnChangeUserStats(nID){if(!AW.opera)UserStatsCombo.setControlImage(UserStatsCombo.getItemImage(UserStatsCombo.getSelectedItems()));OnChangeStats(nID);createCookie("%ID%UserID",nID,100);g_nCookieUserID=nID;}function OnChangeGroupStats(nID){if(!AW.opera)GroupStatsCombo.setControlImage(GroupStatsCombo.getItemImage(GroupStatsCombo.getSelectedItems()));OnChangeStats(nID);g_nCookieGroupID=GroupStatsCombo.getControlText();createCookie("%ID%GroupID",g_nCookieGroupID,100);}function OnChangeStats(nID){var sStatsXML="%ADMIN_FILE%XML/UserStats.xml%OBJECT_COMMAND_REF%CDomainAttrs.%ID%.LoadUser";var sLoadID="LoginID";if((g_nCurrUserGroupID!=undefined)&&(nID!=g_nCurrUserGroupID)){clearTimeout(g_tUserGroupStatsTimer);g_tUserGroupStatsTimer=undefined;g_UserStatsRequest=undefined;}g_nCurrUserGroupID=nID;if(g_bGroupStats){sStatsXML="%ADMIN_FILE%XML/GroupStats.xml?ID="+decodeURIComponent(g_nCurrUserGroupID);}if(!g_bGroupStats){createCookie("%ID%UserID",g_nCurrUserGroupID,100);createCookie("%ID%StatsID",g_nCurrentUserOrg,100);}g_UserStatsRequest=CreatePostRequest(sStatsXML);if(!g_bGroupStats)g_UserStatsRequest.setParameter(sLoadID,decodeURIComponent(g_nCurrUserGroupID));g_UserStatsRequest.setAsync(true);g_UserStatsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){OnGroupUserStatsReset();}else{if(g_bGroupStats&&g_nCurrUserGroupID==""){OnGroupUserStatsReset();}else{OnGroupUserStatsCallback(XMLDoc,g_nCurrUserGroupID);}}};g_UserStatsRequest.request();}function OnLoadUsersStatList(sText){var asUsers=[];var asUserIDs=[];var asUserIcon=[];g_asUserStatsInfo=[];clearTimeout(g_tLoadStatsTimer);clearTimeout(g_tLoadODBCStatsTimer);g_tLoadStatsTimer=undefined;g_tLoadODBCStatsTimer=undefined;this.responseDef(sText);for(var nIndex=0;nIndex<this.getCount();nIndex++){var sUserFullName="";if(this.getData(1,nIndex)!="")sUserFullName=" ("+FormatClientString(this.getData(1,nIndex))+")";if(this.getData(7,nIndex)=="0")sUserIcon=("UserDisabled");else if(this.getData(8,nIndex)=="1")sUserIcon=("UserAutoDisabled");else if(this.getData(6,nIndex)=="0")sUserIcon=("UserWarn");else if(parseInt(this.getData(5,nIndex))>0)sUserIcon=("UserTemp");else sUserIcon=("User");g_asUserStatsInfo.push([FormatClientString(this.getData(0,nIndex))+sUserFullName,this.getData(0,nIndex),sUserIcon]);}g_asUserStatsInfo.sort(DomainSortAlpha);for(var i=0;i<g_asUserStatsInfo.length;i++){asUsers.push(g_asUserStatsInfo[i][0]);asUserIDs.push(g_asUserStatsInfo[i][1]);asUserIcon.push(g_asUserStatsInfo[i][2]);}UpdateStatsList(UserStatsCombo,asUsers,asUserIDs,asUserIcon,g_bGroupStats);LoadingDialog(false);}function OnLoadGroupStatList(sText){var asGroups=[];var asGroupIDs=[];var asGroupsIcon=[];if(g_bDomainActivity&&g_bSysAdmin&&g_bShowWindowsGroups){asGroups=["$WINDOWS_AUTH_GROUP_NAME$"];asGroupIDs=[g_nNTGroupID];asGroupsIcon=["Group"];}this.responseDef(sText);for(var nIndex=0;nIndex<this.getCount();nIndex++){asGroups.push(FormatClientString(this.getData(0,nIndex)));asGroupIDs.push(this.getData(1,nIndex));asGroupsIcon.push("Group");}if(g_nODBCGroupID)AddODBCGroups(GroupStatsCombo,asGroups,asGroupIDs,asGroupsIcon);else UpdateStatsList(GroupStatsCombo,asGroups,asGroupIDs,asGroupsIcon,true);}function AddODBCGroups(GroupStatsCombo,asGroups,asGroupIDs,asGroupsIcon){g_GroupStatsCombo=GroupStatsCombo;g_asODBCGroupsAdd=asGroups;g_asODBCGroupIDsAdd=asGroupIDs;g_asODBCGroupsIconAdd=asGroupsIcon;GetGroupStatsXML(true);}function OnLoadODBCGroupStatList(sText){this.responseDef(sText);for(var nIndex=0;nIndex<this.getCount();nIndex++){g_asODBCGroupsAdd.push(FormatClientString(this.getData(0,nIndex)));g_asODBCGroupIDsAdd.push(this.getData(1,nIndex));g_asODBCGroupsIconAdd.push("Group");}UpdateStatsList(g_GroupStatsCombo,g_asODBCGroupsAdd,g_asODBCGroupIDsAdd,g_asODBCGroupsIconAdd);LoadingDialog(false);}function UpdateStatsList(objCombo,asLabels,asValues,asIcons,bSkipSelect){objCombo.setItemText(asLabels);objCombo.setItemValue(asValues);objCombo.setItemImage(asIcons);objCombo.getPopupTemplate().setStyle("height",(asLabels.length<=10)?((20*asLabels.length)+((AW.ie)?3:0))+"px":"200px");if(g_bFireFox3Browser||g_bSafariBrowser){objCombo.getPopupTemplate().setStyle("margin-top","-7px");objCombo.getPopupTemplate().setStyle("background-color","#fff");}objCombo.setItemCount(asLabels.length);var nUserIndex=0;if(g_nCookieUserID!=""&&!g_bGroupStats){for(var nIndex=0;nIndex<objCombo.getItemCount();nIndex++){if(objCombo.getItemValue(nIndex)==g_nCookieUserID){nUserIndex=nIndex;break;}}}if(!bSkipSelect&&!g_bGroupStats){objCombo.setSelectedItems([nUserIndex]);objCombo.setControlText(objCombo.getItemText(nUserIndex));if(!AW.opera)objCombo.setControlImage(objCombo.getItemImage(nUserIndex));}var nGroupIndex=0;if(g_nCookieGroupID!=""&&g_bGroupStats){for(var nIndex=0;nIndex<objCombo.getItemCount();nIndex++){if(objCombo.getItemText(nIndex)==g_nCookieGroupID){nGroupIndex=nIndex;break;}}}if(!bSkipSelect&&g_bGroupStats){objCombo.setSelectedItems([nGroupIndex]);objCombo.setControlText(objCombo.getItemText(nGroupIndex));if(!AW.opera)objCombo.setControlImage(objCombo.getItemImage(nGroupIndex));}LoadingDialog(false);}function AddODBCOrganizations(asOrgs,asOrgIDs,sText,ObjTable){ObjTable.responseDef(sText);for(var nIndex=0;nIndex<ObjTable.getCount();nIndex++){asOrgs.push(FormatClientString(ObjTable.getData(0,nIndex)));asOrgIDs.push(ObjTable.getData(1,nIndex));}UpdateOrganizations(asOrgs,asOrgIDs);}function GetODBCOrganizationsXML(asOrgs,asOrgIDs){var g_OrgTable=new AW.XML.SUObjectTable("DomainODBCOrganizations.xml","%ID%",["@name","@ID"]);if(g_OrgTable){g_OrgTable.responseDef=g_OrgTable.response;g_OrgTable.response=function(sText){AddODBCOrganizations(asOrgs,asOrgIDs,sText,this);};g_OrgTable.request();g_tLoadODBCStatsTimer=setTimeout(function(){LoadingDialog(true);},2000);g_bOrgNotLoaded=false;}}function OnLoadOrganizations(sText){var asOrgs,sOrgIDs,bGetODBCColl=false;if("%CDomain.%ID%.ODBCAvailable%"!="1"){asOrgs=["$GENERAL_USERS_NAME$"];asOrgIDs=[g_nDefaultOrgID];}else{asOrgs=["$GENERAL_USERS_NAME$","$GENERAL_ODBC_USERS$"];asOrgIDs=[g_nDefaultOrgID,g_nODBCUserOrg];bGetODBCColl=true;}this.responseDef(sText);for(var nIndex=0;nIndex<this.getCount();nIndex++){asOrgs.push(FormatClientString(this.getData(0,nIndex)));asOrgIDs.push(this.getData(1,nIndex));}if(bGetODBCColl)GetODBCOrganizationsXML(asOrgs,asOrgIDs);else UpdateOrganizations(asOrgs,asOrgIDs);}function UpdateOrganizations(asLabels,asValues){CollectionCombo.setItemText(asLabels);CollectionCombo.setItemValue(asValues);CollectionCombo.setItemCount(asLabels.length);CollectionCombo.getPopupTemplate().setStyle("height",(asLabels.length<=10)?((18*asLabels.length)+((AW.ie)?3:0))+"px":"163px");if(g_bFireFox3Browser||g_bSafariBrowser){CollectionCombo.getPopupTemplate().setStyle("margin-top","-7px");CollectionCombo.getPopupTemplate().setStyle("background-color","#fff");}var bSelected=false;for(var nIndex=0;nIndex<CollectionCombo.getItemCount();nIndex++){if(g_bUseStatsCookie&&(g_nCookieOrgID!="")&&(parseInt(g_nCookieOrgID)!=g_nCurrentUserOrg))g_nCurrentUserOrg=parseInt(g_nCookieOrgID);if(CollectionCombo.getItemValue(nIndex)==g_nCurrentUserOrg){CollectionCombo.setSelectedItems([nIndex]);CollectionCombo.setControlText(CollectionCombo.getItemText(nIndex));bSelected=true;break;}}if(!bSelected)SelectOrganization(0,g_nDefaultOrgID);else GetUserStatsXML();}function SelectOrganization(nIndex,nID){CollectionCombo.setSelectedItems([nIndex]);CollectionCombo.setControlText(CollectionCombo.getItemText(nIndex));OnChangeCollection(nID);}function OnChangeCollection(sValue){var nNewID=parseInt(sValue);if(!g_bGroupStats)createCookie("%ID%StatsID",g_nCurrUserGroupID,100);if(nNewID!=g_nCurrentUserOrg){LoadingDialog(true);g_nCurrentUserOrg=nNewID;g_nActiveUserOrg=nNewID;GetUserStatsXML();}}function OnSaveStatsCSV(sFilePath){var SaveStatsObj=undefined;if(g_bDomain){if(g_bGroupStats){g_sStatsType="Domain";g_nActiveStatsID="%ID%";g_sActivStatsObj="CreateGroupsStatsFileCSV";}else{g_sStatsType="Organization";g_nActiveStatsID=g_nCurrentUserOrg;g_sActivStatsObj="CreateUsersStatsFileCSV";}}else{if(g_bGroupStats){g_sStatsType="Server";g_nActiveStatsID="%SERVER_ID%";g_sActivStatsObj="CreateGroupsStatsFileCSV";}else{g_sStatsType="Organization";g_nActiveStatsID=g_nCurrentUserOrg;g_sActivStatsObj="CreateUsersStatsFileCSV";}}var sStatsFilePath=sFilePath;if(Trim(sStatsFilePath)!=""){if(SaveStatsObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"SaveStatsInfo.xml%OBJECT_COMMAND_REF%C"+g_sStatsType+"."+g_nActiveStatsID+"."+g_sActivStatsObj),OnSaveStatsDone)){SaveStatsObj.setParameter("File",sStatsFilePath);SaveStatsObj.FileNamePath=sStatsFilePath;SavingDialog(true);SaveStatsObj.request();}}}function OnSaveStatsDone(){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();nLen=nCountFormatted.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));if(g_bGroupStats)sStatsSavingMsg="$SAVE_GROUP_STATS_MSG$";else sStatsSavingMsg="$SAVE_USER_STATS_MSG$";AlertDialog(nCountFormatted+" "+sStatsSavingMsg+"<br><br>"+this.FileNamePath);}else{AlertDialog(GetResultText(0,"",sResultText));}}
var SaveUserGroupsStatsButton=CreatePushButton("$SAVE_STATS_BUTTON$...","SaveUserGroupStats",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,false,"0","0",OnSaveStatsCSV]]);SaveUserGroupsStatsButton.setControlImage("ExportDB");var LogPathBrowse=CreatePushButton("","BrowseButtonLogPath",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[LogFilePathInput,false,"0","0"]]);LogPathBrowse.setControlImage("Browse");if(!g_bReadOnlyAccess){CreatePushButton("$RESET_BUTTON$","ResetUserGroupStats",OnConfirmResetUserGroupStats,undefined,undefined,undefined,"ResetIcon");CreatePushButton("$RESET_All_BUTTON$...","ResetAllStats",OnShowResetAllStats,undefined,undefined,undefined,"ResetAllIcon");}function OnConfirmResetUserGroupStats(){if(g_bGroupStats)sResetText="$CONFIRM_RESET_GROUP_STATS$";else sResetText="$CONFIRM_RESET_USER_STATS$";ConfirmDialog(sResetText,OnResetUserGroupStats,undefined,undefined);}function OnResetUserGroupStats(){if(g_bGroupStats)OnResetGroupStats();else OnResetUserStats();}function OnResetGroupStats(){var objResetCommand=CreatePostRequest("%ADMIN_FILE%XML/Result.xml?Command=ObjectCommand&Object=CGroup."+g_nCurrUserGroupID+".ResetStats");objResetCommand.response=function(){var xmlDoc=this.getResponseXML();var nResult=GetXMLValueInt(xmlDoc,"result");var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((nResult!=undefined)&&(nResult!=g_nSessionOkay)){if(nResult==g_nPermissionDenied)AlertDialog("$SESS_GROUP_NO_RESET_PERM$");else AlertDialog(GetResultText(0,"",sResultText));}};SavingDialog(true);objResetCommand.request(null);}function OnResetUserStats(){var sResetStatsXML="%ADMIN_FILE%XML/ResetUserStats.xml%OBJECT_COMMAND_REF%CDomainAttrs.%ID%.LoadUser";var sLoadID="LoginID";ResetUserStatsRequest=CreatePostRequest(sResetStatsXML);ResetUserStatsRequest.setParameter(sLoadID,g_nCurrUserGroupID);ResetUserStatsRequest.setAsync(true);ResetUserStatsRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if((nResult!=undefined)&&(nResult!=g_nSessionOkay)){if(nResult==g_nPermissionDenied)AlertDialog("$SESS_USER_NO_RESET_PERM$");else AlertDialog(GetResultText(0,"",sResultText));}};SavingDialog(true);ResetUserStatsRequest.request();}function OnShowSaveUserGroupStats(){if(g_bGroupStats)OnShowSaveStatsDialog("Domain","%ID%","CreateGroupsStatsFileCSV");else OnShowSaveStatsDialog("Organization",g_nCurrentUserOrg,"CreateUsersStatsFileCSV");}function OnDownloadLog(){nPos=g_sLogFile.lastIndexOf("\\");sDir="";if(nPos<0)nPos=g_sLogFile.lastIndexOf("%5C");if(nPos<0)nPos=g_sLogFile.lastIndexOf("/");if(nPos<0)nPos=g_sLogFile.lastIndexOf("%2F");if(nPos<0)sFile=g_sLogFile;else{if(nPos==0)sFile=g_sLogFile;else{sDir=g_sLogFile.substring(0,nPos);sFile=g_sLogFile.substring(nPos);}}var sFileCheckCmd="/?Command=List&Dir="+sDir+"&File="+sFile+'&CsrfToken='+g_sEncXsrfToken;var FileCheckTable=new AW.XML.Table;FileCheckTable.setURL(sFileCheckCmd);FileCheckTable.setRows("//file");FileCheckTable.setColumns(["FileName"]);FileCheckTable.response1=FileCheckTable.response;FileCheckTable.response=function(data){this.response1(data);sFileCheck=this.getData(0,0);if(sFileCheck!=undefined&&Trim(sFileCheck)!="")location.href="/?Command=Download&File="+g_sLogFile+'&CsrfToken='+"%ENC_CSRF_TOKEN%";else AlertDialog("$SESS_NO_FILES_FOUND_STR$");};if(sDir!="")FileCheckTable.request();else AlertDialog("$SESS_NO_FILES_FOUND_STR$");}function OnCheckBoxValueChanged(CheckBox){if(CheckBox.getControlValue()==false)CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.SessionAttrsLogging.%CDomain.%ID%.Logging.ID%");else OnSaveFileLogging(true,CheckBox);}function toggleWarn(isVisible){var lowPerformanceWarn=document.querySelector(".low-performance-warning");if(!lowPerformanceWarn)return;if(isVisible)lowPerformanceWarn.classList.remove("Hidden");else lowPerformanceWarn.classList.add("Hidden");}function updatePerformanceWarning(){var isCheckboxEnabled=false;for(var i=0;i<DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES.length;i++){var checkboxVal=DOMAIN_PERFORMANCE_AFFECTING_CHECKBOXES[i].getControlValue();if(checkboxVal){isCheckboxEnabled=checkboxVal;break;}}toggleWarn(isCheckboxEnabled);}function OnFileCheckBoxValueChanged(CheckBox){CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.FileLogging.ID%",updatePerformanceWarning);}function OnScreenCheckBoxValueChanged(CheckBox){CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.%CSessionAttrsLogging.%CDomain.%ID%.Logging.ID%.ScreenLogging.ID%",updatePerformanceWarning);}function OnSaveFileLogging(bEnableLogging,CheckBox){var SaveFileLogRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.SessionAttrsLogging.%CDomain.%ID%.Logging.ID%");SavingDialog(true);SaveFileLogRequest.setParameter("LogFilePath",document.LogSettings.LogFilePath.value);SaveFileLogRequest.setParameter("LogFileArchiveMode",document.LogSettings.LogFileArchiveMode.value);SaveFileLogRequest.setParameter("MaxLogFiles",MaxLogFilesInput.getControlText());SaveFileLogRequest.setParameter("MaxLogFilesBytes",parseInt(parseFloat(MaxLogFilesBytesInput.getControlText())*(1024*1024)));SaveFileLogRequest.setAsync(true);SaveFileLogRequest.response=function(obj,bLeaveSave){OnSaveComplete(obj,bLeaveSave);if(bEnableLogging)CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.SessionAttrsLogging.%CDomain.%ID%.Logging.ID%");};SaveFileLogRequest.request(null);return(false);}function OnLogIPAccess(){EnableDisableLogIPAccess();ShowDialog("LogIPAccessListDialog",undefined,EnableDisableLogIPAccess);}function OnChangeTab(nOldTab,nNewTab){switch(nOldTab){case(0):ActivityMonitorEnableDisable(false);break;case(1):if(g_bGroupAdmin){clearTimeout(g_tUserGroupStatsTimer);g_tUserGroupStatsTimer=undefined;g_UserStatsRequest=undefined;nStatsLoad=0;g_bReloadStats=true;}else StatsEnableDisable(false);break;case(2):clearTimeout(g_tUserGroupStatsTimer);g_tUserGroupStatsTimer=undefined;g_UserStatsRequest=undefined;nStatsLoad=0;g_bReloadStats=true;break;case(3):if(!FreezeBox.getControlValue())FreezeDomainAttrLog(true);g_bShowLogLegend=false;OnShowLegend();break;}switch(nNewTab){case(0):ActivityMonitorEnableDisable(true);g_ActiveRezizeGrid=ActiveSessions;g_nGridOffSet=525;ResizeGrids(true);break;case(1):if(g_bGroupAdmin){if(g_bGroupStats)nStatsLoad=1;if(g_bReloadStats)OnUserGroupStatsChange(nStatsLoad);else GetOrganizationsXML();g_bReloadStats=false;nNewTab=2;}else StatsEnableDisable(true);break;case(2):if(g_bGroupStats)nStatsLoad=1;if(g_bReloadStats)OnUserGroupStatsChange(nStatsLoad);else GetOrganizationsXML();g_bReloadStats=false;break;case(3):if(!FreezeBox.getControlValue())FreezeDomainAttrLog(false);g_ActiveRezizeGrid="logwindow";if(AW.ie)g_nGridOffSet=366;else g_nGridOffSet=373;ResizeGrids(true);break;}g_sHelpPage=aTabMainHelpPages[nNewTab];}function SetLogFileFocus(){LogFilePathInput.getContent("box/text").element().focus();}</script></div></div><div style='clear:both;'>&nbsp;</div></div></div><div class="footerDiv"><a href="%PRODUCT_HOME%" target="_blank" rel="noopener noreferrer">%PRODUCT%</a> <span id="SUVersionNumber">%VERSION%</span> &copy; 1995 - %COPYRIGHT_END_YEAR% <a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer">%COMPANY_NAME_FORMAL%</a>&nbsp;$ALL_RIGHTS_RESERVED$</div><ul id="UserOptList" style="display: none; width: auto;min-width: 100px;"><li id="UserOptList-password" style="display: none;"><a href="#" data-handler="javascript:ChangePasswordDialog();" >$CHANGE_PASSWORD_BUTTON$</a></li><li id="UserOptList-changeemail" style="display: none;"><a href="#" data-handler="javascript:OnShowChangeEmailDialog();" >$CHANGE_EMAIL_BUTTON$</a></li><li id="UserOptList-logout"><a href="#" data-handler="javascript:OnLogOut();">$LOGOUT$</a></li></ul><ul id="HelpOptList" class="menu-toggle" style="display: none; width: auto;min-width: 100px;"><li id="HelpOptList-whatsnew"><a href="#" data-handler="javascript:WhatsNewShow();" class="ActionOption" style="white-space:nowrap;"><span class="Action-ico"><img src="%COMMON_FILE%Images/FolderSize.png" class="SUWCActionico" alt="$WHATS_NEW$" border="0"/></span>$WHATS_NEW$</a></li></ul></div><div id="FooterDelayContent" style="display:none;"></div><ul id="AdhocNavBarJumpToMenu" style="display: none; width: auto;min-width: 160px;"><li id="MCNavOption"><a href="#AdhocHeadJumpto" id="MCNavOption-href" data-handler="javascript:OnJumpTo(0);">$MANAGEMENT_CONSOLE$</a></li><li id="WCNavOption"><a href="#AdhocHeadJumpto" id="WCNavOption-href" data-handler="javascript:OnJumpTo(1);">$BASIC_WEB_CLIENT$</a></li><li id="WCNewNavOption"><a href="#AdhocHeadJumpto" id="WCNewNavOption-href" data-handler="javascript:OnJumpTo(4);">$WEB_CLIENT_NEW$</a></li><li id="FSNewNavOption"><a href="#AdhocHeadJumpto" id="FSNewNavOption-href" data-handler="javascript:OnJumpTo(5);">$WEB_CLIENT_SHARE_NEW$</a></li><li id="FJNavOption"><a href="#AdhocHeadJumpto" id="FJNavOption-href" data-handler="javascript:OnJumpTo(2);">$FVJV$</a></li><li id="FSNavOption"><a href="#AdhocHeadJumpto" id="FSNavOption-href" data-handler="javascript:OnJumpTo(3);">$FILE_SHARING$</a></li></ul><script type="text/javascript">$(document).ready(function(){var g_bShowMC=(%IS_ADMIN%=="1")?true:false;var g_bShowWC=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bShowFVJV=(%ALLOW_FTP_VOYAGER_JV%=="1")?true:false;var g_bShowFileSharing=(%ALLOW_ADHOC_FILE_SHARING%=="1")?true:false;$("#ManConNavBarJumpToList").contextMenu({"menu":"AdhocNavBarJumpToMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#AdhocNavBarJumpToMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocNavBarJumpToMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});var nTotalHidden=0;if(!g_bShowMC||g_JumpToPage==0){$("#MCNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==1){$("#WCNavOption").hide();nTotalHidden+=1;}if(!g_bShowFVJV||g_JumpToPage==2){$("#FJNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==3){$("#FSNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==4){$("#WCNewNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==5){$("#FSNewNavOption").hide();nTotalHidden+=1;}if(nTotalHidden==6)$(".AdhocNavBarJumpTo").hide();else $(".AdhocNavBarJumpTo").show();});function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href="%FILE%ListDir.htm";break;case(2):location.href="%COMMON_FILE%FVJVLoggedIn.htm";break;case(3):location.href="%FILE%Share/Console.htm";break;case(4):location.href="/WebClientNew/Browser/~";break;case(5):location.href="/WebClientNew/Requested";break;}}</script><script type="text/javascript" language="javascript">var g_bFooterDelayLoaded=false;var g_bIsFileNameSelected=true;var g_bFooterIsWindowAuth=(%WINDOWS_AUTH_SUPPORT%==1);function IsFooterDelayLoaded(){return(g_bFooterDelayLoaded);}function OnFooterDelayLoaded(){g_bFooterDelayLoaded=true;}function OnLogOut(){g_bLinkRequested=true;clearSessionCookies('domainid');clearSessionCookies('domainodbc');location.href='%LOGOUT%';}function OnMoreWebClientInfo(){window.open("https://customerportal.solarwinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank","noopener");}function LaunchBasicWebClient(){if(g_bWebClientLicense){LoadingDialog(true);location.href="%FILE%ListDir.htm?Dir=%CURRENT_DIR%";}else ConfirmDialog(g_sWebClienLicenseInfo,OnMoreWebClientInfo);}function MainHelp(){LaunchHelp(g_sHelpPage,g_sHelpNode);}function OnShowChangeEmailDialog(){OnShowSetEmailDialog(g_sUserEmail);g_sUserEmail="";}if(%IS_LOCAL_ADMIN%){sLoggedInUser="($LOCAL_ADMIN$)";sLoggedInUserAlt="$LOCAL_ADMIN$";}else{sLoggedInUser=FormatClientString("%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)");sLoggedInUserAlt="%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)";}document.getElementById("CurrentlyLoggedIn").innerHTML=sLoggedInUser;setTimeout(function(){LoadDynamicContent("%ADMIN_FILE%Include/footerInclude.htm?ID=%ID%","FooterDelayContent",OnFooterDelayLoaded);});if(g_bOperaBrowser)document.body.onmousedown=function(){return false;};$(document).ready(function(){$('.menu-toggle').on('click',function(e){$('.menu-toggle').removeClass('active');$(this).addClass('active');});$(document).on('mouseup',function(e){var container=$(".menu-toggle");if(!container.is(e.target)&&container.has(e.target).length===0){$('.menu-toggle').removeClass('active');}});$("#UserOptBtn").contextMenu({"menu":"UserOptList","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#UserOptList").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#UserOptList").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});if(!(%IS_LOCAL_ADMIN%)){if(g_bAllowChangePassword)$("#UserOptList-password").show();if(g_bAllowChangeEmail)$("#UserOptList-changeemail").show();}});</script></body></html>