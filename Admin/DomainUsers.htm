%PRIV_GROUP_ADMIN%
<!--#include "Include\..\Strings\Strings.strings"-->
<!--#include "Include\..\..\Common\Strings\Strings.strings"-->
<!--#include "Include\..\..\Common\Strings\Result.strings"-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"/><script type="text/javascript" language="javascript">if(%IS_LOCAL_ADMIN%)sTitleText="$USERS$ ";else sTitleText="%PRODUCT% - $USERS$ ";document.write("<title>"+sTitleText+"</title>");</script>%PAGE_CHANGE%<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script type="text/javascript" language="javascript">var g_bSecurityAlertTriggered=%SECURITY_ALERT_TRIGGERED%;var g_bServerIdentityAlertTriggered=%SERVER_IDENTITY_ALERT_TRIGGERED%;var g_bIsWebClient=false;var g_nShowList;var g_bLinkRequested=false;var g_sFontOverride="$FONT_OVERRIDE$";var g_bTreeNavVisible=false;var bTreeLoaded=false;var NavigationTree;var g_nServerSection="";var g_sTreeURL;var g_nTreeHeight=350;var g_bTreeRoot=false;var tree=new Array();var g_aHistory=new Array();var g_aHistoryNames=new Array();var g_aHistoryIcon=new Array();var g_aHistoryActive=new Array();var g_HistoryPointer=0;var g_sLastIcon="";var g_bHistoryButtonUsed=false;var g_bIslocalAdminBrowser=false;var g_sCannotMoveFile="$DRAG_DROP_CANNOT_MOVE_FILE$";var g_sConfirmMoveFileFrom="$CONFIRM_MOVE_FILE_FROM$ ";var g_sTo=" $TO$ ";var g_bCaseSensitiveOS=(%CASE_SENSITIVE_OS%==1);var g_bIsiPad=false;var sUserAgentCheck=navigator.userAgent.toLowerCase();var g_bSupportsMSMQ=("%SUPPORTS_MSMQ%"!="0");var g_bMSMQLicense=("%CServer.%SERVER_ID%.MSMQLicense%"!="0");var g_bSupportWinEventLog=("%SUPPORTS_WINDOWS_EVENT_LOG%"!="0");var g_bIsDemo=(%IS_DEMO%==1);var g_bLoginUser=false;var g_nDaysRemaining=parseInt("%CServer.%SERVER_ID%.LicenseDaysRemaining%");var g_bLicenseIsTemp=(%CServer.%SERVER_ID%.LicenseIsTemp%==1);var g_bLicenseIsPastTrial=(%CServer.%SERVER_ID%.LicenseIsPastTrial%==1);var g_bIsModEvalExp=(%IS_MODIFIED_EVAL_EXP%==1);var g_sTrialExpiredTxt="$TRIAL_IS_EXPIRED$";var g_sTrialExpiresInTxt="$TRIAL_EXPIRES_IN$";var g_sTrialExpiresDaysTxt="$DAYS$";var g_sBuyNow="$BUY_NOW$";var g_bIsAdminAllowedToAddUsers=(parseInt("%IS_ADMIN_ALLOWED_TO_ADD_USERS%")!=0);var g_sDomainName="%CDomain.%ID%.DomainName%";var g_JumpToPage=0;if(%IS_LOCAL_ADMIN%){g_bIslocalAdminBrowser=true;}if(sUserAgentCheck.indexOf('ipad')!=-1)g_bIsiPad=true;var g_sEncXsrfToken="%ENC_CSRF_TOKEN%";</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BrowserCheckAW.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-ui.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-contextMenu.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mousewheel.min.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.mCustomScrollbar.min.js"></script><link type="text/css" href="%COMMON_FILE%Style/Fonts.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Dialog.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/Common.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/global.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery.mCustomScrollbar.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-ui.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-contextMenu.css" rel="stylesheet" /><link type="text/css" href="%ADMIN_FILE%Style/nav.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonHeader.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonUI.css" rel="stylesheet" /><script type="text/javascript" language="javascript">if(AW.ff3){AW.getLeft=function(element){return element.getBoundingClientRect().left-document.documentElement.getBoundingClientRect().left;};AW.getTop=function(element){return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(g_bSafariBrowser){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top-4;};}if(AW.chrome){AW.getTop=function(element){if(element.innerHTML.indexOf("aw-image-none")!=-1)return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top+4;else return element.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top;};}if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1){document.write('<style type="text/css">');document.write('body,table{');document.write(' font-size:11px;font-family: Helvetica Arial sans-serif;');document.write('}');document.write('</style>');}var g_sMenuDividers="--***--";var g_sImagePath="%COMMON_FILE%Images/";var g_sCommonPath="%COMMON_FILE%";var g_sFilePath="%ADMIN_FILE%";var g_sHelpPath="%HELP_BASE_URL%";var g_sConsoleInclude="0";var g_bDomainNav=true;var g_sAdminXMLPath="%ADMIN_FILE%XML/";var g_sUseInherited="$USE_INHERITED$";var g_bIE7=true;var g_bIEDomainCheck=true;var g_sLoading="$LOADING_DIALOG_TITLE$";var g_sSelectDomainMsg='$SELECT_DOMAIN_MSG$';var g_nDomainID;var g_sHelpPage="Help-Overview.htm";var g_sHelpNode="none";var g_sCurrentURLFileName="%INTERNAL_FILE%";var g_nSessionOkay=0;var g_nPermissionDenied=3;var g_nULLMax=18446744073709551615;var g_sGB="$FS_ABBREV_GIGABYTE$";var g_sMB="$FS_ABBREV_MEGABYTE$";var g_sKB="$FS_ABBREV_KILOBYTE$";var g_sBytes="$FS_BYTES$";var g_bFVJVLaunchPage=false;var g_sUnknownError="$UNKNOWN_ERROR$";var g_sHomeStr="$HOME$";var g_ActiveTab;var g_ActivePage;var g_bODBC64BitWarn=(%CServer.%SERVER_ID%.WarnODBC64BitUpgrade%==1);var g_bAllowChangePassword=%CAN_CHANGE_PASSWORD%;var g_bAllowChangeEmail=%USER_CAN_SET_EMAIL_ADDRESS%;var g_sUserEmail=HTMLDecode("%USER_EMAIL_ADDRESS%");var g_bSysAdmin=(%CUser.%USER_ID%.AdminType%==2||%CUser.%USER_ID%.AdminType%==4);var g_bGroupAdmin=(%CUser.%USER_ID%.AdminType%==5||%CUser.%USER_ID%.AdminType%==6);var g_bDomainAdmin=((%CUser.%USER_ID%.AdminType%==1)||(%CUser.%USER_ID%.AdminType%==3));var g_bReadOnlyAccess=(%CUser.%USER_ID%.AdminType%==3||%CUser.%USER_ID%.AdminType%==4||%CUser.%USER_ID%.AdminType%==6);var g_bAllowWebClient=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bFVJVLicense=(%CServer.%SERVER_ID%.AllowFVJV%==1);var g_bAllowFVJV=(%ALLOW_FTP_VOYAGER_JV%==1);var g_bWebClientLicense=(%CServer.%SERVER_ID%.WebClientLicense%==1);var g_sFVJVLicenseInfo="$FVJV_LICENSE_INFO$";var g_sWebClienLicenseInfo="$WEB_CLIENT_LICENSE_INFO$";var g_sLicenseEmail="%CServer.%SERVER_ID%.LicenseEMail%";var g_bUsingFIPS=(%CServer.%SERVER_ID%.UsingFIPS%==1);var g_sWebFilePath=%FILE%;var g_bAllowAdhocFileSharing=(%ALLOW_ADHOC_FILE_SHARING%==1);var g_bFileSharingLicense=(%CServer.%SERVER_ID%.FileSharingLicense%==1);var g_sAdhocFileShareLicenseInfo="$ADHOC_LICENSE_INFO$";if(!g_bSysAdmin)g_nDomainID=%DOMAIN_ID%;setTimeout("OnSendNOOP()",55000);</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Menus.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/InitialScript.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/utility.js"></script><script type="text/javascript" language="javascript">function RecommendAdminIEUpgrade(){if(g_bIslocalAdminBrowser){var bRecommendIEUpgrade=false;var nVersion=0;if(navigator.appVersion.indexOf("MSIE")!=-1){aTemp=navigator.appVersion.split("MSIE");nVersion=parseFloat(aTemp[1]);}if(nVersion>5.5&&nVersion<8)bRecommendIEUpgrade=(%WARN_OLD_BROWSER%!=0);if(navigator.userAgent.indexOf("MSIE")!=-1){var nVersionIndex=(navigator.userAgent.indexOf("MSIE")+5);var nVersionIE=parseInt(navigator.userAgent.charAt(nVersionIndex));if(nVersionIE>=8)bRecommendIEUpgrade=false;else if((navigator.userAgent.indexOf("compatible")!=-1)&&(nVersionIE>=8))bRecommendIEUpgrade=false;}if(bRecommendIEUpgrade)window.location.href="%FILE%AdminIEWarning.htm";}}</script><div id="ChangePasswordDialoginner" style="display:none;"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;"><div>$OLD_PASSWORD$:<div style="overflow:auto"><span id="OldPasswordChange"></span></div></div><div>$NEW_PASSWORD$:<br /><div style="overflow:auto"><span id="NewPasswordChange"></span></div></div><div>$VERIFY_PASSWORD$:<div style="overflow:auto"><span id="VerifyNewPasswordChange"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"></span><br /><span id="CancelChangePasswordButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var sWebClientChangePWord=undefined;var sChangePWordImg=undefined;try{if(g_bIsWebClient){sWebClientChangePWord="WC-Icon-ChangePassword";}else{sChangePWordImg="Change_Password16.png";}}catch(e){sChangePWordImg="Change_Password16.png";}BuildDialog("$CHANGE_PASSWORD_TITLE$","ChangePasswordDialog","300","155","","$CLOSE_CANCEL$",sChangePWordImg,undefined,sWebClientChangePWord);function OnChangePasswordSubmit(){var sChangePasswordCmd="%FILE%Login.xml?Command=LoginChangePassword";var ChangePasswordRequest=CreatePostRequest(sChangePasswordCmd);var sOldPassWord,sNewPassWord,sVerifyPassWord;sOldPassWord=OldPasswordInput.getControlText();sNewPassWord=NewPasswordInput.getControlText();sVerifyPassWord=VerifyNewPasswordInput.getControlText();if(sNewPassWord==sVerifyPassWord){ChangePasswordRequest.setParameter("old_password",sOldPassWord);ChangePasswordRequest.setParameter("new_password",sNewPassWord);ChangePasswordRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);ChangePasswordRequest.setAsync(true);ChangePasswordRequest.request();ChangePasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sWelcomeMsg=GetXMLValue(XMLDoc,"welcomemsg");if(nResult!=0){if(nResult==1)sResultText="$ERROR_PASSWORD_CHANGE_FAIL$";AlertDialog(GetResultText(0,"",sResultText));}else if(g_bLoginUser){ReplaceDialog("ChangePasswordDialog","LoggingInDialog");OnLoginOK(false,nResult,XMLDoc);}else{HideDialog('ChangePasswordDialog');AlertDialog("$PASSWORD_CHANGED$");}};}else{AlertDialog("$PASSWORDS_DONT_MATCH$",true);}}function OnCancelChangePassword(){HideDialog('ChangePasswordDialog');location.href="%LOGOUT%";}function ClearPasswordDialog(){OldPasswordInput.setControlText("");NewPasswordInput.setControlText("");VerifyNewPasswordInput.setControlText("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");OldPasswordInput.getContent("box/text").element().focus();if(bLogin){CancelPasswordButton.setControlText("$LOGOUT$");document.getElementById("ChangePasswordDialogCloseIcon").onmousedown=OnCancelChangePassword;}}CreateDialogPushButton("$OK_BUTTON$","ChangePasswordButton",OnChangePasswordSubmit);var CancelPasswordButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelChangePasswordButton",OnCancelChangePassword);var OldPasswordInput=CreatePasswordField("","OldPasswordChange","OldPasswordChange",undefined,200);var NewPasswordInput=CreatePasswordField("","NewPasswordChange","NewPasswordChange",undefined,200);var VerifyNewPasswordInput=CreatePasswordField("","VerifyNewPasswordChange","VerifyNewPasswordChange",undefined,200);</script><div id="UserEmailDialoginner" style="display:none;"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;">$EMAIL_DESCR$ <br /><div style="margin-top:5px;">$EMAIL$:<br /><div style="overflow:auto"><span id="CurrentUserEmail"></span></div></div><div>$VERIFY_EMAIL$:<br /><div style="overflow:auto"><span id="UserEmail"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"></span><br /><span id="LogoutUserEmailButton"></span><span id="CancelUserEmailButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sWebClientChangeEmail=undefined;var sChangeEmailImg=undefined;try{if(g_bIsWebClient){sWebClientChangeEmail="WC-Icon-ChangeEmail";}else{sChangeEmailImg="ChangeEmail.png";}}catch(e){sChangeEmailImg="ChangeEmail.png";}BuildDialog("$USER_EMAIL_TITLE$","UserEmailDialog","300","160","","$CLOSE_CANCEL$",sChangeEmailImg,undefined,sWebClientChangeEmail);function OnSetEmailAddressSubmit(){var sSetEmailCmd="%FILE%Result.xml?Command=SetEmailAddress";var SetEmailRequest=CreatePostRequest(sSetEmailCmd);var sEmailAddrs,CurrentEmailAddr;sEmailAddr=UserEmailInput.getControlText();sCurrentEmailAddr=CurrentUserEmail.getControlText();SetEmailRequest.setParameter("emailaddress",sEmailAddr);SetEmailRequest.setAsync(true);if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.request();else AlertDialog("$EMAIL_VALS_NO_MATCH$");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{HideDialog('UserEmailDialog');if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnCancelSetEmail(){HideDialog('UserEmailDialog');}function ClearSetEmailDialog(){UserEmailInput.setControlText("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(bNoCloseButton){var DialogCloseContainer=document.getElementById("UserEmailDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("UserEmailDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";CancelEmailButton.setStyle("display","none");LogoutUserEmailButton.setStyle("display","");}else{LogoutUserEmailButton.setStyle("display","none");}if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)CurrentUserEmail.setControlText(sEmail);else ClearSetEmailDialog();ShowDialog("UserEmailDialog");CurrentUserEmail.getContent("box/text").element().focus();}function OnLogoutEmailSet(){location.href="%LOGOUT%";}CreateDialogPushButton("$OK_BUTTON$","SaveUserEmailButton",OnSetEmailAddressSubmit);var CancelEmailButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelUserEmailButton",OnCancelSetEmail);var LogoutUserEmailButton=CreateDialogPushButton("$LOGOUT$","LogoutUserEmailButton",OnLogoutEmailSet);var UserEmailInput=CreateInputField("","UserEmail","UserEmail",undefined,200,undefined,undefined,OnSetEmailAddressSubmit);var CurrentUserEmail=CreateInputField("","CurrentUserEmail","CurrentUserEmail",undefined,200,undefined,undefined);</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_sBusyDialog="BusyDialog";function BusyDialog(bShow,sTitle,bWebClientIcon,bFromApplet){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top!="-5000px")bSkip=true;if(!bSkip){if(bShow)ShowDialog(g_sBusyDialog,undefined,undefined,bFromApplet);else{HideDialog(g_sBusyDialog,undefined,bFromApplet);sTitle="$BUSY_DIALOG_TITLE$";}SetupBusyDialog(sTitle,bWebClientIcon);}}function SetupBusyDialog(sTitle,bWebClientIcon){var TitleText=document.getElementById("BusyDialogTitleText");var sBusyDialogImage="su16x16.png";MCBusyDialogImage=new Image();MCBusyDialogImage.src="%COMMON_FILE%Images/su16x16.png";WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bWebClientIcon)document.getElementById("BusyDialogTitleIcon").src=WCBusyDialogImage.src;else document.getElementById("BusyDialogTitleIcon").src=MCBusyDialogImage.src;if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML="<strong>"+sTitle+"</strong>";var DialogCloseContainer=document.getElementById("BusyDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("BusyDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";}function SavingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$SAVING_DIALOG_TITLE$",bWebClientIcon);}function LoadingDialog(bShow,bWebClientIcon){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top=="-5000px")bSkip=true;if(!bSkip)BusyDialog(bShow,"$LOADING_DIALOG_TITLE$",bWebClientIcon);}function DeletingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$DELETING_DIALOG_TITLE$",bWebClientIcon);}</script><div id="BusyDialoginner" style="display:none;text-align:center;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" style="margin:0px auto 0px auto;"></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("$BUSY_DIALOG_TITLE$","BusyDialog","200","50","text-align:center","$CLOSE_CANCEL$");</script><div id="AlertDialoginner" style="display:none;"><table border="0"><tr><td style="vertical-align:top;"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px"></td><td style="text-align:left; padding-right: 10px"><span id="AlertDialogText" style="word-break: break-word; -ms-word-break: break-word; display: inline-block"></span><div id="AlertNoShowContainer" style="display:none;padding-top:10px;"><span id="AlertNoShowDialogCheckBox"></span></div></td></tr></table><div style="width:100%;text-align:center;"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></div><!--tr><td colspan="2" style="text-align:center"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></td></tr></table--></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var ExtraButton,g_bAlertNoShow,g_sAlertNoShowCookie;InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";BuildDialog("%PRODUCT%","AlertDialog","250","115","text-align:center","$CLOSE_CANCEL$");function AlertDialog(sText,bWarn,fn_OKCallback,bWebClientIcon,sExtraButtonText,fn_ExtraCallback,nWidth,nHeight,bAlertNoShow,sAlertNoShowCookie){WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";g_bAlertNoShow=false;g_sAlertNoShowCookie="";document.getElementById("AlertNoShowContainer").style.display="none";if(bWebClientIcon){document.getElementById("AlertDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("AlertDialogTitleIcon").height="16";document.getElementById("AlertDialogTitleIcon").width="16";}if((sExtraButtonText!=undefined)&&(fn_ExtraCallback!=undefined)){ExtraButton=CreatePushButton(sExtraButtonText,"ExtraButton",function(){HideDialog("AlertDialog");fn_ExtraCallback();});document.getElementById("ExtraButton").style.display="";}else{document.getElementById("ExtraButton").style.display="none";ExtraButton=undefined;fn_ExtraCallback=undefined;}if(nWidth!=undefined){document.getElementById("AlertDialog").style.width=nWidth+"px";}else document.getElementById("AlertDialog").style.width="250px";if(bAlertNoShow&&sAlertNoShowCookie!=undefined){g_bAlertNoShow=true;g_sAlertNoShowCookie=sAlertNoShowCookie;document.getElementById("AlertNoShowContainer").style.display="block";}g_fnAlertOKCallback=fn_OKCallback;if(document.getElementById("AlertImage")!=undefined){if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;document.getElementById("AlertImage").src=sImage;}if((document.getElementById("AlertDialogText")!=undefined)&&(sText!=undefined))document.getElementById("AlertDialogText").innerHTML=sText;ShowDialog("AlertDialog");OKAlertButton.focus();}function WarnDialog(sText,bWebClientIcon){AlertDialog(sText,true,undefined,bWebClientIcon);}function OnAlertDialogOkay(){HideDialog("AlertDialog");if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();document.getElementById("AlertImage").src=BlankImg.src;g_fnAlertOKCallback=undefined;if(g_bAlertNoShow){if(AlertNoShowCheckBox.getControlValue())createCookie(g_sAlertNoShowCookie,"1",60);}}var OKAlertButton=CreatePushButton("$OK_BUTTON$","AlertDialogOkButton",OnAlertDialogOkay);var AlertNoShowCheckBox=CreateCheckBox("$DONT_SHOW_AGAIN$","AlertNoShowDialogCheckBox","AlertNoShowCheckBox");</script><div id="ToolTipDialog" style="width:220px;height:180px;" class="DialogLayer"><table id="ToolTipDialogTitleBar" class="ToolTipDialogTitle" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCorner"><img src="%COMMON_FILE%Images/tooltip-left-top.png" width="27" height="23" border="0"></td><td class="ToolTipHeadContainer"><div id="ToolTipDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:5px;"><span id="ToolTipDialogTitleText" style="font-weight:bold;">&nbsp;</span></div></td><td class="ToolTipRightCorner"><a id="ToolTipClose" href="javascript:HideDialog('ToolTipDialog', true);"><img src="%COMMON_FILE%Images/tooltip-right-top.png" width="27" height="23" alt="$CLOSE_CANCEL$" border="0" onmouseover="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top-over.png'" onmouseout="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top.png'"></a></td></tr></table><div id="ToolTipDialogBody" style="width:2px;" class="ToolTipDialogBody"><div style="padding:0 5px 0 5px;"><span id="ToolTipDialogText"></span></div></div><table class="ToolTipFooter" id="ToolTipFooter" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCornerBottom">&nbsp;</td><td class="ToolTipPointerTop"><div class="BottomPointerOpening">&nbsp;</div></td><td class="ToolTipFooterFill">&nbsp;</td><td class="ToolTipRightCornerBottom">&nbsp;</td></tr></table><div style="text-align:left; vertical-align:top;" class="ToolTipPointerCell"></div></div><script type="text/javascript" language="JavaScript">var g_fnToolTipCallback=undefined;BubbleLoadingImg1=new Image();BubbleLoadingImg1.src="%COMMON_FILE%Images/tooltip-left-top.png";BubbleLoadingImg2=new Image();BubbleLoadingImg2.src="%COMMON_FILE%Images/tooltip-right-top.png";BubbleLoadingImg3=new Image();BubbleLoadingImg3.src="%COMMON_FILE%Images/tooltip-right-top-over.png";BubbleLoadingImg4=new Image();BubbleLoadingImg4.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";BubbleLoadingImg5=new Image();BubbleLoadingImg5.src="%COMMON_FILE%Images/Tooltip-fill.png";function ToolTipDialog(sTitle,sText,fn_CloseCallback,ToolTipPosObj,nWidth,nHeight,sCheckboxFunc,sResetId,xPointOffSet,yPointOffSet){if(sResetId!=undefined){var DialogIdReset=document.getElementById("ToolTipDialog");DialogIdReset.setAttribute('id',sResetId);}if(fn_CloseCallback!=undefined)g_fnToolTipCallback=fn_CloseCallback;if((document.getElementById("ToolTipDialogText")!=undefined)&&(sText!=undefined))document.getElementById("ToolTipDialogText").innerHTML=sText;if((document.getElementById("ToolTipDialogTitleText")!=undefined)&&(sTitle!=undefined))document.getElementById("ToolTipDialogTitleText").innerHTML=sTitle;if(nWidth!=undefined)document.getElementById("ToolTipDialogTitleContainer").style.width=(nWidth-60).toString()+"px";var sHideDialogFunction=String("HideDialog(");var sCheckBoxId="ToolTipDialog";if(sResetId!=""){document.getElementById("ToolTipClose").setAttribute("href","javascript:"+sHideDialogFunction+"\""+sResetId+"\", true);");sCheckBoxId=sResetId;}if(sCheckboxFunc!=undefined){document.getElementById("ToolTipDialogText").innerHTML+="<div style='padding-top:5px;'><input type='checkbox' value='noshow' onclick='"+sCheckboxFunc+sHideDialogFunction+"\""+sCheckBoxId+"\", true);'/> $DONT_SHOW_AGAIN$</div>";}ShowToolTipDialog("ToolTipDialog",false,g_fnToolTipCallback,ToolTipPosObj,nWidth,nHeight,undefined,undefined,undefined,sResetId,xPointOffSet,yPointOffSet);var nWidthAdjust;nWidthAdjust=parseInt(document.getElementById("ToolTipDialogBody").style.width);if(bIsOpera)document.getElementById("ToolTipDialogBody").style.width=(nWidthAdjust).toString()+"px";nWidthAdjust=(nWidthAdjust+2);document.getElementById("ToolTipDialogTitleBar").style.width=nWidthAdjust.toString()+"px";document.getElementById("ToolTipFooter").style.width=nWidthAdjust.toString()+"px";}</script><div id="ConfirmDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"><table border="0" id="ConfirmDialogtable"><tr><td><img src="%COMMON_FILE%Images/QuestionMark.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div id="ConfirmDialogText" style="width:200px;overflow-y:visible;overflow-x:auto;text-align:left;padding-left:2px;"></div></td></tr><tr><td colspan="2" style="text-align:center" id="ConfirmDialogbuttons"><span id="ConfirmDialogYesButton"></span><span id="ConfirmDialogNoButton"></span></td></tr></table></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("%PRODUCT%","ConfirmDialog","250","115","text-align:center","$CLOSE_CANCEL$");var g_sDeletingDialogTitle="$DELETING_DIALOG_TITLE$";var g_sConfirmDialog="ConfirmDialog";var g_fnYes=undefined,g_fnNo=undefined;var g_YesNoData=undefined;var g_bNoCloseDialog=false;var DEFAULT_CONFIRM_DIALOG_SIZE={WIDTH:"250px",HEIGHT:"115px"};function ConfirmDialog(sText,fnYes,fnNo,YesNoData,nWidth,nHeight,bDelete,bWebClientIcon,bNoCloseDialog,fnClose){var confirmDialog=document.getElementById("ConfirmDialog");var confirmDialogText=document.getElementById("ConfirmDialogText");var confirmDialogIcon=document.getElementById("ConfirmDialogTitleIcon");var dialogSize=getDialogSize(nWidth,nHeight);g_fnYes=g_fnNo=undefined;WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bNoCloseDialog)g_bNoCloseDialog=true;else g_bNoCloseDialog=false;if(bWebClientIcon){confirmDialogIcon.src=WCBusyDialogImage.src;confirmDialogIcon.height="16";confirmDialogIcon.width="16";}if((confirmDialogText!=undefined)&&(sText!=undefined)){confirmDialogText.innerHTML=sText;}g_fnYes=fnYes;g_fnNo=fnNo;g_YesNoData=YesNoData;confirmDialog.style.width=dialogSize.width;confirmDialogText.style.width=(parseInt(dialogSize.width)-50)+"px";document.getElementById("ConfirmDialogBody").style.overflow="hidden";document.getElementById("ConfirmDialogBody").style.textOverflow="ellipsis";ShowDialog("ConfirmDialog",undefined,fnClose);if(bDelete)ConfirmDialogNoButton.focus();else ConfirmDialogYesButton.focus();}function getDialogSize(customWidth,customHeight){var dialogWidth=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;var dialogHeight=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;if(!!customWidth){dialogWidth=isWithUnits(customWidth)?customWidth:customWidth+"px";}if(!!customHeight){dialogHeight=isWithUnits(customHeight)?customHeight:customHeight+"px";}return{width:dialogWidth,height:dialogHeight};}function isWithUnits(size){return size.toString().match(/px|%|vh|vw|em|rem/);}function CloseConfirmDialog(){HideDialog("ConfirmDialog");}function OnConfirmDialogYes(){if(g_fnYes!=undefined){setTimeout(function(){g_fnYes(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}if(!g_bNoCloseDialog)CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined){setTimeout(function(){g_fnNo(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}CloseConfirmDialog();}var ConfirmDialogYesButton=CreatePushButton("$YES_BUTTON$","ConfirmDialogYesButton",OnConfirmDialogYes);ConfirmDialogYesButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogYesButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogNoButton.focus();}});var ConfirmDialogNoButton=CreatePushButton("$NO_BUTTON$","ConfirmDialogNoButton",OnConfirmDialogNo);ConfirmDialogNoButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogNoButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogYesButton.focus();}});</script><div id="TopPntToolTipDialog" style="width:220px;height:180px;" class="DialogLayer"><table id="TopPntToolTipDialogTitleBar" class="ToolTipDialogTitle" cellpadding="0" cellspacing="0"><tr><td colspan="3" class="TopPointer">&nbsp;</td></tr><tr><td class="ToolTipLeftCorner"><img src="%COMMON_FILE%Images/tooltip-left-top.png" width="27" height="23" border="0"></td><td class="TopPntToolTipHeadContainer"><div id="TopPntToolTipDialogTitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-left:5px;"><span id="TopPntToolTipDialogTitleText" style="font-weight:bold;">&nbsp;</span></div></td><td class="ToolTipRightCorner"><a href="javascript:HideDialog('TopPntToolTipDialog', true);"><img src="%COMMON_FILE%Images/tooltip-right-top.png" width="27" height="23" alt="$CLOSE_CANCEL$" border="0" onmouseover="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top-over.png'" onmouseout="javascript:this.src='%COMMON_FILE%Images/tooltip-right-top.png'"></a></td></tr></table><div id="TopPntToolTipDialogBody" style="width:2px;" class="ToolTipDialogBody"><div style="padding:0 5px 0 5px;"><span id="TopPntToolTipDialogText"></span></div></div><table class="ToolTipFooter" cellpadding="0" cellspacing="0"><tr><td class="ToolTipLeftCornerBottom">&nbsp;</td><td class="ToolTipFooterFill">&nbsp;</td><td class="ToolTipRightCornerBottom">&nbsp;</td></tr></table></div>
<script type="text/javascript" language="JavaScript">var g_fnToolTipCallback=undefined;TPBubbleLoadingImg1=new Image();TPBubbleLoadingImg1.src="%COMMON_FILE%Images/tooltip-left-top.png";TPBubbleLoadingImg2=new Image();TPBubbleLoadingImg2.src="%COMMON_FILE%Images/tooltip-right-top.png";TPBubbleLoadingImg3=new Image();TPBubbleLoadingImg3.src="%COMMON_FILE%Images/tooltip-right-top-over.png";TPBubbleLoadingImg4=new Image();TPBubbleLoadingImg4.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";TPBubbleLoadingImg5=new Image();TPBubbleLoadingImg5.src="%COMMON_FILE%Images/Tooltip-fill.png";function TopToolTipDialog(sTitle,sText,fn_CloseCallback,ToolTipPosObj,nWidth,nHeight,sCheckboxFunc,sResetId,xPointOffSet,yPointOffSet){if(fn_CloseCallback!=undefined)g_fnToolTipCallback=fn_CloseCallback;if((document.getElementById("TopPntToolTipDialogText")!=undefined)&&(sText!=undefined))document.getElementById("TopPntToolTipDialogText").innerHTML=sText;if((document.getElementById("TopPntToolTipDialogTitleText")!=undefined)&&(sTitle!=undefined))document.getElementById("TopPntToolTipDialogTitleText").innerHTML=sTitle;if(sCheckboxFunc!=undefined){sHideDialogFunction=String("HideDialog(");document.getElementById("TopPntToolTipDialogText").innerHTML+="<div style='padding-top:5px;'><input type='checkbox' value='noshow' onclick='"+sCheckboxFunc+sHideDialogFunction+"\"TopPntToolTipDialog\", true);'/> $DONT_SHOW_AGAIN$</div>";}ShowToolTipDialog('TopPntToolTipDialog',false,g_fnToolTipCallback,ToolTipPosObj,nWidth,nHeight,true,50,30,sResetId,xPointOffSet,yPointOffSet);var nWidthAdjust;nWidthAdjust=parseInt(document.getElementById("TopPntToolTipDialogBody").style.width);if(bIsOpera)document.getElementById("TopPntToolTipDialogBody").style.width=(nWidthAdjust).toString()+"px";}</script>
<script type="text/vbScript" language="vbscript">
<!--
Function VBDateFormat(sDateSeconds,nTimeZoneOffset)
sDate=DateAdd("s", sDateSeconds, "1/1/1970 00:00:00 AM")
sDate=DateAdd("n", -nTimeZoneOffset, sDate)
VBDateFormat = FormatDateTime(sDate,0)
End Function
-->
</script>
<style type="text/css">@import url(%ADMIN_FILE%Include/Calendar/calendar-system.css);</style><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Calendar/calendar.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Calendar/lang/calendar-en.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Calendar/calendar-setup.js"></script><script type="text/javascript" language="javascript">var g_sUserNameLoginIdColumn="$USER_NAME_LOGIN_ID_COLUMN$";var g_sFullNameColumn="$FULL_NAME_COLUMN$";var g_sDescriptionColumn="$DESCRIPTION$";var g_sLastLoginColumn="$LAST_LOGIN_TIME$";var g_sHomeDirColumn="$HOMEDIR$";var g_sExpireLabelDisable="$WILL_DISABLE_ON$";var g_sExpireLabelDelete="$WILL_DELETE_ON$";var g_sExpireLabelExpired="$EXPIRED$";var g_sMinPassLen="%CDomain.%ID%.MinPasswordLen%";var g_nDomainHelpType=0;var g_sPageType="users";var g_sUnlimited="$EDITION_UNLIMITED$";var g_MaxUserLicense="%CServer.%SERVER_ID%.MaxUsersLicense%";var g_bIsODBC=false;g_nServerSection="$SERVER_SECTION$";g_sHelpPage="Help-About-User-Accts.htm";g_sHelpNode="Item2_2";g_ActivePage=2;var g_nDefaultOrgID=%CDomain.%ID%.GeneralUsers.ID%;var g_nDefaultODBCOrgID=%CDomain.%ID%.ODBCUsers.ID%;var g_nCurrentUserOrg=g_nDefaultOrgID;var g_nODBCUserOrg=parseInt("%CDomain.%ID%.ODBCUsers.ID%");var g_nCurrentODBCUserOrg=g_nDefaultODBCOrgID;var g_nActiveUserOrg=0;var g_nActiveODBCUserOrg=0;var g_bODBCCurrentOrg=false;var g_ActiveUserGrid=undefined;var g_ActiveRezizeGrid;var g_nGridOffSet=465;var g_sOrganizationType="";var g_bShowLimitsContextMenu=false;var g_bShowWindowsAuth=("Domain"!="Server")&&(%WINDOWS_AUTH_SUPPORT%==1);var g_sPageObjectID="%ID%";var g_bPasswordRecoveryLicense=(parseInt("%CServer.%SERVER_ID%.PasswordRecoveryLicense%")?true:false);var g_sFormType="User";var g_bFileSharingOn=(parseInt("%CDomain.%ID%.AllowAdHocFileSharing%")?true:false);var aGridCtrls=new Array();var aSecondaryGridCtrls=new Array();var awActiveGrid=undefined;var awSecondaryActiveGrid=undefined;var g_EditObjectID=-1;var g_bDisablePasswordGenerators=("%CUser.%USER_ID%.DisablePasswordGenerators%"=="1")?true:false;</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/ObjectTable.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BasicGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/AdminGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Dialog.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/UserList.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/NaturalSort.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/FileList.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/IPAccess.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/DirAccess.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/Events.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/XMLHTTPRequest.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/commonlogscripts.js"></script><script type="text/javascript" language="JavaScript" src="%ADMIN_FILE%Include/Scripts/DomainAttrLogScripts.js"></script><div id="GroupEmailDialogs" style="display:none;"></div><div id="UserSubDialogs" style="display:none;"></div><div id="BrowseDialogDiv" style="display:none;"></div><div id="NewSSHKeyPairDialogDiv" style="display:none;"></div><div id="FilterDialogDiv" style="display:none;"></div><script type="text/javascript" language="javascript">g_nCurrentUserWizardPage=1;g_nTotalUserWizardPages=4;</script><div id="UserWizardDialoginner" style="display:none;"><form name="User-Wizard" onsubmit="return (false);"><div class="wiz-bg"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$USER_WIZARD$" src="%ADMIN_FILE%Images/UserWizard32.png" width="32" height="32" /></td><td style="vertical-align:top;">$USER_WIZARD_INFO$</td></tr></table></div><hr style="height:1px;margin:5px;" /><table border="0" class="DialogTable"><tr><td style="vertical-align:top;height:165px;padding-left:5px;"><div id="UserWizardDialog-1" style="display:block;">$USER_NAME_WIZARD_DESCR$ <br /><br />$USERNAME$:<div style="overflow:auto"><span id="LoginIDWizard"></span></div><div id="FullNamelDiv">$FULLNAME$:<br /><span id="FullNameWizard"></span><span id="FullNameWizardOpt">($OPTIONAL$)</span></div><div id="UserEmailDiv" >$EMAIL$:<br /><span id="EmailAddressWizard"></span><span id="EmailAddressWizardOpt">($OPTIONAL$)</span></div></div><div id="UserWizardDialog-2" style="display:none;">$USER_PASSWORD_WIZARD_DESCR$ <br /><br />$PASSWORD$:<div style="overflow:auto"><span id="PasswordWizard"></span></div><span id="RequirePasswordChange-Wizard"></span></div><div id="UserWizardDialog-3" style="display:none;"><div>$USER_HOME_DIR_WIZARD_DESCR$ <br /><br />$HOMEDIR$:<div style="overflow:auto"><span id="HomeDirWizard"></span><span id="BrowseButtonUserInfo-Wizard"></span></div></div><div><span id="LockInHomeDir-Wizard"></span></div></div><div id="UserWizardDialog-4" style="display:none;">$USER_ACCESS_RIGHTS_WIZARD_DESCR$ <br /><br />$ACCESS_RIGHTS$:<br /><span id="DirAccessType_Wizard"></span></div></td></tr><tr><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="BackUserWizardButton"></span>&nbsp;&nbsp;<span id="NextUserWizardButton"></span>&nbsp;&nbsp;&nbsp;<span id="CancelUserWizardButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">var HomeDirWizardInput;var UserInfoWizardBrowse;var LockInHomeDirCheck;BuildDialog("$USER_WIZARD$ - $STEP$ 1 $OF$ 4","UserWizardDialog","450","300","","$CLOSE_CANCEL$","Wizard-Wand16.png");function OnHideUserWizard(){g_ActiveUserGrid.EnableUpdates(true);}function OnShowUserWizard(){ResetUserWizard(false);g_ActiveUserGrid.EnableUpdates(false);InitUserWizard();}function OnCancelWizardUser(){HideDialog("UserWizardDialog");g_ActiveUserGrid.EnableUpdates(true);}function InitUserWizard(){LoadingDialog(true);if(g_UserWizardQuery=createAWHttpRequest("GET",(g_sAdminXMLPath+"UserWizard.xml?ID=%CDomain.%ID%.DefaultUser.ID%"),OnUserWizardQueryDone))g_UserWizardQuery.request();}function OnUserWizardQueryDone(xmlDoc){if(xmlDoc==undefined)xmlDoc=this.getResponseXML();if(xmlDoc){OnWizardHomeDirLoad(GetXMLValue(xmlDoc,"HomeDir"),GetXMLValue(xmlDoc,"HomeDirDefault"));OnWizardLockInHomeDirLoad(GetXMLValue(xmlDoc,"LockInHomeDir"),GetXMLValue(xmlDoc,"LockInHomeDirDefault"),GetXMLValue(xmlDoc,"LockInHomeDirIsDefault"));}LoadingDialog(false);ShowDialog("UserWizardDialog",undefined,OnHideUserWizard);setTimeout("OnSetUserWizardInitialFocus()");}function OnSaveWizardUser(){var sLoginId=LoginIDWizardInput.getControlText();var sUserPassword=UserPasswordWizardInput.getControlText();var sHomeDir=HomeDirWizardInput.getControlText();var bLockInHomeDir=document.getElementById(LockInHomeDirCheck.getContent("hidden").getId()).value;var nAccessRights=DirAccessWizardCombo.getItemValue(DirAccessWizardCombo.getSelectedItems());var sEmail=EmailWizardInput.getControlText();var sUserFullName=FullNameWizard.getControlText();var bRequirePasswordChange=(WizardRequirePasswordChangeCheck.getControlValue()?1:0);if((Trim(sLoginId))!=""){SavingDialog(true);var WizardUserRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".CreateUser");WizardUserRequest.setParameter("LoginID",sLoginId);WizardUserRequest.setParameter("Password",sUserPassword);WizardUserRequest.setParameter("HomeDir",sHomeDir);WizardUserRequest.setParameter("LockInHomeDir",bLockInHomeDir);WizardUserRequest.setParameter("Access",nAccessRights);WizardUserRequest.setParameter("EmailAddress",sEmail);WizardUserRequest.setParameter("FullName",sUserFullName);WizardUserRequest.setParameter("RequirePasswordChange",bRequirePasswordChange);WizardUserRequest.setAsync(true);WizardUserRequest.request();WizardUserRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else OnCancelWizardUser();};}else{setTimeout(function(){AlertDialog("$PLEASE_ENTER_USER_NAME$",undefined,OnEnterUserName);},0);}}function OnEnterUserName(){ResetUserWizard(true);document.getElementById("LoginID_Wizard-box-text").focus();}function OnEnterEmail(){document.getElementById("EmailAddress_Wizard-box-text").focus();}function OnEnterFullName(){document.getElementById("FullName_Wizard-box-text").focus();}function OnDirAccessWizardTypeLoad(sValue){DirAccessWizardCombo.initValue(sValue);}function OnSetUserWizardInitialFocus(){OnSetUserWizardFocus(1);}function ResetUserWizard(bPartialReset){if(!bPartialReset){LoginIDWizardInput.setControlText("");UserPasswordWizardInput.setControlText("");EmailWizardInput.setControlText("");FullNameWizard.setControlText("");DirAccessWizardCombo.setControlText("$READ_ONLY_DESC$");DirAccessWizardCombo.setControlValue("4353");WizardRequirePasswordChangeCheck.setChecked(false,true);}NextUserWizardButton.setControlText("$NEXT_BUTTON$&gt;&gt;");BackUserWizardButton.setStyle("visibility","hidden");document.getElementById("UserWizardDialog-"+g_nCurrentUserWizardPage.toString()).style.display="none";document.getElementById("UserWizardDialog-1").style.display="block";document.getElementById("UserWizardDialogTitleText").innerHTML="<strong>$USER_WIZARD$ - $STEP$ 1 $OF$ "+g_nTotalUserWizardPages.toString()+"</strong>";g_nCurrentUserWizardPage=1;}function ValidateUserWizard(){var bValid=false;switch(g_nCurrentUserWizardPage){case 1:if(Trim(LoginIDWizardInput.getControlText())==""){setTimeout(function(){AlertDialog("$PLEASE_ENTER_USER_NAME$",undefined,OnEnterUserName);},0);}else if(!CheckEmailValidation(Trim(EmailWizardInput.getControlText()))){setTimeout(function(){AlertDialog("$SU_VALID_INVALID_EMAIL_ADDRESS_STR$",undefined,OnEnterEmail);},0);}else bValid=true;break;case 3:if(Trim(HomeDirWizardInput.getControlText())==""){setTimeout(function(){AlertDialog("$PLEASE_ENTER_HOME_DIR$");},0);}else bValid=true;break;default:bValid=true;}return(bValid);}function OnUserNextWizard(){if(g_nCurrentUserWizardPage==g_nTotalUserWizardPages)OnSaveWizardUser();else if((ValidateUserWizard())&&(g_nCurrentUserWizardPage<g_nTotalUserWizardPages)){var WizardLayer=document.getElementById("UserWizardDialog-"+g_nCurrentUserWizardPage.toString());OnSetUserWizardBlur(g_nCurrentUserWizardPage);WizardLayer.style.display="none";g_nCurrentUserWizardPage++;if(g_nCurrentUserWizardPage==g_nTotalUserWizardPages){DirAccessWizardCombo.onKeyEnter=OnUserNextWizard;NextUserWizardButton.setControlText("$FINISH_BUTTON$");setTimeout(function(){NextUserWizardButton.focus();},0);}if(g_nCurrentUserWizardPage==1)BackUserWizardButton.setStyle("visibility","hidden");else BackUserWizardButton.setStyle("visibility","visible");document.getElementById("UserWizardDialogTitleText").innerHTML="<strong>$USER_WIZARD$ - $STEP$ "+g_nCurrentUserWizardPage.toString()+" $OF$ "+g_nTotalUserWizardPages.toString()+"</strong>";document.getElementById("UserWizardDialog-"+g_nCurrentUserWizardPage.toString()).style.display="block";OnSetUserWizardFocus(g_nCurrentUserWizardPage);}}function OnUserBackWizard(){if(g_nCurrentUserWizardPage>1){document.getElementById("UserWizardDialog-"+g_nCurrentUserWizardPage.toString()).style.display="none";g_nCurrentUserWizardPage--;if(g_nCurrentUserWizardPage==1)BackUserWizardButton.setStyle("visibility","hidden");NextUserWizardButton.setControlText("$NEXT_BUTTON$&gt;&gt;");NextUserWizardButton.setStyle("visibility","visible");document.getElementById("UserWizardDialogTitleText").innerHTML="<strong>$USER_WIZARD$ - $STEP$ "+g_nCurrentUserWizardPage.toString()+" $OF$ "+g_nTotalUserWizardPages.toString()+"</strong>";document.getElementById("UserWizardDialog-"+g_nCurrentUserWizardPage.toString()).style.display="block";OnSetUserWizardFocus(g_nCurrentUserWizardPage);}}function OnSetUserWizardBlur(nFocusLayer){var sFocusElement;switch(nFocusLayer){case(1):sFocusElement="LoginID_Wizard-box-text";document.getElementById("FullName_Wizard-box-text").blur();if(parseInt("%CServer.%SERVER_ID%.EventLicense%")==1)document.getElementById("EmailAddress_Wizard-box-text").blur();break;case(2):sFocusElement="Password_Wizard-box-text";break;case(3):sFocusElement="HomeDir_Wizard-box-text";break;}if(sFocusElement!=undefined)document.getElementById(sFocusElement).blur();}function OnSetUserWizardFocus(nFocusLayer){var sFocusElement;switch(nFocusLayer){case(1):{sFocusElement="LoginID_Wizard-box-text";}break;case(2):{sFocusElement="Password_Wizard-box-text";if((UserPasswordWizardInput.getControlText()=="")&&(!g_bDisablePasswordGenerators))UserPasswordWizardInput.setControlText(PasswordGen(g_sMinPassLen));}break;case(3):{sFocusElement="HomeDir_Wizard-box-text";}break;}if(sFocusElement!=undefined)document.getElementById(sFocusElement).focus();}function OnWizardHomeDirLoad(sValue,sDefaultValue){if(sValue!=undefined){if(HomeDirWizardInput==undefined)HomeDirWizardInput=CreateComboBox("","",[],[],"HomeDirWizard","HomeDir_Wizard",undefined,"",true,380,20,OnUserNextWizard,true);if(sDefaultValue==undefined)sDefaultValue="";HomeDirWizardInput.initValue(sValue,sDefaultValue);if(sValue.length)HomeDirWizardInput.setControlText(sValue);else HomeDirWizardInput.setControlText(sDefaultValue);}else HomeDirWizardInput=CreateInputField("","HomeDirWizard","HomeDir_Wizard","",380,undefined,undefined,OnUserNextWizard);UserInfoWizardBrowse=CreatePushButton("","BrowseButtonUserInfo-Wizard",LoadDynamicContentAndRun,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[HomeDirWizardInput,false,"0","1"]]);UserInfoWizardBrowse.setControlImage("Browse");EnableSelectionOnFormElements();}function OnWizardLockInHomeDirLoad(sValue,sDefaultValue,bIsDefault){LockInHomeDirCheck=CreateTriStateCheckBox("$LOCK_HOME_DIR$","LockInHomeDir-Wizard","LockInHomeDir-Wizard",sValue,sDefaultValue,bIsDefault);}var LoginIDWizardInput=CreateInputField("","LoginIDWizard","LoginID_Wizard","",250,undefined,undefined,OnUserNextWizard);var UserPasswordWizardInput=CreatePasswordField("","PasswordWizard","Password_Wizard","",250,undefined,undefined,OnUserNextWizard);setTimeout(function(){initPasswordTypeToggler(UserPasswordWizardInput,"Password_Wizard");});var EmailWizardInput=CreateInputField("","EmailAddressWizard","EmailAddress_Wizard","",250,undefined,undefined,OnUserNextWizard);var FullNameWizard=CreateInputField("","FullNameWizard","FullName_Wizard","",250,undefined,undefined,OnUserNextWizard);var DirAccessWizardCombo=CreateComboBox("$READ_ONLY_DESC$","4353",["$READ_ONLY_DESC$","$FULL_ACCESS$"],["4353","7967"],"DirAccessType_Wizard","DirAccessType_Wizard",undefined,"OnDirAccessWizardTypeLoad()",false,180,20);var WizardRequirePasswordChangeCheck=CreateCheckBox("$REQUIRE_PASSWORD_CHANGE$","RequirePasswordChange-Wizard","RequirePasswordChange-Wizard",0,undefined,true);var CancelWizardUserButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelUserWizardButton",OnCancelWizardUser);var NextUserWizardButton=CreatePushButton("$NEXT_BUTTON$&gt;&gt;","NextUserWizardButton",OnUserNextWizard,60,30,"UserWizardDialog");var BackUserWizardButton=CreatePushButton("&lt;&lt;$BACK_BUTTON$","BackUserWizardButton",OnUserBackWizard,60,30,"UserWizardDialog");BackUserWizardButton.setStyle("visibility","hidden");</script><div id="MoveUsersDialoginner" style="display:none;padding-left:5px;"><form name="MoveUsersForm" onsubmit="return (false);"><div style="padding-left:5px;">$MOVE_USER_DESCR$</div><table class="DialogTable"><tr><td style="vertical-align:top;"><span id="CollectionRadio"></span><br /><span id="MoveUsersCombo" ></span><span id="ODBCMoveUsersCombo" ></span></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="MoveUserMoveButton"></span><br /><span id="MoveUserCancelButton"></span><br /><br /><span id="HelpMoveUserButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$MOVE_USERS_TITLE$","MoveUsersDialog","375","150","","$CLOSE_CANCEL$");function OnMoveUsers(bODBC){var nDestinationOrg;SavingDialog(true);var MoveUsersRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CDomainAttrs.%ID%.MoveUsers");if(parseInt(document.getElementById(MoveUserRadio.getContent("hidden").getId()).value)==1)nDestinationOrg=MoveUserCombo.getItemValue(MoveUserCombo.getSelectedItems());else nDestinationOrg=ODBCMoveUserCombo.getItemValue(ODBCMoveUserCombo.getSelectedItems());var IDs=new Array();var MoveCells=new Array();MoveCells=g_ActiveUserGrid.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<MoveCells.length);nIndex++){var sLoginID=g_ActiveUserGrid.getCellValue(0,MoveCells[nIndex]);IDs.push(sLoginID);}nSourceOrg=g_nActiveUserOrg;MoveUsersRequest.setParameter("SourceOrganization",nSourceOrg);MoveUsersRequest.setParameter("DestinationOrganization",nDestinationOrg);MoveUsersRequest.setParameter("IDs",IDs);MoveUsersRequest.setAsync(true);MoveUsersRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else if(bODBC==true)HideDialog("ConfirmDialog");else HideDialog("MoveUsersDialog");};MoveUsersRequest.request(null);}function OnCancelMoveUsers(){HideDialog('MoveUsersDialog');}function OnMoveUsersHelp(){LaunchHelp("","");}function OnChangeMoveUserRadio(nCollectionType){if(parseInt(nCollectionType)==0){document.getElementById("MoveUsersCombo").style.display="none";document.getElementById("ODBCMoveUsersCombo").style.display="block";}else{document.getElementById("MoveUsersCombo").style.display="block";document.getElementById("ODBCMoveUsersCombo").style.display="none";}}var MoveUserCombo=CreateComboBox("","",[],[],"MoveUsersCombo","MoveUsersCombo",undefined,undefined,false,250,20);var ODBCMoveUserCombo=CreateComboBox("","",[],[],"ODBCMoveUsersCombo","ODBCMoveUsersCombo",undefined,undefined,false,250,20);if(g_bFireFox3Browser||g_bSafariBrowser){MoveUserCombo.getPopupTemplate().setStyle("margin-top","-5px");MoveUserCombo.getPopupTemplate().setStyle("background-color","#fff");ODBCMoveUserCombo.getPopupTemplate().setStyle("margin-top","-5px");ODBCMoveUserCombo.getPopupTemplate().setStyle("background-color","#fff");}var MoveUserRadio=CreateRadioButtons(0,["$MOVE_TO_ODBC$","$MOVE_TO_SERVU$"],"CollectionRadio","CollectionRadio","250px",OnChangeMoveUserRadio,[0,1],undefined,true,120);CreateDialogPushButton("$MOVE_BUTTON$","MoveUserMoveButton",OnMoveUsers);CreateDialogPushButton("$CANCEL_BUTTON$","MoveUserCancelButton",OnCancelMoveUsers);CreateDialogPushButton("$HELP_BUTTON$","HelpMoveUserButton",OnMoveUsersHelp);</script><div id="LogDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div id="logwindow" class="SpyLogScroll"><div id="log" style="width:100%;"></div></div><span id="CloseLog"></span></div></div><script type="text/javascript" language="javascript">var g_sAttrLogObjectType="Domain";var g_nAttrLogObjectId=%ID%;var g_sFilterLogText="";var g_GridToReload;BuildDialog("$LOG_DIALOG_TITLE$","LogDialog","775","300","","$CLOSE_CANCEL$");function OnShowLogDialog(){g_GridToReload=undefined;try{if(awActiveGrid!=undefined&&awActiveGrid.m_bUpdates)g_GridToReload=awActiveGrid;}catch(e){try{if(g_ActiveRezizeGrid!=undefined&&g_ActiveRezizeGrid.m_bUpdates)g_GridToReload=g_ActiveRezizeGrid;}catch(e){try{if(awSecondaryActiveGrid!=undefined&&awSecondaryActiveGrid.m_bUpdates)g_GridToReload=awSecondaryActiveGrid;}catch(e){g_GridToReload=undefined;}}}if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(false);InitDomainAttrLog();FreezeDomainAttrLog(false);ShowDialog("LogDialog",undefined,ResetLogDialog);}function ResetLogDialog(){if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(true);FreezeDomainAttrLog(true);document.getElementById("log").innerHTML="";}function OnOkViewLog(){HideDialog('LogDialog');}CreateDialogPushButton("$CLOSE_BUTTON$","CloseLog",OnOkViewLog);InitLog("log","",0);</script><div id="LogDialoginner" style="display:none;"><div style="margin:0 5px 0 5px;"><div id="logwindow" class="SpyLogScroll"><div id="log" style="width:100%;"></div></div><span id="CloseLog"></span></div></div><script type="text/javascript" language="javascript">var g_sAttrLogObjectType="Domain";var g_nAttrLogObjectId=%ID%;var g_sFilterLogText="";var g_GridToReload;BuildDialog("$LOG_DIALOG_TITLE$","LogDialog","775","300","","$CLOSE_CANCEL$");function OnShowLogDialog(){g_GridToReload=undefined;try{if(awActiveGrid!=undefined&&awActiveGrid.m_bUpdates)g_GridToReload=awActiveGrid;}catch(e){try{if(g_ActiveRezizeGrid!=undefined&&g_ActiveRezizeGrid.m_bUpdates)g_GridToReload=g_ActiveRezizeGrid;}catch(e){try{if(awSecondaryActiveGrid!=undefined&&awSecondaryActiveGrid.m_bUpdates)g_GridToReload=awSecondaryActiveGrid;}catch(e){g_GridToReload=undefined;}}}if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(false);InitDomainAttrLog();FreezeDomainAttrLog(false);ShowDialog("LogDialog",undefined,ResetLogDialog);}function ResetLogDialog(){if(g_GridToReload!=undefined)g_GridToReload.EnableUpdates(true);FreezeDomainAttrLog(true);document.getElementById("log").innerHTML="";}function OnOkViewLog(){HideDialog('LogDialog');}CreateDialogPushButton("$CLOSE_BUTTON$","CloseLog",OnOkViewLog);InitLog("log","",0);</script><div id="LDAPDomainControllerCancelinner" style="display:none;"><div id="CancelContent"><div style="text-align:center;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" /></div></div><div style="text-align:right;padding-right:10px;"><span id="CloseDCButton"></span></div></div><script type="text/javascript" language="javascript">BuildDialog("$DC_DETECTING$","LDAPDomainControllerCancel","240","170","","$CLOSE_CANCEL$");function OnCancelDialogShow(){ShowDialog("LDAPDomainControllerCancel");}function OnCancelDialogHide(){HideDialog("LDAPDomainControllerCancel");}function OnCancelRetrievingDC(){var sDetectConnectionCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.AbortGetDC";var TestLDAPRequest=CreatePostRequest(sDetectConnectionCmd);TestLDAPRequest.request();TestLDAPRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult==0){}else{AlertDialog("Operation can not be performed",true);}};OnCancelDialogHide();}CreatePushButton("$CANCEL_BUTTON$","CloseDCButton",OnCancelRetrievingDC,85,25);</script><div id="LDAPBrowseDNDialoginner" style="display:none;"><div class="LdapBox"><div id="DNContent" class="tree-placeholder"><div><div id="tree"></div></div></div><div id="LDAPGetDNResult" style="margin-bottom: 5px; margin-left: 5px;"><label id="DNResultLabel" class="hidden"></label></div></div><div style="text-align:right;padding-right:10px;"><span id="CloseBrowseDNButton"></span><span id="SelectDNButton"></span></div></div><link href="%COMMON_FILE%Style/jquery/ui.fancytree.min.css" rel="stylesheet" type="text/css"><style media="screen" type="text/css">.tree-placeholder {overflow: auto;min-height: 300px;max-height: 550px;margin-bottom: 10px;}ul.fancytree-container {overflow: inherit;outline:none !important;border: none;}</style><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.fancytree.min.js"></script><script type="text/javascript" language="javascript">BuildDialog("Select Base Distinguished Name","LDAPBrowseDNDialog","450","400","","$CLOSE_CANCEL$");function OnBrowseDNShow(){BusyDialog(true);performNodeGet("Root DSE",function(response){var result=GetXMLValueInt(response,"result");if(result===46){BusyDialog(false);AlertDialog(GetXMLValue(response,"ResultText"));return;}else if(result!=0){BusyDialog(false);var sResultText=GetXMLValue(response,"ResultText");var outputResult=HandleLDAPErrorResponse(response,result,sResultText);AlertDialog(outputResult,true);return;}common.nodeExpandResultHide();buildFancyTree(response);BusyDialog(false);ShowDialog("LDAPBrowseDNDialog");$('#btn-SelectDNButton').prop('disabled',true);});}function OnBrowseDNHide(){HideDialog("LDAPBrowseDNDialog");}var variables={rootNode:'Root DSE',getDomainNamesTree:function(){return $("#tree");},getSelectBtn:function(){return $('#btn-SelectDNButton');},getNodeExpandResult:function(){return $('#DNResultLabel');}};var common={getXmlInnerContent:function(element){return(element.innerHTML)?element.innerHTML:element.text;},nodeExpandResultError:function(errorMessage){var statusLabelObj=variables.getNodeExpandResult()[0];statusLabelObj.setAttribute("class","Error");statusLabelObj.innerHTML=errorMessage;},nodeExpandResultHide:function(){var statusLabelObj=variables.getNodeExpandResult()[0];statusLabelObj.setAttribute("class","Hidden");}};function funcExecuteAlertSafe(_function){try{return _function();}catch(ex){return null;}}function retrieveNodeFromXmlTree(data,name){for(var idx=0;idx<data.childNodes.length;idx++){if(data.childNodes[idx].nodeName&&data.childNodes[idx].nodeName.toLowerCase()==name.toLowerCase()){return data.childNodes[idx];}}return null;}function parseXmlDNs(response){var roots=retrieveNodeFromXmlTree(retrieveNodeFromXmlTree(response,"response"),"roots");var result=[];var nodes=roots.childNodes;for(var idx=0;idx<nodes.length;idx++){var innerContent=common.getXmlInnerContent(nodes[idx]);if(innerContent){result.push({title:innerContent,folder:true,lazy:true});}}return result;}function buildFancyTree(response){var result=[{title:variables.rootNode,folder:true,expanded:true,children:parseXmlDNs(response)}];var tree=funcExecuteAlertSafe(function(){return variables.getDomainNamesTree().fancytree('getTree')});if(tree){tree.reload(result);}else{variables.getDomainNamesTree().fancytree({source:result,lazyLoad:function(e,data){var deferred=new $.Deferred();data.result=deferred.promise();performNodeGet(data.node.title,function(data){var nResult=GetXMLValueInt(data,"result");if(nResult!=0){var sResultText=GetXMLValue(data,"ResultText");var outputResult=HandleLDAPErrorResponse(data,nResult,sResultText);common.nodeExpandResultError(outputResult);}else {common.nodeExpandResultHide();}deferred.resolve(parseXmlDNs(data));});},activate:function(event,data){if(data.node.title===variables.rootNode){variables.getSelectBtn().prop('disabled',true);}else{variables.getSelectBtn().prop('disabled',false);LDAPServerBase.value=data.node.title;}}});}}function performNodeGet(node,callback){var sGetRootDSECmd="%ADMIN_FILE%XML/LDAPRootDSE.xml%OBJECT_COMMAND_REF%CServer.%SERVER_ID%.GetLDAPChildrenDN";var baseDNRequest=CreatePostRequest(sGetRootDSECmd,callback);baseDNRequest.setParameter("LDAPHost",Trim(LDAPServerHost.value));baseDNRequest.setParameter("LDAPPort",Trim(LDAPServerPort.value));baseDNRequest.setParameter("LDAPConnectionAccount",Trim(LDAPServerConnectionAccount.value));baseDNRequest.setParameter("LDAPPassword",LDAPServerConnectionPwd.value);baseDNRequest.setParameter("LDAPRootDN",node);baseDNRequest.setParameter("LDAPServerID",LDAPServerIDField.value);if(LDAPSecureServerEnabledCheck.checked)baseDNRequest.setParameter("LDAPSecure",1);else baseDNRequest.setParameter("LDAPSecure",0);if(!IS_WINDOWS_OS&&LDAPSecureServerEnabledCheck.checked){baseDNRequest.setParameter("CACertificatePath",LDAPCACertificatePath.value);baseDNRequest.setParameter("CACertificateFingerprintSHA256",LDAPCACertFingerprintSHA256.value);}baseDNRequest.request();}CreatePushButton("$CANCEL_BUTTON$","CloseBrowseDNButton",OnBrowseDNHide,85,25);CreatePushButton("Select","SelectDNButton",OnBrowseDNHide,85,25,undefined,undefined,"button_green");$(function(){});</script><div id="LDAPServersDialoginner" style="display:none;  position: relative;overflow:auto"><form name="LDAPServerForm" onsubmit="return (false);"><table class="DialogTable"><tr><td><div class="LdapBox"><div class="LDAPUnderscoreBox LdapGrayText">$LDAP_SERVER_DESCRIPTION$<a class="LdapGrayedLink" href="http://www.serv-u.com/kb" target="_blank"rel="noopener noreferrer">$MORE_INFORMATION$</a><table id="LDAPWarningText" style="display: block"><tr><td><img src="Images/Warn16.png"></td><td style="vertical-align: bottom"><span style="color:#f56e07">The configured connection is notsecure</span></td></tr></table></div><div class="LDAPServerConnection">$LDAP_SERVER_CONNECTION$</div><div><div class="AutoLeft" style="width:auto;padding-bottom:17px;padding-right:2px;"><input class="LdapCheckBox" type="checkbox" id="LDAPServerEnabled" name="Enabled" tabindex="1"><label for="LDAPServerEnabled" style="display: inline-block; width:215px;" class="BoldLabel"title="$LDAP_ENABLING_TT$">$ENABLE_LDAP_SERVER$</label></div><div class="AutoLeft"><input class="LdapCheckBox" type="checkbox" id="LDAPSecureServerEnabled" name="Secure" tabindex="2"onclick="javascript:OnToggleSecureLDAP();"><label for="LDAPSecureServerEnabled" class="BoldLabel"title="$LDAP_SECURE_ENABLING_TT$">$SECURE_LDAP$</label></div></div><div class="LDAPUnderscoreBox"><div class="AutoLeft" style="padding-right:20px"><div style="padding-bottom:7px;"><div class="TextBottomPadding BoldLabel">$HOST$<br /></div><input class="LdapInputField" type="text" id="LDAPServerHost" name="LDAP_Host" title="$LDAP_HOST_TT$"tabindex="2" /></div><div style="padding-bottom:7px;"><div class="TextBottomPadding"><strong>$CONN_ACCOUNT$</strong><br /></div><input class="LdapInputField" type="text" id="LDAPServerConnectionAccount"name="LDAP_ConnectionAccount" title="$LDAP_CONNECTION_ACCOUNT_TT$" tabindex="4" /></div></div><div class="AutoLeft"><div style="padding-bottom:7px;"><div class="TextBottomPadding BoldLabel">$LISTENER_PORT$<br /></div><input class="LdapInputField" type="text" id="LDAP_Port" name="LDAP_Port" title="$LDAP_PORT_TT$"tabindex="3" /></div><div style="padding-bottom:7px;" class="password-container"><div class="TextBottomPadding"><strong>$CONN_ACCOUNT_PWORD$</strong><br /></div><input class="LdapInputField" type="password" autocomplete="new-password"id="LDAPServerConnectionPassword" name="LDAP_ConnectionPassword"title="$LDAP_CONNECTION_ACCOUNT_PASSWORD_TT$" tabindex="5" /></div></div><div class="AutoLeft"><div class="TextBottomPadding"><strong>$DESCRIPTION$</strong> ($LDAP_OPTIONAL$)</div>
<div><input class="LdapInputField" type="text" id="LDAPDescription" name="LDAP_Description"style="width:460px;" title="$LDAP_DESCRIPTION_TT$" tabindex="9" /></div><br /></div><div id="LDAPCACertificateDiv" class="LdapCertificate linux-only" style="display: none"><fieldset id="LDAP_ldapCertificateType" name="LDAP_ldapCertificateType"onchange="javascript:OnToggleCertificateOption()"><legend><b>$LDAP_ROOT_CERTIFICATE$</b></legend><div class="ldapCertificateOption"><input id="defaultCertificateLocation" class="inputRadio" type="radio" name="ldapCertificateRadio"value="0" autocomplete="off" checked /><label id="defaultCertificateLocationLabel" for="defaultCertificateLocation">$LDAP_DEFAULT_CERTIFICATE$</label></div><div class="ldapCertificateOption"><input id="browseCertificate" class="inputRadio" type="radio" name="ldapCertificateRadio" value="1"autocomplete="off" /><label id="browseCertificateLabel" for="browseCertificate">$LDAP_BROWSE_CERTIFICATE$</label></div><div class="ldapCertificateOption"><input id="pickCertificateFromServer" class="inputRadio" type="radio" name="ldapCertificateRadio"value="2" autocomplete="off" /><label id="pickCertificateFromServerLabel" for="pickCertificateFromServer">$LDAP_PICK_CERTIFICATE$</label></div></fieldset><div id="ldapCertificatePath" class="Hidden"><input id="LDAP_CACertificateFingerprintSHA256" type="text" name="LDAP_CACertificateFingerprintSHA256"class="Hidden" disabled readonly><input id="LDAP_CACertificatePath" type="text" readonly="true" name="LDAP_CACertificatePath"title="$LDAP_ROOT_PATH_HINT$" onchange="javascript:setCertificatePathSection(this.value)"><span id="BrowseLDAPCAPath" title="$LDAP_BROWSE_BUTTON_HINT$"></span><span id="PickLDAPCAPath" title="$LDAP_RETRIEVE_BUTTON_HINT$"></span></div><div class="LdapCertificate__error"><label class="LdapCertificate__error-message Error"></label></div></div><div><span id="TestLDAPConnectionButton" tabindex="10" title="$LDAP_TEST_BTN_TT$"></span><input id="LDAPServerIDField" type="hidden" /></div><div id="LDAPDetectionResult" style="padding-top:4px;"><label id='ResultLabel' class="Hidden"></label></div></div><div class="LDAPUnderscoreBox" style="padding-top:10px;"><div class="LdapShowAdvancedOptions"><span id="ArrowSpan" class="navDomain arrowCell"><spanclass="arrow down"></span></span><span id="AdvText"class="navDomain text BoldLabel">$LDAP_ADVANCED_SHOW$</span></div><div id="HiddenOptions" class="Hidden" style="overflow:auto;"><div class="LDAPUnderscoreBox" style="padding-top:10px;"><div class="BoldText" style="clear:both;padding-bottom:10px;">$LDAP_FILTER_USERS$</div><div class="TextBottomPadding BoldLabel">$BASE$</div><input class="LdapInputField" type="text" id="LDAPBaseDN" title="$LDAP_BASE_DN_TT$"name="LDAP_Base" /><span id="BrowseDNButton" title="$LDAP_BROWSE_DN_BTN_TT$"></span><br /><div class="TextBottomPadding BoldLabel">$SEARCH_FILTER$</div><input class="LdapInputField" type="text" id="LDAPearchFilter" name="LDAP_SearchFilter"title="$LDAP_SEARCH_FILTER_TT$" style="width:460px;" /></div><div id="LDAPAttributeMappingBox"><div class="BoldText" style="padding-bottom:10px;padding-top:5px;">$ATTR_MAPS$</div><div class="AutoLeft" style="padding-right:20px"><div style="padding-bottom:7px;"><div class="TextBottomPadding BoldLabel"><strong>$GROUP_MEMBERSHIP$</strong> <br /></div><input class="LdapInputField" type="text" id="LDAPGroupMembership" title="$LDAP_GROUP_TT$"name="LDAP_MapGroupMembership" /></div><div style="padding-bottom:7px;"><div class="TextBottomPadding"><strong>$LDAP_LOGIN_ID$</strong> ($LDAP_OPTIONAL$)<br /></div><input class="LdapInputField" type="text" id="LDAPLoginID" title="$LDAP_MAP_LOGIN_ID_TT$"name="LDAP_MapLoginID" /></div><div style="padding-bottom:7px;"><div class="TextBottomPadding"><strong>$EMAIL$</strong> ($LDAP_OPTIONAL$)<br /></div><input class="LdapInputField" type="text" id="LDAPmail" title="$LDAP_MAP_EMAIL_TT$"name="LDAP_MapEmailAddress" /></div></div><div class="AutoLeft"><div style="padding-bottom:7px;"><div class="TextBottomPadding BoldLabel">$HOMEDIR$<br /></div><input class="LdapInputField" type="text" id="LDAPHomeDirectory" title="$LDAP_MAP_HOME_TT$"name="LDAP_MapHomeDir" /></div><div style="padding-bottom:7px;"><div class="TextBottomPadding"><strong>$FULL_NAME_COLUMN$</strong> ($LDAP_OPTIONAL$)<br /></div><input class="LdapInputField" type="text" id="LDAPFullName" title="$LDAP_MAP_FULL_NAME_TT$"name="LDAP_MapFullName" /></div></div></div></div></div><div style="padding-top:10px;"><div class="LdapGrayText" style="clear:both;padding-bottom:10px;">$LDAP_TEST_USER_ACCOUNT$ ($LDAP_OPTIONAL$)</div><div class="AutoLeft" style="padding-right: 20px; padding-bottom: 10px;"><div class="TextBottomPadding BoldLabel">$LDAP_TEST_USER$<br /></div><input class="LdapInputField" type="text" id="LDAPTestLogin" style="width:170px;"title="$LDAP_TEST_LOGIN_TT$" tabindex="11" /></div><div class="AutoLeft password-container" style="padding-bottom:10px;"><div class="TextBottomPadding BoldLabel">$PASSWORD$<br /></div><input class="LdapInputField" type="password" autocomplete="new-password" id="LDAPTestPassword"style="width:170px;" title="$LDAP_TEST_PASSWORD_TT$" tabindex="12" /></div><div style="padding-top:14px;float:right;"><span id="TestLDAPLoginButton" title="$LDAP_TEST_USER_BTN_TT$" tabindex="13"></span></div></div><div class="AutoLeft" id="LDAPTestUserResult"><label id='ResultTestLabel' class="Hidden"></label></div></div></td></tr><tr><td style=" text-align:right;"><div class="LdapBox LDAPButtons" style="margin-top:5px;"><span id="CancelLDAPServerButton" tabindex="14"></span><span id="SaveLDAPServerButton" tabindex="15"></span></div></td></tr></table></form></div><script type="text/javascript" language="javascript">var IS_WINDOWS_OS=!(+"%NON_WINDOWS%");var LDAP_CERTIFICATE_STATE={BROWSED_FILE_PATH:"",BROWSED_FINGERPRINT:""};removeNonWindowsElements();BuildDialog("$LDAP_SERVER$","LDAPServersDialog","500","300","","$CLOSE_CANCEL$","LDAP16.png");function removeNonWindowsElements(){var elements=document.querySelectorAll('.linux-only');if(IS_WINDOWS_OS){for(var i=0;i<elements.length;i++){elements[i].classList.add("Hidden");}}}function setCertificatePathSection(path){var certificateRadio=$("#LDAP_ldapCertificateType");var radioButtons=certificateRadio.find("input[type=radio]");var fingerprint=$("#LDAP_CACertificateFingerprintSHA256").val()||"";if(!!path.length){LDAP_CERTIFICATE_STATE.BROWSED_FILE_PATH=path;LDAP_CERTIFICATE_STATE.BROWSED_FINGERPRINT=fingerprint;radioButtons.eq(1).prop("checked",true);}else{radioButtons.eq(0).prop("checked",true);LDAP_CERTIFICATE_STATE.BROWSED_FILE_PATH="";LDAP_CERTIFICATE_STATE.BROWSED_FINGERPRINT="";}caCertificateError.innerHTML="";caCertificateError.classList.add("Hidden");OnToggleCertificateOption();}function ChangeDialogPosition(){var sDialog="LDAPServersDialog";var Dialog=document.getElementById(sDialog);var nWidth=parseInt(Dialog.style.width);var nHeight=parseInt(Dialog.style.height);var nOpaqueZIndex=(8000+(nTopDialog*2));var sOpaqueLayer=(sDialog+"OpaqueLayer");nHeight=(Dialog.style.pixelHeight)?Dialog.style.pixelHeight:Dialog.offsetHeight;DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer);}function ShowHideAdvanced(){if(bShowHideAdvanced){$("#HiddenOptions").removeClass("Hidden");$("#AdvText").html("$LDAP_ADVANCED_HIDE$");$("#ArrowSpan").find("span.arrow").removeClass("down").addClass("up");ChangeDialogPosition();}else{$("#HiddenOptions").addClass("Hidden");$("#AdvText").html("$LDAP_ADVANCED_SHOW$");$("#ArrowSpan").find("span.arrow").removeClass("up").addClass("down");}bShowHideAdvanced=!bShowHideAdvanced;}function OnAddLDAPServerLoad(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("LDAPServersDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}LDAPServerHost.focus();LDAPDetectionResult.setAttribute("class","Hidden");ClearTestUserResult();LDAPServerEnabledCheck.checked=(LDAPServerEnabledCheck.value=='1');LDAPSecureServerEnabledCheck.checked=(LDAPSecureServerEnabledCheck.value=='1');var label=document.getElementById('LDAPWarningText');label.style.display="block";bShowHideAdvanced=false;ShowHideAdvanced();var sUpdateHtml;var sOSName="%CServer.%SERVER_ID%.OSName%";if((sOSName.indexOf("Linux")<0)){OnGetDomainController();}$("#LDAPServerHost").tooltip("close");LDAPServerIDField.value=-1;OnToggleSecureLDAP();}function OnCopyLDAPServerLoad(Grid){LDAPServerHost.focus();LDAPDetectionResult.setAttribute("class","Hidden");ClearTestUserResult();var label=document.getElementById('LDAPWarningText');LDAPServerEnabledCheck.checked=(LDAPServerEnabledCheck.value=='1');LDAPSecureServerEnabledCheck.checked=(LDAPSecureServerEnabledCheck.value=='1');if(LDAPSecureServerEnabledCheck.checked){label.style.display="none";}bShowHideAdvanced=false;ShowHideAdvanced();$("#LDAPServerHost").tooltip("close");LDAPServerIDField.value=-1;LDAPServerConnectionPwd.value="";}function OnEditLDAPServerLoad(Grid){LDAPServerHost.focus();LDAPDetectionResult.setAttribute("class","Hidden");ClearTestUserResult();var label=document.getElementById('LDAPWarningText');LDAPServerEnabledCheck.checked=(LDAPServerEnabledCheck.value=='1');LDAPSecureServerEnabledCheck.checked=(LDAPSecureServerEnabledCheck.value=='1');if(LDAPSecureServerEnabledCheck.checked){label.style.display="none";}$("#LDAPServerHost").tooltip("close");LDAPServerIDField.value=this.m_nEditObjectID;OnToggleSecureLDAP();}function OnSaveLDAPServer(){if(LDAPServerEnabledCheck.checked)LDAPServerEnabledCheck.value='1';else LDAPServerEnabledCheck.value='0';if(LDAPSecureServerEnabledCheck.checked)LDAPSecureServerEnabledCheck.value='1';else LDAPSecureServerEnabledCheck.value='0';LDAPServerConnectionAccount.value=Trim(LDAPServerConnectionAccount.value);LDAPServerHost.value=Trim(LDAPServerHost.value);clearLdapPathIfDefault();if(Trim(LDAPServerConnectionAccount.value)!=""&&Trim(LDAPServerConnectionPwd.value)=="")AlertDialog("$PLEASE_ENTER_CONN_ACCOUNT_PWORD$");else LDAPServersList.OnSaveObject();var label=document.getElementById('LDAPWarningText');label.style.display="block";return(false);}function OnCancelLDAPServer(){var label=document.getElementById('LDAPWarningText');label.style.display="block";HideDialog('LDAPServersDialog');}function OnLDAPServerHelp(){LaunchHelp("Help-LDAP-Auth.htm","RootItem6");}function ShowEmptyConnectionAccountWarning(bOk){if(bOk&&Trim(LDAPServerConnectionAccount.value)==""){AlertDialog("$LDAP_DC_DETECTED_CONNECTION_ACCOUNT_IS_EMPTY$");}}function ShowConnectionTestResult(bOk,sText){if(bOk){LDAPDetectionResult.removeAttribute("class","Hidden");LDAPDetectionResult.setAttribute("class","LdapSuccess");}else{LDAPDetectionResult.removeAttribute("class","Hidden");LDAPDetectionResult.setAttribute("class","Error");}LDAPDetectionResult.innerHTML=sText;}function ShowTestUserResult(bOk,sText){if(bOk){LDAPTestUserResult.removeAttribute("class","Hidden");LDAPTestUserResult.setAttribute("class","LdapSuccess");}else{LDAPTestUserResult.removeAttribute("class","Hidden");LDAPTestUserResult.setAttribute("class","Error");}LDAPTestUserResult.innerHTML=sText;}function ClearTestUserResult(){LDAPTestUserResult.setAttribute("class","Hidden");LDAPTestUserResult.innerHTML="";}function ClearConnectionTestResult(){LDAPDetectionResult.setAttribute("class","Hidden");LDAPDetectionResult.innerHTML="";}function ShowValidationAlert(sLabel){var sRequiredField="$LDAP_REQUIRED_FIELD$";sRequiredField=sRequiredField.replace("$Label",sLabel);AlertDialog(sRequiredField,true);}function ValidateParameters(sHost,nPort,sConnectionAccount,sConnectionPassword){var nPortVal=Trim(nPort.value);if(sHost.value==''){ShowValidationAlert("$HOST$");return false;}if(nPortVal==''){ShowValidationAlert("$LISTENER_PORT$");return false;}if(nPortVal!=parseInt(nPortVal,10)){AlertDialog("$LDAP_PORT_INVALID$",true);return false;}if(Trim(sConnectionAccount.value)!=''&&Trim(sConnectionPassword.value)==''){AlertDialog("$LDAP_PASSWORD_REQUIRED$",true);return false;}return true;}function OnNoLdapResponse(){BusyDialog(false);AlertDialog("$SESS_LDAP_NO_RESPONSE$",true,undefined,undefined,"$CANCEL_BUTTON$");}function OnCancelOperation(){var SESS_LDAP_SERVER_UNAVAILABLE=1305;var sDetectConnectionCmd="%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%CDomain.%ID%.AbortGetDC";var TestLDAPRequest=CreatePostRequest(sDetectConnectionCmd);TestLDAPRequest.request();TestLDAPRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult==0){}else{AlertDialog("Operation can not be performed",true);}};}function OnNoDCResponse(){BusyDialog(false);OnCancelDialogShow();}function OnLdapRecieveResponse(XMLDoc){var LDAP_SERVER_DOWN=0x51;var LDAP_ERROR_MIN=1300;var LDAP_ERROR_MAX=1312;var LDAP_OK_ACTIVE_DIRECTORY_DETECTED=1313;var LDAP_OK_LDAP_DETECTED=1314;var LDAP_VALIDATION_ERROR_MIN=5000;var LDAP_VALIDATION_ERROR_MAX=5067;BusyDialog(false);OnCancelDialogHide();var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sBaseDN=GetXMLValue(XMLDoc,"BaseDN");if(sBaseDN==undefined){sBaseDN="";}var outputResult;var bConnectionOK=false;if(nResult==46){AlertDialog(sResultText);return;}if(nResult==LDAP_OK_LDAP_DETECTED){bConnectionOK=true;outputResult="$LDAP_CONNECTION_OK$";bShowHideAdvanced=true;ShowHideAdvanced();}else if(nResult==LDAP_OK_ACTIVE_DIRECTORY_DETECTED){bConnectionOK=true;outputResult="$LDAP_CONNECTION_AD_OK$";}else if(nResult>=LDAP_ERROR_MIN&&nResult<LDAP_ERROR_MAX){bConnectionOK=false;outputResult=sResultText;}else if(nResult>=LDAP_VALIDATION_ERROR_MIN&&nResult<=LDAP_VALIDATION_ERROR_MAX){bConnectionOK=false;outputResult=sResultText;}else{var sErrorCode=GetXMLValue(XMLDoc,"ErrorCode");bConnectionOK=false;outputResult="$LDAP_UNKNOWN_ERR$"+sErrorCode;}if(bConnectionOK){LDAPServerBase.value=sBaseDN;if(sBaseDN!=""){outputResult+="$LDAP_BASE_DN_DETECTED$ ";outputResult+=sBaseDN;}}ShowConnectionTestResult(bConnectionOK,outputResult);ShowEmptyConnectionAccountWarning(bConnectionOK);}function HandleLDAPErrorResponse(XMLDoc,nResult,sResultText){var LDAP_ERROR_MIN=1300;var LDAP_ERROR_MAX=1309;var LDAP_VALIDATION_ERROR_MIN=5000;var LDAP_VALIDATION_ERROR_MAX=5070;var outputResult;if(nResult>=LDAP_ERROR_MIN&&nResult<LDAP_ERROR_MAX){outputResult=sResultText;}else if(nResult>=LDAP_VALIDATION_ERROR_MIN&&nResult<=LDAP_VALIDATION_ERROR_MAX){outputResult=sResultText;}else{var sErrorCode=GetXMLValue(XMLDoc,"ErrorCode");outputResult="$LDAP_UNKNOWN_ERR$"+sErrorCode;}return outputResult;}function OnDetectAndTestConnection(){ClearConnectionTestResult();WAITING_RESPONSE_TIME_MS=20000;if(!ValidateParameters(LDAPServerHost,LDAPServerPort,LDAPServerConnectionAccount,LDAPServerConnectionPwd)){return;}var sDetectConnectionCmd="%ADMIN_FILE%XML/LDAPDomainController.xml%OBJECT_COMMAND_REF%CDomain.%ID%.DetectLDAPConnection";var TestLDAPRequest=CreatePostRequest(sDetectConnectionCmd);var LDAPNoResponseTimeOut;TestLDAPRequest.setParameter("LDAPHost",Trim(LDAPServerHost.value));TestLDAPRequest.setParameter("LDAPPort",Trim(LDAPServerPort.value));TestLDAPRequest.setParameter("LDAPConnectionAccount",Trim(LDAPServerConnectionAccount.value));TestLDAPRequest.setParameter("LDAPPassword",LDAPServerConnectionPwd.value);TestLDAPRequest.setParameter("LDAPServerID",LDAPServerIDField.value);if(!IS_WINDOWS_OS){TestLDAPRequest.setParameter("CACertificatePath",LDAPCACertificatePath.value);TestLDAPRequest.setParameter("CACertificateFingerprintSHA256",LDAPCACertFingerprintSHA256.value);}if(LDAPSecureServerEnabledCheck.checked)TestLDAPRequest.setParameter("LDAPSecure",1);else TestLDAPRequest.setParameter("LDAPSecure",0);TestLDAPRequest.request();BusyDialog(true,"$LDAP_DETECTING$");TestLDAPRequest.response=function(XMLDoc){OnLdapRecieveResponse(XMLDoc);};}function OnGetDomainController(){var WAITING_RESPONSE_TIME_MS=5000;var SESS_LDAP_SERVER_UNAVAILABLE=1305;var SESS_INTERNAL_ERROR=11;var sDetectConnectionCmd="%ADMIN_FILE%XML/LDAPDomainController.xml%OBJECT_COMMAND_REF%CDomain.%ID%.GetDomainControllerName";var TestLDAPRequest=CreatePostRequest(sDetectConnectionCmd);TestLDAPRequest.request();BusyDialog(true,"$DC_DETECTING$");var LdapDCTimeOut=setTimeout(OnNoDCResponse,WAITING_RESPONSE_TIME_MS);TestLDAPRequest.response=function(XMLDoc){BusyDialog(false);clearTimeout(LdapDCTimeOut);OnCancelDialogHide();var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var outputResult;var sServerName=GetXMLValue(XMLDoc,"ServerName");var sBaseDN=GetXMLValue(XMLDoc,"BaseDN");if(nResult==46){return;}if(nResult==0&&(sServerName!='')){var sADDetectedNotification="$LDAP_LOCAL_DC_DETECTED$";sADDetectedNotification=sADDetectedNotification.replace("$ADServer",sServerName);LDAPServerHost.value=sServerName;if(sBaseDN!=''){LDAPServerBase.value=sBaseDN;sADDetectedNotification+="$LDAP_BASE_DN_DETECTED$ ";sADDetectedNotification+=sBaseDN;}ShowConnectionTestResult(true,sADDetectedNotification);}else if(nResult==SESS_LDAP_SERVER_UNAVAILABLE||nResult==46){}else{AlertDialog("$LDAP_LOCAL_DOMAIN_NOT_FOUND$",true);}};}function OnTestUser(){ClearTestUserResult();if(!ValidateParameters(LDAPServerHost,LDAPServerPort,LDAPServerConnectionAccount,LDAPServerConnectionPwd)){return;}var sDetectConnectionCmd="%ADMIN_FILE%XML/ResultTestLDAP.xml%OBJECT_COMMAND_REF%CDomain.%ID%.TestLDAPUser";var TestLDAPRequest=CreatePostRequest(sDetectConnectionCmd);var LDAPNoResponseTimeOut;TestLDAPRequest.setParameter("LDAPHost",Trim(LDAPServerHost.value));TestLDAPRequest.setParameter("LDAPPort",Trim(LDAPServerPort.value));TestLDAPRequest.setParameter("LDAPConnectionAccount",Trim(LDAPServerConnectionAccount.value));TestLDAPRequest.setParameter("LDAPPassword",LDAPServerConnectionPwd.value);TestLDAPRequest.setParameter("user",Trim(LDAPTestLogin.value));TestLDAPRequest.setParameter("pword",LDAPTestPassword.value);TestLDAPRequest.setParameter("LDAPearchFilter",LDAPSearchFilter.value);TestLDAPRequest.setParameter("LDAPBaseDN",LDAPServerBase.value);TestLDAPRequest.setParameter("CACertificatePath",LDAPCACertificatePath.value);TestLDAPRequest.setParameter("CACertificateFingerprintSHA256",LDAPCACertFingerprintSHA256.value);if(LDAPSecureServerEnabledCheck.checked)TestLDAPRequest.setParameter("LDAPSecure",1);else TestLDAPRequest.setParameter("LDAPSecure",0);TestLDAPRequest.setParameter("LDAPServerID",LDAPServerIDField.value);TestLDAPRequest.request();BusyDialog(true);TestLDAPRequest.response=function(XMLDoc){BusyDialog(false);OnLdapTestUserResponse(XMLDoc);};}function OnConfirmedCACertificatePath(certInfo){$("#LDAP_CACertificatePath").val(certInfo.path||"");$("#LDAP_CACertificateFingerprintSHA256").val(certInfo.fingerprint||"");LDAP_CERTIFICATE_STATE.BROWSED_FILE_PATH=certInfo.path;LDAP_CERTIFICATE_STATE.BROWSED_FINGERPRINT=certInfo.fingerprint;}function OnCACertificateResponse(XMLDoc){var certificateInfoTemplateFields=[{name:"$LDAP_SERIAL_NUMBER$",value:"SerialNumber"},{name:"$LDAP_SIGNATURE_ALGORITHM$",value:"SignatureAlgorithm"},{name:"$LDAP_PUBLIC_KEY_ALGORITHM$",value:"PublicKeyAlgorithm"},{name:"$LDAP_ORGANIZATION$",value:"IssuerOrganization"},{name:"$LDAP_LOCATION$",value:"IssuerLocation"},{name:"$LDAP_ORGANIZATION$",value:"SubjectOrganization"},{name:"$LDAP_LOCATION$",value:"SubjectLocation"},{name:"$LDAP_VALID_FROM$",value:"ValidityFrom"},{name:"$LDAP_VALID_TO$",value:"ValidityTo"},{name:"SHA-256",value:"FingerprintSHA256"},{name:"SHA-1",value:"FingerprintSHA1"},{name:"CA certificate path",value:"CAFilePath"}];var nResult=GetXMLValueInt(XMLDoc,"result");var sFingerprint256=GetXMLValue(XMLDoc,"FingerprintSHA256");var sCAFilePath=GetXMLValue(XMLDoc,"CAFilePath");BusyDialog(false);if(nResult===0){var certificationInfoTemplate=getReceivedCertificateInfoTemplate(XMLDoc,certificateInfoTemplateFields);ConfirmDialog(certificationInfoTemplate,OnConfirmedCACertificatePath,null,{path:sCAFilePath,fingerprint:sFingerprint256},650);}else{var errorMessage=GetXMLValue(XMLDoc,"ResultText");updateCertificateDownloadError(errorMessage);}}function getReceivedCertificateInfoTemplate(XMLDoc,fields){var info=fields.reduce(function(acc,currentVal){acc[currentVal.value]={name:currentVal.name,value:GetXMLValue(XMLDoc,currentVal.value)};return acc;},{});var template="<div style=\"padding-right: 5px; padding-bottom: 10px;\">"+"<h4 style=\"margin-top: 0;\">$LDAP_VALIDATE$</h4>"+"<div>"+"<span><b>"+info.SerialNumber.name+": </b></span>"+"<span>"+info.SerialNumber.value+"</span>"+"</div><br />"+"<div>"+"<span><b>$LDAP_ALGORITHMS$</b></span><br />"+"<span>"+info.SignatureAlgorithm.name+": "+info.SignatureAlgorithm.value+"</span><br />"+"<span>"+info.PublicKeyAlgorithm.name+": "+info.PublicKeyAlgorithm.value+"</span>"+"</div><br />"+"<div><span><b>$LDAP_ISSUER$</b></span><br />"+"<span>"+info.IssuerOrganization.name+": "+info.IssuerOrganization.value+"</span><br />"+"<span>"+info.IssuerLocation.name+": "+info.IssuerLocation.value+"</span>"+"</div><br />"+"<div><span><b>$LDAP_SUBJECT$</b></span><br />"+"<span>"+info.SubjectOrganization.name+": "+info.SubjectOrganization.value+"</span><br />"+"<span>"+info.SubjectLocation.name+": "+info.SubjectLocation.value+"</span>"+"</div><br />"+"<div><span><b>$LDAP_VALIDITY_PERIOD$</b></span><br />"+"<span>"+info.ValidityFrom.name+": "+info.ValidityFrom.value+"</span><br />"+"<span>"+info.ValidityTo.name+": "+info.ValidityTo.value+"</span>"+"</div><br />"+"<div><span><b>$LDAP_FINGERPRINTS$</b></span><br />"+"<span>"+info.FingerprintSHA1.name+": "+info.FingerprintSHA1.value+"</span><br />"+"<span>"+info.FingerprintSHA256.name+": "+info.FingerprintSHA256.value+"</span><br />"+"</div><br />"+"<div>"+"<span><b>$LDAP_FILE_PATH$:</b></span>"+"<span>"+info.CAFilePath.value+"</span>"+"</div><br /><br />"+"<div>"+"<span><b>$LDAP_CONFIRM_QUESTION$</b></span>"+"</div>"+"</div>";return template;}function updateCertificateDownloadError(message){if(message&&message.length){caCertificateError.innerHTML=message;caCertificateError.classList.remove("Hidden");}else{caCertificateError.innerHTML="";caCertificateError.classList.add("Hidden");}}function OnBrowseCACertificate(sFilePath){if(sFilePath==undefined||sFilePath==""){console.log("Please select CA certificate location");return;}HideDialog("BrowseDialog");var sGetTLSCertificateInfoCmd="%ADMIN_FILE%XML/ResultTLSCertificateInfo.xml%OBJECT_COMMAND_REF%CDomain.%ID%.GetTLSCertificateInfo";var GetTLSCertificateInfoRequest=CreatePostRequest(sGetTLSCertificateInfoCmd,OnCACertificateResponse);GetTLSCertificateInfoRequest.setParameter("TLSCertificatePath",Trim(sFilePath));GetTLSCertificateInfoRequest.request();updateCertificateDownloadError();BusyDialog(true);}function OnDownloadCACert(sFilePath){if(sFilePath==undefined||sFilePath==""){console.log("Please select CA certificate location");return;}HideDialog("BrowseDialog");var sDownloadCACertificateCmd="%ADMIN_FILE%XML/ResultTLSCertificateInfo.xml%OBJECT_COMMAND_REF%CDomain.%ID%.DownloadCACertificate";var DownloadCACertificateRequest=CreatePostRequest(sDownloadCACertificateCmd,OnCACertificateResponse);DownloadCACertificateRequest.setParameter("TLSCertificatePath",Trim(sFilePath));DownloadCACertificateRequest.setParameter("TLSServerHost",Trim(LDAPServerHost.value));DownloadCACertificateRequest.setParameter("TLSServerPort",Trim(LDAPServerPort.value));DownloadCACertificateRequest.request();updateCertificateDownloadError();BusyDialog(true);}function OnLdapTestUserResponse(XMLDoc){var LDAP_USER_NOT_FOUND=1303;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sErrorCode=GetXMLValue(XMLDoc,"ErrorCode");var sUserName=GetXMLValue(XMLDoc,"UserName");var sEmail=GetXMLValue(XMLDoc,"Email");var sGroup=GetXMLValue(XMLDoc,"Group");var outputResult;var bConnectionOK=false;if(nResult==46){AlertDialog(sResultText);return;}if(nResult==0){outputResult="$LDAP_TEST_USER_SUCCEED$";if(sUserName==undefined)sUserName="";if(sGroup==undefined)sGroup="";if(sEmail==undefined)sEmail="";var alertResult="$LDAP_TEST_USER_SUCCEED_INFO$";alertResult=alertResult.replace("$UserName",sUserName);alertResult=alertResult.replace("$Email",sEmail);alertResult=alertResult.replace("$Group",sGroup);AlertDialog(alertResult);bConnectionOK=true;}else if(nResult==LDAP_USER_NOT_FOUND){bConnectionOK=false;var sHint;var sLoginIDMap=document.getElementById("LDAPLoginID").value;if(sLoginIDMap=="")sLoginIDMap="userPrincipalName";var sLDAPSearchFilter=LDAPSearchFilter.value;if(sLDAPSearchFilter.indexOf(sLoginIDMap)<0){sHint=" $LDAP_TEST_USER_NOT_FOUND_MAPLOGIN_MISSED$";}else{sHint=" $LDAP_TEST_USER_NOT_FOUND$";}sHint=sHint.replace("$LoginIDAttr",sLoginIDMap);outputResult=sResultText+sHint;}else{bConnectionOK=false;outputResult=HandleLDAPErrorResponse(XMLDoc,nResult,sResultText);}ShowTestUserResult(bConnectionOK,outputResult);}function OnToggleCertificateOption(e){var certificateRadio=document.getElementById("LDAP_ldapCertificateType");var radioButtons=certificateRadio.querySelectorAll('input[type=radio]');var checkedRadioButton;for(var i=0;i<radioButtons.length;i++){if(radioButtons[i].checked){checkedRadioButton=radioButtons[i];}}var certificatePath=document.getElementById("ldapCertificatePath");certificateRadio.value=checkedRadioButton.value;ToggleCertificateSource(certificatePath,checkedRadioButton);}function clearLdapPathIfDefault(){if(IS_WINDOWS_OS)return;var certificateRadio=document.getElementById("LDAP_ldapCertificateType");var radioButtons=certificateRadio.querySelectorAll('input[type=radio]');var checkedRadioButton;for(var i=0;i<radioButtons.length;i++){if(radioButtons[i].checked){checkedRadioButton=radioButtons[i];}}if(checkedRadioButton.value==="0"){LDAPCACertificatePath.value="";LDAPCACertFingerprintSHA256.value="";}if(checkedRadioButton.value==="2"){LDAP_CERTIFICATE_STATE.BROWSED_FILE_PATH="";LDAP_CERTIFICATE_STATE.BROWSED_FINGERPRINT="";}}function ToggleCertificateSource(certificatePath,checkedRadioButton){var isBrowse=checkedRadioButton.id==="browseCertificate";var isDefault=checkedRadioButton.id==="defaultCertificateLocation";var pathInput=$(certificatePath).find("#LDAP_CACertificatePath");var fingerprintInput=$(certificatePath).find("#LDAP_CACertificateFingerprintSHA256");if(isDefault){certificatePath.classList.add("Hidden");certificatePath.classList.remove("Flex");pathInput.val("");fingerprintInput.val("");return;}certificatePath.classList.remove("Hidden");certificatePath.classList.add("Flex");if(isBrowse){certificatePath.querySelector("#BrowseLDAPCAPath").classList.remove("Hidden");certificatePath.querySelector("#PickLDAPCAPath").classList.add("Hidden");pathInput.val(LDAP_CERTIFICATE_STATE.BROWSED_FILE_PATH);fingerprintInput.val(LDAP_CERTIFICATE_STATE.BROWSED_FINGERPRINT);}else{certificatePath.querySelector("#BrowseLDAPCAPath").classList.add("Hidden");certificatePath.querySelector("#PickLDAPCAPath").classList.remove("Hidden");pathInput.val("");fingerprintInput.val("");}}function OnLDAPBrowseDN(){OnBrowseDNShow();}var LDAPServerEnabledCheck=document.getElementById("LDAPServerEnabled");var LDAPSecureServerEnabledCheck=document.getElementById("LDAPSecureServerEnabled");var bShowHideAdvanced=true;var LDAPServerPort=document.getElementById("LDAP_Port");var LDAPServerHost=document.getElementById("LDAPServerHost");var LDAPServerConnectionAccount=document.getElementById("LDAPServerConnectionAccount");var LDAPServerConnectionPwd=document.getElementById("LDAPServerConnectionPassword");var LDAPTestLogin=document.getElementById("LDAPTestLogin");var LDAPTestPassword=document.getElementById("LDAPTestPassword");var LDAPDescription=document.getElementById("LDAPDescription");var LDAPServerBase=document.getElementById("LDAPBaseDN");var LDAPSearchFilter=document.getElementById("LDAPearchFilter");var LDAPDetectionResult=document.getElementById("ResultLabel");var LDAPTestUserResult=document.getElementById("ResultTestLabel");var LDAPServerIDField=document.getElementById("LDAPServerIDField");var caCertificateError=document.querySelector(".LdapCertificate__error-message");var LDAPCACertificatePath=document.getElementById("LDAP_CACertificatePath");var LDAPCACertFingerprintSHA256=document.getElementById("LDAP_CACertificateFingerprintSHA256");var LDAPCACertificateChoiseType=parseInt("%CLDAPServer.%ID%.CACertificateChoiseType%");var BrowseDNButton=CreatePushButton("","BrowseDNButton",OnLDAPBrowseDN,undefined,undefined);BrowseDNButton.setControlImage("Browse");CreatePushButton("$SAVE_BUTTON$","SaveLDAPServerButton",OnSaveLDAPServer,85,25,undefined,undefined,"button_green");CreatePushButton("$CANCEL_BUTTON$","CancelLDAPServerButton",OnCancelLDAPServer,85,25);CreatePushButton("$LDAP_TEST_CONNECTION_BUTTON$","TestLDAPConnectionButton",OnDetectAndTestConnection,"auto",25,undefined,undefined,"button_blue");CreatePushButton("$LDAP_TEST_LOGIN_BUTTON$","TestLDAPLoginButton",OnTestUser,"auto",25,undefined,undefined,"button_blue");CreatePushButton("$LDAP_BROWSE$","BrowseLDAPCAPath",LoadDynamicContentAndRun,undefined,25,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnBrowseCACertificate,false]],undefined,"button_blue");CreatePushButton("$LDAP_RETRIEVE$","PickLDAPCAPath",LoadDynamicContentAndRun,undefined,25,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnDownloadCACert,undefined,undefined,true]],undefined,"button_blue");var TOOLTIP_SHOW_DELAY_IN_MILLIS=1000;var TOOLTIP_SHOW_DURATION_IN_MILLIS=500;var TOOLTIP_HIDE_IN_MILLIS=10;var passwordContainers=$(".password-container");passwordContainers.each(function(i,pswdCont){initNativePasswordTypeToggler(pswdCont);});function OnToggleSecureLDAP(){var label=document.getElementById('LDAPWarningText');var CACertDiv=document.getElementById("LDAPCACertificateDiv");if(LDAPSecureServerEnabledCheck.checked){LDAPServerPort.value=636;label.style.display="none";if(!IS_WINDOWS_OS)CACertDiv.style.display="block";}else{LDAPServerPort.value=389;label.style.display="block";if(!IS_WINDOWS_OS)CACertDiv.style.display="none";}}$(document).tooltip({"tooltipClass":"mycustomTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_IN_MILLIS,"delay":TOOLTIP_HIDE_IN_MILLIS },position:{my:"left top",at:"left bottom+5"}});$("#TestLDAPConnectionButton, #TestLDAPLoginButton , #BrowseDNButton").tooltip({"show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,
"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },position:{my:"left top",at:"left bottom+10"}});$("#LDAPServerHost").tooltip({"show":{"effect":"fade","delay":TOOLTIP_SHOW_DELAY_IN_MILLIS,"duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,},position:{my:"left top",at:"left bottom+5"}});$(document).ready(function(){$(".LDAPDialogDescription").append("<a href=http://www.serv-u.com/kb/ >$MORE_INFORMATION$</a>");$(".LdapShowAdvancedOptions").click(function(){ShowHideAdvanced();});});</script><div id="UserOrgDialoginner" style="display:none;"><form method="post" name="UserOrgForm" onsubmit="return (false);"><table style="padding:0;margin:0;"><tr><td style="vertical-align:top;width:200px;">$ORG_NAME$:<div style="overflow:auto"><span id="Org_Description"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="SaveOrgButton"></span><span id="CancelOrgButton"></span></td></tr></table></form></div><div id="ODBCUserOrgDialoginner" style="display:none;"><form method="post" name="ODBCUserOrgForm" onsubmit="return (false);"><table style="padding:0;margin:0;"><tr><td style="vertical-align:top;width:200px;">$ORG_NAME$:<div style="overflow:auto"><span id="OrgODBC_Description"></span></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;"><span id="SaveODBCOrgButton"></span><span id="CancelODBCOrgButton"></span></td></tr></table></form></div><script type="text/javascript" language="javascript">BuildDialog("$USER_ORG_PROPERTIES$","UserOrgDialog","300","100","","$CLOSE_CANCEL$");BuildDialog("$USER_ORG_PROPERTIES$","ODBCUserOrgDialog","300","100","","$CLOSE_CANCEL$");var OrgNameInput=CreateInputField("","Org_Description","Description",undefined,175,undefined,false,OnSaveCollection);CreateDialogPushButton("$SAVE_BUTTON$","SaveOrgButton",OnSaveCollection);CreateDialogPushButton("$CANCEL_BUTTON$","CancelOrgButton",OnCancelUserOrgDialog);var ODBCOrgNameInput=CreateInputField("","OrgODBC_Description","ODBC_Description",undefined,175,undefined,false,OnSaveODBCCollection);CreateDialogPushButton("$SAVE_BUTTON$","SaveODBCOrgButton",OnSaveODBCCollection);CreateDialogPushButton("$CANCEL_BUTTON$","CancelODBCOrgButton",OnCancelODBCUserOrgDialog);var g_bNewOrg=false,g_bNewODBCOrg=false;function OnAddCollection(){g_bNewOrg=true;UsersList.OnAddObject("Organization.xml%DEFAULT_OBJECT_REF%CDomain.%ID%.Organization","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.Organization",document.UserOrgForm,"UserOrgDialog",[OnLoadOrganization],g_bReadOnlyAccess);}function OnAddODBCCollection(){g_bNewODBCOrg=true;ODBCUsersList.OnAddObject("Organization.xml%DEFAULT_OBJECT_REF%CDomain.%ID%.ODBCOrganization","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.ODBCOrganization",document.ODBCUserOrgForm,"ODBCUserOrgDialog",[OnLoadODBCOrganization],g_bReadOnlyAccess);}function OnRenameCollection(){if(g_nCurrentUserOrg!=g_nDefaultOrgID){g_bNewOrg=false;UsersList.OnEditObject("Organization.xml","Result.xml%OBJECT_COMMAND_REF%C"+g_sOrganizationType+"."+g_nCurrentUserOrg+".Rename&StaticOnly=1",document.UserOrgForm,"UserOrgDialog","","",[OnLoadOrganization],false,g_nCurrentUserOrg,undefined,true);}else AlertDialog("$NO_RENAME_GENERAL_ORG$");}function OnRenameODBCCollection(){if(g_nCurrentODBCUserOrg!=g_nDefaultODBCOrgID){g_bNewODBCOrg=false;ODBCUsersList.OnEditObject("Organization.xml","Result.xml%OBJECT_COMMAND_REF%C"+g_sOrganizationType+"."+g_nCurrentODBCUserOrg+".Rename",document.ODBCUserOrgForm,"ODBCUserOrgDialog","","",[OnLoadODBCOrganization],false,g_nCurrentODBCUserOrg,undefined,true);}else AlertDialog("$NO_RENAME_GENERAL_ORG$");}function OnLoadOrganization(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("UserOrgDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}OrgNameInput.setControlText(document.getElementById(OrgNameInput.getContent("box/text").getId()).value);OrgNameInput.getContent("box/text").element().focus();}function OnLoadODBCOrganization(Grid,XMLTable){var aNodes=[];var aNodesResultTxt=[];var sVal="";var sResultTextVal="";if((aNodes=XMLTable.GetCollectionByAttrib("var","name","Result"))&&(aNodes.length)&&((sVal=XMLTable.GetNodeValue(aNodes[0],"val"))!="0")){aNodesResultTxt=XMLTable.GetCollectionByAttrib("var","name","ResultText");sResultTextVal=XMLTable.GetNodeValue(aNodesResultTxt[0],"val");HideDialog("ODBCUserOrgDialog");AlertDialog(GetResultText(0,"",sResultTextVal),true);return;}ODBCOrgNameInput.setControlText(document.getElementById(ODBCOrgNameInput.getContent("box/text").getId()).value);ODBCOrgNameInput.getContent("box/text").element().focus();}function OnDeleteCollection(){if(g_nCurrentUserOrg!=g_nDefaultOrgID)ConfirmDialog("$ORG_DELETE_CONFIRM$",OnConfirmDeleteCollection,undefined,undefined,undefined,undefined,true);else AlertDialog("$NO_DELETE_GENERAL_ORG$");}function OnDeleteODBCCollection(){if(g_nCurrentODBCUserOrg!=g_nDefaultODBCOrgID)ConfirmDialog("$ORG_DELETE_CONFIRM$",OnConfirmDeleteODBCCollection,undefined,undefined,undefined,undefined,true);else AlertDialog("$NO_DELETE_GENERAL_ORG$");}function OnConfirmDeleteCollection(){var objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%CDomain.%ID%.Organization");if(objRequest){var asItems=[];UnloadOrganization(g_nCurrentUserOrg);objRequest.setParameter("IDs",g_nCurrentUserOrg);objRequest.request(null);CollectionCombo.setTimeout(function(){for(var nIndex=1;nIndex<CollectionCombo.getItemCount();nIndex++){if(CollectionCombo.getItemValue(nIndex)!=g_nCurrentUserOrg){asItems.push([CollectionCombo.getItemText(nIndex),CollectionCombo.getItemValue(nIndex)]);}}UpdateOrganizations(asItems,CollectionCombo,g_nCurrentUserOrg,g_nDefaultOrgID,"$GENERAL_USERS_NAME$");});}}function OnConfirmDeleteODBCCollection(){var objRequest=CreatePostRequest(g_sAdminXMLPath+"Result.xml%DELETE_OBJECT_REF%CDomain.%ID%.Organization");if(objRequest){var asItems=[];UnloadOrganization(g_nCurrentODBCUserOrg,"ODBCOrganization");objRequest.setParameter("IDs",g_nCurrentODBCUserOrg);objRequest.request(null);ODBCCollectionCombo.setTimeout(function(){for(var nIndex=1;nIndex<ODBCCollectionCombo.getItemCount();nIndex++){if(ODBCCollectionCombo.getItemValue(nIndex)!=g_nCurrentODBCUserOrg){asItems.push([ODBCCollectionCombo.getItemText(nIndex),ODBCCollectionCombo.getItemValue(nIndex)]);}}UpdateOrganizations(asItems,ODBCCollectionCombo,g_nCurrentODBCUserOrg,g_nDefaultODBCOrgID,"$GENERAL_ODBC_USERS$");});}}function OnSaveCollection(){if(Trim(document.getElementById(OrgNameInput.getContent("box/text").getId()).value)!=""){setTimeout(function(){UsersList.OnSaveObject(OnNewCollectionSaved);},500);}else AlertDialog("$EMPTY_ORG_NAME$");}function OnSaveODBCCollection(){if(Trim(document.getElementById(ODBCOrgNameInput.getContent("box/text").getId()).value)!=""){setTimeout(function(){ODBCUsersList.OnSaveObject(OnNewODBCCollectionSaved);},500);}else AlertDialog("$EMPTY_ORG_NAME$");}function OnCancelUserOrgDialog(){HideDialog("UserOrgDialog");}function OnCancelODBCUserOrgDialog(){HideDialog("ODBCUserOrgDialog");}function OnNewCollectionSaved(nObjectID){var sOrgName=FormatClientString(document.getElementById(OrgNameInput.getContent("box/text").getId()).value,true);var asItems=[];for(var nIndex=1;nIndex<CollectionCombo.getItemCount();nIndex++){if(!g_bNewOrg&&(CollectionCombo.getItemValue(nIndex)==nObjectID))sCollText=sOrgName;else sCollText=CollectionCombo.getItemText(nIndex);asItems.push([sCollText,CollectionCombo.getItemValue(nIndex)]);}if(g_bNewOrg){asItems.push([sOrgName,nObjectID]);}else{CollectionCombo.setControlText(sOrgName);CollectionCombo.setControlValue(nObjectID);}UpdateOrganizations(asItems,CollectionCombo,g_nCurrentUserOrg,g_nDefaultOrgID,"$GENERAL_USERS_NAME$");if(g_bNewOrg)SelectOrganization(CollectionCombo,nObjectID);}function OnNewODBCCollectionSaved(nObjectID){var sOrgName=FormatClientString(document.getElementById(ODBCOrgNameInput.getContent("box/text").getId()).value,true);var asItems=[];for(var nIndex=1;nIndex<ODBCCollectionCombo.getItemCount();nIndex++){if(!g_bNewODBCOrg&&(ODBCCollectionCombo.getItemValue(nIndex)==nObjectID))sCollText=sOrgName;else sCollText=ODBCCollectionCombo.getItemText(nIndex);asItems.push([sCollText,ODBCCollectionCombo.getItemValue(nIndex)]);}if(g_bNewODBCOrg){asItems.push([sOrgName,nObjectID]);}else{ODBCCollectionCombo.setControlText(sOrgName);ODBCCollectionCombo.setControlValue(nObjectID);}UpdateOrganizations(asItems,ODBCCollectionCombo,g_nCurrentODBCUserOrg,g_nDefaultODBCOrgID,"$GENERAL_ODBC_USERS$");if(g_bNewODBCOrg)SelectOrganization(ODBCCollectionCombo,nObjectID);}</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--></head><body><script type="text/javascript" language="JavaScript">document.addEventListener('DOMContentLoaded',function(){var createServerIdentityContainer=document.getElementById("CreateServerIdentity");if(g_bSysAdmin&&g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY_FOR_READONLY_SYSADMIN$</a></div>';}if(g_bSysAdmin&&!g_bReadOnlyAccess){createServerIdentityContainer.innerHTML='<div><a onclick="javascript:navigateToServerIdentityTab(); return false;" target="_blank" id="CreateServerIdentityTxt" class="CreateSITxt"><span id="CreateSI"></span>$CLICK_TO_CREATE_SERVER_IDENTITY$</a></div>';}});</script><div id="container"><div id="MC-logo" style="overflow:visible;"><div id="sulogo-div"><div class="header-logo-container"><a href="javascript:LoadConsolePage('%ADMIN_FILE%', true)"><img src="%COMMON_FILE%Images/swlogo.png" id="SWLOGO" style="border:none;" alt="$CONSOLE_TITLE$"/></a></div><div class="sulogo-prodname"><strong style="font-size:12pt; margin-right: 8px;">%PRODUCT%</strong><span style="font-size:10pt;">$MANAGEMENT_CONSOLE$</span></div></div><div id="TrialExpire" style="display:none;"><div><a href="https://ecomm.solarwinds.com/onepagecheckout/Servu?sku=7205&CMPSource=SERVUSITE#/" target="_blank" id="TrialExpireTxt" class="DaysExpireTxt"><span id="TrialExpireDays"></span>$DAYS$ $TRIAL_EXPIRES_IN$. $BUY_NOW$</a></div></div><div id="CreateServerIdentity" style="display:none;"></div><div class="header-user-block"><span class="head-item head-user"><span id="UserOptBtn" class="menu-toggle"><span class="head-icon"></span><span id="CurrentlyLoggedIn" style="font-weight:bold;"></span></span></span><span class="head-item head-help"><a href="javascript:MainHelp();"><span class="head-icon"></span></a></span><span class="head-item head-menu"><span id="ManConNavBarJumpToList" class="menu-toggle"><span class="head-icon"></span></span></span></div></div><noscript><center><p>$NO_SCRIPT_TEXT$</p></center></noscript><div class="maincontent" ><div id="leftCol-Contain"><div id="leftCol-Nav"><div class="menu-nav" id="MenuListNav"><ul id="nav"><li id="navmenuserver-global" style="display:none;"><a id="navmenuserver-global-href" href="#"><div><span class="navDomain icon"></span><span class="navDomain text">$GLOBAL$</span></div></a><ul><li data-active='6' class='activetab'><a id="navmenuserver-global-dashboard-href" href="javascript:LoadConsolePage('%ADMIN_FILE%')"><span></span>$DASHBOARD$</a></li><li data-active='0' class='activetab'><a id="navmenuserver-global-details-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%Server.htm', 1,0,true);">$SERVERDETAILS$</a></li><li data-active='1' class='activetab'><a id="navmenuserver-global-users-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerUsers.htm', 1,1,true);">$USERS$</a></li><li data-active='2' class='activetab'><a id="navmenuserver-global-groups-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerGroups.htm', 1,2,true);">$GROUPS$</a></li><li data-active='3' class='activetab'><a id="navmenuserver-global-dirs-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerDir.htm', 1,3,true);">$DIRECTORIES$</a></li><li data-active='4' class='activetab'><a id="navmenuserver-global-limits-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerLimits.htm', 1,4,true);">$LIMITS$</a></li><li data-active='5' class='activetab'><a id="navmenuserver-global-activity-href" href="javascript:SubmitServerNavFrame('%ADMIN_FILE%ServerActivity.htm', 1,5,true);">$SERVERACTIVITY$</a></li></ul></li><li id="navmenuserver-DomainStart" class="NavDomainStart"><span class="navHeadTxtWhite">$DOMAINS$ <span id="DomainStart-Count"></span></span></li><div class="nav-add-domain"><a id="AddDomain-btn" href="javascript:OnShowDomainWizard();" style="align-items: center;"><img src="%COMMON_FILE%Images/add_domain_icon.png" width="20px" height="20px" alt="$NEW_DOMAIN_BUTTON$" title="$NEW_DOMAIN_BUTTON$" border="0" /><span id="brdcrumb-main" class="navHeadTxtWhite">$NEW_DOMAIN$</span></a></div></ul><div id="nav-loading" style="width:230px;text-align:center;"><img src='%COMMON_FILE%Images/domain-load.gif' alt='$LOADING_DOMAINS$' border='0' style="margin:0 auto;"/></div></div><div class="TreeInfoBox"><div style="min-height:400px; display: flex; flex-direction: column; flex-grow: 1; justify-content: flex-end"><div id="MaintContainUpdate" class="MaintInfoBox"><span class="TreeInfoBox__text-panel">$LATEST_UPDATE$</span><div id="SU-UpdateInfo" style="margin-top:10px;color:#333333;">$NO_UPDATE$</div></div><div id="MaintContain" class="MaintInfoBox"><div class="TreeInfoBox__text-secondary">$MAINTENANCE_ENDS$:</div><div class="TreeInfoBox__text-default" id="MaintDaybox"><span id="MaintDays"></span> $DAYS$, <span id="MaintDate"></span></div></div></div></div></div><div class="content-container"><div class="breadcrumb-container"><div style="display:inline-block;padding-left:15px"><span id="breadcrumb"></span></div></div><div id="TreeCol"><div class="MainHeaderInfo" style="vertical-align:top"><img src="%ADMIN_FILE%Images/User2-32.png" width="32" height="32" class="tab-header" alt="$DOMAIN_USERS_INFO$" /><strong>$USERS$</strong> - $DOMAIN_USERS_INFO$</div><br style="clear:both" /><span id="PageTabs"></span><div id="TabsContent" class="tabs-content"><div id="UsersTab" style="display:none"><div class="layercontent"><div class="ie6positionfix"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$USERS$" src="%ADMIN_FILE%Images/UsersEdit32.png" width="32" height="32"/></td><td style="vertical-align:top;">$DOMAIN_USERS_TAB_DESCRIPTION$</td></tr></table><div><div style="clear:both;margin-bottom:5px;"><span id="CollectionGroup" style="float:left;margin-right:10px;"><div style="padding-left:5px;"><span id="UserCollection"></span><span style="padding-left:15px;"><span id="AddCollection"></span><span id="RenameCollection"></span><span id="DeleteCollection"></span></span>&nbsp;&nbsp;&nbsp;<span id="ImportUsersButton"></span><span id="ExportUsersButton"></span></div></span><span id="FilterGroup" style="float:left;"><div style="padding-left:5px;"><div style="overflow:auto"><span id="UserFilterInput"></span><span style="padding-left:15px;"><span id="UserFilterClearButton"></span></span></div></div></span></div><div style="clear:both;text-align:right;" id="TotalUsersDiv">&nbsp;</div><div id="UsersListContainer" data-load="true"><span id="UsersList"></span></div><div style="padding:5px 0 5px 0; white-space:nowrap;"><span id="RecoverPassword" style="float:right;display:none;"></span><span id="AddUserButton"></span><span id="EditUserButton"></span><span id="DeleteUserButton"></span>&nbsp;&nbsp;&nbsp;<span id="CopyUserButton"></span>&nbsp;&nbsp;&nbsp;<span id="MoveUserButton"></span>&nbsp;&nbsp;&nbsp;<span id="UserWizardButton"></span>&nbsp;&nbsp;&nbsp;<span id="DefaultNewUser"></span></div></div></div></div></div><div id="ODBCUsersTab" style="display:none"><div class="layercontent"><div class="ie6positionfix"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$USERS$" src="%ADMIN_FILE%Images/UsersEdit32.png" width="32" height="32"/></td><td style="vertical-align:top;">$ODBC_USERS_TAB_INFO$</td></tr></table><div id="ODBCUsersTabContent"><div style="clear:both;margin-bottom:5px;"><span id="ODBCCollectionGroup" style="float:left;margin-right:10px;"><div style="padding-left:5px;"><span id="ODBCUserCollection"></span><span style="padding-left:15px;"><span id="AddODBCCollection"></span><span id="RenameODBCCollection"></span><span id="DeleteODBCCollection"></span></span>&nbsp;&nbsp;&nbsp;<span id="ImportODBCUsersButton"></span><span id="ExportODBCUsersButton"></span></div></span><span id="DBFilterGroup" style="float:left;"><div style="padding-left:5px;"><div style="overflow:auto"><span id="DBUserFilterInput"></span><span style="padding-left:15px;"><span id="DBUserFilterClearButton"></span></span></div></div></span></div><div style="clear:both;text-align:right;" id="ODBCTotalUsersDiv">&nbsp;</div><div id="ODBCUsersListContainer" data-load="true"><span id="ODBCUsersList"></span></div><div style="padding:5px 0 5px 0; white-space:nowrap;"><span id="ODBCRecoverPassword" style="float:right;display:none;"></span><span id="AddODBCUserButton"></span><span id="EditODBCUserButton"></span><span id="DeleteODBCUserButton"></span>&nbsp;&nbsp;&nbsp;<span id="CopyODBCUserButton"></span>&nbsp;&nbsp;&nbsp;<span id="MoveUserOrgODBCButton"></span>&nbsp;&nbsp;&nbsp;<span id="ODBCUserWizardButton"></span>&nbsp;&nbsp;&nbsp;<span id="ODBCDefaultNewUser"></span></div></div><div style="text-align:center;" id="ODBCUsersTabContentContainer"><div id="ODBCUsersTabContentNone" class="UpgradeLicenseMsg"><img id="ODBCUsersTabContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="ODBCUsersTabContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div></div><div id="WindowsAuthTab" style="display:none"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$WINDOWS_AUTH_TAB_NAME$" src="%ADMIN_FILE%Images/WinAuth32.png" width="32" height="32"/></td><td style="vertical-align:top;">$WINDOWS_AUTH_TAB_INFO$</td></tr></table><div id="WindowsAuthContent" style="padding-top:10px;"><span id="AllowNTLogin"></span><br /><div id="NTEnabledContent"><span id="NTUserUseGroupHomeDir"></span><br /><form name="WindowsAuthForm" onsubmit="return (false);"><div style="padding-top:5px;">$WINDOWS_DOMAIN_NAME$ ($OPTIONAL$):<div style="overflow:auto"><span id="NTDomain"></span> <span id="SaveNTDomain"></span></div></div></form><div style="padding:5px 0 5px 0;"><span id="WinGroupButton"></span>&nbsp;&nbsp;&nbsp;<span id="OUGroupButton"></span></div></div></div><div style="text-align:center;" id="WindowsAuthContentContainer"><div id="WindowsAuthContentNone" class="UpgradeLicenseMsg"><img id="WindowsAuthContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="WindowsAuthContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div><div id="LDAPAuthTab" style="display:none"><div class="layercontent"><table cellpadding="0" cellspacing="0"><tr><td style="vertical-align:top;padding-right:10px;"><img alt="$LDAP_AUTH_TAB_NAME$" src="%ADMIN_FILE%Images/LDAP32.png" width="32" height="32"/></td><td style="vertical-align:top;">$LDAP_AUTH_TAB_INFO$</td></tr></table><div id="LDAPAuthContent" style="padding-top:10px;"><span id="AllowLDAPLogin"></span><br /><div id="LDAPEnabledContent"><span id="LDAPUserUseGroupHomeDir"></span><br /><form name="LDAPAuthForm" onsubmit="return (false);"><div style="padding-top:5px;">$LDAP_LOGIN_ID_SUFFIX$:<div style="overflow:auto"><span id="LDAPLoginIDSuffix"></span> <span id="SaveLDAPLoginIDSuffix"></span></div></div></form><div style="padding-top:10px;"><span id="LDAPServersGroup"><table border="0" cellpadding="0" cellspacing="0"><tr><td style="width:100%;padding: 10px 8px 0 0;"><span id="LDAPServersList"><div class="busylist"><img src="%COMMON_FILE%Images/BusyGrid.gif" border="0"></div></span></td><td style="width:40px;text-align:center;"><span id="LDAPServersListTopArrow"></span><br /><span id="LDAPServersListUpArrow"></span><br /><br /><span id="LDAPServersListDownArrow"></span><br /><span id="LDAPServersListBottomArrow"></span></td></tr></table><div style="padding:5px 0 0 0;"><span id="AddLDAPServerButton"></span><span id="EditLDAPServerButton"></span><span id="RemoveLDAPServerButton"></span><span id="CopyLDAPButton"></span></div></span></div><div style="padding:5px 0 5px 0;"><span id="LDAPGroupButton"></span>&nbsp;&nbsp;&nbsp;<span id="LDAPGroupsButton"></span></div></div></div><div style="text-align:center;" id="LDAPAuthContentContainer"><div id="LDAPAuthContentNone" class="UpgradeLicenseMsg"><img id="LDAPAuthContentDisableImage" src="%COMMON_FILE%Images/Warn.png" width="32" height="32" alt="" class="UpgradeLicenseImg" /><div id="LDAPAuthContentBody">$LICENSE_DISABLED_FEATURE$<br /><br />$UPGRADE_LICENSE_NOTE$</div></div></div></div></div></div><script type="text/javascript" language="JavaScript">g_sHelpPage="Help-About-User-Accts.htm";g_sHelpNode="RootItem6";var g_nBubbleAttempt=0;var aUserTabMainHelpPages=["Help-About-User-Accts.htm","Help-About-User-Accts.htm","Help-Windows-Auth.htm"];if(g_bShowWindowsAuth&&g_bSysAdmin)aUserTabMainHelpPages=["Help-About-User-Accts.htm","Help-About-User-Accts.htm","Help-Windows-Auth.htm","Help-LDAP-Auth.htm"];else if(g_bSysAdmin)aUserTabMainHelpPages=["Help-About-User-Accts.htm","Help-About-User-Accts.htm","Help-LDAP-Auth.htm"];function OnAddUser(){g_bNewAccount=true;g_ActiveUserGrid.OnAddObject("User.xml%ADD_OBJECT_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User&Temp=1","Result.xml%UPDATE_OBJECT_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User.",document.UserForm,"UserDialog",[OnShowUserDialog,OnHideUserDialog]);ClearLoginLimits();}function OnEditUser(){var sLoginID=encodeURIComponent(g_ActiveUserGrid.getCellValue(0,g_ActiveUserGrid.getSelectedRows()));g_ActiveUserGrid.OnEditObject("User.xml?Command=CreateTempObject&Name="+sLoginID+"&Object=C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User.","Result.xml?Name="+sLoginID+"&Command=UpdateObject&Object=C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User.",document.UserForm,"UserDialog","$SELECT_ONLY_ONE_USER_EDIT$","$SELECT_ONE_USER_EDIT$",[OnShowUserDialog,OnHideUserDialog],true);ClearLoginLimits();}function OnCopyUser(){var sLoginID=encodeURIComponent(g_ActiveUserGrid.getCellValue(0,g_ActiveUserGrid.getSelectedRows()));g_ActiveUserGrid.OnCopyObject("User.xml?ClearLoginID=1&Command=CreateTempObject&Name="+sLoginID+"&Object=C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User.","Result.xml?Name="+sLoginID+"&Command=UpdateObject&Object=C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User.",document.UserForm,"UserDialog","$SELECT_ONLY_ONE_USER_COPY$","$SELECT_ONE_USER_COPY$",[OnShowUserDialog,OnHideUserDialog],true);}function OnDeleteUser(){g_ActiveUserGrid.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User","$ASK_DELETE_USER$","$SELECT_A_USER_TO_DELETE$",UserLicenseInfo,undefined,undefined,"$SESS_CANT_DELETE_SELF_STR$","Name");}function OnEditDefaultUser(){g_bEditUserTemplate=true;g_ActiveUserGrid.OnEditObject("User.xml?Command=CreateTempObject&Object=CDomain.%ID%.User.","Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.User.",document.UserForm,"UserDialog","","",[OnShowUserDialog,OnHideUserDialog],true,%CDomain.%ID%.DefaultUser.ID%);}function OnNewCollection(){CloseConfirmDialog();OnAddCollection();}function OnNewODBCCollection(){CloseConfirmDialog();OnAddODBCCollection();}function OnShowMoveUser(){var bODBCLicense=(parseInt("%CServer.%SERVER_ID%.ODBCLicense%")?true:false);var bODBCAvailable=(parseInt("%CDomain.%ID%.ODBCAvailable%")?true:false);if(parseInt(CollectionCombo.getItemCount())<=1&&parseInt(ODBCCollectionCombo.getItemCount())<=1&&(!bODBCLicense||!bODBCAvailable))ConfirmDialog("$NO_COLLECTION_TO_MOVE_TO$",OnNewCollection);else if((g_ActiveUserGrid.getSelectedRows()!="")&&(g_ActiveUserGrid.getSelectedRows()!=-1)){var asMoveItems=[];var asMoveItemVals=[];var asODBCMoveItems=[];var asODBCMoveItemVals=[];var bGotODBCColl=false,bGotColl=false;if("%CServer.%SERVER_ID%.ODBCLicense%"!="1")MoveUserRadio.setStyle("display","none");else if("%CDomain.%ID%.ODBCAvailable%"!="1")MoveUserRadio.setStyle("display","none");else MoveUserRadio.setStyle("display","inline");if(g_sOrganizationType=="ODBCOrganization")MoveUserRadio.setSelectedItems([0]);else MoveUserRadio.setSelectedItems([1]);for(var nIndex=0;nIndex<CollectionCombo.getItemCount();nIndex++){if(CollectionCombo.getItemValue(nIndex)!=g_nCurrentUserOrg||g_sOrganizationType=="ODBCOrganization"){asMoveItems.push(CollectionCombo.getItemText(nIndex));asMoveItemVals.push(CollectionCombo.getItemValue(nIndex));bGotColl=true;}}if(!bGotColl){MoveUserRadio.setSelectedItems([0]);MoveUserRadio.setStyle("display","none");}MoveUserCombo.setItemText(asMoveItems);MoveUserCombo.setItemValue(asMoveItemVals);MoveUserCombo.setControlText(asMoveItems[0]);MoveUserCombo.setControlValue(asMoveItemVals[0]);MoveUserCombo.setItemCount(asMoveItems.length);if(asMoveItems.length>1)MoveUserCombo.getPopupTemplate().setStyle("height",(asMoveItems.length<=10)?((16*asMoveItems.length)+((AW.ie)?3:0))+"px":"163px");else if(asMoveItems.length==1)MoveUserCombo.getPopupTemplate().setStyle("height",(((g_bFireFox4Browser)?"24px":"20px")));MoveUserCombo.setSelectedItems([0]);for(var nODBCIndex=0;nODBCIndex<ODBCCollectionCombo.getItemCount();nODBCIndex++){if(ODBCCollectionCombo.getItemValue(nODBCIndex)!=g_nCurrentODBCUserOrg||g_sOrganizationType!="ODBCOrganization"){asODBCMoveItems.push(ODBCCollectionCombo.getItemText(nODBCIndex));asODBCMoveItemVals.push(ODBCCollectionCombo.getItemValue(nODBCIndex));bGotODBCColl=true;}}if(!bGotODBCColl){MoveUserRadio.setSelectedItems([1]);MoveUserRadio.setStyle("display","none");}ODBCMoveUserCombo.setItemText(asODBCMoveItems);ODBCMoveUserCombo.setItemValue(asODBCMoveItemVals);ODBCMoveUserCombo.setControlText(asODBCMoveItems[0]);ODBCMoveUserCombo.setControlValue(asODBCMoveItemVals[0]);ODBCMoveUserCombo.setItemCount(asODBCMoveItems.length);if(asODBCMoveItems.length>1)ODBCMoveUserCombo.getPopupTemplate().setStyle("height",(asODBCMoveItems.length<=10)?((16*asODBCMoveItems.length)+((AW.ie)?3:0))+"px":"163px");else if(asODBCMoveItems.length==1)ODBCMoveUserCombo.getPopupTemplate().setStyle("height",(((g_bFireFox4Browser)?"24px":"20px")));ODBCMoveUserCombo.setSelectedItems([0]);g_bODBCCurrentOrg=false;ShowDialog("MoveUsersDialog");}else AlertDialog("$SELECT_USERS_TO_MOVE$");}function OnLoadOrganizations(sText){var asItems=[];this.responseDef(sText);for(var nIndex=0;nIndex<this.getCount();nIndex++){asItems.push([FormatClientString(this.getData(0,nIndex)),this.getData(1,nIndex)]);}UpdateOrganizations(asItems,CollectionCombo,g_nCurrentUserOrg,g_nDefaultOrgID,"$GENERAL_USERS_NAME$");}function OnLoadODBCOrganizations(sText){var asItems=[];this.responseDef(sText);for(var nIndex=0;nIndex<this.getCount();nIndex++){asItems.push([FormatClientString(this.getData(0,nIndex)),this.getData(1,nIndex)]);}UpdateOrganizations(asItems,ODBCCollectionCombo,g_nCurrentODBCUserOrg,g_nDefaultODBCOrgID,"$GENERAL_ODBC_USERS$");}function UpdateOrganizations(asItems,CollObj,nCurrenCollOrg,nDefaultCollOrg,sLabelText){var asLabels=[sLabelText];var asValues=[nDefaultCollOrg];asItems.sort(ArrayAlphaSort);for(var nIndex=0;nIndex<asItems.length;nIndex++){asLabels.push(asItems[nIndex][0]);asValues.push(asItems[nIndex][1]);}CollObj.setItemText(asLabels);CollObj.setItemValue(asValues);CollObj.setItemCount(asLabels.length);if(asLabels.length>1)CollObj.getPopupTemplate().setStyle("height",(asLabels.length<=10)?((16*asLabels.length)+((AW.ie)?3:0))+"px":"163px");else if(asLabels.length==1)CollObj.getPopupTemplate().setStyle("height",(((g_bFireFox4Browser)?"24px":"20px")));var bSelected=false;for(var nIndex=0;nIndex<CollObj.getItemCount();nIndex++){if(CollObj.getItemValue(nIndex)==nCurrenCollOrg){CollObj.setSelectedItems([nIndex]);bSelected=true;break;}}if(!bSelected)SelectOrganization(CollObj,nDefaultCollOrg);}function SelectOrganization(CollObj,nID){for(var nIndex=0;nIndex<CollObj.getItemCount();nIndex++){if(CollObj.getItemValue(nIndex)==nID){CollObj.setSelectedItems([nIndex]);CollObj.setControlText(CollObj.getItemText(nIndex));bSelected=true;break;}}if(!bSelected){CollObj.setSelectedItems([0]);CollObj.setControlText(CollObj.getItemText(0));if(CollObj==CollectionCombo)nID=g_nDefaultOrgID;else nID=g_nDefaultODBCOrgID;}if(CollObj==CollectionCombo)OnChangeCollection(nID);else OnChangeODBCCollection(nID);}function OnChangeCollection(sValue){var nNewID=parseInt(sValue);if(nNewID!=g_nCurrentUserOrg){LoadingDialog(true);RenameCollButton.setStyle("display",(nNewID==g_nDefaultOrgID)?"none":"");DeleteCollButton.setStyle("display",(nNewID==g_nDefaultOrgID)?"none":"");document.getElementById("CollectionGroupFS").style.width=(nNewID==g_nDefaultOrgID)?"$COLL_GROUP_WIDTH_1$px":"$COLL_GROUP_WIDTH_2$px";var sBrowserLanguageCheck=navigator.language?navigator.language:navigator.userLanguage;sBrowserLanguageCheck=sBrowserLanguageCheck.replace("-",",");if((sBrowserLanguageCheck.toLowerCase()=="zh,cn"||sBrowserLanguageCheck.toLowerCase()=="zh,tw")&&g_bFireFox3Browser)document.getElementById("CollectionGroupFS").style.width=parseInt(document.getElementById("CollectionGroupFS").style.width)+20;ClearGrid(UsersList);UsersList.ShowHideLoadingFilesMessage(true);UnloadOrganization(g_nCurrentUserOrg);UsersList.m_bSaving=true;UsersList.EnableUpdates(true,("ID="+g_nCurrentUserOrg),("ID="+nNewID),true);UsersList.setSortColumn(UsersList.saveColSortColumn);UsersList.setSortDirection(UsersList.saveSortDirection,UsersList.saveColSortColumn);g_nCurrentUserOrg=nNewID;g_nActiveUserOrg=nNewID;}}function OnChangeODBCCollection(sValue){var nNewID=parseInt(sValue);if(nNewID!=g_nCurrentODBCUserOrg){LoadingDialog(true);ODBCRenameCollButton.setStyle("display",(nNewID==g_nDefaultODBCOrgID)?"none":"");ODBCDeleteCollButton.setStyle("display",(nNewID==g_nDefaultODBCOrgID)?"none":"");
document.getElementById("ODBCCollectionGroupFS").style.width=(nNewID==g_nDefaultODBCOrgID)?"$COLL_GROUP_WIDTH_1$px":"$COLL_GROUP_WIDTH_2$px";var sBrowserLanguageCheck=navigator.language?navigator.language:navigator.userLanguage;sBrowserLanguageCheck=sBrowserLanguageCheck.replace("-",",");if((sBrowserLanguageCheck.toLowerCase()=="zh,cn"||sBrowserLanguageCheck.toLowerCase()=="zh,tw")&&g_bFireFox3Browser)document.getElementById("ODBCCollectionGroupFS").style.width=parseInt(document.getElementById("ODBCCollectionGroupFS").style.width)+20;ClearGrid(ODBCUsersList);ODBCUsersList.ShowHideLoadingFilesMessage(true);UnloadOrganization(g_nCurrentODBCUserOrg,g_sOrganizationType);ODBCUsersList.m_bSaving=true;ODBCUsersList.EnableUpdates(true,("ID="+g_nCurrentODBCUserOrg),("ID="+nNewID),true);ODBCUsersList.setSortColumn(ODBCUsersList.saveColSortColumn);ODBCUsersList.setSortDirection(ODBCUsersList.saveSortDirection,ODBCUsersList.saveColSortColumn);g_nCurrentODBCUserOrg=nNewID;g_nActiveUserOrg=nNewID;}}function UnloadOrganization(nOrgID,sOrganizationType){if(sOrganizationType==undefined)sOrganizationType="Organization";if(nOrgID>0){var objUnload=createAWHttpRequest("GET","%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+sOrganizationType+"."+nOrgID+".UnloadUsers");if(objUnload)objUnload.request();}}function OnCheckWindowsAuth(CheckBox){OnCheckBoxValueChanged(CheckBox);if(CheckBox.getControlValue()==false){document.getElementById("NTEnabledContent").style.display="none";}else{document.getElementById("NTEnabledContent").style.display="block";}}function OnCheckBoxValueChanged(CheckBox){CheckBoxValueChanged(CheckBox,"Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");}function OnSaveNTDomain(){var SaveDomainRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");SavingDialog(true);SaveDomainRequest.setParameter("NTDomain",document.WindowsAuthForm.NTDomain.value);SaveDomainRequest.setAsync(true);SaveDomainRequest.response=OnSaveComplete;SaveDomainRequest.request(null);return(false);}function OnCheckLDAPAuth(CheckBox){OnCheckBoxValueChanged(CheckBox);if(CheckBox.getControlValue()==false){document.getElementById("LDAPEnabledContent").style.display="none";}else{document.getElementById("LDAPEnabledContent").style.display="block";}}function OnSaveLDAPLoginIDSuffix(){var SaveLDAPLoginIDSuffixRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CServer.%SERVER_ID%.Domain.%ID%&StaticOnly=1");SavingDialog(true);SaveLDAPLoginIDSuffixRequest.setParameter("LDAPLoginIDSuffix",document.LDAPAuthForm.LDAPLoginIDSuffix.value);SaveLDAPLoginIDSuffixRequest.setAsync(true);SaveLDAPLoginIDSuffixRequest.response=OnSaveComplete;SaveLDAPLoginIDSuffixRequest.request(null);return(false);}function OnDynamicUserContentLoaded(){g_bUserContentLoaded=true;}function IsDynamicUserContentLoaded(){return(g_bUserContentLoaded);}function OnDelayLoadEditUser(){DelayLoadExecute([IsDynamicUserContentLoaded,OnEditUser]);}function OnChangeTab(nOldTab,nNewTab){var nLDAPTab=3;if(g_bShowWindowsAuth&&g_bSysAdmin)nLDAPTab=3;else if(g_bSysAdmin)nLDAPTab=2;switch(nOldTab){case(0):UsersList.EnableUpdates(false);break;case(1):ODBCUsersList.EnableUpdates(false);break;case(nLDAPTab):LDAPServersList.EnableUpdates(false);break;}switch(nNewTab){case(0):UsersList.EnableUpdates(true);g_nActiveUserOrg=g_nCurrentUserOrg;g_ActiveUserGrid=UsersList;g_ActiveRezizeGrid=g_ActiveUserGrid;g_sOrganizationType="Organization";g_bIsODBC=false;g_nGridOffSet=465;ResizeGrids(true);break;case(1):ODBCUsersList.EnableUpdates(true);g_bIsODBC=true;g_nActiveUserOrg=g_nCurrentODBCUserOrg;g_ActiveUserGrid=ODBCUsersList;g_ActiveRezizeGrid=g_ActiveUserGrid;g_sOrganizationType="ODBCOrganization";g_nGridOffSet=465;ResizeGrids(true);break;case(nLDAPTab):LDAPServersList.EnableUpdates(true);g_ActiveRezizeGrid=LDAPServersList;g_nGridOffSet=546;ResizeGrids(true);break;}g_sHelpPage=aUserTabMainHelpPages[nNewTab];}function OnRecoverPasswords(){if(parseInt("%CDomain.%ID%.CanEmail%")){if((g_ActiveUserGrid.getSelectedRows()!="")&&(g_ActiveUserGrid.getSelectedRows()!=-1)){var IDs=new Array();var CannotDecryptIDs=new Array();var bShowRecoverConfirm=false;SelectedCells=g_ActiveUserGrid.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var sLoginID=g_ActiveUserGrid.getCellValue(0,SelectedCells[nIndex]);var bCanDecrypt=g_ActiveUserGrid.getCellText(9,SelectedCells[nIndex]);if(parseInt(bCanDecrypt)==0){CannotDecryptIDs.push(sLoginID);bShowRecoverConfirm=true;}IDs.push(sLoginID);}if(bShowRecoverConfirm){ConfirmDialog("$CANNOT_DECRYPT_CONFIRM_MSG_1$ <BR><BR><strong>"+CannotDecryptIDs+"</strong><BR><BR>$CANNOT_DECRYPT_CONFIRM_MSG_2$",RecoverPasswords,undefined,IDs,"425","200");}else{RecoverPasswords(IDs,true);}}else AlertDialog("$SELECT_USERS_TO_RECOVER_PASSWORD$");}else AlertDialog("$NO_SMTP_CONFIG$");}function RecoverPasswords(aIDs,bNoConfirmReplace){var RecoverPasswordRequest=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%OBJECT_COMMAND_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".RecoverUserPassword");if(bNoConfirmReplace)SavingDialog(true);else ReplaceDialog("ConfirmDialog","BusyDialog");RecoverPasswordRequest.setParameter("IDs",aIDs);RecoverPasswordRequest.setAsync(true);RecoverPasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$PASSWORD_RECOVER_SENT$");};RecoverPasswordRequest.request(null);}function OnAutoShowUserWizard(){ResetUserWizard(false);g_ActiveUserGrid.EnableUpdates(false);HideDialog("ConfirmDialog");OnShowUserWizard();}function OnShowWinGroup(){SubmitDomain("%ADMIN_FILE%DomainGroups.htm",3,"ntgroup=1");}function OnGoWinGroupTab(){SubmitDomain("%ADMIN_FILE%DomainGroups.htm",3);}function OnShowLDAPGroup(){var nLDAPTab=4;if(g_bShowWindowsAuth&&g_bSysAdmin)nLDAPTab=4;else if(g_bSysAdmin)nLDAPTab=3;SubmitDomain("%ADMIN_FILE%DomainGroups.htm",nLDAPTab,"ldapgroup=1");}function OnGoLDAPGroupsTab(){var nLDAPTab=4;if(g_bShowWindowsAuth&&g_bSysAdmin)nLDAPTab=4;else if(g_bSysAdmin)nLDAPTab=3;SubmitDomain("%ADMIN_FILE%DomainGroups.htm",nLDAPTab);}function OnShowImportUsers(){ShowDialog("ImportUserDialog");ImportUsersInput.getContent("box/text").element().focus();}function OnShowExportUsers(){ShowDialog("ExportUserDialog");ExportUsersInput.getContent("box/text").element().focus();}function HasInvalidSearchParms(sFilter){var bHasInvalidSearchParms=(sFilter.indexOf('\\')>-1);if((!bHasInvalidSearchParms)&&(sFilter.indexOf('/')>-1))bHasInvalidSearchParms=true;if((!bHasInvalidSearchParms)&&(sFilter.indexOf(':')>-1))bHasInvalidSearchParms=true;if((!bHasInvalidSearchParms)&&(sFilter.indexOf('"')>-1))bHasInvalidSearchParms=true;if((!bHasInvalidSearchParms)&&(sFilter.indexOf('<')>-1))bHasInvalidSearchParms=true;if((!bHasInvalidSearchParms)&&(sFilter.indexOf('>')>-1))bHasInvalidSearchParms=true;if((!bHasInvalidSearchParms)&&(sFilter.indexOf('|')>-1))bHasInvalidSearchParms=true;if((!bHasInvalidSearchParms)&&(sFilter.indexOf('/')>-1))bHasInvalidSearchParms=true;return(bHasInvalidSearchParms);}function OnFilterUsers(bTypeFilter){if(FilterUserInput.getControlText()!=""){if(!HasInvalidSearchParms(FilterUserInput.getControlText()))UsersList.FilterGrid(FilterUserInput.getControlText(),0,true);else AlertDialog(decodeURIComponent("$SU_VALID_INVALID_FILE_NAME_CHARACTERS_STR_EX$"));}else{if(bTypeFilter!=true)AlertDialog("$ENTER_FILTER_INPUT$");else UsersList.FilterGrid("",0,false);}}function OnClearFilterUsers(){FilterUserInput.setControlText("");UsersList.FilterGrid("",0,false);}function OnFilterDBUsers(bTypeFilter){if(FilterDBUserInput.getControlText()!="")ODBCUsersList.FilterGrid(FilterDBUserInput.getControlText(),0,true);else{if(bTypeFilter!=true)AlertDialog("$ENTER_FILTER_INPUT$");else ODBCUsersList.FilterGrid("",0,false);}}function OnClearFilterDBUsers(){FilterDBUserInput.setControlText("");ODBCUsersList.FilterGrid("",0,false);}CreateGroupBox("$FILTER_USERS$","FilterGroup",$FILTER_GROUPBOX_WIDTH$,56,true);var FilterUserInput=CreateInputField("","UserFilterInput","UserFilterInput","",180,undefined,undefined,OnFilterUsers);FilterUserInput.onControlTextChanged=function(){setTimeout("OnFilterUsers(true)",100);};FilterUserInput.onControlEditStarted=function(){var sCurText=FilterUserInput.getControlText();FilterUserInput.setTimeout(function(){var e=FilterUserInput.element().getElementsByTagName("INPUT")[0];if(sCurText!=undefined&&sCurText!=null&&sCurText!="")e.setSelectionRange(0,sCurText.length);e.focus();});if(sCurText==undefined||sCurText==null||sCurText=="")FilterUserInput.setControlText("*");};var FilterUserClearButton=CreatePushButton("$CLEAR_FILTER_BUTTON$","UserFilterClearButton",OnClearFilterUsers);CreateGroupBox("$FILTER_USERS$","DBFilterGroup",305,56,true);var FilterDBUserInput=CreateInputField("","DBUserFilterInput","DBUserFilterInput","",180,undefined,undefined,OnFilterDBUsers);FilterDBUserInput.onControlTextChanged=function(){setTimeout("OnFilterDBUsers(true)",100);};FilterDBUserInput.onControlEditStarted=function(){FilterDBUserInput.setTimeout(function(){var e=FilterDBUserInput.element().getElementsByTagName("INPUT")[0];var nStart=0;var nEnd=e.value.indexOf('*');if(AW.ie){var r=e.createTextRange();r.collapse(true);r.moveStart('character',0);r.moveEnd('character',0);r.select();}else{e.selectionStart=0;e.selectionEnd=0;}e.focus();});FilterDBUserInput.setControlText("*");};var FilterDBUserClearButton=CreatePushButton("$CLEAR_FILTER_BUTTON$","DBUserFilterClearButton",OnClearFilterDBUsers);var g_bNewAccount=false;var g_bSavingObj=false;var g_bEditUserTemplate=false;var g_UserLockInHomeDirCheck=undefined;var g_IncludeRespCodeMsgFiles=undefined;CreateGroupBox("$SELECT_USER_COLLECTION$","CollectionGroup",$COLL_GROUP_WIDTH_1$,56,true);CreateGroupBox("$SELECT_USER_COLLECTION$","ODBCCollectionGroup",$COLL_GROUP_WIDTH_1$,56,true);var sBrowserLangCheck=navigator.language?navigator.language:navigator.userLanguage;sBrowserLangCheck=sBrowserLangCheck.replace("-",",");if((sBrowserLangCheck.toLowerCase()=="zh,cn"||sBrowserLangCheck.toLowerCase()=="zh,tw")&&g_bFireFox3Browser){document.getElementById("CollectionGroupFS").style.width=parseInt(document.getElementById("CollectionGroupFS").style.width)+20;document.getElementById("ODBCCollectionGroupFS").style.width=parseInt(document.getElementById("ODBCCollectionGroupFS").style.width)+20;}var CollectionCombo=CreateComboBox("$GENERAL_USERS_NAME$",g_nDefaultOrgID,["$GENERAL_USERS_NAME$"],[g_nDefaultOrgID],"UserCollection","UserCollection",OnChangeCollection,undefined,false,200);CreatePushButton("$ADD_BUTTON$...","AddCollection",OnAddCollection);var RenameCollButton=CreatePushButton("$RENAME_BUTTON$...","RenameCollection",OnRenameCollection);var DeleteCollButton=CreatePushButton("$DELETE_BUTTON$","DeleteCollection",OnDeleteCollection);RenameCollButton.setStyle("display","none");DeleteCollButton.setStyle("display","none");var g_OrgTable=new AW.XML.SUObjectTable("DomainOrganizations.xml","%ID%",["@name","@ID"]);if(g_OrgTable){g_OrgTable.responseDef=g_OrgTable.response;g_OrgTable.response=OnLoadOrganizations;g_OrgTable.request();}var ODBCCollectionCombo=CreateComboBox("$GENERAL_ODBC_USERS$",g_nODBCUserOrg,["$GENERAL_ODBC_USERS$"],[g_nODBCUserOrg],"ODBCUserCollection","ODBCUserCollection",OnChangeODBCCollection,undefined,false,200);CreatePushButton("$ADD_BUTTON$...","AddODBCCollection",OnAddODBCCollection);var ODBCRenameCollButton=CreatePushButton("$RENAME_BUTTON$...","RenameODBCCollection",OnRenameODBCCollection);var ODBCDeleteCollButton=CreatePushButton("$DELETE_BUTTON$","DeleteODBCCollection",OnDeleteODBCCollection);ODBCRenameCollButton.setStyle("display","none");ODBCDeleteCollButton.setStyle("display","none");var g_ODBCOrgTable=new AW.XML.SUObjectTable("DomainODBCOrganizations.xml","%ID%",["@name","@ID"]);if(g_ODBCOrgTable){g_ODBCOrgTable.responseDef=g_ODBCOrgTable.response;g_ODBCOrgTable.response=OnLoadODBCOrganizations;g_ODBCOrgTable.request();}var g_bShowUserToolTip=true;var g_bShowMoveUserToolTip=true;var g_bShowODBCUserToolTip=true;var g_bShowMoveODBCUserToolTip=true;if(!g_bIsAdminAllowedToAddUsers){g_bShowUserToolTip=false;g_bShowODBCUserToolTip=false;}var UsersList=CreateUserGrid("UsersList",OnDelayLoadEditUser,"OrganizationUsers.xml?ID=%CDomain.%ID%.GeneralUsers.ID%");UsersList.m_nTimerMS=5000;UsersList.onKeyDelete=OnDeleteUser;UsersList.onKeyEnter=OnEditUser;var sOnEditUser=String("OnEditUser(");var sOnAddUser=String("OnAddUser(");var sOnDeleteUser=String("OnDeleteUser(");var sOnCopyUser=String("OnCopyUser(");var sOnMoveUsers=String("OnShowMoveUser(");var sOnEnableUser=String("OnEnableDisableUser(1,");var sOnDisableUser=String("OnEnableDisableUser(0,");CreateContextMenu([sOnAddUser,sOnEditUser,sOnDeleteUser,"",sOnCopyUser,sOnMoveUsers],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(UsersList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(UsersList,"$DELETE_BUTTON$"))},function(){return(OnGreaterZeroContextMenu(UsersList,g_sMenuDividers))},function(){return(OnEqualOneContextMenu(UsersList,"$COPY_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(UsersList,"$MOVE_BUTTON$..."))}],["Add","Edit","FileDelete","","Copy","Move"],UsersList,"UsersListContext",true);UsersList.m_fnPostUpdate=function(){var bMoveUsersCookie=false;var nMaxOrgUsers=50;var bLinkRequestFlag;if(g_bLinkRequested==undefined)bLinkRequestFlag=false;else bLinkRequestFlag=g_bLinkRequested;if(!bLinkRequestFlag&&g_bShowUserToolTip&&UsersList.getRowCount()==0&&!g_bReadOnlyAccess){BusyDialog(false);ToolTipDialog("$USER_WIZARD_BALLOON_TITLE$","$USER_WIZARD_BALLOON_TIP$",undefined,"UserWizardButton");g_bShowUserToolTip=false;}else if((UsersList.getRowCount()>nMaxOrgUsers)&&g_nBubbleAttempt>=0){for(var nIndex=0;nIndex<CollectionCombo.getItemCount();nIndex++){if(CollectionCombo.getItemValue(nIndex)==g_nCurrentUserOrg){if(readCookie(CollectionCombo.getItemText(nIndex))!="false")bMoveUsersCookie=true;sCollectionCookie=CollectionCombo.getItemText(nIndex);break;}}if(bMoveUsersCookie&&g_bShowMoveUserToolTip&&!g_bReadOnlyAccess){sCreateCookieFunction=String("createCookie(");sNoShowFunc='javascript:'+sCreateCookieFunction+'"'+sCollectionCookie+'","false",60);';BusyDialog(false);ToolTipDialog("$MOVE_USERS_BALLOON_TITLE$","$MOVE_USER_BALLOON_TIP$",undefined,"AddCollection",220,200,sNoShowFunc,"MoveUserBalloonTip");g_bShowMoveUserToolTip=false;}}if(g_nBubbleAttempt>0){g_bShowUserToolTip=false;g_bShowMoveUserToolTip=false;}g_nBubbleAttempt++;};var AddUserBtn=CreatePushButton("$ADD_BUTTON$...","AddUserButton",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnAddUser]);CreatePushButton("$EDIT_BUTTON$...","EditUserButton",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnEditUser]);CreatePushButton("$COPY_BUTTON$...","CopyUserButton",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnCopyUser]);CreatePushButton("$DELETE_BUTTON$","DeleteUserButton",OnDeleteUser);CreatePushButton("$MOVE_BUTTON$...","MoveUserButton",OnShowMoveUser);CreatePushButton("$MOVE_BUTTON$...","MoveUserOrgODBCButton",OnShowMoveUser);if(!g_bIsAdminAllowedToAddUsers)AddUserBtn.setStyle("display","none");function OnImportUsers(sFilePath){var ImportUsersObj=undefined;var sImportFile=sFilePath;if(Trim(sImportFile)!=""){if(ImportUsersObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".ImportCSV"),OnImportDone)){ImportUsersObj.setParameter("File",sImportFile);ImportUsersObj.FilePathName=sImportFile;SavingDialog(true);ImportUsersObj.request();}}}function OnImportDone(){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){var nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();var nLen=nCountFormatted.length;var nExistedCount=GetXMLValueInt(xmlDoc,"ExistedCount");var nExistedCountFormatted=new Number(nExistedCount).toLocaleString();var nExistedLen=nExistedCountFormatted.length;var nNotSavedCount=GetXMLValueInt(xmlDoc,"NotSavedCount");var nTotalUsersInFile=new Number(parseInt(nExistedCountFormatted)+parseInt(nCountFormatted)).toLocaleString();if(parseInt(nTotalUsersInFile)<=0&&nNotSavedCount>0)nTotalUsersInFile=new Number(parseInt(nNotSavedCount)).toLocaleString();var nTotalUsersInFileLen=nTotalUsersInFile.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));if(nExistedCountFormatted.substr((nExistedLen-3))==".00"||nExistedCountFormatted.substr((nExistedLen-3))==",00")nExistedCountFormatted=nExistedCountFormatted.substr(0,(nExistedLen-3));if(nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==".00"||nTotalUsersInFile.substr((nTotalUsersInFileLen-3))==",00")nTotalUsersInFile=nTotalUsersInFile.substr(0,(nTotalUsersInFileLen-3));var sImportNotSavedStr="";var bWarn=false;if(parseInt(nCountFormatted)>0&&parseInt(nNotSavedCount)>0){if(g_sOrganizationType=="ODBCOrganization")sImportNotSavedStr="$SOME_IMPORT_ODBC_USERS_NOT_SAVED$<br><br>";else sImportNotSavedStr="$SOME_IMPORT_USERS_NOT_SAVED$<br><br>";}if(parseInt(nCountFormatted)<=0&&parseInt(nNotSavedCount)>0){if(g_sOrganizationType=="ODBCOrganization")sImportStr="$NO_IMPORT_ODBC_USERS_SAVED$<br><br><div style='width:290px;'  class='ellipsis'  title='"+this.FilePathName+"'>"+this.FilePathName+"</div>";else sImportStr="$NO_IMPORT_USERS_SAVED$<br><br><div style='width:290px;'  class='ellipsis'  title='"+this.FilePathName+"'>"+this.FilePathName+"</div>";bWarn=true;}else if(parseInt(nExistedCountFormatted)>0)sImportStr=sImportNotSavedStr+nCountFormatted+" $OF$ "+nTotalUsersInFile+" $IMPORT_MSG_EXIST1$<br><br>"+nExistedCountFormatted+" $IMPORT_MSG_EXIST2$<br><br><div style='width:290px;' title='"+this.FilePathName+"'  class='ellipsis'>"+this.FilePathName+"</div>";else sImportStr=sImportNotSavedStr+nCountFormatted+" $OF$ "+nTotalUsersInFile+" $IMPORT_MSG$<br><br><div style='width:290px;' title='"+this.FilePathName+"' class='ellipsis'>"+this.FilePathName+"</div>";AlertDialog(sImportStr,bWarn,undefined,undefined,undefined,undefined,350);}else AlertDialog(GetResultText(0,"",sResultText));}function OnExportUsersOrgOnly(sFilePath){CloseConfirmDialog();OnExportUsers(sFilePath,true);}function OnConfirmExportUsers(sFilePath){if(sFilePath!=undefined&&sFilePath!="")ConfirmDialog("$EXPORT_USERS_CONFIRM$ <br><br> $EXPORT_USERS_YES_CONFIRM$ <br> $EXPORT_USERS_NO_CONFIRM$",OnExportUsers,OnExportUsersOrgOnly,sFilePath,330);else AlertDialog("$PLEASE_ENTER_EXPORT_PATH$");}function OnExportUsers(sFilePath,bOrg){CloseConfirmDialog();var ExportUsersObj=undefined;var sExportFile=sFilePath;if(bOrg)sExportType=g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%C"+g_sOrganizationType+"."+g_nActiveUserOrg+".ExportCSV";else sExportType=g_sAdminXMLPath+"ImportExportInfo.xml%OBJECT_COMMAND_REF%CDomain.%ID%.ExportCSV";if(Trim(sExportFile)!=""){if(ExportUsersObj=createAWHttpRequest("POST",(sExportType),OnExportDone)){ExportUsersObj.setParameter("File",sExportFile);ExportUsersObj.FilePathName=sExportFile;SavingDialog(true);ExportUsersObj.request();}}}function OnExportDone(sFilePath){var xmlDoc=this.getResponseXML();var nResult=0;var nCount=0;var sResultText=GetXMLValue(xmlDoc,"ResultText");SavingDialog(false);if((xmlDoc)&&((nResult=GetXMLValueInt(xmlDoc,"result"))==0)){nCount=GetXMLValueInt(xmlDoc,"Count");var nCountFormatted=new Number(nCount).toLocaleString();nLen=nCountFormatted.length;if(nCountFormatted.substr((nLen-3))==".00"||nCountFormatted.substr((nLen-3))==",00")nCountFormatted=nCountFormatted.substr(0,(nLen-3));AlertDialog(nCountFormatted+" $EXPORT_MSG$<br><br>"+this.FilePathName);}else{AlertDialog(GetResultText(nResult,"",sResultText));}}function OnLoadImportExport(aParams){g_bShowODBCUserToolTip=false;g_bShowUserToolTip=false;LoadDynamicContentAndRun(aParams);}var ImportButton=CreatePushButton("$IMPORT_BUTTON$...","ImportUsersButton",OnLoadImportExport,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnImportUsers]],"Import");var ExportButton=CreatePushButton("$EXPORT_BUTTON$...","ExportUsersButton",OnLoadImportExport,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnConfirmExportUsers,undefined,undefined,true]],"Export");var ImportODBCButton=CreatePushButton("$IMPORT_BUTTON$...","ImportODBCUsersButton",OnLoadImportExport,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnImportUsers]],"ImportDB");var ExportODBCButton=CreatePushButton("$EXPORT_BUTTON$...","ExportODBCUsersButton",OnLoadImportExport,undefined,undefined,["%ADMIN_FILE%Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[undefined,true,"0","0",OnConfirmExportUsers,undefined,undefined,true]],"ExportDB");var DefaultNewUserButton=CreatePushButton("$DEFAULT_USER_BUTTON$...","DefaultNewUser",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnEditDefaultUser]);DefaultNewUserButton.setControlImage("User_Template_Icon");if(g_bGroupAdmin){DefaultNewUserButton.setStyle("display","none");}var RecoverPasswordButton=CreatePushButton("$RECOVER_PASSWORD_BUTTON$","RecoverPassword",OnRecoverPasswords,undefined,undefined,undefined,"RecoverPasswordIcon");var ODBCRecoverPasswordButton=CreatePushButton("$RECOVER_PASSWORD_BUTTON$","ODBCRecoverPassword",OnRecoverPasswords,undefined,undefined,undefined,"RecoverPasswordIcon");var ODBCDefaultNewUserButton=CreatePushButton("$DEFAULT_USER_BUTTON$...","ODBCDefaultNewUser",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnEditDefaultUser]);ODBCDefaultNewUserButton.setControlImage("User_Template_Icon");if(g_bGroupAdmin){ODBCDefaultNewUserButton.setStyle("display","none");}var UserWizButton=CreatePushButton("$WIZARD_BUTTON$...","UserWizardButton",OnShowUserWizard);UserWizButton.setControlImage("Wizard_Wand_Icon");if(!g_bIsAdminAllowedToAddUsers)UserWizButton.setStyle("display","none");var ODBCWizButton=CreatePushButton("$WIZARD_BUTTON$...","ODBCUserWizardButton",OnShowUserWizard);ODBCWizButton.setControlImage("Wizard_Wand_Icon");if(!g_bIsAdminAllowedToAddUsers)ODBCWizButton.setStyle("display","none");var ODBCUsersList=CreateUserGrid("ODBCUsersList",OnDelayLoadEditUser,"OrganizationUsers.xml?ID="+g_nODBCUserOrg);ODBCUsersList.m_nTimerMS=5000;ODBCUsersList.onKeyDelete=OnDeleteUser;ODBCUsersList.onKeyEnter=OnEditUser;var sDBOnEditUser=String("OnEditUser(");var sDBOnAddUser=String("OnAddUser(");var sDBOnDeleteUser=String("OnDeleteUser(");var sDBOnCopyUser=String("OnCopyUser(");var sDBOnMoveUsers=String("OnShowMoveUser(");CreateContextMenu([sDBOnAddUser,sDBOnEditUser,sDBOnDeleteUser,"",sDBOnCopyUser,sDBOnMoveUsers],["$ADD_BUTTON$...",function(){return(OnEqualOneContextMenu(ODBCUsersList,"$EDIT_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(ODBCUsersList,"$DELETE_BUTTON$"))},function(){return(OnGreaterZeroContextMenu(ODBCUsersList,g_sMenuDividers))},function(){return(OnEqualOneContextMenu(ODBCUsersList,"$COPY_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(ODBCUsersList,"$MOVE_BUTTON$..."))}],["Add","Edit","FileDelete","","Copy","Move"],ODBCUsersList,"ODBCUsersListContext",true);ODBCUsersList.m_fnPostUpdate=function(){var bMoveUsersCookie=false;var nMaxOrgUsers=50;var bLinkRequestFlag;if(g_bLinkRequested==undefined)bLinkRequestFlag=false;else bLinkRequestFlag=g_bLinkRequested;if(!bLinkRequestFlag&&g_bShowODBCUserToolTip&&ODBCUsersList.getRowCount()==0&&!g_bReadOnlyAccess){BusyDialog(false);ToolTipDialog("$USER_WIZARD_BALLOON_TITLE$","$USER_WIZARD_BALLOON_TIP$",undefined,"ODBCUserWizardButton");g_bShowODBCUserToolTip=false;}else if((ODBCUsersList.getRowCount()>nMaxOrgUsers)&&g_nBubbleAttempt>=0){for(var nIndex=0;nIndex<ODBCCollectionCombo.getItemCount();nIndex++){if(ODBCCollectionCombo.getItemValue(nIndex)==g_nCurrentODBCUserOrg){if(readCookie(ODBCCollectionCombo.getItemText(nIndex))!="false")bMoveUsersCookie=true;sCollectionCookie=ODBCCollectionCombo.getItemText(nIndex);break;}}if(bMoveUsersCookie&&g_bShowMoveODBCUserToolTip&&!g_bReadOnlyAccess){sCreateCookieFunction=String("createCookie(");sNoShowFunc='javascript:'+sCreateCookieFunction+'"'+sCollectionCookie+'","false",60);';BusyDialog(false);ToolTipDialog("$MOVE_USERS_BALLOON_TITLE$","$MOVE_USER_BALLOON_TIP$",undefined,"AddODBCCollection",220,200,sNoShowFunc,"MoveODBCUsersBalloonTip");g_bShowMoveODBCUserToolTip=false;}}if(g_nBubbleAttempt>0){g_bShowODBCUserToolTip=false;g_bShowMoveODBCUserToolTip=false;}g_nBubbleAttempt++;};var AddODBCUserBtn=CreatePushButton("$ADD_BUTTON$...","AddODBCUserButton",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnAddUser]);CreatePushButton("$EDIT_BUTTON$...","EditODBCUserButton",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnEditUser]);CreatePushButton("$COPY_BUTTON$...","CopyODBCUserButton",DelayLoadExecute,undefined,undefined,[IsDynamicUserContentLoaded,OnCopyUser]);CreatePushButton("$DELETE_BUTTON$","DeleteODBCUserButton",OnDeleteUser);if(!g_bIsAdminAllowedToAddUsers)AddODBCUserBtn.setStyle("display","none");if(g_bShowWindowsAuth&&g_bSysAdmin){var WindowsGroupButton=CreatePushButton("$WINDOWS_AUTH_GROUP_CONFIG$...","WinGroupButton",OnShowWinGroup);var OUGroupButton=CreatePushButton("$OU_GROUP_CONFIG$...","OUGroupButton",OnGoWinGroupTab);if(parseInt("%CDomain.%ID%.AllowNTLogin%")){document.getElementById("NTEnabledContent").style.display="block";}else{document.getElementById("NTEnabledContent").style.display="none";}CreateCheckBox("$ENABLE_WINDOWS_AUTH$","AllowNTLogin","AllowNTLogin",parseInt("%CDomain.%ID%.AllowNTLogin%"),OnCheckWindowsAuth);CreateCheckBox("$WINDOWS_AUTH_USE_GROUP_HOMEDIR$","NTUserUseGroupHomeDir","NTUserUseGroupHomeDir",parseInt("%CDomain.%ID%.NTUserUseGroupHomeDir%"),OnCheckBoxValueChanged);CreateInputField("%CDomain.%ID%.NTDomain%","NTDomain","NTDomain",undefined,250,undefined,false,OnSaveNTDomain);CreatePushButton("$SAVE_BUTTON$","SaveNTDomain",OnSaveNTDomain);if("%CServer.%SERVER_ID%.WinAuthLicense%"!="1")DisableTab("WindowsAuthContent");}if(g_bSysAdmin){var LDAPGroupButton=CreatePushButton("$LDAP_AUTH_GROUP_CONFIG$...","LDAPGroupButton",OnShowLDAPGroup);var LDAPGroupsButton=CreatePushButton("$LDAP_GROUPS_CONFIG$...","LDAPGroupsButton",OnGoLDAPGroupsTab);if(parseInt("%CDomain.%ID%.AllowLDAPLogin%")){document.getElementById("LDAPEnabledContent").style.display="block";}else{document.getElementById("LDAPEnabledContent").style.display="none";}CreateCheckBox("$ENABLE_LDAP_AUTH$","AllowLDAPLogin","AllowLDAPLogin",parseInt("%CDomain.%ID%.AllowLDAPLogin%"),OnCheckLDAPAuth);CreateCheckBox("$LDAP_AUTH_USE_GROUP_HOMEDIR$","LDAPUserUseGroupHomeDir","LDAPUserUseGroupHomeDir",parseInt("%CDomain.%ID%.LDAPUserUseGroupHomeDir%"),OnCheckBoxValueChanged);CreateInputField("%CDomain.%ID%.LDAPLoginIDSuffix%","LDAPLoginIDSuffix","LDAPLoginIDSuffix",undefined,250,undefined,false,OnSaveLDAPLoginIDSuffix);CreatePushButton("$SAVE_BUTTON$","SaveLDAPLoginIDSuffix",OnSaveLDAPLoginIDSuffix);if("%CServer.%SERVER_ID%.LDAPAuthLicense%"!="1")DisableTab("LDAPAuthContent");}function OnAddLDAPServer(){LDAPServersList.OnAddObject("LDAPServer.xml%DEFAULT_OBJECT_REF%CDomain.%ID%.LDAPServer","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.LDAPServer",document.LDAPServerForm,"LDAPServersDialog",[OnAddLDAPServerLoad],g_bReadOnlyAccess);}function OnEditLDAPServer(){LDAPServersList.OnEditObject("LDAPServer.xml","Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.LDAPServer.",document.LDAPServerForm,"LDAPServersDialog","$SELECT_ONLY_ONE_LDAPSERVER_EDIT$","$SELECT_ONE_LDAPSERVER_EDIT$",[OnEditLDAPServerLoad]);}function OnCopyLDAPServer(){LDAPServersList.OnCopyObject("LDAPServer.xml?ID=","Result.xml%ADD_OBJECT_REF%CDomain.%ID%.LDAPServer",document.LDAPServerForm,"LDAPServersDialog","$SELECT_ONLY_ONE_LDAPSERVER_COPY$","$SELECT_ONE_LDAPSERVER_COPY$",[OnCopyLDAPServerLoad],true);}CreateGroupBox("$LDAP_SERVERS$","LDAPServersGroup","100%","auto",true);function OnRemoveLDAPServer(){LDAPServersList.OnDeleteObject("Result.xml%DELETE_OBJECT_REF%CDomain.%ID%.LDAPServer&ID=%ID%","$ASK_DELETE_LDAPSERVER$","$SELECT_ONE_LDAPSERVER_DELETE$");}var LDAPServersList=CreateAdminGrid("LDAPServersList",["$HOST$","$LISTENER_PORT$","$DESCRIPTION$"],[150,50,270],"LDAPServers.xml?ID=%ID%","servers","server",5,OnEditLDAPServer,-1);LDAPServersList.NoResizeColumns([1,1,0]);LDAPServersList.setCellFormat([new AW.Formats.XMLString,new AW.Formats.XMLString,new AW.Formats.XMLString]);LDAPServersList.RightAlignColumn(1,true);LDAPServersList.getCellImage=function(nCol,nRow){var sEnabledDisabled="Enabled";if(this.getCellData(3,nRow)=="0")sEnabledDisabled="Disabled";return("LDAP-"+sEnabledDisabled);};LDAPServersList.m_fnPostUpdate=function(){this.DisableSorting();this.refresh();};LDAPServersList.onKeyDelete=OnRemoveLDAPServer;var sOnEditLDAPServer=String("OnEditLDAPServer(");var sOnAddLDAPServer=String("OnAddLDAPServer(");var sOnRemoveLDAPServer=String("OnRemoveLDAPServer(");var sOnCopyLDAPServer=String("OnCopyLDAPServer(");var sOnEnableLDAPServer=String("OnEnableDisableLDAPServer(1,");var sOnDisableLDAPServer=String("OnEnableDisableLDAPServer(0,");CreateContextMenu([sOnEditLDAPServer,"",sOnAddLDAPServer,sOnRemoveLDAPServer,sOnCopyLDAPServer,sOnEnableLDAPServer,sOnDisableLDAPServer],[function(){return(OnEqualOneContextMenu(LDAPServersList,"$EDIT_BUTTON$..."))},function(){return(OnEqualOneContextMenu(LDAPServersList,g_sMenuDividers))},"$ADD_BUTTON$...",function(){return(OnGreaterZeroContextMenu(LDAPServersList,"$DELETE_BUTTON$..."))},function(){return(OnGreaterZeroContextMenu(LDAPServersList,"$COPY_BUTTON$..."))},OnEnableLDAPServerContextMenu,OnDisableLDAPServerContextMenu],["Edit","","New","FileDelete","Copy",OnEnableLDAPServerContextImage,OnDisableLDAPServerContextImage],LDAPServersList,"LDAPServersListContext",true);CreatePushButton("$ADD_BUTTON$...","AddLDAPServerButton",OnAddLDAPServer);CreatePushButton("$EDIT_BUTTON$...","EditLDAPServerButton",OnEditLDAPServer);CreatePushButton("$DELETE_BUTTON$","RemoveLDAPServerButton",OnRemoveLDAPServer);CreatePushButton("$COPY_BUTTON$...","CopyLDAPButton",OnCopyLDAPServer);LDAPServersList.InitObjectMove(["LDAPServersListTopArrow","LDAPServersListUpArrow","LDAPServersListDownArrow","LDAPServersListBottomArrow"],"CDomain.%ID%.LDAPServer");
function OnEnableDisableLDAPServer(bEnable){var EditCells=new Array();EditCells=LDAPServersList.getSelectedRows().toString().split(",");var LDAPServerEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(LDAPServersList.getCellData((LDAPServersList.m_nNumColumns-1),EditCells[nIndex]));LDAPServerEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml%UPDATE_OBJECT_REF%CDomain.%ID%.LDAPServer."+nObjectID+"&StaticOnly=1");LDAPServerEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;LDAPServerEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;LDAPServerEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);LDAPServerEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};LDAPServerEnabledDisabledRequest[nIndex].request(null);}}function OnEnableLDAPServerContextMenu(){if(LDAPServerEnableOrDisable()[1]&&LDAPServersList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_LDAP_SERVER$";else sMenuItemName="";return(sMenuItemName);}function OnDisableLDAPServerContextMenu(){if(LDAPServerEnableOrDisable()[0]&&LDAPServersList.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_LDAP_SERVER$";else sMenuItemName="";return(sMenuItemName);}function OnEnableLDAPServerContextImage(){if(LDAPServerEnableOrDisable()[1])sImageClass="LDAPEnabled";else sImageClass="";return(sImageClass);}function OnDisableLDAPServerContextImage(){if(LDAPServerEnableOrDisable()[0])sImageClass="LDAPDisabled";else sImageClass="";return(sImageClass);}function LDAPServerEnableOrDisable(){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=LDAPServersList.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(LDAPServersList.getCellText(3,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}var g_bUserContentLoaded=false;var g_sPageObjectType="Domain";if("%CServer.%SERVER_ID%.ODBCLicense%"!="1")DisableTab("ODBCUsersTabContent",ODBCUsersList);else if("%CDomain.%ID%.ODBCAvailable%"!="1")DisableTab("ODBCUsersTabContent",ODBCUsersList,"$ODBC_USERS_NOT_CONFIGURED$");if(g_bPasswordRecoveryLicense){document.getElementById("ODBCRecoverPassword").style.display="block";document.getElementById("RecoverPassword").style.display="block";}if(g_bShowWindowsAuth&&g_bSysAdmin)g_ActiveTab=CreateTabs(["$DOMAIN_USERS_TAB$","$ODBC_USERS_TAB_NAME$","$WINDOWS_AUTH_TAB_NAME$","$LDAP_AUTH_TAB_NAME$"],["UsersTab","ODBCUsersTab","WindowsAuthTab","LDAPAuthTab"],"PageTabs","TabsContent",1,OnChangeTab);else if(g_bSysAdmin&&"Domain"!="Server")g_ActiveTab=CreateTabs(["$DOMAIN_USERS_TAB$","$ODBC_USERS_TAB_NAME$","$LDAP_AUTH_TAB_NAME$"],["UsersTab","ODBCUsersTab","LDAPAuthTab"],"PageTabs","TabsContent",1,OnChangeTab);else g_ActiveTab=CreateTabs(["$DOMAIN_USERS_TAB$","$ODBC_USERS_TAB_NAME$"],["UsersTab","ODBCUsersTab"],"PageTabs","TabsContent",1,OnChangeTab);window.onunload=function(){if(g_ActiveUserGrid!=undefined)g_ActiveUserGrid.EnableUpdates(false);UnloadOrganization(g_nCurrentUserOrg);UnloadOrganization(g_nCurrentODBCUserOrg,"ODBCOrganization");};if(GetURLParameter("ShowWiz")==1){g_bShowUserToolTip=false;g_bShowODBCUserToolTip=false;ConfirmDialog("$CONFIRM_USE_USER_WIZARD$",OnAutoShowUserWizard,undefined,undefined);}setTimeout(function(){LoadDynamicContent("%ADMIN_FILE%Include/UserSubDialogs.htm?ID=%ID%","UserSubDialogs",OnDynamicUserContentLoaded);});function UserLicenseInfo(){if(g_MaxUserLicense!=-1){var UserLicenseObj=undefined;if(UserLicenseObj=createAWHttpRequest("POST",(g_sAdminXMLPath+"MCLicenseUserInfo.xml?ID=%SERVER_ID%"),OnUserLicenseInfoDone)){UserLicenseObj.request();}}}function OnUserLicenseInfoDone(){var xmlDoc=this.getResponseXML();var nMaxUsers=GetXMLValue(xmlDoc,"MaxUsersLicense");var nTotalUsers=GetXMLValue(xmlDoc,"TotalUsers");if((nMaxUsers!=undefined&&nTotalUsers!=undefined)&&nMaxUsers!="-1"){document.getElementById("TotalUsersDiv").innerHTML="$USING$ "+nTotalUsers+" $OF$ "+nMaxUsers+" $USERS$";document.getElementById("ODBCTotalUsersDiv").innerHTML="$USING$ "+nTotalUsers+" $OF$ "+nMaxUsers+" $USERS$";}}function OnEnableDisableUser(bEnable){var EditCells=new Array();var objGrid=g_ActiveUserGrid;EditCells=objGrid.getSelectedRows().toString().split(",");var UserEnabledDisabledRequest=[];SavingDialog(true);for(var nIndex=0;(nIndex<EditCells.length);nIndex++){var nObjectID=parseInt(objGrid.getCellData((objGrid.m_nNumColumns-1),EditCells[nIndex]));var sLoginID=encodeURIComponent(objGrid.getCellValue(0,EditCells[nIndex]));UserEnabledDisabledRequest[nIndex]=CreatePostRequest("%ADMIN_FILE%XML/Result.xml?Command=UpdateObject&Object=C"+g_sOrganizationType+"."+g_nActiveUserOrg+".User."+nObjectID+"&StaticOnly=1");UserEnabledDisabledRequest[nIndex].m_nIndexEnabled=nIndex;UserEnabledDisabledRequest[nIndex].m_nTotalEnabled=EditCells.length;UserEnabledDisabledRequest[nIndex].setParameter("Enabled",bEnable);UserEnabledDisabledRequest[nIndex].response=function(XMLDoc){if(parseInt(this.m_nIndexEnabled)==parseInt(this.m_nTotalEnabled-1)){SavingDialog(false);var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0)AlertDialog(GetResultText(0,"",sResultText));}};UserEnabledDisabledRequest[nIndex].request(null);}}function OnEnableUserContextMenu(){var objGrid=g_ActiveUserGrid;if(UserEnableOrDisable(objGrid)[1]&&objGrid.getSelectedRows().length>0)sMenuItemName="$CONTEXT_ENABLE_ACCOUNT$";else sMenuItemName="";return(sMenuItemName);}function OnDisableUserContextMenu(){var objGrid=g_ActiveUserGrid;if(UserEnableOrDisable(objGrid)[0]&&objGrid.getSelectedRows().length>0)sMenuItemName="$CONTEXT_DISABLE_ACCOUNT$";else sMenuItemName="";return(sMenuItemName);}function OnEnableUserContextImage(){var objGrid=g_ActiveUserGrid;if(UserEnableOrDisable(objGrid)[1])sImageClass="UserEnabled";else sImageClass="";return(sImageClass);}function OnDisableUserContextImage(){var objGrid=g_ActiveUserGrid;if(UserEnableOrDisable(objGrid)[0])sImageClass="UserDisabled";else sImageClass="";return(sImageClass);}function UserEnableOrDisable(objGrid){var aEnabledDisabled=[0,0];var bGotEnabled=0;bGotDisabled=0;SelectedCells=objGrid.getSelectedRows().toString().split(",");for(var nIndex=0;(nIndex<SelectedCells.length);nIndex++){var bEnabled=parseInt(objGrid.getCellText(7,SelectedCells[nIndex]));if(bEnabled)bGotEnabled=1;else bGotDisabled=1;if(bGotEnabled&&bGotDisabled)break;}aEnabledDisabled=[bGotEnabled,bGotDisabled];return(aEnabledDisabled);}if(!(parseInt("%CServer.%SERVER_ID%.IsGold%")||parseInt("%CServer.%SERVER_ID%.IsPlatinum%")?true:false))AddOnloadEvent(UserLicenseInfo);if((parseInt(GetURLParameter("Page"))-1)>1)g_ActiveTab.setSelectedItems([(parseInt(GetURLParameter("Page"))-1)]);</script></div></div><div style='clear:both;'>&nbsp;</div></div></div><div class="footerDiv"><a href="%PRODUCT_HOME%" target="_blank" rel="noopener noreferrer">%PRODUCT%</a> <span id="SUVersionNumber">%VERSION%</span> &copy; 1995 - %COPYRIGHT_END_YEAR% <a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer">%COMPANY_NAME_FORMAL%</a>&nbsp;$ALL_RIGHTS_RESERVED$</div><ul id="UserOptList" style="display: none; width: auto;min-width: 100px;"><li id="UserOptList-password" style="display: none;"><a href="#" data-handler="javascript:ChangePasswordDialog();" >$CHANGE_PASSWORD_BUTTON$</a></li><li id="UserOptList-changeemail" style="display: none;"><a href="#" data-handler="javascript:OnShowChangeEmailDialog();" >$CHANGE_EMAIL_BUTTON$</a></li><li id="UserOptList-logout"><a href="#" data-handler="javascript:OnLogOut();">$LOGOUT$</a></li></ul><ul id="HelpOptList" class="menu-toggle" style="display: none; width: auto;min-width: 100px;"><li id="HelpOptList-whatsnew"><a href="#" data-handler="javascript:WhatsNewShow();" class="ActionOption" style="white-space:nowrap;"><span class="Action-ico"><img src="%COMMON_FILE%Images/FolderSize.png" class="SUWCActionico" alt="$WHATS_NEW$" border="0"/></span>$WHATS_NEW$</a></li></ul></div><div id="FooterDelayContent" style="display:none;"></div><ul id="AdhocNavBarJumpToMenu" style="display: none; width: auto;min-width: 160px;"><li id="MCNavOption"><a href="#AdhocHeadJumpto" id="MCNavOption-href" data-handler="javascript:OnJumpTo(0);">$MANAGEMENT_CONSOLE$</a></li><li id="WCNavOption"><a href="#AdhocHeadJumpto" id="WCNavOption-href" data-handler="javascript:OnJumpTo(1);">$BASIC_WEB_CLIENT$</a></li><li id="WCNewNavOption"><a href="#AdhocHeadJumpto" id="WCNewNavOption-href" data-handler="javascript:OnJumpTo(4);">$WEB_CLIENT_NEW$</a></li><li id="FSNewNavOption"><a href="#AdhocHeadJumpto" id="FSNewNavOption-href" data-handler="javascript:OnJumpTo(5);">$WEB_CLIENT_SHARE_NEW$</a></li><li id="FJNavOption"><a href="#AdhocHeadJumpto" id="FJNavOption-href" data-handler="javascript:OnJumpTo(2);">$FVJV$</a></li><li id="FSNavOption"><a href="#AdhocHeadJumpto" id="FSNavOption-href" data-handler="javascript:OnJumpTo(3);">$FILE_SHARING$</a></li></ul><script type="text/javascript">$(document).ready(function(){var g_bShowMC=(%IS_ADMIN%=="1")?true:false;var g_bShowWC=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bShowFVJV=(%ALLOW_FTP_VOYAGER_JV%=="1")?true:false;var g_bShowFileSharing=(%ALLOW_ADHOC_FILE_SHARING%=="1")?true:false;$("#ManConNavBarJumpToList").contextMenu({"menu":"AdhocNavBarJumpToMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#AdhocNavBarJumpToMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocNavBarJumpToMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});var nTotalHidden=0;if(!g_bShowMC||g_JumpToPage==0){$("#MCNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==1){$("#WCNavOption").hide();nTotalHidden+=1;}if(!g_bShowFVJV||g_JumpToPage==2){$("#FJNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==3){$("#FSNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==4){$("#WCNewNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==5){$("#FSNewNavOption").hide();nTotalHidden+=1;}if(nTotalHidden==6)$(".AdhocNavBarJumpTo").hide();else $(".AdhocNavBarJumpTo").show();});function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href="%FILE%ListDir.htm";break;case(2):location.href="%COMMON_FILE%FVJVLoggedIn.htm";break;case(3):location.href="%FILE%Share/Console.htm";break;case(4):location.href="/WebClientNew/Browser/~";break;case(5):location.href="/WebClientNew/Requested";break;}}</script><script type="text/javascript" language="javascript">var g_bFooterDelayLoaded=false;var g_bIsFileNameSelected=true;var g_bFooterIsWindowAuth=(%WINDOWS_AUTH_SUPPORT%==1);function IsFooterDelayLoaded(){return(g_bFooterDelayLoaded);}function OnFooterDelayLoaded(){g_bFooterDelayLoaded=true;}function OnLogOut(){g_bLinkRequested=true;clearSessionCookies('domainid');clearSessionCookies('domainodbc');location.href='%LOGOUT%';}function OnMoreWebClientInfo(){window.open("https://customerportal.solarwinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank","noopener");}function LaunchBasicWebClient(){if(g_bWebClientLicense){LoadingDialog(true);location.href="%FILE%ListDir.htm?Dir=%CURRENT_DIR%";}else ConfirmDialog(g_sWebClienLicenseInfo,OnMoreWebClientInfo);}function MainHelp(){LaunchHelp(g_sHelpPage,g_sHelpNode);}function OnShowChangeEmailDialog(){OnShowSetEmailDialog(g_sUserEmail);g_sUserEmail="";}if(%IS_LOCAL_ADMIN%){sLoggedInUser="($LOCAL_ADMIN$)";sLoggedInUserAlt="$LOCAL_ADMIN$";}else{sLoggedInUser=FormatClientString("%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)");sLoggedInUserAlt="%CUser.%USER_ID%.FullName% (%CUser.%USER_ID%.LoginID%)";}document.getElementById("CurrentlyLoggedIn").innerHTML=sLoggedInUser;setTimeout(function(){LoadDynamicContent("%ADMIN_FILE%Include/footerInclude.htm?ID=%ID%","FooterDelayContent",OnFooterDelayLoaded);});if(g_bOperaBrowser)document.body.onmousedown=function(){return false;};$(document).ready(function(){$('.menu-toggle').on('click',function(e){$('.menu-toggle').removeClass('active');$(this).addClass('active');});$(document).on('mouseup',function(e){var container=$(".menu-toggle");if(!container.is(e.target)&&container.has(e.target).length===0){$('.menu-toggle').removeClass('active');}});$("#UserOptBtn").contextMenu({"menu":"UserOptList","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#UserOptList").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#UserOptList").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});if(!(%IS_LOCAL_ADMIN%)){if(g_bAllowChangePassword)$("#UserOptList-password").show();if(g_bAllowChangeEmail)$("#UserOptList-changeemail").show();}});</script></body></html>