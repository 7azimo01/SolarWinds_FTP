<!--#include "Strings\Strings.strings"-->
<!--#include "..\Common\Strings\Strings.strings"-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">%CSP_USE_NONCE%<html><head><title>%LOGIN_PAGE_TITLE%</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="ROBOTS" content="NOINDEX,NOFOLLOW,NOARCHIVE"/><meta name="viewport" content="width=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_OnceUsageToken="%CSP_NONCE_USAGE_TOKEN%";var g_bIsWebClient=false;var g_bIsDemo=(%IS_DEMO%==1);var g_sFontOverride="$FONT_OVERRIDE$";var g_bIslocalAdminBrowser=false;var g_bAllowRemember=true;var m_sFileShareStartupPage="%FILE%Share/Console.htm";var m_sViewShareToken="";var m_bShowViewShareNotFound=false;var g_bAllowAutoComplete=false;if(parseInt(%ALLOW_AUTO_COMPLETE_IN_LOGIN_FIELDS%)!=1)g_bAllowAutoComplete=false;if(parseInt(%ALLOW_REMEMBER_ME%)!=1){g_bAllowRemember=false;}if(%IS_LOCAL_ADMIN%){g_bIslocalAdminBrowser=true;}var g_bDisableBranding=false;var g_bHasCustomLogo=false;if(%DISABLE_BRANDING%){g_bDisableBranding=true;}if(%HAS_CUSTOM_LOGO%){g_bHasCustomLogo=true;}</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BrowserCheckAW.js"></script><link type="text/css" href="%COMMON_FILE%Style/Dialog.css" rel="stylesheet" /><link type="text/css" href="%FILE%Style/LoginForm.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonUI.css" rel="stylesheet" /><link type="text/css" href="/%25CUSTOM_HTML_LOGIN_CSS%25%FILE%Style/Login.css" rel="stylesheet" /><style type="text/css">#UserPlacementRadio .aw-list-item {height: 20px;}.aw-item-template{height:18px;}.aw-system-control {color: #fff !important;}</style><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var agent=navigator.userAgent.toLowerCase();var g_HTTPTitle="%LOGIN_PAGE_TITLE%";if(g_HTTPTitle=="")document.title="$LOGIN_TITLE$";var bIs_iPhone=false,bIs_BlackBerry=false,bIs_IEMobile=false,bIs_AndroidMobile=false,bIs_KindleMobile=false,g_bIsiPad=false;if((agent.indexOf('iphone')!=-1)||(agent.indexOf('ipod')!=-1))bIs_iPhone=true;if(agent.indexOf('ipad')!=-1)g_bIsiPad=true;if((agent.indexOf('blackberry')!=-1))bIs_BlackBerry=true;if((agent.indexOf('iemobile')!=-1)||(agent.indexOf('windows phone')!=-1))bIs_IEMobile=true;if((agent.indexOf('android')!=-1))bIs_AndroidMobile=true;if((agent.indexOf('kindle')!=-1)||(agent.indexOf('silk')!=-1))bIs_KindleMobile=true;if(bIs_iPhone||bIs_BlackBerry||bIs_IEMobile||bIs_AndroidMobile||bIs_KindleMobile){window.location='%FILE%Mobile/MLogin.htm';}if(g_bFireFox3Browser||g_bSafariBrowser||AW.webkit){document.write('<style type="text/css">');if(g_bSafariBrowser){document.write('body,table{');document.write(' font-size:11px;');document.write('}');}document.write('.aw-popup-window{');if(AW.webkit)document.write('margin-top:17px;}');else document.write('margin-top:4px;}');document.write('</style>');}g_sEnterUser="$PLEASE_ENTER_USER_NAME$";g_sEnableCookies="$PLEASE_ENABLE_COOKIES$";var g_bIsLocalAdmin=false;var g_bLoginUser=true;var g_bBrowserOk=false;var g_bRecommendIEUpgrade=false;var g_sCommonPath="%COMMON_FILE%";var g_sWebFilePath="%FILE%";var g_sUnknownError="$UNKNOWN_ERROR$";if(navigator.userAgent.indexOf("Firefox")!=-1){var nVersionIndex=navigator.userAgent.indexOf("Firefox")+8;if(parseInt(navigator.userAgent.charAt(nVersionIndex))>=1)g_bBrowserOk=true;}if(navigator.userAgent.indexOf("Shiretoko")!=-1)g_bBrowserOk=true;if(navigator.userAgent.indexOf("Opera")!=-1){var nVersionIndex=(navigator.userAgent.indexOf("Opera")+6);if(parseInt(navigator.userAgent.charAt(nVersionIndex))>=9)g_bBrowserOk=true;}var nVersion=0;if(navigator.appVersion.indexOf("MSIE")!=-1){aTemp=navigator.appVersion.split("MSIE");nVersion=parseFloat(aTemp[1]);}if(nVersion>5.5)g_bBrowserOk=true;if(nVersion>5.5&&nVersion<8)g_bRecommendIEUpgrade=(%WARN_OLD_BROWSER%!=0);if(navigator.userAgent.indexOf("MSIE")!=-1){var nVersionIndex=(navigator.userAgent.indexOf("MSIE")+5);var nVersionIE=parseInt(navigator.userAgent.charAt(nVersionIndex));if(nVersionIE>=8)g_bRecommendIEUpgrade=false;else if((navigator.userAgent.indexOf("compatible")!=-1)&&(nVersionIE>=8))g_bRecommendIEUpgrade=false;}if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)g_bBrowserOk=true;if(navigator.userAgent.toLowerCase().indexOf('trident')!=-1)g_bBrowserOk=true;var g_bFVJVLicense=false;LoadingImg1=new Image();LoadingImg1.src="%COMMON_FILE%Images/DialogBar-bg.png";LoadingImg2=new Image();LoadingImg2.src="%COMMON_FILE%Images/Busy.gif";LoadingImg8=new Image();LoadingImg8.src="%COMMON_FILE%Images/tooltip-left-top.png";LoadingImg12=new Image();LoadingImg12.src="%COMMON_FILE%Images/tooltip-right-top.png";LoadingImg13=new Image();LoadingImg13.src="%COMMON_FILE%Images/tooltip-right-top-over.png";LoadingImg16=new Image();LoadingImg16.src="%COMMON_FILE%Images/Tooltip-bars-bg.png";LogoImg1=new Image();LogoImg1.src="%COMMON_FILE%Images/sulogo.png";LogoImg2=new Image();LogoImg2.src="%COMMON_FILE%Images/RSlogo-footer.png";LogoImg3=new Image();LogoImg3.src="%COMMON_FILE%Images/top-bottom-bar-bg.png";LogoImg4=new Image();LogoImg4.src="%COMMON_FILE%Images/top-bottom-bar-bg.png";</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript" src="%FILE%Include/LoginFunctions.js"></script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript" src="%FILE%Include/Login.js"></script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/Dialog.js"></script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_sBusyDialog="BusyDialog";function BusyDialog(bShow,sTitle,bWebClientIcon,bFromApplet){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top!="-5000px")bSkip=true;if(!bSkip){if(bShow)ShowDialog(g_sBusyDialog,undefined,undefined,bFromApplet);else{HideDialog(g_sBusyDialog,undefined,bFromApplet);sTitle="$BUSY_DIALOG_TITLE$";}SetupBusyDialog(sTitle,bWebClientIcon);}}function SetupBusyDialog(sTitle,bWebClientIcon){var TitleText=document.getElementById("BusyDialogTitleText");var sBusyDialogImage="su16x16.png";MCBusyDialogImage=new Image();MCBusyDialogImage.src="%COMMON_FILE%Images/su16x16.png";WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bWebClientIcon)document.getElementById("BusyDialogTitleIcon").src=WCBusyDialogImage.src;else document.getElementById("BusyDialogTitleIcon").src=MCBusyDialogImage.src;if((TitleText!=undefined)&&(sTitle!=undefined))TitleText.innerHTML="<strong>"+sTitle+"</strong>";var DialogCloseContainer=document.getElementById("BusyDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("BusyDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";}function SavingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$SAVING_DIALOG_TITLE$",bWebClientIcon);}function LoadingDialog(bShow,bWebClientIcon){var bSkip=false;if(bShow&&document.getElementById("BusyDialog").style.top=="-5000px")bSkip=true;if(!bSkip)BusyDialog(bShow,"$LOADING_DIALOG_TITLE$",bWebClientIcon);}function DeletingDialog(bShow,bWebClientIcon){BusyDialog(bShow,"$DELETING_DIALOG_TITLE$",bWebClientIcon);}</script><div id="BusyDialoginner" style="display:none;text-align:center;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" style="margin:0px auto 0px auto;"></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("$BUSY_DIALOG_TITLE$","BusyDialog","200","50","text-align:center","$CLOSE_CANCEL$");</script><div id="ConfirmDialoginner" style="display:none;overflow:hidden; text-overflow:ellipsis;"><table border="0" id="ConfirmDialogtable"><tr><td><img src="%COMMON_FILE%Images/QuestionMark.png" border="0" width="32" height="32" style="margin-right:8px"></td><td style="overflow:hidden; text-overflow:ellipsis;"><div id="ConfirmDialogText" style="width:200px;overflow-y:visible;overflow-x:auto;text-align:left;padding-left:2px;"></div></td></tr><tr><td colspan="2" style="text-align:center" id="ConfirmDialogbuttons"><span id="ConfirmDialogYesButton"></span><span id="ConfirmDialogNoButton"></span></td></tr></table></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("%PRODUCT%","ConfirmDialog","250","115","text-align:center","$CLOSE_CANCEL$");var g_sDeletingDialogTitle="$DELETING_DIALOG_TITLE$";var g_sConfirmDialog="ConfirmDialog";var g_fnYes=undefined,g_fnNo=undefined;var g_YesNoData=undefined;var g_bNoCloseDialog=false;var DEFAULT_CONFIRM_DIALOG_SIZE={WIDTH:"250px",HEIGHT:"115px"};function ConfirmDialog(sText,fnYes,fnNo,YesNoData,nWidth,nHeight,bDelete,bWebClientIcon,bNoCloseDialog,fnClose){var confirmDialog=document.getElementById("ConfirmDialog");var confirmDialogText=document.getElementById("ConfirmDialogText");var confirmDialogIcon=document.getElementById("ConfirmDialogTitleIcon");var dialogSize=getDialogSize(nWidth,nHeight);g_fnYes=g_fnNo=undefined;WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";if(bNoCloseDialog)g_bNoCloseDialog=true;else g_bNoCloseDialog=false;if(bWebClientIcon){confirmDialogIcon.src=WCBusyDialogImage.src;confirmDialogIcon.height="16";confirmDialogIcon.width="16";}if((confirmDialogText!=undefined)&&(sText!=undefined)){confirmDialogText.innerHTML=sText;}g_fnYes=fnYes;g_fnNo=fnNo;g_YesNoData=YesNoData;confirmDialog.style.width=dialogSize.width;confirmDialogText.style.width=(parseInt(dialogSize.width)-50)+"px";document.getElementById("ConfirmDialogBody").style.overflow="hidden";document.getElementById("ConfirmDialogBody").style.textOverflow="ellipsis";ShowDialog("ConfirmDialog",undefined,fnClose);if(bDelete)ConfirmDialogNoButton.focus();else ConfirmDialogYesButton.focus();}function getDialogSize(customWidth,customHeight){var dialogWidth=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;var dialogHeight=DEFAULT_CONFIRM_DIALOG_SIZE.WIDTH;if(!!customWidth){dialogWidth=isWithUnits(customWidth)?customWidth:customWidth+"px";}if(!!customHeight){dialogHeight=isWithUnits(customHeight)?customHeight:customHeight+"px";}return{width:dialogWidth,height:dialogHeight};}function isWithUnits(size){return size.toString().match(/px|%|vh|vw|em|rem/);}function CloseConfirmDialog(){HideDialog("ConfirmDialog");}function OnConfirmDialogYes(){if(g_fnYes!=undefined){setTimeout(function(){g_fnYes(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}if(!g_bNoCloseDialog)CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined){setTimeout(function(){g_fnNo(g_YesNoData);g_fnYes=g_fnNo=undefined;},200);}CloseConfirmDialog();}var ConfirmDialogYesButton=CreatePushButton("$YES_BUTTON$","ConfirmDialogYesButton",OnConfirmDialogYes);ConfirmDialogYesButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogYesButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogNoButton.focus();}});var ConfirmDialogNoButton=CreatePushButton("$NO_BUTTON$","ConfirmDialogNoButton",OnConfirmDialogNo);ConfirmDialogNoButton.keypress(function(event){sYesButtonChar=ConfirmDialogYesButton.getControlText().charAt(0).toLowerCase();sNoButtonChar=ConfirmDialogNoButton.getControlText().charAt(0).toLowerCase();if(sYesButtonChar!=sNoButtonChar){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toLowerCase()==sYesButtonChar)OnConfirmDialogYes();else if(key.toLowerCase()==sNoButtonChar)OnConfirmDialogNo();}});ConfirmDialogNoButton.keyup(function(event){var code=event.keyCode||event.which;if(code=='9'){ConfirmDialogYesButton.focus();}});</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">var sLocalHostName=document.location.hostname;if((sLocalHostName=="localhost"||sLocalHostName=="127.0.0.1"||sLocalHostName=="::1")&&parseInt(GetURLParameter("LocalAdmin"))==1)g_bIsLocalAdmin=true;clearSessionCookies('domainid');clearSessionCookies('domainodbc');</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">LoadingDialog(true);</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--></head><body>
<!--#include "%CUSTOM_HTML_DIR%\%CUSTOM_HTML_LOGIN_HEADER%" "Include\LoginHeader.htm"-->
<div id="JavaWarning" style="display:block;"><table border="0" class="jwarn"><tr><td><img src="%COMMON_FILE%Images/Warn.png" border="0" width="32" height="32" style="margin-right:8px"></td><td><div id="JavaWarningText">$JSCRIPT_DISABLED_WARN$</div><div id="BrowserWarningText" style="display:none;">$BROWSER_NOT_COMPATIBLE_WARN$</div></td></tr></table><div style="text-align:center;" id="JavaWarningReload"><a href="/">$RELOAD$</a></div></div><div id="FormLayer" style="display:none;"><div id="ErrMsg" ><span id="ErrMsg-text"></span></div></div><div id="CustomHTTPLoginText" style="display:none;">%LOGIN_PAGE_TEXT%</div><form name="login" onsubmit="return (false);"><div class="username" id="UserNameID" style="visibility:hidden;"><span class="fieldname">$LOGINID$:</span><span class="fieldinput"><span id="UserNameInput"></span></span></div><div class="pword"><span class="fieldname">$PASSWORD$:</span><span class="fieldinput"><span id="PasswordInput"></span></span></div><div class="language" id="LangContainer" style="display:none"><span class="fieldname">$LANGUAGE$:</span><span class="fieldinput"><span id="Language"><select id="Language-Combo" value="jp,JP" style="width:200px;height:21px;outline:none;"><option value="en,US">$ENGLISH$</option><option value="de,DE">$GERMAN$</option><option value="it,IT">$ITALIAN$</option><option value="fr,FR">$FRENCH$</option><option value="es,ES">$SPANISH$</option><option value="pt,PT">$PORTUGUESE$</option><option value="sr,SR">$SERBIAN$</option><option value="se,SE">$SWEDISH$</option><option value="fi,FI">$FINISH$</option><option value="no,NO">$NORWEGIAN$</option><option value="ru,RU">$RUSSIAN$</option><option value="dk,DK">$DANISH$</option><option value="zh,CN">$SIMPLIFIED_CHINESE$</option><option value="zh,TW">$TRADITIONAL_CHINESE$</option><option value="jp,JP">$JAPANESE$"</option></select></span></span></div><div><table border="0" cellpadding="0" cellspacing="0" class="RememberMeTable"><tr><td style="text-align:left;"><div class="RememberMeSpacer"><span id="RememberUserID" style="visibility:hidden;font-weight:bold;"><span id="remember"></span></span></div></td><td id="loginBtnCol" style="text-align:right;"><span id="LoginButton"></span></td></tr></table></div></form></div><div id="LoginTaskBar" style="display:none; padding-bottom: 10px;"><span id="PasswordRecoverTxt"><a id="PasswordRecoverTxtLink" class="">$RECOVER_PASSWORD_BUTTON$</a></span></div>
<!--#include "%CUSTOM_HTML_DIR%\%CUSTOM_HTML_LOGIN_FOOTER%" "Include\LoginFooter.htm"-->
<FORM id="CookieCheck"><input type="hidden" name="cookieexists" value="false"></FORM><FORM id="UserPlacementPost" method="post" action=""><input type="hidden" id="EncSession" name="EncSession"/></FORM><div id="AlertDialoginner" style="display:none;"><table border="0"><tr><td style="vertical-align:top;"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px"></td><td style="text-align:left; padding-right: 10px"><span id="AlertDialogText" style="word-break: break-word; -ms-word-break: break-word; display: inline-block"></span><div id="AlertNoShowContainer" style="display:none;padding-top:10px;"><span id="AlertNoShowDialogCheckBox"></span></div></td></tr></table><div style="width:100%;text-align:center;"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></div><!--tr><td colspan="2" style="text-align:center"><span id="AlertDialogOkButton"></span><span id="ExtraButton"></span></td></tr></table--></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var ExtraButton,g_bAlertNoShow,g_sAlertNoShowCookie;InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";BuildDialog("%PRODUCT%","AlertDialog","250","115","text-align:center","$CLOSE_CANCEL$");function AlertDialog(sText,bWarn,fn_OKCallback,bWebClientIcon,sExtraButtonText,fn_ExtraCallback,nWidth,nHeight,bAlertNoShow,sAlertNoShowCookie){WCBusyDialogImage=new Image();WCBusyDialogImage.src="%COMMON_FILE%Images/WebClient16.png";g_bAlertNoShow=false;g_sAlertNoShowCookie="";document.getElementById("AlertNoShowContainer").style.display="none";if(bWebClientIcon){document.getElementById("AlertDialogTitleIcon").src=WCBusyDialogImage.src;document.getElementById("AlertDialogTitleIcon").height="16";document.getElementById("AlertDialogTitleIcon").width="16";}if((sExtraButtonText!=undefined)&&(fn_ExtraCallback!=undefined)){ExtraButton=CreatePushButton(sExtraButtonText,"ExtraButton",function(){HideDialog("AlertDialog");fn_ExtraCallback();});document.getElementById("ExtraButton").style.display="";}else{document.getElementById("ExtraButton").style.display="none";ExtraButton=undefined;fn_ExtraCallback=undefined;}if(nWidth!=undefined){document.getElementById("AlertDialog").style.width=nWidth+"px";}else document.getElementById("AlertDialog").style.width="250px";if(bAlertNoShow&&sAlertNoShowCookie!=undefined){g_bAlertNoShow=true;g_sAlertNoShowCookie=sAlertNoShowCookie;document.getElementById("AlertNoShowContainer").style.display="block";}g_fnAlertOKCallback=fn_OKCallback;if(document.getElementById("AlertImage")!=undefined){if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;document.getElementById("AlertImage").src=sImage;}if((document.getElementById("AlertDialogText")!=undefined)&&(sText!=undefined))document.getElementById("AlertDialogText").innerHTML=sText;ShowDialog("AlertDialog");OKAlertButton.focus();}function WarnDialog(sText,bWebClientIcon){AlertDialog(sText,true,undefined,bWebClientIcon);}function OnAlertDialogOkay(){HideDialog("AlertDialog");if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();document.getElementById("AlertImage").src=BlankImg.src;g_fnAlertOKCallback=undefined;if(g_bAlertNoShow){if(AlertNoShowCheckBox.getControlValue())createCookie(g_sAlertNoShowCookie,"1",60);}}var OKAlertButton=CreatePushButton("$OK_BUTTON$","AlertDialogOkButton",OnAlertDialogOkay);var AlertNoShowCheckBox=CreateCheckBox("$DONT_SHOW_AGAIN$","AlertNoShowDialogCheckBox","AlertNoShowCheckBox");</script><div id="LoggingInDialoginner" class="nova-spinner-container" style="display:none;"><span class="nui nui-icon-busy-circular nui-spinner nui-spinner__container--large "><div class="nui-spinner__container"><svg viewBox="25 25 50 50" class="nui-spinner__circular" style=""><circle cx="50" cy="50" r="22" fill="none" stroke-width="5" stroke-miterlimit="10" class="nui-spinner__path-under"></circle><circle cx="50" cy="50" r="22" fill="none" stroke-width="5" stroke-miterlimit="10" class="nui-spinner__path"></circle></svg></div><div class="nui-spinner__text-content"></div></span></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">BuildDialog("$LOGGING_IN_DIALOG_TITLE$","LoggingInDialog","200","50","text-align:center","$CLOSE_CANCEL$");var DialogLoginCloseContainer=document.getElementById("LoggingInDialogclosebox");if(DialogLoginCloseContainer!=undefined)DialogLoginCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("LoggingInDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";</script><div id="WelcomeDialoginner" style="display:none;text-align:left;"><table border="0"><tr><td style="width:50px;vertical-align:top;"><img src="%COMMON_FILE%Images/Star32.png" width="32" height="32" border="0" align="middle" alt="%PRODUCT%" style="margin:0 8px 0 0;border:none;"></td><td style="width:340px;text-align:left;vertical-align:middle;padding-right:10px;"><div id="WelcomeDialogText"></div></td></tr><tr><td colspan="2" style="text-align:center"><span id="WelcomeDialogOkButton"></span>&nbsp;&nbsp;<span id="LogOutWelcomeDialogButton"></span></td></tr></table></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnWelcomeOKCallback=undefined;BuildDialog("%PRODUCT%","WelcomeDialog","400","300","text-align:center","$CLOSE_CANCEL$");function WelcomeDialog(sText,fn_OKCallback){var DialogCloseButton=document.getElementById("WelcomeDialogCloseIcon");var WelcomeDialogText=document.getElementById("WelcomeDialogText");var DialogCloseContainer=document.getElementById("WelcomeDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";if(fn_OKCallback!=undefined)g_fnWelcomeOKCallback=fn_OKCallback;if((WelcomeDialogText!=undefined)&&(sText!=undefined))WelcomeDialogText.innerHTML=sText;ShowDialog("WelcomeDialog");WelcomeDialogOKButton.focus();}function OnWelcomeDialogOkay(){if(g_fnWelcomeOKCallback!=undefined)g_fnWelcomeOKCallback();else HideDialog("WelcomeDialog");g_fnWelcomeOKCallback=undefined;}function OnLogOutWelcomeDialog(){location.href='%LOGOUT%';}var WelcomeDialogOKButton=CreateDialogPushButton("$OK_BUTTON$","WelcomeDialogOkButton",OnWelcomeDialogOkay);CreateDialogPushButton("$LOGOUT$","LogOutWelcomeDialogButton",OnLogOutWelcomeDialog);</script>
<!--#include "Include\..\..\Common\Strings\Result.strings"-->
<div id="RecoverPasswordDialoginner" style="display:none;"><form name="login_recover_password" onsubmit="return (false);"><div class="recover-password-dialog-main"><div class="nova-dialog-field-label"><span>$LOGINID$:</span></div><div class="nova-dialog-field-input"><span id="RecoverPasswordLoginID"></span></div></div><div class="recover-password-dialog-footer"><span id="CancelRecoverPasswordButton"></span><span id="RecoverPasswordButton"></span></div></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BuildDialog("$RECOVER_PASSWORD_TITLE$","RecoverPasswordDialog","300","200","","$CLOSE_CANCEL$",undefined,undefined,"");function OnRecoverPasswordSubmit(){var sRecoverPasswordCmd="%FILE%Result.xml?Command=RecoverUserPassword";var RecoverPasswordRequest=CreatePostRequest(sRecoverPasswordCmd);var sIDPasswordRecover;sIDPasswordRecover=PasswordRecoverLoginID.getControlText();RecoverPasswordRequest.setParameter("user",sIDPasswordRecover);RecoverPasswordRequest.setAsync(true);RecoverPasswordRequest.request();RecoverPasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==1)AlertDialog("$PASSWORD_RECOVER_FAILURE_ERROR$");else AlertDialog(GetResultText(0,"",sResultText));}else{HideDialog('RecoverPasswordDialog');AlertDialog("$PASSWORD_RECOVERED$");}};}function OnCancelRecoverPassword(){HideDialog('RecoverPasswordDialog');}function ClearPasswordDialog(){PasswordRecoverLoginID.setControlText("");}function OnShowRecoverPasswordDialog(){if(LoginIDInput!=undefined)PasswordRecoverLoginID.setControlText(document.login.user.value);else ClearPasswordDialog();ShowDialog("RecoverPasswordDialog");PasswordRecoverLoginID.getContent("box/text").element().focus();}CreatePushButton("$OK_BUTTON$","RecoverPasswordButton",OnRecoverPasswordSubmit,85,25,undefined,undefined,"button_blue_nova");var CancelPasswordButton=CreatePushButton("$CANCEL_BUTTON$","CancelRecoverPasswordButton",OnCancelRecoverPassword,85,25,undefined,undefined,"button-white-nova");var PasswordRecoverLoginID=CreateInputField("","RecoverPasswordLoginID","recoverID",undefined,270,undefined,undefined,OnRecoverPasswordSubmit);var PasswordRecoverCloseButton=document.getElementById("RecoverPasswordDialogCloseIcon");PasswordRecoverCloseButton.addEventListener("click",OnCancelRecoverPassword);</script>
<!--#include "Include\..\..\Common\Strings\Result.strings"-->
<div class="nova-dialog-wrapper Hidden"><div id="MFADialog" class="nova-dialog"><div class="nova-dialog__header"><h3 class="nova-dialog__title">$MFA_MODAL_TITLE$</h3><div class="nova-dialog__close"><img src="/Web Client/Images/close-outline.svg" alt="close"></div></div><div class="nova-dialog__body"><div class="mfa-totp__setup mfa-setup"><div class="mfa-setup__step-info"><img src="/Web Client/Images/info-outline.svg" alt="info"><span class="admin-setup">$MFA_ADMIN_ENABLED$</span></div><p class="nova-dialog__head-text">$MFA_SETUP_HEADER$</p><p>$MFA_SETUP_COMPLETE$</p><div class="mfa-setup__step"><div class="mfa-setup__step-title"><span>1. <span>$MFA_SETUP_STEP_ONE_INSTALL$</span></span></div><div class="mfa-setup__step-description"><p style="font-weight: 500;">$MFA_SETUP_STEP_ONE_REOMMENDATIONS$</p><p><span>Android/IOS: </span><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2"target="_blank">Google</a>&nbsp;<a href="https://www.microsoft.com/security/mobile-authenticator-app" target="_blank">Microsoft</a>&nbsp;<a href="https://lastpass.com/misc_download2.php" target="_blank">LastPass</a>&nbsp;<a href="https://authy.com/download" target="_blank">Authy</a></p></div></div><div class="mfa-setup__step"><div class="mfa-setup__step-title"><span>2. <span>$MFA_SETUP_STEP_TWO_CHOOSE$</span></span></div><div class="mfa-setup__step-description"><div class="mfa-setup__barcode"><img class="mfa-setup__barcode-image" src="" alt="bar_code"></div></div><div class="mfa-setup__secret mfa-secret"><div class="mfa-secret__container"><div class="mfa-secret__content"><div class="mfa-secret__head"><div class="mfa-secret__icon"><img src="/Web Client/Images/caret-right.svg" alt="toggle-secret"></div><span>$MFA_SETUP_STEP_TWO_SHOW_KEY$</span></div><div class="mfa-secret__hidden"><span class="mfa-secret__text">$MFA_SETUP_STEP_TWO_TYPE_KEY$</span><div class="mfa-secret__key-container"><div class="mfa-secret__key"></div><button class="mfa-secret__copy nova-button nova-button--primary nova-button--unsized"><span class="mfa-secret__tooltip">$MFA_COPIED_TO_CLIPBOARD$</span>$COPY_BUTTON$</button></div></div></div></div></div></div><div class="mfa-setup__step"><div class="mfa-setup__step-title"><span>3. <span>$MFA_SETUP_STEP_THREE_NEXT$</span></span></div></div></div><div class="mfa-totp__form Hidden"><h4 class="nova-dialog__head-text">$MFA_FORM_ENTER$</h4><form id="mfa-totp-form" class="mfa-totp-form" name="mfa-totp-form" onsubmit="return (false);"><div class="mfa-totp-form__controls"><div class="mfa-totp-form__control"><input type="text" class="mfa-totp-form__input"></div><div class="mfa-totp-form__control"><input type="text" class="mfa-totp-form__input"></div><div class="mfa-totp-form__control"><input type="text" class="mfa-totp-form__input"></div><div class="mfa-totp-form__control"><input type="text" class="mfa-totp-form__input"></div><div class="mfa-totp-form__control"><input type="text" class="mfa-totp-form__input"></div><div class="mfa-totp-form__control"><input type="text" class="mfa-totp-form__input"></div></div><div class="mfa-totp-form__error"><span class="error-message">$MFA_FORM_ERROR$</span></div><div class="mfa-totp-form__tries"><span>$MFA_FORM_TRIES$</span></div></form></div><div class="mfa-totp-result mfa-totp__result Hidden"><div class="mfa-totp-result__content"><img src="/Web Client/Images/check_circle_success.svg" class="mfa-totp-result__image" alt="success"><span class="mfa-totp-result__message">$MFA_MODAL_SUCCESS$</span></div></div></div><div class="nova-dialog__footer"><div class="nova-dialog__controls"><button class="nova-button nova-dialog__skip">$SKIP_BUTTON$</button><button class="nova-button nova-dialog__cancel">$CANCEL_BUTTON$</button><button class="nova-button nova-dialog__back">$BACK_BUTTON$</button><button class="nova-button nova-button--primary nova-dialog__next">$NEXT_BUTTON$</button></div><div class="nova-dialog__entering Hidden"><span class="entering-text">$MFA_MODAL_ENTERING$...</span></div></div></div></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var mfaDialog={dialog:document.getElementById("MFADialog"),setupStep:document.querySelector(".mfa-totp__setup"),barCodeImage:document.querySelector(".mfa-setup__barcode-image"),formStep:document.querySelector(".mfa-totp__form"),adminSetup:document.querySelector(".mfa-setup__step-info .admin-setup"),resultStep:document.querySelector(".mfa-totp__result"),form:document.getElementById("mfa-totp-form"),formHeader:document.querySelector(".mfa-totp__form .nova-dialog__head-text"),totpValidationError:document.querySelector(".mfa-totp-form__error .error-message"),totpTriesLeft:document.querySelector(".mfa-totp-form__tries"),entering:document.querySelector(".nova-dialog__entering"),wrapper:document.querySelector(".nova-dialog-wrapper"),secretHead:document.querySelector(".mfa-secret__head"),secretContent:document.querySelector(".mfa-secret__content"),secretKey:document.querySelector(".mfa-secret__key"),secretCopy:document.querySelector(".mfa-secret__copy"),secretTooltip:document.querySelector(".mfa-secret__tooltip"),controls:document.querySelector(".nova-dialog__controls"),skip:document.querySelector(".nova-dialog__skip"),cancel:document.querySelector(".nova-dialog__cancel"),back:document.querySelector(".nova-dialog__back"),close:document.querySelector(".nova-dialog__close"),next:document.querySelector(".nova-dialog__next"),};var STEPS={SETUP:"SETUP",AUTH:"AUTH",RESULT:"RESULT"};var MFA_STATE={step:undefined,isFormValid:undefined,mfaStatus:undefined,isSkipped:false,isPassed:false };var AUTOFOCUS_ELEMENTS={};AUTOFOCUS_ELEMENTS[STEPS.SETUP]=mfaDialog.next;AUTOFOCUS_ELEMENTS[STEPS.AUTH]=mfaDialog.form[0];initMfaDialog();function initMfaDialog(){resetMfaState();addMfaListeners();}function showMFADialog(mfaStatus,mfaUrls){var isRequired=mfaStatus===MFA_STATUS.REQUIRED;var isSetup=isRequired||(mfaStatus===MFA_STATUS.MAY);MFA_STATE.mfaStatus=mfaStatus;if(isSetup){mfaDialog.barCodeImage.setAttribute("src","/Web Client/"+mfaUrls.barCodeUri);mfaDialog.secretKey.innerHTML=mfaUrls.totpSecret;if(isRequired){mfaDialog.adminSetup.innerHTML="$MFA_ADMIN_ENFORCED$";mfaDialog.skip.classList.add("Hidden");}}else{nextMfaDialog();}mfaDialog.back.classList.add("Hidden");mfaDialog.wrapper.classList.remove("Hidden");AUTOFOCUS_ELEMENTS[MFA_STATE.step].focus();}function addMfaListeners(){mfaDialog.cancel.addEventListener("click",cancelMfaDialog);mfaDialog.skip.addEventListener("click",sendSkipTOTP);mfaDialog.back.addEventListener("click",backMfaDialog);mfaDialog.close.addEventListener("click",cancelMfaDialog);mfaDialog.next.addEventListener("click",nextMfaDialog);mfaDialog.secretHead.addEventListener("click",toggleSecretKey);mfaDialog.secretCopy.addEventListener("click",copySecretKeyToClipboard);for(var i=0;i<mfaDialog.form.elements.length;i++){mfaDialog.form.elements[i].addEventListener("input",onInputChange);mfaDialog.form.elements[i].addEventListener("keyup",onBackspaceInInput);}mfaDialog.form.addEventListener("input",validateMfaForm);}function toggleSecretKey(){mfaDialog.secretContent.classList.toggle("opened");}function copySecretKeyToClipboard(){var text=mfaDialog.secretKey.innerHTML;var clipboard=navigator.clipboard;if(!clipboard){showClipboardCopyTooltip(true);return;}navigator.clipboard.writeText(text).then(function(){showClipboardCopyTooltip();}).catch(function(error){showClipboardCopyTooltip(true);});}function showClipboardCopyTooltip(isError){var copiedToClipboardMessage="$MFA_COPIED_TO_CLIPBOARD$";if(isError){copiedToClipboardMessage="$MFA_COPIED_TO_CLIPBOARD_FAIL$";}mfaDialog.secretTooltip.innerHTML=copiedToClipboardMessage;mfaDialog.secretTooltip.classList.add("visible");setTimeout(function(){mfaDialog.secretTooltip.classList.remove("visible");},1000);}function cancelMfaDialog(){mfaDialog.wrapper.classList.add("Hidden");mfaDialog.form.reset();if(isMFARequired()){logoutUser();return;}logoutUser();}function nextMfaDialog(){if(MFA_STATE.step===STEPS.SETUP){goToAuthStep();AUTOFOCUS_ELEMENTS[MFA_STATE.step].focus();return;}sendTOTP();}function backMfaDialog(){mfaDialog.back.classList.add("Hidden");mfaDialog.cancel.classList.remove("Hidden");mfaDialog.setupStep.classList.remove("Hidden");mfaDialog.formStep.classList.add("Hidden");if(isMFARequired()){mfaDialog.cancel.classList.remove("Hidden");}else{mfaDialog.cancel.classList.remove("Hidden");mfaDialog.skip.classList.remove("Hidden");}mfaDialog.form.reset();mfaDialog.next.removeAttribute("disabled");MFA_STATE.step=STEPS.SETUP;}function goToAuthStep(){mfaDialog.setupStep.classList.add("Hidden");mfaDialog.formStep.classList.remove("Hidden");mfaDialog.next.setAttribute("disabled",true);mfaDialog.skip.classList.add("Hidden");mfaDialog.back.classList.remove("Hidden");if(MFA_STATE.mfaStatus===MFA_STATUS.MAY){mfaDialog.formHeader.innerHTML="$MFA_FORM_ENTER$";mfaDialog.skip.classList.remove("Hidden");}else{mfaDialog.formHeader.innerHTML="$MFA_FORM_ENTER_EXISTING$";mfaDialog.cancel.classList.add("Hidden");}MFA_STATE.step=STEPS.AUTH;}function goToSetupStep(){if(isMfaEnforced()){mfaDialog.skip.classList.add("Hidden");mfaDialog.back.classList.add("Hidden");mfaDialog.cancel.classList.remove("Hidden");}else{mfaDialog.skip.classList.remove("Hidden");mfaDialog.back.classList.add("Hidden");mfaDialog.cancel.classList.add("Hidden");}MFA_STATE.step=STEPS.SETUP;}function validateMfaForm(){var isFormValid=Array.from(mfaDialog.form.elements).every(function(input){return!!input.value.length;});MFA_STATE.isFormValid=isFormValid;if(isFormValid){mfaDialog.next.removeAttribute("disabled");mfaDialog.next.focus();}else{mfaDialog.next.setAttribute("disabled",true);}}function onInputChange(event){if(mfaDialog.form.classList.contains("invalid")){mfaDialog.form.classList.remove("invalid");}allowOnlyDigits(event);}function onBackspaceInInput(event){if(event.code.toUpperCase()!=="BACKSPACE"){return;}var previousControl=event.target.parentElement.previousElementSibling;if(previousControl){previousControl.querySelector(".mfa-totp-form__input").focus();}}function allowOnlyDigits(event){var currentValueAsDigit=event.target.value.replace(/[^0-9\s]/g,"");if(event.data){newDigit=event.data[0].replace(/[^0-9\s]/g,"");}else{newDigit="";}if(!newDigit.length){event.target.value=currentValueAsDigit;return;}event.target.value=newDigit[0];var nextControl=event.target.parentElement.nextElementSibling;if(newDigit.length&&nextControl){nextControl.querySelector(".mfa-totp-form__input").focus();}}function sendSkipTOTP(){var url="%FILE%Login.xml?Command=TOTPPassin";var totpRequest=CreatePostRequest(url,onOptionalMfaSkipped);totpRequest.setParameter("role",MFA_ROLES.SKIP_CREATION);totpRequest.request();}function onOptionalMfaSkipped(xmlDoc){if(isResultSuccessful(xmlDoc)){MFA_STATE.isSkipped=true;if(g_IsShowWelcomeDialog){showWelcomeDialog(g_DialogInfo.bReplace,g_DialogInfo.nResult);return;}redirectAfterSuccessfulLogin(g_DialogInfo.bReplace,g_DialogInfo.nResult);return;}if(isPasswordOrEmailChange(xmlDoc)){MFA_STATE.isSkipped=true;showChangeEmailOrPassword();}else{logoutUser();}}function logoutUser(){var logoutUrl=window.location.protocol+"/"+window.location.host+"/"+"?Command=Logout";window.location.href="%LOGOUT%";}function sendTOTP(){if(!MFA_STATE.isFormValid)return;var url="%FILE%Login.xml?Command=TOTPPassin";var passcode=Array.from(mfaDialog.form.elements).map(function(e){return e.value;}).join('');var totpRequest=CreatePostRequest(url,onTotpResponse);var isMfaCreation=(MFA_STATE.mfaStatus===MFA_STATUS.REQUIRED)||(MFA_STATE.mfaStatus===MFA_STATUS.MAY);if(isMfaCreation){mfaRole=MFA_ROLES.CREATION;}else{mfaRole=MFA_ROLES.VALIDATION;}totpRequest.setParameter("passcode",passcode);totpRequest.setParameter("role",mfaRole);totpRequest.request();}function onTotpResponse(xmlDoc){if(isResultSuccessful(xmlDoc)){MFA_STATE.isPassed=true;onSuccessLogin();return;}if(isPasswordOrEmailChange(xmlDoc)){MFA_STATE.isPassed=true;showChangeEmailOrPassword();}else{handleMFAError(xmlDoc);}}function onSuccessLogin(){MFA_STATE.step=STEPS.RESULT;showSuccessMessage();if(g_IsSetEmailNeeded){showSetEmailDialog(g_DialogInfo.sUserEmail,g_DialogInfo.bReplace,g_DialogInfo.nResult);return;}if(g_IsShowWelcomeDialog){showWelcomeDialog(g_DialogInfo.bReplace,g_DialogInfo.nResult);return;}redirectAfterSuccessfulLogin(g_DialogInfo.bReplace,g_DialogInfo.nResult);}function handleMFAError(xmlDoc){var triesLeft=+GetXMLValue(xmlDoc,"TOTPLoginTriesLeft");if(triesLeft<1){logoutUser();return;}mfaDialog.totpTriesLeft.querySelector(".tries-left").innerHTML=triesLeft;mfaDialog.form.classList.add("invalid");mfaDialog.form.reset();mfaDialog.form[0].focus();mfaDialog.next.setAttribute("disabled",true);}function showSuccessMessage(){mfaDialog.formStep.classList.add("Hidden");mfaDialog.controls.classList.add("Hidden");mfaDialog.resultStep.classList.remove("Hidden");mfaDialog.entering.classList.remove("Hidden");}function resetMfaState(){MFA_STATE.step=STEPS.SETUP;MFA_STATE.isFormValid=false;MFA_STATE.mfaStatus="";}function isMFARequired(){return isMfaEnforced()||isMfaEnabled();}function isMfaEnforced(){return MFA_STATE.mfaStatus===MFA_STATUS.REQUIRED;}function isMfaEnabled(){return MFA_STATE.mfaStatus===MFA_STATUS.USES;}function isResultSuccessful(xmlDoc){return+GetXMLValue(xmlDoc,"result")===0;}function isPasswordOrEmailChange(xmlDoc){return+GetXMLValue(xmlDoc,"result")===g_nSessionChangePasswordOrEmail;}function showChangeEmailOrPassword(){if(g_IsSetEmailNeeded){showSetEmailDialog(g_DialogInfo.sUserEmail,g_DialogInfo.bReplace,g_DialogInfo.nResult);}else{ChangePasswordDialog(true);}}</script><div id="UserEmailDialoginner" style="display:none;"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;">$EMAIL_DESCR$ <br /><div style="margin-top:5px;">$EMAIL$:<br /><div style="overflow:auto"><span id="CurrentUserEmail"></span></div></div><div>$VERIFY_EMAIL$:<br /><div style="overflow:auto"><span id="UserEmail"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"></span><br /><span id="LogoutUserEmailButton"></span><span id="CancelUserEmailButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sWebClientChangeEmail=undefined;var sChangeEmailImg=undefined;try{if(g_bIsWebClient){sWebClientChangeEmail="WC-Icon-ChangeEmail";}else{sChangeEmailImg="ChangeEmail.png";}}catch(e){sChangeEmailImg="ChangeEmail.png";}BuildDialog("$USER_EMAIL_TITLE$","UserEmailDialog","300","160","","$CLOSE_CANCEL$",sChangeEmailImg,undefined,sWebClientChangeEmail);function OnSetEmailAddressSubmit(){var sSetEmailCmd="%FILE%Result.xml?Command=SetEmailAddress";var SetEmailRequest=CreatePostRequest(sSetEmailCmd);var sEmailAddrs,CurrentEmailAddr;sEmailAddr=UserEmailInput.getControlText();sCurrentEmailAddr=CurrentUserEmail.getControlText();SetEmailRequest.setParameter("emailaddress",sEmailAddr);SetEmailRequest.setAsync(true);if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.request();else AlertDialog("$EMAIL_VALS_NO_MATCH$");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{HideDialog('UserEmailDialog');if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnCancelSetEmail(){HideDialog('UserEmailDialog');}function ClearSetEmailDialog(){UserEmailInput.setControlText("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(bNoCloseButton){var DialogCloseContainer=document.getElementById("UserEmailDialogclosebox");if(DialogCloseContainer!=undefined)DialogCloseContainer.className="closebox-none";var DialogCloseButton=document.getElementById("UserEmailDialogCloseIcon");if(DialogCloseButton!=undefined)DialogCloseButton.style.display="none";CancelEmailButton.setStyle("display","none");LogoutUserEmailButton.setStyle("display","");}else{LogoutUserEmailButton.setStyle("display","none");}if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)CurrentUserEmail.setControlText(sEmail);else ClearSetEmailDialog();ShowDialog("UserEmailDialog");CurrentUserEmail.getContent("box/text").element().focus();}function OnLogoutEmailSet(){location.href="%LOGOUT%";}CreateDialogPushButton("$OK_BUTTON$","SaveUserEmailButton",OnSetEmailAddressSubmit);var CancelEmailButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelUserEmailButton",OnCancelSetEmail);var LogoutUserEmailButton=CreateDialogPushButton("$LOGOUT$","LogoutUserEmailButton",OnLogoutEmailSet);var UserEmailInput=CreateInputField("","UserEmail","UserEmail",undefined,200,undefined,undefined,OnSetEmailAddressSubmit);var CurrentUserEmail=CreateInputField("","CurrentUserEmail","CurrentUserEmail",undefined,200,undefined,undefined);</script><div id="ChangePasswordDialoginner" style="display:none;"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;"><div>$OLD_PASSWORD$:<div style="overflow:auto"><span id="OldPasswordChange"></span></div></div><div>$NEW_PASSWORD$:<br /><div style="overflow:auto"><span id="NewPasswordChange"></span></div></div><div>$VERIFY_PASSWORD$:<div style="overflow:auto"><span id="VerifyNewPasswordChange"></span></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"></span><br /><span id="CancelChangePasswordButton"></span></td></tr></table></form></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var sWebClientChangePWord=undefined;var sChangePWordImg=undefined;try{if(g_bIsWebClient){sWebClientChangePWord="WC-Icon-ChangePassword";}else{sChangePWordImg="Change_Password16.png";}}catch(e){sChangePWordImg="Change_Password16.png";}BuildDialog("$PASSWORD_EXPIRED_TITLE$","ChangePasswordDialog","300","155","","$CLOSE_CANCEL$",sChangePWordImg,undefined,sWebClientChangePWord);function OnChangePasswordSubmit(){var sChangePasswordCmd="%FILE%Login.xml?Command=LoginChangePassword";var ChangePasswordRequest=CreatePostRequest(sChangePasswordCmd);var sOldPassWord,sNewPassWord,sVerifyPassWord;sOldPassWord=OldPasswordInput.getControlText();sNewPassWord=NewPasswordInput.getControlText();sVerifyPassWord=VerifyNewPasswordInput.getControlText();if(sNewPassWord==sVerifyPassWord){ChangePasswordRequest.setParameter("old_password",sOldPassWord);ChangePasswordRequest.setParameter("new_password",sNewPassWord);ChangePasswordRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);ChangePasswordRequest.setAsync(true);ChangePasswordRequest.request();ChangePasswordRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var sWelcomeMsg=GetXMLValue(XMLDoc,"welcomemsg");if(nResult!=0){if(nResult==1)sResultText="$ERROR_PASSWORD_CHANGE_FAIL$";AlertDialog(GetResultText(0,"",sResultText));}else if(g_bLoginUser){ReplaceDialog("ChangePasswordDialog","LoggingInDialog");OnLoginOK(false,nResult,XMLDoc);}else{HideDialog('ChangePasswordDialog');AlertDialog("$PASSWORD_CHANGED$");}};}else{AlertDialog("$PASSWORDS_DONT_MATCH$",true);}}function OnCancelChangePassword(){HideDialog('ChangePasswordDialog');location.href="%LOGOUT%";}function ClearPasswordDialog(){OldPasswordInput.setControlText("");NewPasswordInput.setControlText("");VerifyNewPasswordInput.setControlText("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();ShowDialog("ChangePasswordDialog");OldPasswordInput.getContent("box/text").element().focus();if(bLogin){CancelPasswordButton.setControlText("$LOGOUT$");document.getElementById("ChangePasswordDialogCloseIcon").onmousedown=OnCancelChangePassword;}}CreateDialogPushButton("$OK_BUTTON$","ChangePasswordButton",OnChangePasswordSubmit);var CancelPasswordButton=CreateDialogPushButton("$CANCEL_BUTTON$","CancelChangePasswordButton",OnCancelChangePassword);var OldPasswordInput=CreatePasswordField("","OldPasswordChange","OldPasswordChange",undefined,200);var NewPasswordInput=CreatePasswordField("","NewPasswordChange","NewPasswordChange",undefined,200);var VerifyNewPasswordInput=CreatePasswordField("","VerifyNewPasswordChange","VerifyNewPasswordChange",undefined,200);</script><div id="AskUserPlacementDialoginner" style="display:none;"><div class="user-placement-dialog-body" ><div class="user-placement-dialog-helper-box"><div id="Description">$USER_PLACEMENT_DESC1$</div><div id="SwitchClientTxt">$SWITCH_PLACEMENT_ANYTIME$</div></div><div id="UserPlacementGroup"><div id="WCNew-OptBox" class="login-menu-option"><input type="radio" name="UserPlacementRadio" id="radio4" class="css-checkbox" checked="checked" value="2" /><label for="radio4" class="option-label checked" id="radio4-label"><img src="%COMMON_FILE%Images/folder.png" /><div><span class="option-label-header">$WEB_CLIENT_NEW$</span><span class="option-label-header-helper" id="WebClientNewOptionWC" >$USER_PLACEMENT_DESC1_2$</span></div></label></div><div id="WC-OptBox" class="login-menu-option"><input type="radio" name="UserPlacementRadio" id="radio1" class="css-checkbox" checked="checked" value="0" /><label for="radio1" class="option-label checked" id="radio1-label"><img src="%COMMON_FILE%Images/folder.png" /><div><span class="option-label-header">$BASIC_WEB_CLIENT$</span><span class="option-label-header-helper" id="WebClientOptionWC">$USER_PLACEMENT_DESC1_1$</span></div></label></div><div id="FSNew-OptBox" class="login-menu-option"><input type="radio" name="UserPlacementRadio" id="radio5" class="css-checkbox" checked="checked" value="4" /><label for="radio5" class="option-label checked" id="radio5-label"><img src="%COMMON_FILE%Images/share-file.png" /><div><span class="option-label-header">$WEB_CLIENT_SHARE_NEW$</span><span class="option-label-header-helper" id="WebClientOptionSharingNew">$USER_PLACEMENT_DESC2_2$</span></div></label></div><div id="FS-OptBox" class="login-menu-option"><input type="radio" name="UserPlacementRadio" id="radio3" class="css-checkbox" value="3" /><label for="radio3" class="option-label" id="radio3-label"><img src="%COMMON_FILE%Images/share-file.png" /><div><span class="option-label-header">$FILE_SHARING$</span><span class="option-label-header-helper" id="WebClientOptionSharing">$USER_PLACEMENT_DESC3$</span></div></label></div><div id="FVJV-OptBox" class="login-menu-option"><input type="radio" name="UserPlacementRadio" id="radio2" class="css-checkbox" value="1" /><label for="radio2" class="option-label" id="radio2-label"><img src="%COMMON_FILE%Images/folder-up.png" /><div><span class="option-label-header">$FVJV$</span><span class="option-label-header-helper" id="WebClientOptionFVJV">$USER_PLACEMENT_DESC2$</span></div></label></div></div></div><div class="user-placement-dialog-footer"><span id="PlacementOKButton"></span><span id="PlacementLogoutButton"></span></div></div><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">var OPTION_WC=0;var OPTION_WC_NEW=2;var OPTION_FVJV=1;var OPTION_ADHOC=3;var OPTION_ADHOC_NEW=4;var OPTION_IDS={WC:"#WC-OptBox",WC_NEW:"#WCNew-OptBox",FVJV:"#FVJV-OptBox",FILE_SHARE:"#FS-OptBox",FILE_SHARE_NEW:"#FSNew-OptBox"};BuildDialog("$ASK_USER_TITLE$","AskUserPlacementDialog","450","230","","$CLOSE_CANCEL$");var AskUserDialogCloseContainer=document.getElementById("AskUserPlacementDialogclosebox");if(AskUserDialogCloseContainer!=undefined)AskUserDialogCloseContainer.className="closebox-none";var AskUserDialogCloseButton=document.getElementById("AskUserPlacementDialogCloseIcon");if(AskUserDialogCloseButton!=undefined)AskUserDialogCloseButton.style.display="none";var m_bAllowWCLogin=(%ALLOW_WEB_CLIENT%=="1")?true:false;var m_bAllowFVJVLogin=(%ALLOW_FTP_VOYAGER_JV%=="1")?true:false;var m_bAllowAdhocLogin=(%ALLOW_ADHOC_FILE_SHARING%=="1")?true:false;function OnUpdateUserPlacementOpts(bAllowWCLogin,bAllowFVJVLogin,bAllowAdhocLogin){if((!bAllowWCLogin)&&(!bAllowFVJVLogin)&&(!bAllowAdhocLogin)){showNoOptions();}else{var access={bAllowWCLogin:bAllowWCLogin,bAllowFVJVLogin:bAllowFVJVLogin,bAllowAdhocLogin:bAllowAdhocLogin };showMultipleOptions(access);}}function showNoOptions(){document.getElementById("Description").innerHTML="$USER_PLACEMENT_DESC_ALL_DISABLED$";$("#SwitchClientTxt").hide();$("#PlacementOKButton").hide();$("#PlacementLogoutButton").show();$(OPTION_IDS.WC).hide();$(OPTION_IDS.WC_NEW).hide();$(OPTION_IDS.FVJV).hide();$(OPTION_IDS.FILE_SHARE).hide();$(OPTION_IDS.FILE_SHARE_NEW).hide();}function showMultipleOptions(access){var bAllowWCLogin=access.bAllowWCLogin;var bAllowFVJVLogin=access.bAllowFVJVLogin;var bAllowAdhocLogin=access.bAllowAdhocLogin;document.getElementById("Description").innerHTML="$USER_PLACEMENT_DESC1$";$("#SwitchClientTxt").show();$("#PlacementOKButton").show();$("#PlacementLogoutButton").hide();showOption(OPTION_IDS.WC,bAllowWCLogin);showOption(OPTION_IDS.WC_NEW,bAllowWCLogin);showOption(OPTION_IDS.FVJV,bAllowFVJVLogin);showOption(OPTION_IDS.FILE_SHARE,bAllowAdhocLogin);showOption(OPTION_IDS.FILE_SHARE_NEW,bAllowAdhocLogin);if(bAllowAdhocLogin){selectOption(OPTION_IDS.WC_NEW);return;}if(bAllowFVJVLogin){selectOption(OPTION_IDS.FVJV);return;}if(bAllowAdhocLogin){selectOption(OPTION_IDS.FILE_SHARE_NEW);return;}}function showOption(optionId,isShow){if(isShow){$(optionId).show();}else{$(optionId).hide();}}function selectOption(optionId,isSelected){$(OPTION_IDS.WC_NEW).find("[type=radio]").prop("checked",!!isSelected).focus();}function OnUserPlacement(){var nItemValue=parseInt($('input[name="UserPlacementRadio"]:checked').val());if(nItemValue==OPTION_WC)OnBasicWebClient();else if(nItemValue==OPTION_WC_NEW)OnWebClientNew();else if(nItemValue==OPTION_ADHOC_NEW)OnFileSharingNew();else if(nItemValue==OPTION_FVJV)OnFVJV();else if(nItemValue==OPTION_ADHOC)OnFileSharing();}function OnUserPlacementLogout(){location.href="%LOGOUT%";}function OnBasicWebClient(){ReplaceDialog("AskUserPlacementDialog","LoggingInDialog");var sURLParams="";if(GetURLParameter("user")!="")sURLParams=GetBWCLoadParameters();location.href="%FILE%ListDir.htm"+sURLParams;}function OnWebClientNew(){ReplaceDialog("AskUserPlacementDialog","LoggingInDialog");if(GetURLParameter("user")!="")sURLParams=GetBWCLoadParameters();location.href="/WebClientNew/Browser/~";}function OnFileSharingNew(){ReplaceDialog("AskUserPlacementDialog","LoggingInDialog");location.href="/WebClientNew/Requested";}function OnFVJV(){ReplaceDialog("AskUserPlacementDialog","LoggingInDialog");location.href="%COMMON_FILE%FVJVLoggedIn.htm";}function OnFileSharing(){ReplaceDialog("AskUserPlacementDialog","LoggingInDialog");location.href="%FILE%Share/Console.htm";}var PlacementOKButton=CreatePushButton("$OK_CONT_BUTTON$","PlacementOKButton",OnUserPlacement,90,25,undefined,undefined,"button_blue_nova");var PlacementLogoutButton=CreatePushButton("$LOGOUT$","PlacementLogoutButton",OnUserPlacementLogout);$('.option-label').click(function(){$(".option-label").removeClass("checked");$("#"+this.id).addClass("checked");sInputID=this.id.replace("-label","");$("#"+sInputID).prop('checked',true).focus();});$('input:radio').focus(function(){$(".option-label").removeClass("checked");$("#"+this.id+"-label").addClass("checked");sInputID=this.id;$("#"+sInputID).prop('checked',true);});$('input:radio').keypress(function(e){if(e.which==13){OnUserPlacement();return false;}});</script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">var USER_PLACEMENT_BWC=0;var USER_PLACEMENT_FVJV=1;var USER_PLACEMENT_ASK=2;var USER_PLACEMENT_SHARING=3;var USER_PLACEMENT_BWC_PRO=4;var USER_PLACEMENT_NWC=5;var USER_PLACEMENT_NFS=6;var USER_PLACEMENT_NWC_REDIRECT=7;var USER_PLACEMENT_ALL_DISABLED=8;var g_nUserPlacement=USER_PLACEMENT_ASK;var g_bOverrideUserPlacement=false;var g_nUserType;var aLangArray=OnSetLanguageDefault();var g_bLoggedIn=false;var g_IsSetEmailNeeded=false;var g_IsShowWelcomeDialog=false;var g_WelcomeMessage="";var g_DialogInfo={bReplace:false,nResult:0,sUserEmail:""};var g_nSessionOkay=0;var g_nSessionChangePasswordOrEmail=202;var g_nSessNoLicRemoteAdmin=905;var MFA_STATUS={CANNOT:"CANNOT",REQUIRED:"REQUIRED",USES:"USES",MAY:"MAY"};var MFA_ROLES={CREATION:"creation",VALIDATION:"validation",SKIP_CREATION:"skipCreation"};var LanguageCombo=document.getElementById("Language-Combo");LanguageCombo.value=aLangArray[1];LanguageCombo.onchange=SetLangCookie;var g_sLang;if(!String.prototype.includes){String.prototype.includes=function(search,start){'use strict';if(search instanceof RegExp){throw TypeError('first argument must not be a RegExp');}if(start===undefined){start=0;}return this.indexOf(search,start)!==-1;};}function OnSetLanguageDefault(){var sBrowserLanguage=navigator.language?navigator.language:navigator.userLanguage;var sLangVal=readCookie('SULang');var aLanguage;var bLangBrowserSet=false;var sDefaultAdminLang="%LOGIN_PAGE_DEFAULT_LANGUAGE%";if((GetURLParameter("Language")!="")&&(GetURLParameter("Language")!="undefined"))sLangVal=GetURLParameter("Language");if(sLangVal==null||sLangVal==undefined||sLangVal==""){if(sDefaultAdminLang!="")sLangVal=sDefaultAdminLang;else sLangVal=sBrowserLanguage.replace("-",",");bLangBrowserSet=true;}if(sLangVal==null||sLangVal==undefined){sLangVal="";bLangBrowserSet=false;}switch(sLangVal.toLowerCase()){case"de,de":case"de":sText="$GERMAN$";sLangVal="de,DE";break;case"it,it":case"it":sText="$ITALIAN$";sLangVal="it,IT";break;case"fr,fr":case"fr":sText="$FRENCH$";sLangVal="fr,FR";break;case"es,es":case"es":sText="$SPANISH$";sLangVal="es,ES";break;case"pt,pt":case"pt":sText="$PORTUGUESE$";sLangVal="pt,PT";break;case"sr,sr":case"sr":case"sr,rs":case"sr,cs":sText="$SERBIAN$";sLangVal="sr,SR";break;case"se,se":case"se":sText="$SWEDISH$";sLangVal="se,SE";break;case"fi,fi":case"fi":sText="$FINISH$";sLangVal="fi,FI";break;case"no,no":case"no":sText="$NORWEGIAN$";sLangVal="no,NO";break;case"ru,ru":case"ru":sText="$RUSSIAN$";sLangVal="ru,RU";break;case"dk,dk":case"dk":sText="$DANISH$";sLangVal="dk,DK";break;case"jp,jp":case"ja,jp":case"jp":case"ja":sText="$JAPANESE$";sLangVal="jp,JP";break;case"zh,cn":sText="$SIMPLIFIED_CHINESE$";sLangVal="zh,CN";break;case"zh,tw":sText="$TRADITIONAL_CHINESE$";sLangVal="zh,TW";break;default:sText="$ENGLISH$";sLangVal="en,US";bLangBrowserSet=false;break;}createCookie("SULang",sLangVal,60);aLanguage=[sText,sLangVal];if(bLangBrowserSet){g_sLang=sLangVal;setTimeout(function(){OnReloadPage();});}else return(aLanguage);}function OnLogIn(bAutoLogin){LoadingDialog(false);
ShowDialog("LoggingInDialog");var sLoginCmd="%FILE%Login.xml?Command=Login";var LogInRequest=CreatePostRequest(sLoginCmd);var sUserName,sPassWord,sLanguage;m_sViewShareToken="";if(bAutoLogin){sUserName=decodeURIComponent(GetURLParameter("user"));sPassWord=decodeURIComponent(GetURLParameter("password"));}else{if(!g_bIsLocalAdmin)sUserName=document.login.user.value;else sUserName="";sPassWord=document.login.pword.value;}if(GetURLParameter("viewshare")!="")m_sViewShareToken=decodeURIComponent(GetURLParameter("viewshare"));sLanguage=LanguageCombo.value;LogInRequest.setParameter("user",sUserName);LogInRequest.setParameter("pword",sPassWord);LogInRequest.setParameter("viewshare",m_sViewShareToken);LogInRequest.setParameter("language",sLanguage);LogInRequest.setRequestHeader("X-User-Agent",escape(navigator.userAgent));LogInRequest.setAsync(true);LogInRequest.Request();LogInRequest.response=function(XMLDoc){m_bShowViewShareNotFound=false;var nResult=GetXMLValueEInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");g_WelcomeMessage=GetXMLValue(XMLDoc,"welcomemsg");var bAllowWCLogin=(GetXMLValue(XMLDoc,"AllowWC")=="1")?true:false;var bAllowFVJVLogin=(GetXMLValue(XMLDoc,"allowFVJV")=="1")?true:false;var bAllowAdhocLogin=(GetXMLValue(XMLDoc,"AllowFileSharing")=="1")?true:false;OnUpdateUserPlacementOpts(bAllowWCLogin,bAllowFVJVLogin,bAllowAdhocLogin);g_nUserPlacement=document.URL.includes("/WebClientNew")?USER_PLACEMENT_NWC_REDIRECT:GetXMLValue(XMLDoc,"userplacement");var nViewShareResult=GetXMLValueInt(XMLDoc,"ResultViewShare");m_sFileShareStartupPage="%FILE%Share/Console.htm";if((bAllowAdhocLogin)&&(m_sViewShareToken)&&(g_nUserPlacement!=USER_PLACEMENT_NWC_REDIRECT)&&(g_nUserPlacement!=USER_PLACEMENT_NFS)){if(nViewShareResult==0){g_nUserPlacement=USER_PLACEMENT_SHARING;m_sFileShareStartupPage="%FILE%Share/ShareDetails.htm?Command=FileShareInfo&ShareToken="+m_sViewShareToken;}else m_bShowViewShareNotFound=true;}if(g_nUserPlacement==USER_PLACEMENT_BWC_PRO){g_nUserPlacement=USER_PLACEMENT_BWC;}switch(parseInt(g_nUserPlacement)){case USER_PLACEMENT_NWC_REDIRECT:{var fileShareLinks=["Requested","Sent","FileShareLogin","FileShareSummary"];g_nUserPlacement=USER_PLACEMENT_ASK;var NWCURL=document.URL.split("/");var NWCPlace=NWCURL.length>4?NWCURL[4]:"";if(fileShareLinks.includes(NWCPlace)){if(bAllowAdhocLogin){g_nUserPlacement=USER_PLACEMENT_NFS;}}else if(bAllowWCLogin){g_nUserPlacement=USER_PLACEMENT_NWC_REDIRECT;}break;}case USER_PLACEMENT_NWC:{if(!bAllowWCLogin){if(bAllowAdhocLogin&&bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_ASK;else if(bAllowAdhocLogin)g_nUserPlacement=USER_PLACEMENT_NFS;else if(bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_FVJV;else g_nUserPlacement=USER_PLACEMENT_ALL_DISABLED;}}break;case USER_PLACEMENT_NFS:{if(!bAllowAdhocLogin){if(bAllowFVJVLogin&&bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_ASK;else if(bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_FVJV;else if(bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_NWC;else g_nUserPlacement=USER_PLACEMENT_ALL_DISABLED;}}break;case USER_PLACEMENT_SHARING:{if(!bAllowAdhocLogin){if(bAllowFVJVLogin&&bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_ASK;else if(bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_FVJV;else if(bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_BWC;else g_nUserPlacement=USER_PLACEMENT_ALL_DISABLED;}}break;case USER_PLACEMENT_FVJV:{if(!bAllowFVJVLogin){if(bAllowAdhocLogin&&bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_ASK;else if(bAllowAdhocLogin)g_nUserPlacement=USER_PLACEMENT_SHARING;else if(bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_BWC;else g_nUserPlacement=USER_PLACEMENT_ALL_DISABLED;}}break;case USER_PLACEMENT_BWC:{if(!bAllowWCLogin){if(bAllowAdhocLogin&&bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_ASK;else if(bAllowAdhocLogin)g_nUserPlacement=USER_PLACEMENT_SHARING;else if(bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_FVJV;else g_nUserPlacement=USER_PLACEMENT_ALL_DISABLED;}}break;case USER_PLACEMENT_ASK:case USER_PLACEMENT_ALL_DISABLED:default:{if((bAllowAdhocLogin&&bAllowFVJVLogin)||(bAllowAdhocLogin&&bAllowWCLogin)||(bAllowFVJVLogin&&bAllowWCLogin))g_nUserPlacement=USER_PLACEMENT_ASK;else if(bAllowWCLogin)g_nUserPlacement=USER_PLACEMENT_BWC;else if(bAllowFVJVLogin)g_nUserPlacement=USER_PLACEMENT_FVJV;else if(bAllowAdhocLogin)g_nUserPlacement=USER_PLACEMENT_SHARING;else g_nUserPlacement=USER_PLACEMENT_ALL_DISABLED;}break;}if(GetURLParameter("placement")!=""){g_nUserPlacement=parseInt(GetURLParameter("placement"));g_bOverrideUserPlacement=true;if((isNaN(g_nUserPlacement))||(g_nUserPlacement<0)||(g_nUserPlacement>7))g_nUserPlacement=USER_PLACEMENT_ASK;}var bRequireEmailChange=(GetXMLValue(XMLDoc,"requireemailchange")=="1")?true:false;var bUserCanSetEmail=(GetXMLValue(XMLDoc,"usercansetemail")=="1")?true:false;var sUserEmail=decodeURIComponent(GetXMLValue(XMLDoc,"useremail"));g_nUserType=GetXMLValue(XMLDoc,"usertype");g_sEncXsrfToken=GetXMLValue(XMLDoc,"CsrfToken");if(nResult!=g_nSessionOkay&&nResult!=g_nSessNoLicRemoteAdmin){HideDialog("LoggingInDialog");if(nResult==202){if(bRequireEmailChange&&bUserCanSetEmail){OnShowSetEmailDialog(sUserEmail,function(){ChangePasswordDialog(true);},true);}else{ChangePasswordDialog(true);}}else AlertDialog(GetResultText(nResult,"$LOGIN_FAIL_STR$",sResultText));}else{g_bLoggedIn=true;g_IsSetEmailNeeded=bRequireEmailChange&&bUserCanSetEmail;g_IsShowWelcomeDialog=g_WelcomeMessage!=""&&g_WelcomeMessage!=undefined&&nResult!=g_nSessNoLicRemoteAdmin;g_DialogInfo.nResult=nResult;g_DialogInfo.sUserEmail=sUserEmail;OnLoginOK(false,nResult,XMLDoc);}};}function showWelcomeDialog(bReplace,nResult){WelcomeDialog(g_WelcomeMessage.replace(new RegExp("\\n","g"),"<br>"),redirectAfterSuccessfulLogin.bind(null,bReplace,nResult));}function showSetEmailDialog(sUserEmail,bReplace,nResult){OnShowSetEmailDialog(sUserEmail,function(){if(g_IsShowWelcomeDialog){showWelcomeDialog(bReplace,nResult);return;}redirectAfterSuccessfulLogin(false,nResult);},true);}function OnLoginOK(bReplace,nResult,xmlDoc){HideDialog("LoggingInDialog");var mfaStatus=GetXMLValue(xmlDoc,"MFATOTPStatus");if(canProceedWithoutMFA(mfaStatus)){proceedWithoutMFA(bReplace,nResult);return;}var mfaUrls=getBarcodeUrls(xmlDoc);showMFADialog(mfaStatus,mfaUrls);}function canProceedWithoutMFA(mfaStatus){return mfaStatus===MFA_STATUS.CANNOT||mfaStatus===MFA_STATUS.MAY&&MFA_STATE.isSkipped||mfaStatus===MFA_STATUS.USES&&MFA_STATE.isPassed;}function proceedWithoutMFA(bReplace,nResult){if(g_IsSetEmailNeeded){showSetEmailDialog(g_DialogInfo.sUserEmail,bReplace,nResult);return;}if(g_IsShowWelcomeDialog){showWelcomeDialog(bReplace,nResult);return;}redirectAfterSuccessfulLogin(bReplace,nResult);}function redirectAfterSuccessfulLogin(bReplace,nResult){var sPlacement="";var bAskUserBypass=true;if(bReplace==undefined)bReplace=true;if(g_bIsiPad)g_nUserPlacement=USER_PLACEMENT_BWC;var isAdmin=(parseInt(g_nUserType)!=0)&&(nResult!=g_nSessNoLicRemoteAdmin)&&(!g_bOverrideUserPlacement);if(isAdmin)sPlacement="%LOGIN%";else{switch(parseInt(g_nUserPlacement)){case USER_PLACEMENT_BWC:sPlacement="%FILE%ListDir.htm";break;case USER_PLACEMENT_FVJV:bAskUserBypass=false;g_bFVJVLicense=true;location.href="%COMMON_FILE%FVJVLoggedIn.htm";break;case USER_PLACEMENT_SHARING:bAskUserBypass=false;location.href=m_sFileShareStartupPage;break;case USER_PLACEMENT_NWC:bAskUserBypass=true;sPlacement="/WebClientNew/Browser/~";break;case USER_PLACEMENT_NFS:bAskUserBypass=true;sPlacement="/WebClientNew/Requested/";break;case USER_PLACEMENT_NWC_REDIRECT:bAskUserBypass=false;location.href=document.URL.replaceAll("&command=logout","");break;case USER_PLACEMENT_ASK:case USER_PLACEMENT_ALL_DISABLED:g_bFVJVLicense=true;if(bReplace)ReplaceDialog("WelcomeDialog","AskUserPlacementDialog");else ReplaceDialog("LoggingInDialog","AskUserPlacementDialog");if(m_bShowViewShareNotFound)AlertDialog("$ADHOC_SHARE_NOT_FOUND$");bAskUserBypass=false;break;}}if(bAskUserBypass){if(bReplace)ReplaceDialog("WelcomeDialog","LoggingInDialog");if(GetURLParameter("user")!="")sPlacement=sPlacement+GetBWCLoadParameters();window.location=sPlacement;}}function getBarcodeUrls(xmlDoc){var barCodeUri=GetXMLValue(xmlDoc,"MFAURIBarcodeURL");var totpSecret=GetXMLValue(xmlDoc,"MFATOTPSecret");return{barCodeUri:barCodeUri,totpSecret:totpSecret};}function OnLoggedOut(){g_bLoggedIn=false;}function OnReloadPage(){var sReloadURL="%LOGIN%";if(g_bIsLocalAdmin)sReloadURL="%LOGIN%&LocalAdmin=1";if(GetURLParameter("user")!=""){sReloadURL=sReloadURL+"&user="+GetURLParameter("user");sReloadURL=sReloadURL+GetBWCLoadParameters();}if(GetURLParameter("password")!="")sReloadURL=sReloadURL+"&password="+GetURLParameter("password");if(readCookie("Language")==""&&g_sLang!=undefined)sReloadURL=sReloadURL+"&Language="+g_sLang;if(GetURLParameter("viewshare")!="")sReloadURL+="&viewshare="+GetURLParameter("viewshare");window.location.href=sReloadURL;}function SetLangCookie(){LoadingDialog(true);sLangValue=LanguageCombo.value;createCookie("SULang",sLangValue,60);if(!g_bIsLocalAdmin)createCookie("SUUserId",encodeURI(document.login.user.value),60);if(RememberMeCheckBox.getControlValue())createCookie("SURememberMe","true",60);else createCookie("SURememberMe","false",60);g_sLang=sLangValue;setTimeout(function(){OnReloadPage();});}function RecommendIEUpgrade(){window.location.href="%FILE%IEWarning.htm";}if(g_bBrowserOk){document.getElementById("JavaWarning").style.display="none";document.getElementById("FormLayer").style.display="block";}else{document.getElementById("JavaWarningText").style.display="none";document.getElementById("JavaWarningReload").style.display="none";document.getElementById("BrowserWarningText").style.display="block";}if(!g_bIsLocalAdmin){document.getElementById("UserNameID").style.visibility="visible";if(g_bAllowRemember){document.getElementById("RememberUserID").style.visibility="visible";}var LoginIDInput=CreateInputField(g_UserName,"UserNameInput","user",undefined,200,20,false,OnValidate,undefined,g_bAllowAutoComplete);}CreatePasswordField("","PasswordInput","pword",undefined,200,20,false,OnValidate,undefined,g_bAllowAutoComplete);var g_sBrowserLanguageCheck=readCookie("SULang").replace("-",",");var objLoginButton=CreatePushButton("$LOGIN$","LoginButton",OnValidate);if(g_sBrowserLanguageCheck.toLowerCase()=="it,it")objLoginButton.setStyle("width","65px");else if(g_sBrowserLanguageCheck.toLowerCase()=="fr,fr")objLoginButton.css({"width":"auto","min-width":'70px'});var bRememberMe=false;if(readCookie('SURememberMe')=="true"&&g_bAllowRemember)bRememberMe=true;var RememberMeCheckBox=CreateCheckBox("$REMEMBER_USER$","remember","remember",bRememberMe,undefined,true);if(AW.gecko)RememberMeCheckBox.setStyle("height","12px");objLoginButton.onKeyEnter=function(){OnValidate();};if(document.getElementById("SULoginLogo"))LoadCustomImage(g_bDisableBranding,g_bHasCustomLogo);if(parseInt(%ALLOW_PASSWORD_RECOVERY%)!=1){document.getElementById("PasswordRecoverTxt").style.display="none";$('#LoginTaskBar').css("display","none");$('.Bottom-Logos').addClass("Bottom-Logos-No-Toolbar");}else{$('#LoginTaskBar').css("display","block");$('.Bottom-Logos').removeClass("Bottom-Logos-No-Toolbar");}if(document.getElementById("CustomHTTPLoginText").innerHTML!=""){document.getElementById("CustomHTTPLoginText").style.display="block";}if(%SHOW_LANGUAGE%)document.getElementById("LangContainer").style.display="block";LoadErrorMessage("ErrMsg","logout","$LOGGED_OUT_MSG$");if(document.getElementById("Login-Wrapper")){var nOffsetLogin=0;var nLoginWrapperheight=(document.getElementById("Login-Wrapper").style.pixelHeight)?document.getElementById("Login-Wrapper").style.pixelHeight:document.getElementById("Login-Wrapper").offsetHeight;document.getElementById("Login-Wrapper").style.height=(nLoginWrapperheight)+"px";}if(g_bIsiPad&&LoginIDInput!=undefined)LoginIDInput.getContent("box/text").element().setAttribute('autocapitalize','off');</script></body><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">$(document).ready(function(){try{document.getElementById("PasswordRecoverTxtLink").onclick=OnShowRecoverPasswordDialog;}catch(e){console.error(e);}LoginCookieCheck();});</script></html>