var g_objRenameReq,g_objDeleteReq,g_objNOOPRequest,g_UploadRequest,g_CancelUploadRequest;var g_bFireFox3Browser=false;var g_bSafariBrowser=false;var g_bChrome=navigator.userAgent.toLowerCase().indexOf('chrome')>-1;if(navigator.userAgent.indexOf("Firefox")!=-1){var sFFUA=navigator.userAgent;var nFFIndexStart=sFFUA.indexOf("Firefox")+8;var nFFVersionIndex=sFFUA.substr(nFFIndexStart,4);if(parseInt(nFFVersionIndex)>=3)g_bFireFox3Browser=true;}if(navigator.userAgent.indexOf("Shiretoko")!=-1){g_bFireFox3Browser=true;}if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)g_bSafariBrowser=true;function GetDecodedDirPath(sDir){var sDecodedDir="";if(sDir!=undefined){sDecodedDir=sDir.replace(eval("/%2F/g"),"/");sDecodedDir=sDecodedDir.replace(eval("/%3A/g"),":");sDecodedDir=sDecodedDir.replace(eval("/%26/g"),"&");sDecodedDir=sDecodedDir.replace(eval("/%24/g"),"$");sDecodedDir=sDecodedDir.replace(eval("/%2C/g"),",");sDecodedDir=sDecodedDir.replace(eval("/%40/g"),"@");sDecodedDir=sDecodedDir.replace(eval("/%23/g"),"#");sDecodedDir=sDecodedDir.replace(eval("/%2B/g"),"+");sDecodedDir=sDecodedDir.replace(eval("/%3D/g"),"=");sDecodedDir=sDecodedDir.replace(eval("/%3B/g"),";");sDecodedDir=decodeURI(sDecodedDir);}return(sDecodedDir);}function FormatFileDate(nDateinSeconds){var FileDate=new Date(parseInt(nDateinSeconds)*1000);return(FileDate.toLocaleString());}function GetLargeFileIcon(sStr){var asExtensions={"DLL":1,"ISO":1,"MID":1,"WMV":1,"MPG":1,"SAFARI":1,"SAFURL":1,"FIREFOX":1,"FFURL":1,"MOV":1,"M4A":1,"MDB":1,"MP3":1,"PDF":1,"PPT":1,"PNG":1,"DOC":1,"URL":1,"XLS":1,"ZIP":1,"TXT":1,"HTM":1,"HTML":1,"EXE":1,"VCXPROJ":1};sStr=sStr.toUpperCase();switch(sStr){case"MP4":case"M4P":sStr="MOV";break;case"RTF":case"RTX":sStr="DOC";break;case"LOG":sStr="TXT";break;break;case"POT":case"PPA":case"PPS":case"PPZ":case"PWZ":sStr="PPT";break;case"WMA":sStr="MP3";break;case"HTM":case"HTML":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFARI";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FIREFOX";break;case"URL":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFURL";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FFURL";break;case"ARC":case"TAR":case"GZ":case"BZ":case"BZ2":case"IMG":case"MIM":case"TAX":case"TBZ":case"TBZ2":case"TZ":case"UU":case"UUE":case"XXE":case"Z":case"ZIPX":sStr="ZIP";break;}if(asExtensions[sStr])return(sStr+"Ext");else return("DefaultExt");}function GetFileIcon(sStr){var asExtensions={"AVI":1,"BAT":1,"BMP":1,"C":1,"CAB":1,"CHM":1,"CNT":1,"CPP":1,"CRT":1,"CSV":1,"DEF":1,"DLL":1,"DOC":1,"DOT":1,"DSP":1,"DSW":1,"EXE":1,"GIF":1,"H":1,"ANI":1,"HTML":1,"HTM":1,"HXC":1,"HXI":1,"HXK":1,"HXS":1,"HXT":1,"INI":1,"ISO":1,"JPG":1,"JS":1,"MAK":1,"MDB":1,"MDE":1,"MDW":1,"MDZ":1,"MID":1,"MP3":1,"URL":1,"MOV":1,"MPG":1,"MSI":1,"PPT":1,"PDF":1,"POT":1,"PNG":1,"RC":1,"REG":1,"RTF":1,"SCT":1,"SLN":1,"HLP":1,"TTF":1,"TXT":1,"VBS":1,"SAFARI":1,"FIREFOX":1,"VCPROJ":1,"VCXPROJ":1,"VSSSCC":1,"XML":1,"WAV":1,"WMA":1,"WMV":1,"WMZ":1,"WRI":1,"XLS":1,"ZIP":1};sStr=sStr.toUpperCase();switch(sStr){case"MP4":case"M4P":sStr="MOV";break;case"HTM":case"HTML":case"URL":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFARI";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FIREFOX";break;case"POT":case"PPA":case"PPS":case"PPZ":case"PWZ":sStr="PPT";break;case"ARC":case"TAR":case"GZ":case"BZ":case"BZ2":case"IMG":case"MIM":case"TAX":case"TBZ":case"TBZ2":case"TZ":case"UU":case"UUE":case"XXE":case"Z":case"ZIPX":sStr="ZIP";break;}if(asExtensions[sStr])return(sStr+"Ext");else return("DefaultExt");}function GetDriveIcon(nType){var asDriveImages=["DRIVE_UNKNOWN","DRIVE_NO_ROOT_DIR","DRIVE_REMOVABLE","DRIVE_FIXED","DRIVE_REMOTE","DRIVE_CDROM","DRIVE_RAMDISK","DRIVE_REMOVABLE_OTHER"];nType=parseInt(nType);if((!isNaN(nType))&&(nType<asDriveImages.length))return(asDriveImages[nType]);else return("DRIVE_UNKNOWN");}function CleanPathByEscape(sPath){sRawFilePath=sPath;sRawFilePath=sRawFilePath.replace(new RegExp("[\(]","g"),"\\(");sRawFilePath=sRawFilePath.replace(new RegExp("[\)]","g"),"\\)");sRawFilePath=sRawFilePath.replace(new RegExp("'","g"),"\\'");return(sRawFilePath);}function RefreshList(){GetMobileListData(g_sCurrentDir);}function OnShowChangePasswordDialog(){if(g_bAllowChangePassword){ClearPasswordDialog();}}function OnOpenDir(sDir,sRowId,bIsFolder){var sEncodedFilePath=encodeURIComponent(sDir);if(sRowId!=undefined){if(bIsFolder){document.getElementById("a-"+sRowId).setAttribute("selected","progress-dir");document.getElementById("dir-info-"+sRowId).style.display="none";document.getElementById("a-"+sRowId).style.padding="8px 36px 8px 60px";document.getElementById("a-"+sRowId).style.margin="-8px 0px -8px -10px";document.getElementById("a-"+sRowId).style.cssFloat="none";document.getElementById("a-"+sRowId).style.overflow="hidden";document.getElementById("a-"+sRowId).style.width="";}else document.getElementById("a-"+sRowId).setAttribute("selected","progress");this.setTimeout(function(){location.href='MListDir.htm?Dir='+sEncodedFilePath;if(bIsFolder){document.getElementById("a-"+sRowId).setAttribute("selected","done-dir");document.getElementById("dir-info-"+sRowId).style.display="";document.getElementById("a-"+sRowId).style.padding="";document.getElementById("a-"+sRowId).style.margin="";document.getElementById("a-"+sRowId).style.width="70%";document.getElementById("a-"+sRowId).style.cssFloat="left";document.getElementById("a-"+sRowId).style.backgroundImage='none';}else document.getElementById("a-"+sRowId).setAttribute("selected","done");},1500);}else location.href='MListDir.htm?Dir='+sEncodedFilePath;}function OnBackToFile(nRowId){g_bSlideShowPlaying=false;clearTimeout(MobileSlideshowTimeoutId);document.getElementById("Image-File").innerHTML="";OnFileInfo(nRowId);}function OnBackToList(){document.getElementById("GoTo-Layer").style.display='none';document.getElementById("FileInfo").style.display='none';document.getElementById("Upload-Layer").style.display="none";document.getElementById("FileInfo").innerHTML="";document.body.style.backgroundImage='none';document.getElementById("Mobile-Toolbar").style.display='block';document.getElementById("ListMobileFiles").style.display='block';if(g_bPauseThumbnails){g_bPauseThumbnails=false;g_nThumbnailIter=g_nRestartPosition;setTimeout("LoadThumbnailIcons()",0);}scrollTo(0,g_nScrollPos);}function CreateMobileButton(sText,fAction,nWidth,bBlue,sObjId){var sBlueButton="";var sButtonId="";if(sObjId!=undefined)sButtonId=sObjId;if(bBlue)sBlueButton="-blue";sButton='<div id="'+sButtonId+'" class="Button-Mobile'+sBlueButton+'" style="height:33px;width:'+nWidth+'px;" onclick="javascript:'+fAction+'">'+sText+'</div>';return(sButton);}function File(sFileName,sFileSize,sFileDate,sFilePath,bFileIsDir,bFileIsImage,bFileIsAudio,bFileIsVideo,bFileIsDrive,nFileDriveType){this.FileName=sFileName;this.FileSize=sFileSize;this.FileDate=sFileDate;this.FilePath=sFilePath;this.FileIsDir=bFileIsDir;this.FileIsImage=bFileIsImage;this.FileIsAudio=bFileIsAudio;this.FileIsVideo=bFileIsVideo;this.FileIsDrive=bFileIsDrive;this.FileDriveType=nFileDriveType;}function OnLogOut(){location.href=g_sLogout;}function GetMobileDriveIcon(nType){var asDriveImages=["DRIVE_UNKNOWN","DRIVE_NO_ROOT_DIR","DRIVE_REMOVABLE","DRIVE_FIXED","DRIVE_REMOTE","DRIVE_CDROM","DRIVE_RAMDISK","DRIVE_REMOVABLE_OTHER"];nType=parseInt(nType);if((!isNaN(nType))&&(nType<asDriveImages.length))return(asDriveImages[nType]);else return("DRIVE_UNKNOWN");}function OnFileDelete(bDir,sPath){var sDeleteFilePath="";var bDelete=false;if(sPath!=""){if(bDir)sDeleteMsg=g_sDeleteDir;else sDeleteMsg=g_sDeleteFile;bDelete=confirm(sDeleteMsg);if(bDelete)ConfirmDelete(bDir,sPath);}else alert(g_sSelectFile);}function OnShowFileRename(bDoDir,sRenameFilePath,sRenameFileName){g_sOriginalFilename=sRenameFileName;document.getElementById("NewPath").value=sRenameFileName;document.getElementById("original_path").value=sRenameFilePath;document.getElementById("isdir").value=bDoDir;document.getElementById("FileInfo").style.display="none";document.getElementById("File-Rename").style.display="block";document.getElementById("NewPath").focus();}function DeleteDone(){if((g_objDeleteReq!=undefined)&&(g_objDeleteReq.readyState==4)){var XMLDoc=g_objDeleteReq.responseXML;g_objDeleteReq=undefined;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay)alert(sResultText);else{ResetList();RefreshList();}}}function ConfirmDelete(bDoDir,sDeleteFilePath){if(bDoDir)sDeleteCmd="/?Command=DeleteDir";else sDeleteCmd="/?Command=Delete";g_objDeleteReq=createXMLHttpRequest("POST",sDeleteCmd,DeleteDone);g_objDeleteReq.setRequestHeader("X-User-Agent",escape(navigator.userAgent));g_objDeleteReq.send("File="+encodeURIComponent(sDeleteFilePath));}function RenameDone(){if((g_objRenameReq!=undefined)&&(g_objRenameReq.readyState==4)){var XMLDoc=g_objRenameReq.responseXML;g_objRenameReq=undefined;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");var nFilePathLength;var nLastSlash;var sDirBool=document.getElementById("isdir").value;if(sDirBool=="false")bIsDir=false;else bIsDir=true;if(nResult!=g_nSessionOkay){if(nResult==g_sPermissionDenied){if(bIsDir){sErrorMessage1=g_sSessonNoRenameDir1;sErrorMessage2="\n\n"+g_sSessonNoRenameDir2;}else{sErrorMessage1=g_sSessonNoRenameFile1;sErrorMessage2="\n\n"+g_sSessonNoRenameFile2;}alert(GetResultText(nResult,sErrorMessage1+g_sOriginalFilename+sErrorMessage2,sResultText));}else alert(sResultText);}else{document.getElementById("File-Rename").style.display="none";document.getElementById("NewPath").value="";document.getElementById("NewPath").blur();document.getElementById("original_path").value="";document.getElementById("isdir").value="";ResetList();RefreshList();}}}function OnRenameFile(){var sOriginalPath=document.getElementById("original_path").value;var sNewFilePath=document.getElementById("NewPath").value;var sRenameCmd="/?Command=Rename&Dir="+g_sCurrentDir;g_objRenameReq=createXMLHttpRequest("POST",sRenameCmd,RenameDone);g_objRenameReq.setRequestHeader("X-User-Agent",escape(navigator.userAgent));g_objRenameReq.send("new_path="+encodeURIComponent(sNewFilePath)+"&original_path="+encodeURIComponent(sOriginalPath));return false;}function ResetList(){document.getElementById("ListMobileFiles").innerHTML="";document.body.style.backgroundImage='url(/Common/Images/BusyGrid.gif)';document.body.style.backgroundRepeat='no-repeat';document.body.style.backgroundFixed='fixed';document.body.style.backgroundPosition='50% 50%';document.getElementById("GoTo-Layer").style.display="none";document.getElementById("FileInfo").style.display='none';document.getElementById("Upload-Layer").style.display="none";document.getElementById("FileInfo").innerHTML="";document.getElementById("Mobile-Toolbar").style.display='block';document.getElementById("ListMobileFiles").style.display='block';}function OnCancelRenameFile(){document.getElementById("NewPath").value="";document.getElementById("original_path").value="";document.getElementById("isdir").value="";document.getElementById("File-Rename").style.display="none";document.getElementById("FileInfo").style.display="block";}function ParentDir(){var nPos=0;sParentPath=decodeURI(g_sCurrentDir);nPos=sParentPath.lastIndexOf("/");if(nPos<0)nPos=sParentPath.lastIndexOf("%2F");if(nPos<0)g_sCurrentDir=g_sHomeDir;else{if(nPos==0)g_sCurrentDir="/";else g_sCurrentDir=sParentPath.substring(0,nPos);}location.href='MListDir.htm?Dir='+g_sCurrentDir;}function OnShowGoTo(){document.getElementById("GoToPath").value=decodeURIComponent(g_sCurrentDir);document.getElementById("GoTo-Layer").style.display="block";document.body.style.backgroundRepeat='repeat-x';document.body.style.backgroundFixed='fixed';document.getElementById("Mobile-Toolbar").style.display='none';document.getElementById("ListMobileFiles").style.display='none';document.getElementById("GoToPath").focus();}function OnGoToMC(){if(g_nAdminType==1||g_nAdminType==3)sPath=g_sAdminPath+"DomainConsole.htm";else if(g_nAdminType==2||g_nAdminType==4)sPath=g_sAdminPath+"console.htm";else if(g_nAdminType==5||g_nAdminType==6)sPath=g_sAdminPath+"GroupConsole.htm";location.href=sPath;}function OnShowUpload(){document.getElementById("Upload-Layer").style.display="block";document.body.style.backgroundRepeat='repeat-x';document.body.style.backgroundFixed='fixed';document.getElementById("Mobile-Toolbar").style.display='none';document.getElementById("ListMobileFiles").style.display='none';}function GoTo(){var sGoToPath=document.getElementById("GoToPath").value;ResetList();OnOpenDir(sGoToPath);return false;}function Upload(){var sFileName=document.UploadFile.File.value;var nUploadId="1";document.UploadFile.action="/?Command=Upload&Dir="+g_sCurrentDir+" &TransferID="+nUploadId+"&File="+encodeURIComponent(sFileName)+'&CsrfToken='+"%ENC_CSRF_TOKEN%";document.UploadFile.submit();return false;}function OnCancelGoTo(){OnBackToList();}function OnCancelUpload(){OnBackToList();}function createXMLHttpRequest(sMethod,sURL,fnCallback){var objRequest=null;try{objRequest=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{objRequest=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){try{objRequest=new XMLHttpRequest();}catch(e){alert(g_sAjaxNotSupported);}}}if(objRequest){if((sMethod)&&(sURL)){objRequest.open(sMethod,sURL+SyncRequestParameter(),true);if(sMethod.toUpperCase()=="POST")objRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}if((typeof g_sEncXsrfToken!=='undefined')&&(g_sEncXsrfToken!==null)&&(g_sEncXsrfToken!==""))objRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);if(fnCallback)objRequest.onreadystatechange=fnCallback;}return(objRequest);}function NOOPDone(){if((g_objNOOPRequest!=undefined)&&(g_objNOOPRequest.readyState==4)){var nNOOPDelay=55000;if(g_bFVJVLoggedInCheck)nNOOPDelay=10000;var XMLDoc=g_objNOOPRequest.responseXML;g_objNOOPRequest=undefined;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay){alert(GetResultText(0,"",sResultText));}else setTimeout("OnSendMobileNOOP()",nNOOPDelay);}}function OnSendMobileNOOP(){var sNOOPCmd="/?Command=NOOP";g_objNOOPRequest=createXMLHttpRequest("POST",sNOOPCmd,NOOPDone);g_objNOOPRequest.setRequestHeader("X-User-Agent",escape(navigator.userAgent));g_objNOOPRequest.send(null);}function OnUploadSubmit(bBypassCheck){var nFrameNum=(document.getElementsByTagName('iframe').length-1);if(bBypassCheck==undefined)bBypassCheck=false;top.frames[nFrameNum].Upload(bBypassCheck);}this.OnNoFile=function(){alert(g_sPleaseSelectFile);};this.GetCurrentDir=function(){return(g_sCurrentDir);};this.VerifyUpload=function(sUploadingFile){var sFileUpload=sUploadingFile;var nPos=0;var bNoFileFound=true;var sGridFile;var sFileComp;nPos=sFileUpload.lastIndexOf("/");if(nPos<0)nPos=sFileUpload.lastIndexOf("\\");if(nPos<0)sFile=sFileUpload;else{sFile=sFileUpload.substring((nPos+1));}if(g_bCaseSensitiveOS)sFileComp=sFile.replace(new RegExp("&","g"),"&amp;");else sFileComp=sFile.replace(new RegExp("&","g"),"&amp;").toLowerCase();return bNoFileFound;};this.ShowUploadLoadingDialog=function(){};this.HideUploadBusyDialog=function(){var nFrameNum=(document.getElementsByTagName('iframe').length-1);};function OnCloseUploadDialog(){var nFrameNum=(document.getElementsByTagName('iframe').length-1);if(nFrameNum>0)RefreshList();clearTimeout(UploadTimer);OnBackToList();}