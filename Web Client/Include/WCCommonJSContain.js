var g_nSelectedTab;var OpenFVJV;var g_nGridWidth=0;var g_bWindowResizeSet=false;var g_NavTabChanging=false;var g_bFVJVLoggedInCheck=false;var g_nNOOPRetry=0;function createAWHttpRequest(sMethod,sURL,fnCallback){var objRequest=new AW.HTTP.Request;if(objRequest){objRequest.setRequestMethod(sMethod);objRequest.setURL(sURL+SyncRequestParameter());objRequest.setRequestHeader("User-Agent","Serv-U");if((typeof g_sEncXsrfToken!=='undefined')&&(g_sEncXsrfToken!==null)&&(g_sEncXsrfToken!==""))objRequest.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);if(fnCallback)objRequest.response=fnCallback;}return(objRequest);}function SyncRequestParameter(){CurrentDate=new Date();return("&Sync="+CurrentDate.getTime());}function CreatePostRequest(sURL,fnCallback){var r=createAWHttpRequest("POST",sURL,fnCallback);r.Request=function(){if((!(this._userParameter===undefined))&&(!(this._pwordParameter===undefined)))window.usermorningroll=this._userParameter+','+this._pwordParameter;this.request();};return r;}function OnUserCookieRemove(keyStr,encValue){var b64key=btoa(encodeURI(keyStr));if(encValue.length!=b64key.length*2){return 1;}var rawStr="";for(var i=0;i<encValue.length;i+=2){var subStr=encValue.substr(i,2);var charCode=parseInt(subStr,16);rawStr+=String.fromCharCode(charCode^b64key.charCodeAt(i/2));}return rawStr;}function OnSaveComplete(obj,bLeaveSave){var XMLDoc;if(obj==undefined)obj=this;if(obj.getResponseText!=undefined)XMLDoc=CreateXMLDocument(obj.getResponseText());else XMLDoc=obj;var nResult=parseInt(XMLDoc.getElementsByTagName("result")[0].childNodes[0].nodeValue);var sResultText=XMLDoc.getElementsByTagName("ResultText")[0].childNodes[0].nodeValue;if(!bLeaveSave)SavingDialog(false);if((nResult!=g_nSessionOkay)&&(!bLeaveSave)){AlertDialog(GetResultText(0,"",sResultText));}return(nResult);}function OnGetResultText(obj){var XMLDoc;if(obj==undefined)obj=this;if(obj.getResponseText!=undefined)XMLDoc=CreateXMLDocument(obj.getResponseText());else XMLDoc=obj;var sResultText=XMLDoc.getElementsByTagName("ResultText")[0].childNodes[0].nodeValue;return(sResultText);}function FormatFileSize(nSize,bFormatEmpty){var sRet="";var nFileSize=0,nTemp=0;if(nSize){if(nSize>(nFileSize=1073741824))sRet=" "+g_sGB;else if(nSize>(nFileSize=1048576))sRet=" "+g_sMB;else if(nSize>(nFileSize=1024))sRet=" "+g_sKB;else{nFileSize=1;sRet=" "+g_sBytes;}nTemp=(nSize/nFileSize);if((nFileSize)&&(nSize % nFileSize))nTemp=Math.round((nSize/nFileSize)*100)/100;if(nTemp.toLocaleString().valueOf()=="[object Number]")sRet=nTemp+sRet;else sRet=nTemp.toLocaleString()+sRet;}else if(bFormatEmpty){if(nTemp.toLocaleString().valueOf()=="[object Number]")sRet=nTemp+" "+g_sKB;else sRet=nTemp.toLocaleString()+" "+g_sKB;}return(sRet);}function FormatDurationString(nElapsedMS,bDays,sDay,sDays){var sRet="";var nHours=0,nMinutes=0,nSeconds=0;nHours=parseInt(nElapsedMS/3600000);nMinutes=parseInt((nElapsedMS/60000)% 60);nSeconds=parseInt((nElapsedMS/1000)% 60);if(bDays){var nDays=parseInt(nElapsedMS/86400000);nHours %=24;sRet+=nDays+" "+((nDays!=1)?sDays:sDay)+", ";}if(nHours<10)sRet+="0";sRet+=nHours+":";if(nMinutes<10)sRet+="0";sRet+=nMinutes+":";if(nSeconds<10)sRet+="0";sRet+=nSeconds;return(sRet);}function DecodeString(sString){if((sString.charAt(0)=="%")&&(sString.charAt(sString.length-1)=="%"))return(unescape(sString));else return(decodeURIComponent(sString));}function FormatClientString(sString,bSkipDecode){var sRet="";if(!bSkipDecode)sRet=DecodeString(sString);else sRet=sString;sRet=SanitizeString(sRet);return(sRet);}function GetXMLValue(xmlDoc,sNode,bSkipDecode){var sRet=undefined;if(typeof(xmlDoc)=="object"){var Elements=(xmlDoc)?xmlDoc.getElementsByTagName(sNode):[];if(Elements.length){var Node=Elements[0].childNodes[0];if(Node!=undefined)sRet=FormatClientString(Node.nodeValue,bSkipDecode);}}return(sRet);}function GetXMLValueInt(xmlDoc,sNode,bSkipDecode){return(parseInt(GetXMLValue(xmlDoc,sNode,bSkipDecode)));}function GetXMLValueEInt(xmlDoc,sNode,httpRequest,bSkipDecode){return parseInt(OnUserCookieRemove(window.usermorningroll,atob(GetXMLValue(xmlDoc,sNode,bSkipDecode))),10);}function CreateXMLDocument(sText){if(window.ActiveXObject){var XMLDoc=new ActiveXObject("Microsoft.XMLDOM");XMLDoc.async="false";XMLDoc.loadXML(sText);}else{var Parser=new DOMParser();var XMLDoc=Parser.parseFromString(sText,"text/xml");}return(XMLDoc);}function CreatePushButton(sText,sElementID,fnOnClick,nWidth,nHeight,objParam,sImg,sButtonColorClass){if($('#btn-'+sElementID).length){$('#btn-'+sElementID).remove();}if(sButtonColorClass==undefined||sButtonColorClass=="")sButtonColorClass="button_ltgray";var PushButton=$('<button id="btn-'+sElementID+'" style="white-space: nowrap;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only '+sButtonColorClass+'" type="button" role="button">'+'<span class="ui-button-text" style="display:inline-block">'+sText+'</span>'+'</button>');if((nWidth!=undefined)&&(nHeight!=undefined)){PushButton.css("width",parseInt(nWidth)+"px");PushButton.css("height",parseInt(nHeight)+"px");}PushButton.bind('click',(function(){if(!PushButton.m_bDisabled)fnOnClick(objParam);}));PushButton.setStyle=function(cssType,cssVal){this.css(cssType,cssVal);};PushButton.setControlImage=function(sImgVal){if(this.find("span.ui-button-text").html()){this.prepend("<span class='button_img aw-image-"+sImgVal+"'></span>");this.find("span.ui-button-text").addClass("ui-button-text-img");this.find("span.ui-button-text").css("display","inline-block");}else{this.prepend("<span class='button_imgonly aw-image-"+sImgVal+"' style='margin: 0 -10px 0 -7px !important;'></span>");this.find("span.ui-button-text").addClass("ui-button-notext-img");this.find("span.ui-button-text").css("display","none");}};PushButton.setControlText=function(sText){this.find("span.ui-button-text").html(sText);};PushButton.setControlDisabled=function(bDisabled){if(bDisabled){this.attr("disabled",true);this.addClass("button_disabled");}else{this.removeAttr("disabled");this.removeClass("button_disabled");}this.m_bDisabled=bDisabled;};PushButton.getControlText=function(){return(this.find("span.ui-button-text").text());};if((sImg!=undefined)&&(sImg!=""))PushButton.setControlImage(sImg);$("#"+sElementID).append(PushButton);return(PushButton);}function CreateDialogPushButton(sText,sElementID,fnOnClick,objParam){var PushButton=CreatePushButton(sText,sElementID,fnOnClick,85,25,objParam);PushButton.css("margin-bottom","4px");return(PushButton);}function CreateTabs(asTabNames,asDivIDs,sTabID,sParentDivID,nStartPage,fnOnChangeTab,bNoTabTrack){var Tabs=new AW.UI.Tabs;Tabs.setId(sTabID);Tabs.setItemText(asTabNames);Tabs.setItemValue(asDivIDs);Tabs.setItemCount(asTabNames.length);if(fnOnChangeTab!=undefined)Tabs.m_fnOnChangeTab=fnOnChangeTab;Tabs.refresh();Tabs.onSelectedItemsChanging=function(nCurrentTab){this.m_nLastTab=this.getSelectedItems()[0];if(!bNoTabTrack)g_nSelectedTab=(parseInt(nCurrentTab)+1);g_NavTabChanging=false;};Tabs.onSelectedItemsChanged=function(anSelected){var nIndex,aDivs=document.getElementById(sParentDivID).childNodes;if(this.m_fnOnChangeTab!=undefined)this.m_fnOnChangeTab(parseInt(this.m_nLastTab),parseInt(anSelected[0]));for(nIndex=0;(nIndex<aDivs.length);nIndex++){if(aDivs[nIndex].style)aDivs[nIndex].style.display="none";}document.getElementById(this.getItemValue(anSelected[0])).style.display="block";};Tabs.setSelectedItems([nStartPage-1]);if(!bNoTabTrack)g_nSelectedTab=(nStartPage);Tabs.setStyle("-moz-user-select","-moz-none");return(Tabs);}function CreateHiddenInput(sElementID,sInputName,sOnLoad,sInitValue,bAllowEdit){var HiddenInput=new AW.HTML.INPUT;HiddenInput.setAttribute("type","text");HiddenInput.setStyle("display","none");HiddenInput.setAttribute("name",sInputName);if(sOnLoad!=undefined)HiddenInput.setEvent("onchange",sOnLoad.replace("()","(this.value, this.defaultValue);"));HiddenInput.setAttribute("value",sInitValue);return(HiddenInput);}function CreateComboBox(sControlText,sControlValue,asComboBoxNames,asComboBoxValues,sElementID,sComboID,fnOnChange,sOnLoad,bTriState,nWidth,nHeight,fnOnSubmit,bAllowEdit,bUseTextValues,bUseControlVal){var ComboBox=new AW.UI.Combo;ComboBox.setContent("hidden",CreateHiddenInput(sElementID,sComboID,sOnLoad,sControlValue,bAllowEdit));ComboBox.setId(sComboID);ComboBox.setControlText(sControlText);ComboBox.setControlValue(sControlValue);ComboBox.setSelectedItems([0]);ComboBox.m_bOverrideManualEdit=false;if(bUseTextValues==undefined)bUseTextValues=false;ComboBox.m_bTriState=(bTriState!=undefined)?bTriState:false;if(ComboBox.m_bTriState){asComboBoxNames[asComboBoxNames.length]="<< "+g_sUseInherited+">>";asComboBoxValues[asComboBoxValues.length]="";}ComboBox.setItemText(asComboBoxNames);ComboBox.setItemValue(asComboBoxValues);ComboBox.setItemCount(asComboBoxNames.length);var PopUp=ComboBox.getPopupTemplate();if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1)nComboWidth=nWidth.toString()+"px";else nComboWidth=nWidth;PopUp.setStyle("width",nComboWidth);var nCnt=ComboBox.getItemCount();PopUp.setStyle("height",(nCnt<=10)?(((g_bFireFox4Browser)?22:20)*nCnt)+"px":"165px");PopUp.setStyle("font-size","11px");ComboBox.getContent("box/text").setAttribute("name","Combo"+sComboID);if(AW.chrome)ComboBox.getContent("box/text").setStyle("padding-right","1px");if(bAllowEdit==undefined||!bAllowEdit){ComboBox.getContent("box/text").setAttribute("readonly",true);ComboBox.getContent("box/text").setStyle("-moz-user-select","-moz-none");ComboBox.onControlEditStarted=function(){this.getContent("box/text").element().contentEditable=false;};}else if(bTriState||bUseTextValues){ComboBox.m_bManualEdit=false;ComboBox.m_bChanged=false;ComboBox.onControlEditStarted=function(sText){this.m_sOriginalText=sText;this.m_bManualEdit=true;this.m_bChanged=false;};ComboBox.onControlEditEnded=function(sText){this.UpdateHiddenValue(sText);this.m_bManualEdit=this.m_bChanged=false;};ComboBox.UpdateHiddenValue=function(sText){if(((this.m_sOriginalText!=sText)&&(sText!=asComboBoxNames[asComboBoxNames.length-1])&&(sText!=this.m_sInheritedVal))||bUseTextValues){if(bTriState)this.getContent("box/text").setStyle("font-weight","bold");document.getElementById(this.getContent("hidden").getId()).value=sText;}else if(sText==""){document.getElementById(this.getContent("hidden").getId()).value=sText;}else{if(this.m_bManualEdit||this.m_bOverrideManualEdit){if((sText==this.m_sInheritedVal)&&(this.m_bChanged||this.m_bOverrideManualEdit)){if(bTriState)this.getContent("box/text").setStyle("font-weight","bold");document.getElementById(this.getContent("hidden").getId()).value=sText;}}else this.getContent("box/text").setStyle("font-weight","");}this.m_bChanged=true;};}if((nWidth!=undefined)||(nHeight!=undefined))ComboBox.setSize(nWidth,nHeight);$("#"+sElementID).addClass('removeme');document.getElementById(sElementID).innerHTML=ComboBox;$(".removeme").removeAttr('id').removeClass('removeme');ComboBox.setControlTextDef=ComboBox.setControlText;ComboBox.setControlText=function(sText){this.setControlTextDef(sText);if((bAllowEdit)&&(bTriState||bUseTextValues))this.UpdateHiddenValue(sText);};ComboBox.SetDisabled=function(bDisable){if(bDisable){this.getContent("box/text").setAttribute("disabled",true);this.getPopupTemplate().setStyle("visibility","hidden");}else{this.getContent("box/text").setAttribute("disabled");this.getPopupTemplate().setStyle("visibility");}this.m_bDisabled=bDisable;};ComboBox.popupEvent=ComboBox.getContent("box/sign").getEvent("onclick");ComboBox.getContent("box/sign").setEvent("onclick",function(event){if(!ComboBox.m_bDisabled)ComboBox.popupEvent(event);});ComboBox.onCurrentItemChangedDef=ComboBox.onCurrentItemChanged;ComboBox.onCurrentItemChanged=function(nNewIndex){var nNewValue="";if((this.m_bTriState||bUseTextValues)&&(this.m_nInheritedVal!=undefined)){if((!isNaN(nNewIndex))&&(nNewIndex!=(asComboBoxNames.length-1||bUseTextValues))){if(this.m_bTriState)this.getContent("box/text").setStyle("font-weight","bold");if(bUseControlVal)nNewValue=this.getItemValue(nNewIndex);else nNewValue=nNewIndex;}else{this.getContent("box/text").setStyle("font-weight","");nNewIndex=this.m_nInheritedVal;nNewValue="";if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(parseInt(this.getItemValue(nIndex))==parseInt(nNewIndex)){nNewIndex=nIndex;break;}}}if((asComboBoxNames.length==1)&&(!this.m_bInitial)){this.setTimeout(function(){this.m_bManualEdit=false;this.setControlText(this.m_sInheritedVal);});}}}else{if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(this.getItemValue(nIndex)==nNewValue){nNewIndex=nIndex;break;}}nNewValue=this.getItemValue(nNewIndex);}else nNewValue=isNaN(nNewIndex)?0:nNewIndex;}document.getElementById(this.getContent("hidden").getId()).value=nNewValue;this.onCurrentItemChangedDef(nNewIndex);};ComboBox.onControlTextChanged=function(value){if((fnOnChange!=undefined)&&(!this.m_bInitial)){nSelectedValue=ComboBox.getItemValue(ComboBox.getSelectedItems());fnOnChange(nSelectedValue);}if(bAllowEdit==undefined||!bAllowEdit)document.getElementById(this.getContent("hidden").getId()).blur();};ComboBox.initValue=function(value,defaultvalue){this.m_sInheritedVal=defaultvalue;this.m_sOriginalText=undefined;value=parseInt(value);defaultvalue=parseInt(defaultvalue);var nControlIndex;if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(parseInt(this.getItemValue(nIndex))==value){nControlIndex=nIndex;break;}}}if(this.m_bTriState){if(isNaN(defaultvalue))this.m_nInheritedVal=0;else this.m_nInheritedVal=defaultvalue;}this.m_bInitial=true;if((isNaN(value))&&(this.m_bTriState)){if(bUseControlVal){for(var nIndex=0;nIndex<this.getItemCount();nIndex++){if(this.getItemValue(nIndex)==this.m_nInheritedVal){this.setSelectedItems([nIndex]);break;}}}else this.setSelectedItems(this.m_nInheritedVal);}else{if(bUseControlVal)this.setSelectedItems([nControlIndex]);else this.setSelectedItems(value);}if(bUseControlVal)this.onCurrentItemChanged(nControlIndex);else this.onCurrentItemChanged(value);this.m_bInitial=false;};ComboBox.EscHidePopup=function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;var sEventType=(window.event)?event:e;var sTarget=sEventType.target||sEventType.srcElement;var bSkipClose=(sTarget.id==(ComboBox.getId()+"-popup-box"));if((IEKeyCode==FFEsc)&&!bSkipClose){ComboBox.showPopup(true);}};ComboBox.showPopup1=ComboBox.showPopup;ComboBox.showPopup=function(bEsc){var el=document;if(this.$popup||bEsc){this.hidePopup();if(el.detachEvent){el.detachEvent("onkeydown",this.EscHidePopup);el.detachEvent("onmouseup",this.EscHidePopup);}else if(el.removeEventListener){el.removeEventListener("keydown",this.EscHidePopup,true);el.removeEventListener("mouseup",this.EscHidePopup,true);}else{el["onkeydown"]=null;el["onmouseup"]=null;}}else{this.showPopup1();if(el.attachEvent){el.attachEvent("onkeydown",this.EscHidePopup);el.attachEvent("onmouseup",this.EscHidePopup);}else if(el.addEventListener){el.addEventListener("keydown",this.EscHidePopup,true);el.addEventListener("mouseup",this.EscHidePopup,true);}else{el["onkeydown"]=this.EscHidePopup;el["onmouseup"]=this.EscHidePopup;}}};if(sControlText.length==0)ComboBox.initValue(sControlValue);if(fnOnSubmit!=undefined)ComboBox.onKeyEnter=fnOnSubmit;ComboBox.m_dateLastSearch=0;ComboBox.m_sSearchStr="";if(bAllowEdit==undefined||!bAllowEdit){ComboBox.onKeyPress=function(event){nEventKeyCode=(event.keyCode!=undefined&&event.keyCode>0)?event.keyCode:undefined;var sKey=String.fromCharCode(nEventKeyCode||event.charCode).toLocaleLowerCase();var dateNow=new Date().getTime();if((sKey!="")){var nStartSearch=0,nCurrentRow=this.getSelectedItems();var bFound=false;var sTemp="";if(nCurrentRow>=0){nStartSearch=parseInt(nCurrentRow);}if((dateNow-this.m_dateLastSearch)>750){this.m_sSearchStr=sKey;if(nStartSearch)nStartSearch++;}else this.m_sSearchStr+=sKey;this.m_dateLastSearch=dateNow;if((!this.ItemSearch(this.m_sSearchStr,nStartSearch,this.getItemCount()))&&(nStartSearch>0))this.ItemSearch(this.m_sSearchStr,0,nStartSearch);}else{this.m_sSearchStr="";this.m_dateLastSearch=0;}};}ComboBox.ItemSearch=function(sSearchStr,nStart,nStop){var bFound=false;for(var nIndex=nStart;nIndex<nStop;nIndex++){var sTemp=this.getItemText(nIndex).substring(0,sSearchStr.length).toLocaleLowerCase();if(sTemp==sSearchStr){this.setSelectedItems([nIndex]);this.setCurrentItem(nIndex);this.setControlText(this.getItemText(nIndex));bFound=true;break;}}return(bFound);};return(ComboBox);}function CreateRadioButtons(nInitValue,asButtonNames,sElementID,sInputName,nWidth,fnOnChange,anValues,anImages,bFlowHorizontal,nFlowItemWidth){var RadioButtons=new AW.UI.Radio;if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1)nWidth=nWidth.toString()+"px";if(bFlowHorizontal){if(nFlowItemWidth.toString().indexOf("px")==-1&&nFlowItemWidth.toString().indexOf("%")==-1)nFlowItemWidth=nFlowItemWidth.toString()+"px";RadioButtons.setClass("flow","horizontal");RadioButtons.getItemTemplate().setStyle("width",nFlowItemWidth);RadioButtons.setStyle("height","25px");}RadioButtons.setContent("hidden",CreateHiddenInput(sElementID,sInputName,"",nInitValue));RadioButtons.setId(sElementID);RadioButtons.setItemText(asButtonNames);RadioButtons.setItemCount(asButtonNames.length);if(anImages!=undefined)RadioButtons.setItemImage(anImages);if(nWidth!=undefined)RadioButtons.setStyle("width",nWidth);document.getElementById(sElementID).innerHTML=RadioButtons;RadioButtons.onSelectedItemsChanged=function(nNewIndex){document.getElementById(this.getContent("hidden").getId()).value=((anValues==undefined)?nNewIndex:anValues[nNewIndex]);if(fnOnChange!=undefined)fnOnChange(this.getSelectedItems(),this);};RadioButtons.initValue=function(value){if(!isNaN(value)){if(anValues==undefined)this.setSelectedItems([value]);else{for(var nIndex=0;nIndex<anValues.length;nIndex++){if(anValues[nIndex]==value){this.setSelectedItems([nIndex]);break;}}}}};RadioButtons.initValue(nInitValue);return(RadioButtons);}function CreateInputField(sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete,nBorderRadius){return(CreateAWInput(new AW.UI.Input,sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete,nBorderRadius));}function CreatePasswordField(sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete,nBorderRadius){return(CreateAWInput(new AW.UI.Password,sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete,nBorderRadius));}function CreateAWInput(InputField,sDefaultText,sElementID,sInputID,fnOnChange,nWidth,nHeight,bRightAlign,fnOnSubmit,bSkipDecode,bTurnOnAutoComplete,nBorderRadius){InputField.setId(sInputID);if((nWidth!=undefined)||(nHeight!=undefined)){var heightToSet=nHeight||20;InputField.setControlSize(nWidth,heightToSet);}InputField.getContent("box/text").setAttribute("name",sInputID);if(nBorderRadius!=undefined){InputField.setStyle("border-radius",nBorderRadius+'px');}if(bTurnOnAutoComplete!=undefined){if(bTurnOnAutoComplete)InputField.getContent("box/text").setAttribute("autocomplete","on");else if(!bTurnOnAutoComplete)InputField.getContent("box/text").setAttribute("autocomplete","off");}if((bRightAlign!=undefined)&&(bRightAlign)){InputField.getContent('box/text').setStyle('text-align','right');InputField.getContent('box/text').setStyle('left','0px');if(AW.ie||AW.opera){if(nWidth!=undefined&&(sElementID==sInputID))InputField.getContent('box/text').setStyle('width',(nWidth-13)+'px');}}if(fnOnChange!=undefined)InputField.onControlEditEnded=fnOnChange;if(fnOnSubmit!=undefined)InputField.onKeyEnter=function(){if(document.selection)document.selection.empty();else if(window.getSelection)window.getSelection().removeAllRanges();fnOnSubmit();};InputField.SetDisabled=function(bDisable){if(bDisable){this.getContent("box/text").setAttribute("disabled",true);}else{this.getContent("box/text").setAttribute("disabled");}this.m_bDisabled=bDisable;};document.getElementById(sElementID).innerHTML=InputField;InputField.setControlText((bSkipDecode)?sDefaultText:DecodeString(sDefaultText));return(InputField);}function CreateGroupBox(sText,sElementID,nWidth,nHeight,bNoOffset){var sContent=document.getElementById(sElementID).innerHTML;var sFieldset=new String;if(nWidth.toString().indexOf("px")==-1&&nWidth.toString().indexOf("%")==-1&&nWidth.toString().indexOf("auto")==-1)nWidth=nWidth.toString()+"px";if(nHeight.toString().indexOf("px")==-1&&nHeight.toString().indexOf("%")==-1&&nHeight.toString().indexOf("auto")==-1)nHeight=nHeight.toString()+"px";sFieldset="<fieldset id='"+sElementID+"FS' class='aw-system-control aw-ui-group' style='overflow:visible;position:static;width:"+nWidth+";height:"+nHeight+";'>";sFieldset+="<legend>"+sText+"</legend>";if((bNoOffset==undefined)||(!bNoOffset)){sFieldset+="<div style='display:block; padding:5px 0px 0px 5px;'>";sContent+="</div>";}document.getElementById(sElementID).innerHTML=sFieldset+sContent+"</fieldset>";}function CreateCheckBox(sText,sElementID,sAttrName,bEnabled,fnOnControlValueChanged,bCreateFormElement,sOnLoad,bInverseLogic){var CheckBox=new AW.UI.Checkbox;CheckBox.setControlText(sText);CheckBox.setAttribute("AttrName",sAttrName);if(bEnabled==1)bEnabled=true;else if(bEnabled==0)bEnabled=false;CheckBox.setControlValue(bEnabled);if(bCreateFormElement)CheckBox.setContent("hidden",CreateHiddenInput(sElementID,sAttrName,sOnLoad,(bEnabled)?"1":"0"));CheckBox.setChecked=function(bChecked,bIgonoreCB){this.m_bIgonoreCB=bIgonoreCB;this.setControlValue(bChecked);};CheckBox.onControlValueChanged=function(bValue){if(bInverseLogic)bValue=(!bValue);if(bCreateFormElement){document.getElementById(this.getContent("hidden").getId()).value=((bValue)?"1":"0");}if((fnOnControlValueChanged!=undefined)&&(!this.m_bIgonoreCB))fnOnControlValueChanged(this);this.m_bIgonoreCB=false;};document.getElementById(sElementID).innerHTML=CheckBox;return(CheckBox);}function CreateTriStateCheckBox(sText,sElementID,sAttrName,sVal,sDefaultVal,sUseDefault,fnOnControlValueChanged,sOnLoad){if(isNaN(parseInt(sVal))){sVal=sDefaultVal;sUseDefault="1";}var CheckBox=CreateCheckBox(sText,sElementID,sAttrName,(parseInt(sVal)?true:false),fnOnControlValueChanged,true,sOnLoad);CheckBox.setBoldText=function(bBold){this.getContent("box/text").setStyle("font-weight",(bBold)?"bold":"normal");};if(sUseDefault=="1"){document.getElementById(CheckBox.getContent("hidden").getId()).value="";}else CheckBox.setBoldText(true);CheckBox.onControlValueChanged=function(bValue){if(this.m_bIgonoreCB){this.m_bIgonoreCB=false;return;}else{var bBoldText=true;var sOldValue=document.getElementById(this.getContent("hidden").getId()).value;var sNewValue=(bValue?"1":"0");if(sOldValue=="")sNewValue=((sDefaultVal!="0")?"0":"1");else{if(sOldValue!=sDefaultVal)sNewValue=sDefaultVal;else{sNewValue="";bBoldText=false;}}document.getElementById(this.getContent("hidden").getId()).value=sNewValue;this.setChecked(((sNewValue=="")?(sDefaultVal!="0"):(sNewValue!="0")),true);this.setBoldText(bBoldText);if(fnOnControlValueChanged!=undefined)fnOnControlValueChanged(this);}};return(CheckBox);}function CheckBoxValueChanged(CheckBox,sURL,fPostProcessFunction){var sAttrName=CheckBox.getAttribute("AttrName");var BoolUpdate=CreatePostRequest(g_sAdminXMLPath+sURL);if(CheckBox.getContent("hidden"))BoolUpdate.setParameter(sAttrName,document.getElementById(CheckBox.getContent("hidden").getId()).value);else BoolUpdate.setParameter(sAttrName,((CheckBox.getControlValue()==false)?0:1));SavingDialog(true);BoolUpdate.request();BoolUpdate.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");SavingDialog(false);if(nResult!=g_nSessionOkay){CheckBox.setChecked((!CheckBox.getControlValue()),true);AlertDialog(GetResultText(0,"",sResultText));}else{if(fPostProcessFunction!=undefined)fPostProcessFunction(CheckBox.getControlValue());}};}function CreateRuleButton(nId,sRuleImage,fnCallback,objParam){var RuleButton=CreatePushButton("",nId,fnCallback,undefined,undefined,objParam);RuleButton.setControlImage(sRuleImage);return(RuleButton);}function CreateRuleButtons(anIds,afnCallbacks,objParam){CreateRuleButton(anIds[0],"toparrow",afnCallbacks[0],objParam);CreateRuleButton(anIds[1],"uparrow",afnCallbacks[1],objParam);CreateRuleButton(anIds[2],"downarrow",afnCallbacks[2],objParam);CreateRuleButton(anIds[3],"bottomarrow",afnCallbacks[3],objParam);}function GetURLParameter(sParameterName,bSkipSanitize){var sParameterValue="";var sCurrentURL=window.location.href;var nPos=sCurrentURL.indexOf("?");if(nPos<=-1)nPos=sCurrentURL.indexOf("&");if(nPos>-1){var sParemeterString=sCurrentURL.substr(nPos+1);var aParameterArray=sParemeterString.split("&");for(var iParam=0;iParam<aParameterArray.length;iParam++){nPos=aParameterArray[iParam].indexOf("=");if(aParameterArray[iParam].substring(0,(nPos+1)).toLowerCase()==(sParameterName.toLowerCase()+"=")){var aParamPosition=aParameterArray[iParam].split("=");if(bSkipSanitize)sParameterValue=aParamPosition[1];else sParameterValue=SanitizeString(aParamPosition[1]);break;}}}return(sParameterValue);}function SanitizeString(sStr){var sSanitizedStr;sSanitizedStr=sStr.replace(new RegExp("&","g"),"&amp;");sSanitizedStr=sSanitizedStr.replace(new RegExp("<","g"),"&lt;");sSanitizedStr=sSanitizedStr.replace(new RegExp(">","g"),"&gt;");sSanitizedStr=sSanitizedStr.replace(new RegExp("'","g"),"&apos;");sSanitizedStr=sSanitizedStr.replace(new RegExp("\"","g"),"&#x22;");sSanitizedStr=sSanitizedStr.replace(new RegExp('\\)',"g"),"&#x29;");sSanitizedStr=sSanitizedStr.replace(new RegExp("\\(","g"),"&#x28;");return(sSanitizedStr);}function OnSendNOOP(bWebClient){var sNOOPCmd="/?Command=NOOP";var NOOPRequest=CreatePostRequest(sNOOPCmd);var nNOOPDelay=55000;if(g_bFVJVLoggedInCheck)nNOOPDelay=10000;NOOPRequest.request();NOOPRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay&&g_nNOOPRetry>=5){if(g_bFVJVLoggedInCheck)GoToLogin();else{if(bWebClient){if(g_bMediaPreviewActive)OnKillMediaShow();setTimeout(function(){if(sResultText==undefined)AlertDialog(GetResultText(0,"",sResultText),true,OnWebClientLogout);else AlertDialog(GetResultText(0,"",sResultText));},1000);}else AlertDialog(GetResultText(0,"",sResultText));}}else{if(nResult!=g_nSessionOkay){g_nNOOPRetry++;nNOOPDelay=0;}else g_nNOOPRetry=0;setTimeout(function(){OnSendNOOP(bWebClient);},nNOOPDelay);}};}function DisableTab(sID,TabGrid,sBodyText,bInfo){if(sBodyText!=undefined)document.getElementById(sID+"Body").innerHTML=sBodyText;document.getElementById(sID).style.display="none";document.getElementById(sID+"None").style.display="block";if(TabGrid!=undefined){TabGrid.EnableUpdatesDef=TabGrid.EnableUpdates;TabGrid.EnableUpdates(false);TabGrid.EnableUpdates=function(){return;};}if(bInfo)document.getElementById(sID+"DisableImage").src=(g_sImagePath+"Information.png");}function EnableTab(sID,TabGrid){document.getElementById(sID+"None").style.display="none";document.getElementById(sID).style.display="block";if((TabGrid)&&(TabGrid.EnableUpdatesDef!=undefined))TabGrid.EnableUpdates=TabGrid.EnableUpdatesDef;}function LaunchFVJV(bBypassWCPCheck){if(g_bMultiTransferLoaded&&g_bWebClientProActive&&bBypassWCPCheck!=true){if(IsAppletWorking()==1)OnWCPQuitPrompt(function(){LaunchFVJV(true)});else LaunchFVJV(true);}else{if(g_bFVJVLicense){g_PageUnloading=true;g_bLinkRequested=true;location.href=g_sCommonPath+"FVJVLoggedIn.htm";}else{ConfirmDialog(g_sFVJVLicenseInfo,OnMoreFVJVInfo);}}}function OnViewFileShareConsole(){if(g_bAllowAdhocFileSharing){g_PageUnloading=true;location.href=g_sWebFilePath+"Share/Console.htm";}else{ConfirmDialog(g_sAdhocFileShareLicenseInfo,OnMoreAdhocInfo);}}function OnMoreAdhocInfo(){window.open("https://customerportal.solarwinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank","noopener");}function Trim(sString){sString=sString.replace(eval("/^\\s*|\\s*$/g"),"");return sString;}function LaunchHelp(sHelpPage,sHelpNode){if(sHelpPage==""||sHelpPage==null||sHelpPage==undefined)sHelpPage=g_sHelpPage;var sLang=readCookie("SULang");sLang=sLang.substring(0,sLang.indexOf(","));sHelpPath="http://"+g_sHelpPath+"/documentation/helploader.aspx?"+"lang="+sLang+"&topic=servu_"+sHelpPage;window.open(sHelpPath,"_help","noopener, resizable=yes, scrollbars=yes");}function LaunchClientHelp(sHelpPage,sHelpNode){if(sHelpPage==""||sHelpPage==null||sHelpPage==undefined)sHelpPage=g_sHelpPage;var sLang=readCookie("SULang");sLang=sLang.substring(0,sLang.indexOf(","));sHelpPath="http://"+g_sHelpPath+"/documentation/helploader.aspx?"+"lang="+sLang+"&topic=webftp_"+sHelpPage;window.open(sHelpPath,"_help","noopener");}function OnMoreFVJVInfo(){window.open("https://customerportal.solarwinds.com/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP&email="+g_sLicenseEmail,"_blank","noopener");}function IsIPAddressCheck(ipaddr){var parts=ipaddr.split(".");if(parseInt(parseFloat(parts[0]))==0||parseInt(parseFloat(parts[0]))=="NaN"){return false;}for(var i=0;i<parts.length;i++){if(parseInt(parseFloat(parts[i]))>255||parseInt(parseFloat(parts[i]))=="NaN"){return false;}}return true;}function createCookie(name,value,days,bNoPath){var expires,sDomainHost,sHost,nPortPos,bBypassDomainCookie=false;var bIsOperaCheck=(navigator.userAgent.indexOf("Opera")>=0);var bChrome=(navigator.userAgent.toLowerCase().indexOf('chrome')>-1);var ua=navigator.userAgent||"";var sSecure="";var sPath="; path=/;";sEncodedValue=encodeURIComponent(value);sHost=top.location.host.toLowerCase();nPortPos=sHost.indexOf(":");if(nPortPos!=-1){sHost=sHost.substr(0,nPortPos);}if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}else expires="; expires=Thu, 01-Jan-1970 00:00:01 GMT";if((bIsOperaCheck||bChrome)||(ua.match("Safari"))&&IsIPAddressCheck(sHost))bBypassDomainCookie=true;if(sHost!="localhost"&&!bBypassDomainCookie)sDomainHost="domain="+sHost;else sDomainHost="";nDotPos=sHost.indexOf(".");if(nDotPos==-1)sDomainHost="";if(location.protocol=='https:'){sSecure="; secure";}if(bNoPath)sPath="";document.cookie=name+"="+sEncodedValue+expires+sPath+sDomainHost+sSecure;}function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0&&decodeURIComponent(c.substring(nameEQ.length,c.length)))return decodeURIComponent(c.substring(nameEQ.length,c.length));}return"";}
function clearSessionCookies(name){document.cookie=name+"=; expires=Thu, 01-Jan-70 00:00:01 GMT"+"; path=/";}function CookieCheck(){if(document.cookie==""){AlertDialog(g_sEnableCookies,true);document.getElementById("CookieCheck").cookieexists.value="false";}else{document.getElementById("CookieCheck").cookieexists.value="true";}}function EnableSelectionOnFormElements(){var bIsOperaCheck=(navigator.userAgent.indexOf("Opera")>=0);var tag_names=["input","textarea"];if(document.getElementsByTagName){for(var i=0;i<tag_names.length;i++){FormElements=document.getElementsByTagName(tag_names[i]);for(var intCounter=0;intCounter<FormElements.length;intCounter++){FormElements[intCounter].onfocus=function(){if(document.attachEvent){if(bIsOperaCheck){document.body.onmousedown=function(){return true;};this.focus();}else{this.detachEvent('onselectstart',StopSelections);this.attachEvent('onselectstart',BubbleCancel);}}else{this.removeEventListener('selectstart',StopSelections,false);this.addEventListener('selectstart',BubbleCancel,false);}};if(tag_names[i]=="textarea"&&bIsOperaCheck){FormElements[intCounter].onclick=function(){this.focus();};}FormElements[intCounter].onblur=function(){if(document.attachEvent){if(bIsOperaCheck){document.body.onmousedown=function(){return false;};}else{this.detachEvent('onselectstart',BubbleCancel);this.attachEvent('onselectstart',StopSelections);}}else{this.removeEventListener('selectstart',BubbleCancel,false);this.addEventListener('selectstart',StopSelections,false);}};}}}}function BubbleCancel(event){if(AW.ie)event.cancelBubble=true;else event.stopPropagation();}function BuildDialog(sTitle,sDialog,sWidth,sHeight,sStyle,sCloseText,sImageFilePath,bOpaqueDialog,sCSSImgClass){var sDivInner=(sDialog+"inner"),sDialogContainer="",sBackgroundSet="",sTitleStyleSet="";var sDialogInner=document.getElementById(sDivInner).innerHTML;var sOnHideDialog=String("HideDialog(");var sBodyStyle="";if(sStyle!=undefined)sBodyStyle=sStyle;if(bOpaqueDialog){sBackgroundSet="background-color:transparent;color:#ffffff;";sTitleStyleSet="z-index: 8000;position:relative;";}document.getElementById(sDivInner).innerHTML="";sDialogContainer+='<table id="'+sDialog+'TitleBar" style="'+sTitleStyleSet+'"  class="DialogTitle" cellpadding="0" cellspacing="0">';sDialogContainer+=' <tr>';sDialogContainer+='  <td class="headcontainer">';sDialogContainer+='   <div id="'+sDialog+'TitleContainer" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">';if(sImageFilePath!=undefined)sDialogContainer+='   <img id="'+sDialog+'TitleIcon" src="'+g_sCommonPath+'Images/'+sImageFilePath+'" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="16" height="16" border="0">';else if(sCSSImgClass!=undefined){sDialogContainer+='   <div  id="'+sDialog+'TitleIcon" style="position:relative;top:6px;margin-right:2px;" class="WC-Icon-18 '+sCSSImgClass+'"></div>';}else sDialogContainer+='   <img id="'+sDialog+'TitleIcon" src="'+g_sCommonPath+'Images/SULogo-Dlg-Ico.png" style="vertical-align:middle; margin:2px 2px 0px 0px;" width="25" height="25" border="0">';sDialogContainer+='   <span id="'+sDialog+'TitleText">'+sTitle+'</span>';sDialogContainer+='   </div>';sDialogContainer+='  </td>';sDialogContainer+='  <td class="closebox" id="'+sDialog+'closebox">';sDialogContainer+='   <span><img id="'+sDialog+'CloseIcon" src="'+g_sCommonPath+'Images/blank.gif" style="vertical-align:middle;cursor:pointer" alt="'+sCloseText+'"  border="0" onmousedown="javascript:'+sOnHideDialog+'\''+sDialog+'\');" onmouseover="javascript:document.getElementById(\''+sDialog+'closebox\').className =\'closebox-hover\'" onmouseout="javascript:document.getElementById(\''+sDialog+'closebox\').className =\'closebox\'" width="40" height="40"></span>';sDialogContainer+='  </td>';sDialogContainer+=' </tr>';sDialogContainer+='</table>';if(bOpaqueDialog)sDialogContainer+='<div id="'+sDialog+'opaqueinner" class="opaquedialoginner"></div>';sDialogContainer+='<div id="'+sDialog+'Body" style="'+sBackgroundSet+'z-index:8000;position:relative;width:2px;'+sBodyStyle+'" class="DialogBody">';sDialogContainer+=sDialogInner;sDialogContainer+="</div>";CreateOpaqueLayerDiv(sDialog+"OpaqueLayer");var DialogElement=document.createElement("div");DialogElement=document.createElement("div");DialogElement.id=sDialog;DialogElement.className="DialogLayer";DialogElement.style.width=parseInt(sWidth)+"px";DialogElement.style.left="-5000px";DialogElement.style.top="-5000px";if(sStyle=="text-align:center")DialogElement.style.textAlign="center";DialogElement.innerHTML=sDialogContainer;document.getElementsByTagName("body")[0].appendChild(DialogElement);}function AdjustDialogWidth(dialogName,dialogWidth){var dialogToAdjust=document.getElementById(dialogName);var tabsWrapper=dialogToAdjust.querySelector("#DialogTabs");var tabsContainer=dialogToAdjust.querySelector("#DialogTabs-view");var tabs=tabsContainer.children;var tabsWidth=0;for(var i=0;i<tabs.length;i++){tabsWidth+=tabs[i].offsetWidth;}if(tabsWidth>dialogWidth){dialogToAdjust.style.width=dialogToAdjust.clientWidth+(tabsWidth-dialogWidth)+25+'px';tabsWrapper.style.width="100%";}}function CreateOpaqueLayerDiv(sLayerID,bBubbleTip){var DialogElement=document.createElement("div");DialogElement.id=(sLayerID);if(bBubbleTip)DialogElement.className="OpaqueLayerBubble";else DialogElement.className="OpaqueLayer";document.getElementsByTagName("body")[0].appendChild(DialogElement);}function AddOnloadEvent(fnc){if(typeof window.addEventListener!="undefined")window.addEventListener("load",fnc,false);else if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",fnc);}else{if(window.onload!=null){var oldOnload=window.onload;window.onload=function(e){oldOnload(e);window[fnc]();};}else window.onload=fnc;}}function eraseCookie(name){createCookie(name,"",false);}function SetActiveStyleSheet(sStyleTitle){var i,StyleTag;for(i=0;(StyleTag=document.getElementsByTagName("link")[i]);i++){if(StyleTag.getAttribute("rel").indexOf("style")!=-1&&StyleTag.getAttribute("title")){StyleTag.disabled=true;if(StyleTag.getAttribute("title")==sStyleTitle)StyleTag.disabled=false;}}}function LoadCustomImage(bDisableBranding,bHasCustomLogo){var CustomImg=new Image();var sCustomImgSrc="/%25LOGO_FILE%25"+g_sWebFilePath+"Images/ServU_Logo_WhiteText.svg"+SyncRequestParameter();var nWidth="400";var nHeight="100";if(bDisableBranding&&!bHasCustomLogo){sCustomImgSrc=g_sCommonPath+"Images/blank.gif"+SyncRequestParameter();nWidth="1";nHeight="1";}if(bDisableBranding){if(document.getElementById("FooterLogos"))document.getElementById("FooterLogos").style.display="none";if(document.getElementById("FooterCopyright"))document.getElementById("FooterCopyright").style.display="none";}CustomImg.src=sCustomImgSrc;document.getElementById("SULoginLogo").src=CustomImg.src;document.getElementById("SULoginLogo").width=nWidth;document.getElementById("SULoginLogo").height=nHeight;}function CreateJSElement(sSource,bIsTextSource,bBody){var ScriptElement=document.createElement("script");ScriptElement.setAttribute("type","text/javascript");ScriptElement.setAttribute("language","JavaScript");if(bIsTextSource)ScriptElement.text=sSource;else ScriptElement.setAttribute("src",sSource);document.getElementsByTagName((bBody)?"body":"head")[0].appendChild(ScriptElement);}function DynamicContentRun(fnDone,oParams){if(typeof(fnDone)=="function")fnDone(oParams);else{window.g_SUDynamicParams=oParams;eval(fnDone+"window.g_SUDynamicParams);");window.g_SUDynamicParams=undefined;}}function LoadDynamicContentAndRun(aParams){LoadingDialog(true);if(!$("#"+aParams[1]).length)$("body").append("<div id='"+aParams[1]+"' style='display:none;'></div>");if(document.getElementById(aParams[1]).innerHTML!="")DynamicContentRun(aParams[2],aParams[3]);else{LoadDynamicContent(aParams[0],aParams[1],function(){DynamicContentRun(aParams[2],aParams[3]);});}}function LoadDynamicContent(sPage,sDivID,fnOnDone){var Request;if(Request=createAWHttpRequest("GET",sPage,OnLoadDynamicContent)){Request.m_sDivID=sDivID;Request.m_fnOnDone=fnOnDone;Request.request();}}function OnLoadDynamicContent(){var sContent=this.getResponseText(),sScript="";var nIndex=0,nEnd=0,nTemp=0;var aJSContent=new Array();while((nIndex=sContent.indexOf("<script"),nIndex)>=0){if((nEnd=sContent.indexOf("<\/script>",(nIndex+1)))){sScript=sContent.substring(nIndex,nEnd);sScript=sScript.substring(sScript.indexOf(">")+1);if(sScript!="")aJSContent.push(sScript);sContent=sContent.substring(0,nIndex)+sContent.substring(nEnd+9);}}document.getElementById(this.m_sDivID).innerHTML=sContent;for(var nIndex=0;nIndex<aJSContent.length;nIndex++)CreateJSElement(aJSContent[nIndex],true);if(typeof(this.m_fnOnDone)=="function")this.m_fnOnDone.call(this);EnableSelectionOnFormElements();}function DelayLoadExecute(afnParams,bSkipLoadingDlg,bDismissLoad){if(afnParams[0]()){if(bDismissLoad)LoadingDialog(false);if(typeof(afnParams[1])=="function")afnParams[1]();else eval(afnParams[1]);EnableSelectionOnFormElements();}else{if(!bSkipLoadingDlg)LoadingDialog(true);setTimeout(function(){DelayLoadExecute(afnParams,true,bDismissLoad);},250);}}function findPos(obj){var nCurleft=nCurtop=0;if(obj.offsetParent){nCurleft=obj.offsetLeft;nCurtop=obj.offsetTop;while(obj=obj.offsetParent){nCurleft+=obj.offsetLeft;nCurtop+=obj.offsetTop;}}return[nCurleft,nCurtop];}function ResizeGrids(bDoColChange){var w_MaxHeight=1600,w_MinHeight=700,nScrollAdjust=20;var anDim=GetScreenDim(30,20);var nIEOffset=0;var nIpadOffSet=0;if(g_bIsiPad)nIpadOffSet=50;if(navigator.appName.indexOf("Microsoft")!=-1)nIEOffset=5;w_NewHeight=anDim[1];if(w_NewHeight>w_MaxHeight)w_NewHeight=w_MaxHeight;else if(w_NewHeight<w_MinHeight)w_NewHeight=w_MinHeight;w_NewHeight=(w_NewHeight-5);if(g_ActiveRezizeGrid!=undefined){if(typeof(g_ActiveRezizeGrid)=="string"){document.getElementById(g_ActiveRezizeGrid).style.height=parseInt(w_NewHeight-(g_nGridOffSet+nIEOffset+nIpadOffSet))+"px";}else{var nTotalCols=(g_ActiveRezizeGrid.getColumnCount());if(g_ActiveRezizeGrid.element().offsetWidth>0){ResizeColumns(nTotalCols,g_ActiveRezizeGrid,nScrollAdjust,bDoColChange);}else{setTimeout(function(){ResizeColumns(nTotalCols,g_ActiveRezizeGrid,nScrollAdjust,bDoColChange);});}g_ActiveRezizeGrid.setStyle("height",parseInt(w_NewHeight-(g_nGridOffSet+nIEOffset+nIpadOffSet))+"px");g_ActiveRezizeGrid.setContentHeight(w_NewHeight-((g_nGridOffSet+nIEOffset+nIpadOffSet)+5),"total");}}if(!g_bWindowResizeSet){g_bWindowResizeSet=true;window.onresize=function(){ResizeGrids(false);};}}function GetScreenDim(nOffSetIE,nOffSetFF){var anScreenDims=[];if(navigator.appName.indexOf("Microsoft")!=-1){w_newWidth=document.documentElement.clientWidth;w_newHeight=document.documentElement.clientHeight-nOffSetIE;}else{var netscapeScrollWidth=nOffSetFF;w_newWidth=window.innerWidth-netscapeScrollWidth;w_newHeight=window.innerHeight-netscapeScrollWidth;}anScreenDims=[w_newWidth,w_newHeight];return(anScreenDims);}function HasMoreDialogs(){var bHasMoreDlgs=false;for(var i=0;i<Dialogs.length;i++){if(Dialogs[i]!=undefined){if(document.getElementById(Dialogs[i].m_sOpaqueLayer).style.display=="block"){bHasMoreDlgs=true;break;}}}return(bHasMoreDlgs);}function IsMacOS(){var bFound=false;var sFind="mac os";var sUserAgent=navigator.userAgent.toLowerCase();var nStartIdx=sUserAgent.indexOf(sFind);if(nStartIdx>=0)bFound=true;return(bFound);}function IsFirefox(){var bFound=false;var sFind="firefox";var sUserAgent=navigator.userAgent.toLowerCase();var nStartIdx=sUserAgent.indexOf(sFind);if(nStartIdx>=0)bFound=true;return(bFound);}function GetIEMajorVersionNumber(){var nMajorVersionNumber=-1;var sUserAgent=navigator.userAgent;if(sUserAgent!=null&&sUserAgent!=undefined){var sMSIE="MSIE";var nFoundMSIE=sUserAgent.indexOf(sMSIE);if(nFoundMSIE!=-1){var nMajorVersionIndex=(nFoundMSIE+(sMSIE.length+1));var nMajorVersionDotIndex=sUserAgent.indexOf('.',nMajorVersionIndex);if(nMajorVersionIndex<nMajorVersionDotIndex){var sMajorVersion=sUserAgent.substring(nMajorVersionIndex,nMajorVersionDotIndex);if(sMajorVersion!=null&&sMajorVersion!=undefined)nMajorVersionNumber=parseInt(sMajorVersion);}}}return(nMajorVersionNumber);}function IsIE7(){return(GetIEMajorVersionNumber()==7);}function IsIE8(){return(GetIEMajorVersionNumber()==8);}function IsIE9(){return(GetIEMajorVersionNumber()==9);}function IsIE10(){return(GetIEMajorVersionNumber()==10);}function ToggleApplet(bHideIt,bCheckForDlgs,bFromApplet,bForceIt){if((g_bMultiTransferLoaded)&&(g_bWebClientProActive)){if(g_bContextKeepAppletHidden)bHideIt=true;if((bCheckForDlgs)&&(HasMoreDialogs()))bHideIt=true;g_bMultiTransferHidden=bHideIt;if(!g_PageUnloading){if(bHideIt){var anDim=GetScreenDim(4,15);var nWidth=anDim[0];var nHeight=anDim[1];OnHideApplet(nWidth,nHeight);try{document.getElementById(g_sAppletFrameID).style.visibility="hidden";}catch(err){if(console.log)console.log("AppletIdContainer is NULL; which could happen due to killing it before it's loaded.");}}else{try{document.getElementById(g_sAppletFrameID).style.visibility="visible";}catch(err){if(console.log)console.log("AppletIdContainer is NULL; which could happen due to killing it before it's loaded.");}OnShowApplet();if(g_nShowList!=0)FilesList.element().focus();}}g_bContextKeepAppletHidden=false;}else if(bForceIt){if(bHideIt){if(document.getElementById(g_sAppletFrameID)!=undefined)document.getElementById(g_sAppletFrameID).style.visibility="hidden";}else{if(document.getElementById(g_sAppletFrameID)!=undefined)document.getElementById(g_sAppletFrameID).style.visibility="visible";}}}function ShowApplet(bFromApplet){ShowAppletEx(true,bFromApplet);}function ShowAppletEx(bCheckForDlgs,bFromApplet){ToggleApplet(false,bCheckForDlgs,bFromApplet);}function HideApplet(bFromApplet){HideAppletEx(true,bFromApplet);}function HideAppletEx(bCheckForDlgs,bFromApplet){ToggleApplet(true,bCheckForDlgs,bFromApplet);}function ResizeColumns(nCols,objGrid,nScrollWidth,bDoColChange){if(objGrid===undefined)return;var nGridWidth=((objGrid.element().offsetWidth)-nScrollWidth);var nGridColSize=0,bMinimize=false;if((objGrid.inMotion==undefined&&bDoColChange)||(!bDoColChange)){if(nGridWidth>0)g_nGridWidth=nGridWidth;if(objGrid.anColWidth==undefined){objGrid.anColWidth=[];objGrid.nTotalColWidth=0;objGrid.nDivisibleCols=nCols;for(var nIndex=0;nIndex<(nCols);nIndex++){objGrid.anColWidth[nIndex]=objGrid.getColumnWidth(nIndex);objGrid.nTotalColWidth=objGrid.nTotalColWidth+objGrid.anColWidth[nIndex];if(objGrid.m_ColumnNoResize[nIndex]==1)objGrid.nDivisibleCols=objGrid.nDivisibleCols-1;}}if((g_nGridWidth)<objGrid.nTotalColWidth){nGridColSize=parseInt((objGrid.nTotalColWidth-g_nGridWidth)/objGrid.nDivisibleCols);bMinimize=true;}else nGridColSize=parseInt((g_nGridWidth-objGrid.nTotalColWidth)/objGrid.nDivisibleCols);if(nGridColSize>0){for(var nIndex=0;nIndex<(nCols);nIndex++){if(objGrid.m_ColumnNoResize[nIndex]!=1){if(bMinimize)objGrid.setColumnWidth(parseInt(objGrid.anColWidth[nIndex]-nGridColSize),nIndex);else objGrid.setColumnWidth(parseInt(objGrid.anColWidth[nIndex]+nGridColSize),nIndex);}}}}objGrid.inMotion=true;objGrid.onColumnWidthChanged=function(width,index){if(this.anColWidth!=undefined&&index!=undefined){var nCurrentWidth=this.nTotalColWidth;if(parseInt(width)>this.anColWidth[index])this.nTotalColWidth=nCurrentWidth+(parseInt(width)-this.anColWidth[index]);else this.nTotalColWidth=nCurrentWidth-(this.anColWidth[index]-parseInt(width));this.anColWidth[index]=parseInt(width);}};}function GetStatsDateTimeFormat(data){var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();if((typeof(data)=="undefined")||(data=="")||(data.toString()=="0"))return("");else{if((AW.ie)&&(parseInt(navigator.appVersion)>=4))return(VBDateFormat(data,nTimeZoneOffset));else{return(FormatFileDate(data));}}}function PasswordGen(nLen){var sChars="bcdfghjklmnpqrstvwxyz";var sPassword="";var nPassLength=8;if((nLen!=undefined)&&(nLen!="")&&(nLen!="0"))nPassLength=parseInt(nLen);for(x=0;x<nPassLength;x++){i=Math.floor(Math.random()*sChars.length);var bCaps=Math.round(Math.random()*1);if(bCaps==0)sPassChar=sChars.charAt(i).toUpperCase();else sPassChar=sChars.charAt(i);sPassword+=sPassChar;}var nNumLen;nNumLen=Math.round(Math.random()*(nPassLength-1))+1;for(var n=0;n<nNumLen;n++){var nNumPos=Math.round(Math.random()*(nPassLength-1));var nNumber=Math.round(Math.random()*9);if(nNumPos==0)sPassword=nNumber+sPassword.substring(1);else if(nNumPos==nPassLength)sPassword=sPassword.substring(0,(nPassLength-1))+nNumber;else sPassword=sPassword.substring(0,(nNumPos-1))+nNumber+sPassword.substring(nNumPos);}return(sPassword);}function GetResultText(nResult,sFailError,sErrorText){var sText=sErrorText;switch(nResult){case 1:case 3:case 6:if(sFailError!=""&&sFailError!=undefined)sText=sFailError;break;}if(sText==""||sText==undefined)sText=g_sUnknownError;return(sText);}function CheckEmailValidation(sEmail){if(sEmail!=""){var nAtPos=sEmail.indexOf("@");var nDotPos=sEmail.lastIndexOf(".");if(nAtPos<=0||parseInt(sEmail.indexOf(".",nAtPos))==-1||nDotPos<(nAtPos+2)||(nDotPos+1)>=sEmail.length)return(false);else return(true);}else return(true);}function DomainSortAlpha(a,b){var bIsNum=false;var nCompareResult;var ta=a[0];var tb=b[0];if(isNaN(ta)&&isNaN(tb)){ta=ta.toLocaleLowerCase();tb=tb.toLocaleLowerCase();nCompareResult=ta.localeCompare(tb);}else bIsNum=true;if(!bIsNum){if(nCompareResult>0)return 1;if(nCompareResult<0)return-1;return 0;}else{if(ta>tb)return 1;if(ta<tb)return-1;return 0;}}function HTMLDecode(value){var txt=document.createElement('textarea');if(value)txt.innerHTML=value;return txt.value;}function ArrayAlphaSort(asVar1,asVar2){return(asVar1[0].localeCompare(asVar2[0]));}function FormatNumberCommas(nNumber,bNoDecimal){var sNumberReturn="";if(nNumber.toLocaleString().valueOf()=="[object Number]")sNumberReturn=nNumber;else sNumberReturn=nNumber.toLocaleString();if(bNoDecimal){if(sNumberReturn.substr(sNumberReturn.length-3)==".00"||sNumberReturn.substr(sNumberReturn.length-3)==",00")sNumberReturn=sNumberReturn.substr(0,(sNumberReturn.length-3));}return(sNumberReturn);}function IsAppletWorking(){return(OnAppletIsWorking());}function OnEqualOneContextMenu(objGrid,sButtonText){if(objGrid.getSelectedRows().length==1){sMenuItemName=sButtonText;}else{sMenuItemName="";}return(sMenuItemName);}function OnGreaterZeroContextMenu(objGrid,sButtonText){if(objGrid.getSelectedRows().length>0){sMenuItemName=sButtonText;}else{sMenuItemName="";}return(sMenuItemName);}function GetFileName(sPath,bUrlDecodeIt){var sFileName=sPath;if(sPath!=null&&sPath!=undefined&&sPath!=""){if(bUrlDecodeIt)sPath=decodeURIComponent(sPath);var nLastIndex=-1;var nLastIndexForwardSlash=sPath.lastIndexOf('/');var nLastIndexBackSlash=sPath.lastIndexOf('\\');if(nLastIndexForwardSlash>-1&&nLastIndexBackSlash>-1)nLastIndex=Math.max(nLastIndexForwardSlash,nLastIndexBackSlash);else if(nLastIndexForwardSlash>-1)nLastIndex=nLastIndexForwardSlash;else nLastIndex=nLastIndexBackSlash;if(nLastIndex>-1)sFileName=sPath.substring(nLastIndex+1);}if(bUrlDecodeIt&&sFileName!=undefined&&sFileName!=null&&sFileName!="")sFileName=decodeURIComponent(sFileName);return SanitizeString(sFileName);}function GetFileIcon(sStr,bLowerCase){var asExtensions={"AVI":1,"BAT":1,"BMP":1,"C":1,"CAB":1,"CHM":1,"CNT":1,"CPP":1,"CRT":1,"CSV":1,"DEF":1,"DLL":1,"DOC":1,"DOT":1,"DSP":1,"DSW":1,"EXE":1,"GIF":1,"H":1,"ANI":1,"HTML":1,"HTM":1,"HXC":1,"HXI":1,"HXK":1,"HXS":1,"HXT":1,"INI":1,"ISO":1,"JPG":1,"JS":1,"MAK":1,"MDB":1,"MDE":1,"MDW":1,"MDZ":1,"MID":1,"MP3":1,"URL":1,"MOV":1,"MPG":1,"MSI":1,"PPT":1,"PDF":1,"POT":1,"PNG":1,"RC":1,"REG":1,"RTF":1,"SCT":1,"SLN":1,"HLP":1,"TTF":1,"TXT":1,"VBS":1,"SAFARI":1,"FIREFOX":1,"VCPROJ":1,"VCXPROJ":1,"VSSSCC":1,"XML":1,"WAV":1,"WMA":1,"WMV":1,"WMZ":1,"WRI":1,"XLS":1,"ZIP":1,"PSD":1,"AI":1,"INDD":1,"ACCDB":1,"DOCX":1,"DOTX":1,"POTX":1,"PPTX":1,"PUB":1,"XLSX":1,"XLTX":1,"RAR":1,"7Z":1,"M4A":1};sStr=sStr.toUpperCase();switch(sStr){case"MP4":case"M4P":sStr="MOV";break;case"HTM":case"HTML":case"URL":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFARI";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FIREFOX";break;case"POT":case"PPA":case"PPS":case"PPZ":case"PWZ":sStr="PPT";break;case"ARC":case"TAR":case"GZ":case"BZ":case"BZ2":case"IMG":case"MIM":case"TAX":case"TBZ":case"TBZ2":case"TZ":case"UU":case"UUE":case"XXE":case"Z":case"ZIPX":sStr="ZIP";break;case"7ZFM":case"7ZG":sStr="7Z";break;}if(asExtensions[sStr]){if(bLowerCase)return(sStr.toLowerCase()+"Ext");else return(sStr+"Ext");}else{if(bLowerCase)return("defaultExt");else return("DefaultExt");}}function GetLargeFileIcon(sStr){var asExtensions={"DLL":1,"ISO":1,"MID":1,"WMV":1,"MPG":1,"SAFARI":1,"SAFURL":1,"FIREFOX":1,"FFURL":1,"MOV":1,"M4A":1,"MDB":1,"MP3":1,"PDF":1,"PPT":1,"PNG":1,"DOC":1,"URL":1,"XLS":1,"ZIP":1,"TXT":1,"HTM":1,"HTML":1,"EXE":1,"PSD":1,"AI":1,"INDD":1,"VCXPROJ":1,"ACCDB":1,"DOCX":1,"DOTX":1,"POTX":1,"PPTX":1,"PUB":1,"XLSX":1,"XLTX":1,"RAR":1,"7Z":1,"M4A2":1};sStr=sStr.toUpperCase();switch(sStr){case"MP4":case"M4P":sStr="MOV";break;case"RTF":case"RTX":sStr="DOC";break;case"LOG":sStr="TXT";break;break;case"POT":case"PPA":case"PPS":case"PPZ":case"PWZ":sStr="PPT";break;case"ARC":case"TAR":case"GZ":case"ARC":case"TAR":case"GZ":case"BZ":case"BZ2":case"IMG":case"MIM":case"TAX":case"TBZ":case"TBZ2":case"TZ":case"UU":case"UUE":case"XXE":case"Z":case"ZIPX":sStr="ZIP";break;case"7ZFM":case"7ZG":sStr="7Z";break;case"WMA":sStr="MP3";break;case"HTM":case"HTML":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFARI";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FIREFOX";break;case"URL":if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1)sStr="SAFURL";else if(navigator.userAgent.indexOf("Firefox")!=-1)sStr="FFURL";break;case"M4A":sStr="M4A2";break;}if(asExtensions[sStr]){return(sStr+"Ext");}else return("DefaultExt");}function GetDriveIcon(nType){var asDriveImages=["DRIVE_UNKNOWN","DRIVE_NO_ROOT_DIR","DRIVE_REMOVABLE","DRIVE_FIXED","DRIVE_REMOTE","DRIVE_CDROM","DRIVE_RAMDISK","DRIVE_REMOVABLE_OTHER"];nType=parseInt(nType);if((!isNaN(nType))&&(nType<asDriveImages.length))return(asDriveImages[nType]);else return("DRIVE_UNKNOWN");}function SWIDemoFrame(){setTimeout(function(){var DemoJSFile=document.createElement('script');DemoJSFile.setAttribute("type","text/javascript");DemoJSFile.setAttribute("src",g_sCommonPath+"DemoContain.js");if((typeof g_OnceUsageToken!='undefined')&&(g_OnceUsageToken!="")){DemoJSFile.setAttribute("nonce",g_OnceUsageToken);}document.getElementsByTagName("body")[0].appendChild(DemoJSFile);ifrm=document.createElement("IFRAME");ifrm.setAttribute("src",g_sCommonPath+"SWIDemo.htm");ifrm.setAttribute("frameBorder","0");ifrm.style.width="100%";ifrm.style.height="57px";ifrm.style.overflow="hidden";ifrm.style.position="absolute";ifrm.style.top="0";ifrm.style.left="0";ifrm.style.zIndex="0";ifrm.setAttribute("scrolling","no");DivBar=document.createElement("div");DivBar.setAttribute("id","demodiv");DivBar.style.width="100%";DivBar.style.height="55px";DivBar.style.overflow="hidden";DivBar.setAttribute("class","sw-mainnav-branding");if(g_bIsWebClient){document.getElementById("container").insertBefore(DivBar,document.getElementById("container").firstChild);document.getElementById("container").insertBefore(ifrm,document.getElementById("container").firstChild);}else{document.body.insertBefore(DivBar,document.body.firstChild);document.body.insertBefore(ifrm,document.body.firstChild);}if((document.getElementById("TopPntToolTipDialog")!=undefined)&&(!isNaN(parseInt(document.getElementById("TopPntToolTipDialog").style.top))))document.getElementById("TopPntToolTipDialog").style.top=(parseInt(document.getElementById("TopPntToolTipDialog").style.top)+parseInt(DivBar.style.height))+"px";},0);}function CleanPathByEscapeWithEncoding(sPath){sRawFilePath=encodeURIComponent(sPath);sRawFilePath=CleanPathByEscape(sRawFilePath);return(sRawFilePath);}function CleanPathByEscape(sPath){sRawFilePath=sPath;sRawFilePath=sRawFilePath.replace(new RegExp("[\(]","g"),"\\(");sRawFilePath=sRawFilePath.replace(new RegExp("[\)]","g"),"\\)");sRawFilePath=sRawFilePath.replace(new RegExp("'","g"),"\\'");return(sRawFilePath);}function ShowHideTrialNotification(bShow){var nDaysRemaining=g_nDaysRemaining;var bPassedTrial=(g_bLicenseIsTemp)?false:(g_bLicenseIsPastTrial);var sTrialColor="";var sExpireTxt=" <span id='TrialExpireDays'></span> "+g_sTrialExpiresDaysTxt+' '+g_sTrialExpiresInTxt+". "+g_sBuyNow;if(bShow){if(g_bIsModEvalExp){$("#ActivateTrial").show();}else{$("#ActivateTrial").hide();}$("#container").css("min-width","1250px");if(nDaysRemaining>=11&&!bPassedTrial){sTrialColor="blue";}else if(nDaysRemaining>5&&nDaysRemaining<=10&&!bPassedTrial){sTrialColor="yellow";}else if((nDaysRemaining<=5&&nDaysRemaining>=1)&&!bPassedTrial){sTrialColor="red";}else{sExpireTxt=g_sTrialExpiredTxt+" "+g_sBuyNow;sTrialColor="dark-red";}$("#TrialExpireTxt").html(sExpireTxt);if(sTrialColor!="dark-red")$("#TrialExpireDays").text(nDaysRemaining);$("#TrialExpire").addClass(sTrialColor);$("#TrialExpire").show();}else{$("#TrialExpire").hide();$("#container").css("min-width","650px");}}function ShowMaintenenceInfoBox(nDaysRemaining,nLicenseDays,ReggieDate){var sMaintExpireColor="";var UpgradeDate=new Date(ReggieDate.getTime()+(nLicenseDays*86400000));if(nDaysRemaining>7&&nDaysRemaining<=30){sMaintExpireColor="yellow";}else if(nDaysRemaining<=7){sMaintExpireColor="red";}else $("#MaintContain").removeClass("red").removeClass("yellow");$("#MaintDays").text(nDaysRemaining);$("#MaintDate").text($.datepicker.formatDate("M d, yy",UpgradeDate));$("#MaintContain").addClass(sMaintExpireColor);$("#MaintContain").show();}function IsValidEmailAddressString(sEmailAddress){var bIsValid=true;var sEmailFilter=eval("/^([A-Za-z0-9_\\s\\-\\.])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,63})$/");if(!sEmailFilter.test(sEmailAddress))bIsValid=false;return(bIsValid);}function RecordException(exception,bShowAlert){var txt="An exception has occurred.\n\n";txt+="Error description: "+exception.description+"\n\n";if(console.log)console.log(txt);if(bShowAlert!=undefined&&bShowAlert){txt+="Click OK to ignore this exception and continue.\n\n";alert(txt);}}function goBackWithRefresh(event){if(window.location.href.indexOf('/Mobile/')>-1){window.history.go(-1);return false;}window.location='/';return false;}function navigateToServerIdentityTab(){document.location.href="/Admin/Server.htm?Page=7";}function getTotpProvisioningValues(config){var currentVal;var defaultVal;var initialVal;if(+config.IsTOTPProvisioningDefault){currentVal="";}else{currentVal=config.TOTPProvisioning;}defaultVal=config.TOTPProvisioningDefault;initialVal=config.InitialTOTPProvisioning;return{currentVal:currentVal,defaultVal:defaultVal,initialVal:initialVal};}function getTotpCompanyNameValues(config){var currentVal;var defaultVal;var initialVal;if(config.TOTPCompanyName.length){currentVal=config.TOTPCompanyName;}else{currentVal=config.TOTPCompanyNameDefault;}defaultVal=config.TOTPCompanyNameDefault;initialVal=config.InitialTOTPCompanyName;return{currentVal:currentVal,defaultVal:defaultVal,initialVal:initialVal};}function initPasswordTypeToggler(inputBox,containerSelectorId){var passwordContainer=inputBox.element().querySelector("#"+containerSelectorId+"-box");var passwordHideIcon=document.createElement("span");passwordHideIcon.classList.add("pass-hide");passwordHideIcon.addEventListener("click",function(){togglePasswordType(inputBox)});passwordContainer.appendChild(passwordHideIcon);}function initNativePasswordTypeToggler(passwordContainer){var input=passwordContainer.querySelector("input[type=password]");var passwordHideIcon=document.createElement("span");passwordHideIcon.classList.add("pass-hide");passwordHideIcon.addEventListener("click",function(){toggleNativePasswordType(passwordContainer,input);});passwordContainer.appendChild(passwordHideIcon);}function togglePasswordType(input){var currentType=input.getContent("box/text").getAttribute("type");var newType=currentType;if(currentType==="text"){newType="password";}else{newType="text";}input.getContent("box/text").setAttribute("type",newType);input.element().querySelector(".pass-hide").classList.toggle("pass-hide--opened");setTimeout(function(){var textLength=input.getControlText().length;input.element().querySelector("input").setSelectionRange(textLength,textLength);});}function toggleNativePasswordType(passwordContainer,input){if(input.getAttribute("disabled")){return;}var currentType=input.getAttribute("type");var icon=passwordContainer.querySelector(".pass-hide");var newType=currentType;if(currentType==="text"){newType="password";}else{newType="text";}input.setAttribute("type",newType);icon.classList.toggle("pass-hide--opened");input.focus();}var bRightClickDisable=true;var BusyGif=new Image();BusyGif.src=g_sImagePath+"Busy.gif";var BusyGifs=new Image();BusyGifs.src=g_sImagePath+"BusyGrid.gif";var g_fnOnSelectStart=document.onselectstart;nBrowserVersion=parseInt(navigator.appVersion);sBrowserType=navigator.appName;document.write("<style type='text/css'>");document.write("BODY{margin: 25px}");document.write(".dividerline{padding:5px 2px 5px 2px;}");document.write("div.dividerline{padding:0px 0px 0px 0px;margin-left:4px;}");document.write("</style>");if(bRightClickDisable){if(document.attachEvent){this.attachEvent('onmousedown',OnRightClickIE4);}else{this.addEventListener('mousedown',OnRightClickNS4,false);}document.oncontextmenu=function(e){var EventType=(window.event)?event.srcElement:e.target;if(EventType.tagName.toLowerCase()!="textarea")return(false);};}function OnRightClickIE4(){if(event.button==2&&event.srcElement.tagName.toLowerCase()!="textarea"){return false;}}function OnRightClickNS4(e){if(document.layers||document.getElementById&&!document.all){if((e.which==2||e.which==3)&&e.target.tagName.toLowerCase()!="textarea"){return false;}}}AddOnloadEvent(EnableSelectionOnFormElements);var timeOn=null;var menuActive=0;var g_sActiveUniqueId="";var g_sMenuOver=String("menuOver();");var g_sMenuOut=String("menuOut(");var g_nActiveCrumbMenuId;var g_bBlockCrumb=false;var g_bIsFavDeleteHover=false;var g_bIsPageLoaded=false;var g_bContextActive=false;var g_bSubNavContainerLoaded=false;function menuOver(){clearTimeout(timeOn);menuActive=1;}function menuOut(nav){menuActive=0;timeOn=setTimeout("TimeOutMenus("+nav+")",400);}function TimeOutMenus(nav){if(nav==0)HideSubNavMenu();else{HideSubNavMenu();HideNavMenu();}}function raiseMenuEvent(e,bGridNoRows,Obj){if(bGridNoRows&&!g_bContextActive)Obj.raiseEvent("onRowContextMenu",e,this.$0);else if(!bGridNoRows){g_bContextActive=true;this.raiseEvent("onRowContextMenu",e,this.$0);}}function raiseMenuKeyPressEvent(e){
var EventKeyCode=(window.event)?event.keyCode:e.keyCode;var EventCharCode=(window.event)?event.charCode:e.charCode;var EventCtrlKey=(window.event)?event.ctrlKey:e.ctrlKey;var MenuKey=(window.event)?93:e.DOM_VK_CONTEXT_MENU;if((EventKeyCode==MenuKey))this.raiseEvent("onRowContextMenu",e,this.$0);else{var key=String.fromCharCode(EventKeyCode||EventCharCode);if(key.toUpperCase()=="A"&&EventCtrlKey&&this.getSelectionMode()=="multi-row"){this.setRowSelected(true);this.setRowState("selected");var i,rows=[],max=this.getRowCount();var bDoWebClientSelect=false;try{if(this==FilesList){bDoWebClientSelect=true;anRowIndex=FilesList.getRowIndices();max=anRowIndex.length;for(i=0;i<max;i++){if(FilesList.getCellValue(9,parseInt(anRowIndex[i]))!=1)rows.push(parseInt(anRowIndex[i]));}}}catch(e){bDoWebClientSelect=false;}if(!bDoWebClientSelect){for(i=0;i<max;i++){rows.push(i);}}this.setSelectedRows(rows);}}}function initMenu(sId){g_bIsPageLoaded=true;var sMenuStyleFix="";var sLangCookieChk=readCookie("SULang")+"";if(sLangCookieChk.indexOf("ru")!=-1||sLangCookieChk.indexOf("es")!=-1||sLangCookieChk.indexOf("fr")!=-1||sLangCookieChk.indexOf("jp")!=-1||sLangCookieChk.indexOf("se")!=-1)sMenuStyleFix="-wide";else if(sLangCookieChk.indexOf("it")!=-1)sMenuStyleFix="-it";var MenuElement=document.createElement("div");MenuElement.id=sId;MenuElement.className='contextmenu'+sMenuStyleFix;MenuElement.style.cursor="pointer";if(sId=="navSubMenu")MenuElement.style.zIndex="160001";document.getElementsByTagName("body")[0].appendChild(MenuElement);}function writeContextMenu(content,sId){var contextMenu=document.getElementById(sId);if(contextMenu)contextMenu.innerHTML='<table cellpadding="0" cellspacing="0" border="0" style="cursor:pointer;width:100%;">'+content+'</table>';}function showContextMenu(e,sId,objId,bNoGridContext,EventClientX,EventClientY){var contextMenu=document.getElementById(sId);var frameWidth,frameHeight,pageOffsetX,pageOffsetY,aTopLeft;if(navigator.userAgent.match("Linux"))g_sActiveUniqueId=sId;if(self.clientWidth){frameWidth=self.innerWidth;frameHeight=self.innerHeight;}else if(document.documentElement&&document.documentElement.clientWidth){frameWidth=document.documentElement.clientWidth;frameHeight=document.documentElement.clientHeight;}else if(document.body){frameWidth=document.body.clientWidth;frameHeight=document.body.clientHeight;}if(self.pageXOffset){pageOffsetX=self.pageXOffset;pageOffsetY=self.pageYOffset;}else if(document.documentElement&&document.documentElement.scrollLeft){pageOffsetX=document.documentElement.scrollLeft;pageOffsetY=document.documentElement.scrollTop;}else if(document.body){pageOffsetX=document.body.scrollLeft;pageOffsetY=document.body.scrollTop;}if(EventClientX==undefined){if(!bNoGridContext||bNoGridContext==undefined){var nFileListRowIndices=objId.getRowIndices();var SelectedRowsContext=objId.getSelectedRows().toString().split(",");aTopLeft=findPos(objId.getRowTemplate(SelectedRowsContext[SelectedRowsContext.length-1]).element());contextMenu.style.left=aTopLeft[0];}}else{if((frameWidth-EventClientX)<contextMenu.offsetWidth){contextMenu.style.left=((pageOffsetX+EventClientX-contextMenu.offsetWidth)+2)+"px";}else{contextMenu.style.left=EventClientX+"px";}}if(navigator.userAgent.match("Linux")){setTimeout(function(){if(document.attachEvent)document.attachEvent("onclick",hideContextMenu);else document.addEventListener("click",hideContextMenu,false);},0);}else{if(document.attachEvent)document.attachEvent("onclick",hideContextMenu);else document.addEventListener("click",hideContextMenu,false);}if(EventClientY==undefined){contextMenu.style.top=(aTopLeft[1]+21);}else{yClickMousePos=EventClientY;if((yClickMousePos+contextMenu.offsetHeight)>frameHeight)yClickMousePos=yClickMousePos-((yClickMousePos+contextMenu.offsetHeight)-frameHeight);if(pageOffsetY>0){contextMenu.style.top=((pageOffsetY+yClickMousePos)-2)+"px";}else{contextMenu.style.top=(yClickMousePos-2)+"px";}}HideApplet();contextMenu.style.visibility="visible";if(navigator.userAgent.match("Linux"))contextMenu.style.display="block";g_bContextMenuActive=true;}function showMenu(e,sId,sPositionImg,bCrumb,bHistory){var Menu=document.getElementById(sId);var aTopLeft,nPosImgWidth;aTopLeft=findPos(document.getElementById(sPositionImg));nPosImgWidth=document.getElementById(sPositionImg).offsetWidth;nPosImgHeight=document.getElementById(sPositionImg).offsetHeight;if(Menu){if(sId=="navSubMenu"){Menu.style.left=(aTopLeft[0]+nPosImgWidth+5)+"px";Menu.style.top=((aTopLeft[1]+(nPosImgHeight))-(Menu.offsetHeight/2))+"px";}else if(bCrumb!=undefined&&bCrumb==true){Menu.style.left=(aTopLeft[0]+5)+"px";Menu.style.top=((aTopLeft[1])+10)+"px";}else if(bHistory!=undefined&&bHistory==true){Menu.style.left=(aTopLeft[0]+5)+"px";Menu.style.top=((aTopLeft[1])+15)+"px";}else{Menu.style.left=(aTopLeft[0]+nPosImgWidth)+"px";Menu.style.top=((aTopLeft[1])-(Menu.offsetHeight))+"px";}HideApplet();Menu.style.visibility="visible";}}function hideContextMenu(){if(document.getElementById(g_sActiveUniqueId)){document.getElementById(g_sActiveUniqueId).style.visibility="hidden";ShowApplet();if(document.detachEvent){document.detachEvent("onclick",hideContextMenu);}else{document.removeEventListener("click",hideContextMenu,false);}}g_bContextActive=false;g_bContextMenuActive=false;}function hideCrumbMenu(nId){if(document.getElementById("crumb-container"+nId)&&document.getElementById("crumb-container"+nId).style.visibility!="hidden"){document.getElementById("crumb-container"+nId).style.visibility="hidden";g_nActiveCrumbMenuId=undefined;ShowApplet();if(document.detachEvent){document.detachEvent("onclick",function(){hideCrumbMenu(nId);});}else{document.removeEventListener("click",function(){hideCrumbMenu(nId);},false);}var el=document;if(el.detachEvent){el.detachEvent("onkeydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}});}else if(el.removeEventListener){el.removeEventListener("keydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}},true);}else{el["onkeydown"]=null;}}}function hideCrumbMenuSetUp(nId){if(document.getElementById("crumb-container"+nId)){if(document.detachEvent){document.attachEvent("onclick",function(){hideCrumbMenu(nId);});}else{document.addEventListener("click",function(){hideCrumbMenu(nId);},false);}}}function hideHistoryMenu(){if(document.getElementById("crumb-containerHistory-Menu").style.visibility=="visible"){document.getElementById("crumb-containerHistory-Menu").style.visibility="hidden";g_nActiveCrumbMenuId=undefined;ShowApplet();if(document.detachEvent){document.detachEvent("onclick",hideHistoryMenu);}else{document.removeEventListener("click",hideHistoryMenu,false);}}}function hideHistoryMenuFav(){if(document.getElementById("crumb-containerHistory-Menu").style.visibility=="visible"&&!g_bIsFavDeleteHover){document.getElementById("crumb-containerHistory-Menu").style.visibility="hidden";g_nActiveCrumbMenuId=undefined;ShowApplet();if(document.detachEvent){document.detachEvent("onclick",hideHistoryMenuFav);}else{document.removeEventListener("click",hideHistoryMenuFav,false);}}}function hideHistoryMenuSetUp(){if(document.getElementById("crumb-containerHistory-Menu")){if(document.attachEvent){document.attachEvent("onclick",hideHistoryMenu);}else{document.addEventListener("click",hideHistoryMenu,false);}}}function hideHistoryMenuSetUpFavs(){if(document.getElementById("crumb-containerHistory-Menu")){if(document.attachEvent){document.attachEvent("onclick",hideHistoryMenuFav);}else{document.addEventListener("click",hideHistoryMenuFav,false);}}}function HideNavMenu(){if(document.getElementById("navMenu")){if(document.getElementById("navMenu").style.visibility=="visible"){document.getElementById("navMenu").style.visibility="hidden";if(document.detachEvent){document.detachEvent("onclick",HideNavMenu);}else{document.removeEventListener("click",HideNavMenu,false);}}}}function HideSubNavMenu(){if(document.getElementById("navSubMenu")){if(document.getElementById("navSubMenu").style.visibility=="visible"){document.getElementById("navSubMenu").style.visibility="hidden";if(document.detachEvent){document.detachEvent("onclick",HideSubNavMenu);}else{document.removeEventListener("click",HideSubNavMenu,false);}}}}function HideMenu(){if(document.attachEvent){document.attachEvent("onclick",HideNavMenu);}else{document.addEventListener("click",HideNavMenu,false);}}function CreateContextMenu(asFunctions,asNames,asImages,obj,sUniqueId,bCoverGridMenu){if(sUniqueId==null||sUniqueId==""||sUniqueId==undefined)sUniqueId="ContextMenu";if(bCoverGridMenu){obj.setEvent("oncontextmenu",function(e){raiseMenuEvent(e,true,this);});}else obj.setEvent("oncontextmenu","return false");obj.getRowTemplate().setEvent("oncontextmenu",function(e){raiseMenuEvent.call(this,e);});obj.setController("copypaste",{});if(!g_bFireFox3Browser)obj.setEvent("onkeydown",raiseMenuKeyPressEvent);obj.onRowContextMenu=function(e,row){var EventClientX=e.clientX;var EventClientY=e.clientY;var nRow=row;var nDelay=100;setTimeout(function(){obj.setSelectedRows(obj.getSelectedRows());var contextMenuContent='';var sMenuItemName;for(nIndex=0;(nIndex<asFunctions.length);nIndex++){if(typeof asNames[nIndex]=="function")sMenuItemName=asNames[nIndex]();else sMenuItemName=asNames[nIndex];if((asNames[nIndex]==g_sMenuDividers)||(sMenuItemName==g_sMenuDividers)){contextMenuContent+='<tr><td class="iconcolumn"><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td><td class="menuItemSep"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td></tr>';}else{if(asImages[nIndex]!=""){sImage='<img src="'+g_sImagePath+'spacer.gif" width="1" height="1">';if(typeof asImages[nIndex]=="function")sImageClass="-"+asImages[nIndex]();else sImageClass="-"+asImages[nIndex];}else{sImage='&nbsp;';sImageClass="";}if(sMenuItemName!="")contextMenuContent+='<tr id="contextrow'+sUniqueId+nIndex+'" onclick="javascript:'+asFunctions[nIndex]+row+');"  onmouseover="javascript:document.getElementById(\'contextitem'+sUniqueId+nIndex+'\').className=\'onnavlinkrow\'" onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\'contextitem'+sUniqueId+nIndex+'\').className=\'offnavlinkrow\'"><td class="iconcolumn"><div class="iconcell'+sImageClass+'">'+sImage+'</div></td><td class="offnavlinkrow" style="" id="contextitem'+sUniqueId+nIndex+'">'+sMenuItemName+'</td></tr>';}}writeContextMenu(contextMenuContent,sUniqueId);showContextMenu(e,sUniqueId,obj,undefined,EventClientX,EventClientY);g_sActiveUniqueId=sUniqueId;},nDelay);};if(g_bIsPageLoaded)initMenu(sUniqueId);else{AddOnloadEvent(function(){initMenu(sUniqueId);});}}function CreateCrumbMenu(aCrumb,sElement,nContainerSize,sSearchText,bHistory,nFavLength){var Navigation=document.getElementById("crumb"+sElement);var sImageClass="";var UserAgent=navigator.userAgent||"";var bFavShorcut=false;var nFavStart=-1;var sFavCell="";if(nFavLength>0)nFavStart=(aCrumb.length-nFavLength);if(nFavStart!=-1)sFavCell="<td style='width:15px;'>&nbsp;</td>";if(nContainerSize==0)nContainerSize=1;var navMenuContent='';if(document.detachEvent){document.detachEvent("onclick",HideNavMenu);}else{document.removeEventListener("click",HideNavMenu,false);}if(aCrumb.length>0){for(nIndex=0;(nIndex<aCrumb.length);nIndex++){var sOnGoToPath;if(nIndex>=nFavStart&&nFavStart!=-1)bFavShorcut=true;if(bHistory)sOnGoToPath=String('OnOpenCrumb(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\','+nIndex+',true);');else sOnGoToPath=String('OnOpenCrumb(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\','+nIndex+',false);');sOnGoToFavPath=String('OnOpenCrumb(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\','+nIndex+',true);');sOnDeleteFavCookie=String('OnDeleteFavCookie(\''+CleanPathByEscape(aCrumb[nIndex][0])+'\',\''+sElement+nIndex+'FavRow\');');sMenuFileMove=String('OnCrumbDropFile(\''+CleanPathByEscape(aCrumb[nIndex][1])+'\');');sOnFavDeleteHover=String('OnIsFavDeleteHover();');sOnFavDeleteBlur=String('OnIsFavDeleteBlur();');if(aCrumb[nIndex][0]==g_sMenuDividers){if(aCrumb[nIndex][1]=="*favs_list*"){navMenuContent+='<tr onmouseover="javascript:'+g_sMenuOver+'" onmouseout="javascript:'+g_sMenuOut+');">';navMenuContent+='<td class="iconcolumn"><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td>';navMenuContent+='<td class="menuItemSep" colspan="2"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td></tr>';}else{navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'" onmouseover="javascript:'+g_sMenuOver+'" onmouseout="javascript:'+g_sMenuOut+');">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td>';navMenuContent+='<td class="menuItemSep" style=""><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td>'+sFavCell+'</tr>';}}else{sMouseOverFunction="";sAltName="";sImage='<img src="'+g_sImagePath+'spacer.gif" width="1" height="1">';if(aCrumb[nIndex][3]==1&&bHistory)sImageClass="-pointer-arrow";else sImageClass="-"+aCrumb[nIndex][2];if(sSearchText==aCrumb[nIndex][0]){if(bFavShorcut){navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"  id="'+sElement+nIndex+'FavRow"';navMenuContent+=' onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'fav-onnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'fav-offnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div  class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td  class="fav-offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>';navMenuContent+='<td class="delete-offnavlinkrow" onclick="javascript:'+sOnDeleteFavCookie+'" style="width:15px;" id="delete-'+sElement+nIndex+'">';navMenuContent+='<img onmouseover="javascript:this.src=\''+g_sImagePath+'DeleteFav-On.png\'"';navMenuContent+=' onmouseout="javascript:this.src=\''+g_sImagePath+'DeleteFav-Off.png\';'+sOnFavDeleteBlur+'" src="'+g_sImagePath+'DeleteFav-Off.png" width="16" height="16"></td></tr>';}else{navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"';navMenuContent+=' onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td class="offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>'+sFavCell+'</tr>';}}else{if(bFavShorcut){navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"  id="'+sElement+nIndex+'FavRow"';navMenuContent+=' onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'fav-onnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'fav-offnavlinkrow\';document.getElementById(\'delete-'+sElement+nIndex+'\').className=\'delete-offnavlinkrow\'">';navMenuContent+='<td onclick="javascript:'+sOnGoToFavPath+'" class="iconcolumn" style=""><div class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td onclick="javascript:'+sOnGoToFavPath+'" class="fav-offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>';navMenuContent+='<td onclick="javascript:'+sOnDeleteFavCookie+'" class="delete-offnavlinkrow" style="width:15px;" id="delete-'+sElement+nIndex+'"><img onmouseover="javascript:this.src=\''+g_sImagePath+'DeleteFav-On.png\';'+sOnFavDeleteHover+'"';navMenuContent+=' onmouseout="javascript:this.src=\''+g_sImagePath+'DeleteFav-Off.png\';'+sOnFavDeleteBlur+'" src="'+g_sImagePath+'DeleteFav-Off.png" width="16" height="16"></td></tr>';}else{navMenuContent+='<tr onmouseup="javascript:'+sMenuFileMove+'"';navMenuContent+=' onclick="javascript:'+sOnGoToPath+'"  onmouseover="javascript:'+sMouseOverFunction+g_sMenuOver+'document.getElementById(\''+sElement+nIndex+'\').className=\'onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+nIndex+'\').className=\'offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell'+sImageClass+'">'+sImage+'</div></td>';navMenuContent+='<td class="offnavlinkrow" style="padding-right:5px;" id="'+sElement+nIndex+'">'+aCrumb[nIndex][0]+'</td>'+sFavCell+'</tr>';}}}}}else{navMenuContent+='<tr onmouseover="javascript:'+g_sMenuOver+'document.getElementById(\''+sElement+'0\').className=\'onnavlinkrow\'"';navMenuContent+=' onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\''+sElement+'0\').className=\'offnavlinkrow\'">';navMenuContent+='<td class="iconcolumn" style=""><div class="iconcell">&nbsp;</div></td><td class="offnavlinkrow" style="padding-right:5px;" id="'+sElement+'0">'+g_sNoSubDirs+'</td></tr>';}writeContextMenu(navMenuContent,"crumb-container"+sElement);var nHeightVal=22;var nAdjustHeightVal=0;if((UserAgent.match("Windows NT 6")||UserAgent.match("Windows NT 6.1"))&&!g_bSafariBrowser){if(!g_bFireFox3Browser&&!(navigator.userAgent.indexOf("Opera")>=0))nAdjustHeightVal=2;if(AW.opera)nHeightVal=22;else nHeightVal=23;}else if(AW.ie)nAdjustHeightVal=4;else if(g_bFireFox3Browser){if(nContainerSize<=5)nAdjustHeightVal=1;else if(nContainerSize<=10)nAdjustHeightVal=4;else if(nContainerSize<15)nAdjustHeightVal=6;}else if(AW.safari){nAdjustHeightVal=2;nHeightVal=23;}else if(AW.chrome){nHeightVal=23;nAdjustHeightVal=2;}else nAdjustHeightVal=6;if(nContainerSize<15){document.getElementById("crumb-container"+sElement).style.height=((nHeightVal*nContainerSize)+nAdjustHeightVal)+"px";document.getElementById("crumb-container"+sElement).style.overflowY="hidden";document.getElementById("crumb-container"+sElement).style.overflowX="hidden";}else{document.getElementById("crumb-container"+sElement).style.height="300px";document.getElementById("crumb-container"+sElement).style.overflowY="auto";document.getElementById("crumb-container"+sElement).style.overflowX="hidden";}sInnerImage='&nbsp;';var el=document;if(el.addEventListener){el.addEventListener("keydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}},true);}else if(el.attachEvent){el.attachEvent("onkeydown",function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}});}else{el["onkeydown"]=function(e){var IEKeyCode=(window.event)?event.keyCode:e.keyCode;var FFEsc=(window.event)?27:e.DOM_VK_ESCAPE;if((IEKeyCode==FFEsc)){hideCrumbMenu(sElement);}};}}function CreateRightClickMenu(asFunctions,asNames,asImages,asElement,sCookie,fLabelFunction,sUniqueID){var sImageClass="";ShowTextLabelOptions=function(e){var bRightClick;var ActionEvent=(window.event)?event:e;if(ActionEvent.which)bRightClick=(ActionEvent.which==3);else if(ActionEvent.button)bRightClick=(ActionEvent.button==2);if(bRightClick){var righClickMenuContent='';for(nIndex=0;(nIndex<asFunctions.length);nIndex++){if(asNames[nIndex]==g_sMenuDividers){righClickMenuContent+='<tr><td class="iconcolumn"><div class="iconcell-divider"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></div></td><td class="menuItemSep"><img src="'+g_sImagePath+'spacer.gif" width="1" height="1"></td></tr>';}else{if(asImages[nIndex]!=""){sImage='<img src="'+g_sImagePath+'spacer.gif" width="1" height="1">';if(typeof asImages[nIndex]=="function")sImageClass="-"+asImages[nIndex]();else sImageClass="-"+asImages[nIndex];}else{sImage='&nbsp;';sImageClass="";}if(typeof asNames[nIndex]=="function")sMenuItemName=asNames[nIndex]();else sMenuItemName=asNames[nIndex];if(sMenuItemName!="")righClickMenuContent+='<tr onclick="javascript:'+asFunctions[nIndex]+',\''+sCookie+'\','+fLabelFunction+');"  onmouseover="javascript:document.getElementById(\'contextitem'+asElement[0]+nIndex+'\').className=\'onnavlinkrow\'" onmouseout="javascript:'+g_sMenuOut+');document.getElementById(\'contextitem'+asElement[0]+nIndex+'\').className=\'offnavlinkrow\'"><td class="iconcolumn"><div class="iconcell'+sImageClass+'">'+sImage+'</div></td><td class="offnavlinkrow" style="" id="contextitem'+asElement[0]+nIndex+'">'+sMenuItemName+'</td></tr>';}}writeContextMenu(righClickMenuContent,"RightClickMenu-"+sUniqueID);showContextMenu(ActionEvent,"RightClickMenu-"+sUniqueID,document.getElementById(asElement[0]),true,ActionEvent.clientX,ActionEvent.clientY);g_sActiveUniqueId="RightClickMenu-"+sUniqueID;}};for(nIndex=0;(nIndex<asElement.length);nIndex++){if(document.attachEvent){document.getElementById(asElement[nIndex]).attachEvent("onmousedown",ShowTextLabelOptions);}else{document.getElementById(asElement[nIndex]).addEventListener("mousedown",ShowTextLabelOptions,false);}}if(g_bIsPageLoaded)initMenu("RightClickMenu-"+sUniqueID);else{AddOnloadEvent(function(){initMenu("RightClickMenu-"+sUniqueID);});}}AW.Formats.XMLString=AW.System.Format.subclass();AW.Formats.XMLString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){return(FormatClientString(data));};obj.dataToValue=function(data){return(this.dataToText(data).toLowerCase());};obj.comparator=DefaultCompareDir;};function CreateBasicGrid(sHtmlId,asHeaders,anColWidths,sXMLFile,sXMLRoot,fnOnDoubleClick,bDynamicLoad){var Grid=new AW.UI.SUBasicGrid(sHtmlId,asHeaders,anColWidths);if(Grid!=undefined){if(bDynamicLoad!=true){Grid.m_XMLTable=new AW.XML.GridTable(sXMLRoot);if((typeof g_sEncXsrfToken!=='undefined')&&(g_sEncXsrfToken!==null)&&(g_sEncXsrfToken!==""))Grid.m_XMLTable.setRequestHeader("X-Csrf-Token",g_sEncXsrfToken);Grid.setCellModel(Grid.m_XMLTable);}Grid.onRowDoubleClicked=fnOnDoubleClick;Grid.refresh();if((typeof(sXMLFile)!="undefined")&&(sXMLFile!="")){Grid.setTimeout(function(){this.Update(sXMLFile,true);},0);}}return(Grid);}function SetGridLoading(Grid){var element=document.getElementById(Grid.getId());element.style.backgroundPosition="50%";element.style.backgroundRepeat="no-repeat";element.style.backgroundImage="url("+g_sImagePath+"BusyGrid.gif)";}AW.XML.GridTable=AW.XML.Table.subclass();AW.XML.GridTable.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(sXMLRoot){_super.init.call(this);if((typeof(sXMLRoot)!="undefined")&&(sXMLRoot!=""))this.setTable("//"+sXMLRoot);};obj.responseDef=obj.response;obj.response=function(response,bSaveRowSelections){var bProcessUpdate=true;if((this.$owner)&&(typeof(this.$owner.PreUpdate)!="undefined"))bProcessUpdate=this.$owner.PreUpdate(bSaveRowSelections);if(bProcessUpdate){this.responseDef(response);if(this.$owner.m_bFilterMode)this.$owner.FilterGrid(this.$owner.m_sSearchVal,this.$owner.m_nColPos,true,this.$owner.m_bAllowEmpty);if((this.$owner)&&(typeof(this.$owner.PostUpdate)!="undefined"))this.$owner.PostUpdate(bSaveRowSelections);}};obj.requestDef=obj.request;obj.request=function(bShowLoad){if((this.$owner)&&(bShowLoad))SetGridLoading(this.$owner);this.requestDef();};obj.setData=function(Value,nColumn,nRow){var Node=this.getNode(nColumn,nRow);Value=EncodeCharForXML(encodeURIComponent(Value));if(typeof(Node.textContent)!='undefined')Node.textContent=Value;else Node.text=Value;};obj.setURLDef=obj.setURL;obj.setURL=function(sURL){var theDate=new Date();this.setURLDef(g_sAdminXMLPath+sURL+"&sync="+theDate.getTime());};obj.selectNodes=function(sXPath,RootNode){var Nodes=new Array();if(RootNode==undefined)RootNode=this.getXML();if(typeof(document.createNSResolver)=='undefined'){var TempNodes=RootNode.selectNodes(sXPath);for(var nIndex=0;nIndex<TempNodes.length;nIndex++)Nodes[nIndex]=TempNodes[nIndex];}else{var nIndex=0;var TempNodes=this.getXML().evaluate(sXPath,RootNode,null,XPathResult.ANY_TYPE,null);var CurrentNode=TempNodes.iterateNext();while(CurrentNode){Nodes[nIndex++]=CurrentNode;CurrentNode=TempNodes.iterateNext();}}return(Nodes);};};AW.UI.SUBasicGrid=AW.UI.Grid.subclass();AW.UI.SUBasicGrid.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(sHtmlId,asHeaders,anColWidths){_super.init.call(this);this.setId(sHtmlId);this.setHeaderText(asHeaders);this.setColumnCount(asHeaders.length);this.setSelectionMode("multi-row");this.setSelectionMultiple(true);this.setStyle("width","100%");this.setStyle("height","297px");this.setCellTemplate(new AW.Templates.ImageText,0);this.setStyle("position","static");var aFormats=new Array();for(var nIndex=0;nIndex<anColWidths.length;nIndex++){aFormats[nIndex]=new AW.Formats.XMLString;this.setColumnWidth(parseInt(anColWidths[nIndex]),nIndex);}this.setCellFormat(aFormats);this.m_dateLastSearch=0;this.m_sSearchStr="";this.m_fnOnViewClicked=null;};obj.UpdateText=function(sText,nColumn,nRow){this.m_XMLTable.setData(sText,nColumn,nRow);this.setCellText(undefined,nColumn,nRow);};obj.Update=function(sURL,bShowLoad,bKeepState){this.ShowHideLoadingFilesMessage(true);g_bSearchView=false;this.setCellModel(this.m_XMLTable);this.m_bKeepState=(bKeepState)?true:false;this.m_XMLTable.setURL(sURL);this.m_XMLTable.request(bShowLoad);};obj.ShowHideLoadingFilesMessage=function(bShow){if(typeof jQuery!="undefined"){if($('#'+this.getId()+'Container').data("load")==true){if(bShow){$("#"+this.getId()+"-view-box-middle").css("visibility","hidden");$("#"+this.getId()).css("background-image","url("+g_sCommonPath+"Images/BusyGrid.gif)");$("#"+this.getId()).css("background-position","50% center");$("#"+this.getId()).css("background-repeat","no-repeat");}else{$("#"+this.getId()).css("background-image","none");$("#"+this.getId()+"-view-box-middle").css("visibility","visible");}}}};obj.PreUpdate=function(bSaveRowSelections){this.m_nSortCol=this.getSortColumn();this.m_sSortDir=this.getSortDirection(this.m_nSortCol);if(bSaveRowSelections)this.PreserveBasicRowState();if(typeof(this.m_fnPreUpdate)!="undefined")this.m_fnPreUpdate.call(this);this.ShowHideLoadingFilesMessage(false);return(true);};obj.PostUpdate=function(bSaveRowSelections){if(this.m_bNoVirtualMode==undefined||!this.m_bNoVirtualMode)this.setVirtualMode(this.getRowCount()>=500);if(this.m_nSortCol>=0)this.sort(this.m_nSortCol,this.m_sSortDir);if(bSaveRowSelections)this.RestoreBasicRowState();else this.ResetCurrentRow();if(typeof(this.m_fnPostUpdate)!="undefined"){this.m_fnPostUpdate.call(this);}};obj.PreserveBasicRowState=function(){var aSelectedRows=new Array();var rows=new Array();var anRowIndex=this.getRowIndices();if(this.getSelectedRows().toString()!=""&&this.getSelectedRows().toString()!="-1"){aSelectedRows=this.getSelectedRows().toString().split(",");for(i=0;i<aSelectedRows.length;i++){if(this.getCellValue(9,parseInt(aSelectedRows[i]))!=1){rows.push(this.getCellValue(0,parseInt(aSelectedRows[i])));}}}this.m_SelectedFileVals=rows;};obj.RestoreBasicRowState=function(){if(this.m_SelectedFileVals.length>0){var rows=[];anRowIndex=this.getRowIndices();nTotalSelectedFiles=this.m_SelectedFileVals.length;for(i=0;i<anRowIndex.length;i++){if(this.getCellValue(9,parseInt(anRowIndex[i]))!=1){for(x=0;x<nTotalSelectedFiles;x++){if(this.getCellValue(0,parseInt(anRowIndex[i]))==this.m_SelectedFileVals[x]){this.setRowState("selected",parseInt(anRowIndex[i]));rows.push(parseInt(anRowIndex[i]));break;}}if(rows.length==nTotalSelectedFiles)break;}}this.setSelectedRows(rows);}};obj.ResetCurrentRow=function(){this.getRowIndices()?this.setCurrentRow(this.getRowIndices()[0]):this.setCurrentRow(0);this.setScrollTop(0);};obj.setCellModelDef=obj.setCellModel;obj.setCellModel=function(model){this.setCellModelDef.call(this,model);function dataToText(i,j){var data=this.getCellData(i,j);var format=this.getCellFormat(i,j);return format?format.dataToText(data,this,i,j):data;};function dataToValue(i,j){var data=this.getCellData(i,j);var format=this.getCellFormat(i,j);return format?format.dataToValue(data,this,i,j):data;};this.setCellText(dataToText);this.setCellValue(dataToValue);};obj.onHeaderClicked=function(Event,nIndex){var anRowIndices;if((nIndex==this.getSortColumn())&&((anRowIndices=this.getRowIndices())!="")){this.setSortDirection((this.getSortDirection(nIndex)=="ascending")?"descending":"ascending",nIndex);anRowIndices.reverse();this.setRowIndices(anRowIndices);return(true);}else return(false);};obj.setEvent("onkeydown",function(event){var key=String.fromCharCode(event.keyCode||event.charCode);if(key.toUpperCase()=="A"&&event.ctrlKey&&this.getSelectionMode()=="multi-row"){this.setRowSelected(true);this.setRowState("selected");var i,rows=[],max=this.getRowCount();var bDoWebClientSelect=false;try{if(this==FilesList){bDoWebClientSelect=true;anRowIndex=FilesList.getRowIndices();max=anRowIndex.length;for(i=0;i<max;i++){if(FilesList.getCellValue(9,parseInt(anRowIndex[i]))!=1)rows.push(parseInt(anRowIndex[i]));}}}catch(e){bDoWebClientSelect=false;}if(!bDoWebClientSelect){for(i=0;i<max;i++){rows.push(i);}}this.setSelectedRows(rows);}});obj.onKeyPress=function(event){var sKey=String.fromCharCode(event.keyCode||event.charCode).toLocaleLowerCase();var dateNow=new Date().getTime();var nSortColumn=this.getSortColumn();var fmtSortCol=this.getCellFormat(nSortColumn);if((sKey!="")&&(nSortColumn>=0)&&((!fmtSortCol)||(fmtSortCol.dataToValue("&",this,nSortColumn,0)!="0"))){var anIndices=this.getRowIndices();var nStartSearch=0,nCurrentRow=this.getCurrentRow();var bFound=false;var sTemp="";if(nCurrentRow>=0){for(var nIndex in anIndices){if(anIndices[nIndex]==nCurrentRow){nStartSearch=parseInt(nIndex);break;}}}if((dateNow-this.m_dateLastSearch)>750){this.m_sSearchStr=sKey;if(nStartSearch)nStartSearch++;}else this.m_sSearchStr+=sKey;this.m_dateLastSearch=dateNow;if((!this.ItemSearch(this.m_sSearchStr,nSortColumn,anIndices,nStartSearch,this.getRowCount()))&&(nStartSearch>0))this.ItemSearch(this.m_sSearchStr,nSortColumn,anIndices,0,nStartSearch);}else{this.m_sSearchStr="";this.m_dateLastSearch=0;}};
obj.ItemSearch=function(sSearchStr,nSortColumn,anIndices,nStart,nStop){var bFound=false;for(var nIndex=nStart;nIndex<nStop;nIndex++){var sTemp=this.getCellText(nSortColumn,anIndices[nIndex]).substring(0,sSearchStr.length).toLocaleLowerCase();if(sTemp==sSearchStr){this.setSelectedRows([anIndices[nIndex]]);this.setCurrentRow(anIndices[nIndex]);bFound=true;break;}}return(bFound);};obj.getPageUpRow=function(){var nScrollingHeight=parseInt(parseInt(document.getElementById(this.getId()).offsetHeight)/parseInt(this.getRowHeight())-1);var i=this.getCurrentRow();var p=Math.max(this.getRowPosition(i)-nScrollingHeight,this.getRowOffset());var a=this.getRowIndices();return a?a[p]:p;};obj.getPageDownRow=function(){var nScrollingHeight=parseInt(parseInt(document.getElementById(this.getId()).offsetHeight)/parseInt(this.getRowHeight())-1);var i=this.getCurrentRow();var p=Math.min(this.getRowPosition(i)+nScrollingHeight,this.getRowOffset()+this.getRowCount()-1);var a=this.getRowIndices();return a?a[p]:p;};obj.FilterGrid=function(sSearchVal,nColPos,bFilterMode,bAllowEmpty){var i,rows=[];this.m_bFilterMode=bFilterMode;this.m_OriginalRowCount=this.m_XMLTable.getCount();this.m_sSearchVal=sSearchVal;this.m_nColPos=nColPos;this.m_bAllowEmpty=(bAllowEmpty==undefined)?false:bAllowEmpty;var sSearchWord="";var bWildCard=false;var nFileNameLength;var nSearchWordLength;var nWildCardPos,nDisAllowWildCardPos;var bDualWildCard=false;sSearchWord=sSearchVal.toLowerCase();nSearchWordLength=sSearchWord.length;nWildCardPos=sSearchWord.indexOf("*");nDisAllowWildCardPos=sSearchWord.indexOf("^");if(nWildCardPos!=-1||nDisAllowWildCardPos!=-1){bWildCard=true;}var nBracketedWord=sSearchWord.match(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"));var nBracketedLength=-1;if(nBracketedWord){nBracketedLength=sSearchWord.replace(eval("/\\[\\b[a-zA-Z0-9_]+\\b\]/g"),"1").length;}if(nBracketedLength>-1){nSearchWordLength=nBracketedLength;}sSearchWord=sSearchWord.replace(eval("/\\./g"),"\\.");sSearchWord=sSearchWord.replace(eval("/\\*/g"),"(.*)");sSearchWord=sSearchWord.replace(eval("/\\_/g"),"\\_");sSearchWord=sSearchWord.replace(eval("/\\?/g"),".");for(i=0;i<this.m_OriginalRowCount;i++){sTargetColValue=HTMLDecode(this.getCellValue(nColPos,i));b_WildCard=false;var bSearchMatch=false;if(sTargetColValue.toLowerCase().search(eval("/"+sSearchWord+"/"))==0){if(bWildCard)bSearchMatch=true;else if(sTargetColValue.length==nSearchWordLength)bSearchMatch=true;}if(bAllowEmpty&&(sTargetColValue==""||sTargetColValue==undefined))bSearchMatch=true;if(bSearchMatch||sSearchWord=="")rows.push(i);}this.setRowCount(rows.length);this.setRowIndices(rows);};obj.GetHitTestOnView=function(bIsVerticalTest,nMouseLocX,nMouseLocY,sVisibleScrollbar){var bRet=false;var sID=this.getId();var rParent=document.getElementById(sID).parentNode;if(rParent!=undefined&&rParent!=null){var rectContainer=rParent.getBoundingClientRect();var nHeaderCount=this.getHeaderCount();var nOverallHeaderHeight=0;for(nIdx=0;nIdx<nHeaderCount;nIdx++)nOverallHeaderHeight+=this.getHeaderHeight(nIdx);var nBottomSideOfLastHeader=(rectContainer.top+nOverallHeaderHeight);if(nMouseLocY>nBottomSideOfLastHeader){if(bIsVerticalTest){var nHorzScrollbarHeight=0;if(sVisibleScrollbar=="horizontal")nHorzScrollbarHeight=18;var nNumOfRows=this.getRowCount(0);var nRowHeight=this.getRowHeight(0);var nOverallRowHeight=(nNumOfRows*nRowHeight);var nBottomSideOfLastRow=(rectContainer.top+(nOverallHeaderHeight+nOverallRowHeight));var nBottomSideOfContainer=(rectContainer.bottom-nHorzScrollbarHeight);if(nMouseLocY>nBottomSideOfLastRow&&nMouseLocY<nBottomSideOfContainer){if(this.m_fnOnViewClicked!=undefined&&this.m_fnOnViewClicked!=null)this.m_fnOnViewClicked(nMouseLocX,nMouseLocY);bRet=true;}}else{var nVertScrollbarWidth=0;if(sVisibleScrollbar=="vertical")nVertScrollbarWidth=18;var nNumOfCols=this.getColumnCount();var nOverallColWidth=0;for(nIdx=0;nIdx<nNumOfCols;nIdx++)nOverallColWidth+=this.getColumnWidth(nIdx);var nRightSideOfLastRow=(rectContainer.left+nOverallColWidth);var nRightSideOfContainer=(rectContainer.right-nVertScrollbarWidth);if(nMouseLocX>nRightSideOfLastRow&&nMouseLocX<nRightSideOfContainer){if(this.m_fnOnViewClicked!=undefined&&this.m_fnOnViewClicked!=null)this.m_fnOnViewClicked(nMouseLocX,nMouseLocY);bRet=true;}}}}return(bRet);};obj.setEvent("onmousedown",function(event){var sScrollBars=this.getScrollBars();if(sScrollBars!=undefined&&sScrollBars!=null){sScrollBars=sScrollBars.toLowerCase();if(sScrollBars=="vertical")this.GetHitTestOnView(false,event.clientX,event.clientY,sScrollBars);else if(sScrollBars=="horizontal")this.GetHitTestOnView(true,event.clientX,event.clientY,sScrollBars);else if(sScrollBars=="none"){if(!this.GetHitTestOnView(true,event.clientX,event.clientY,sScrollBars))this.GetHitTestOnView(false,event.clientX,event.clientY,sScrollBars);}}});};function DefaultCompareDir(values,greater,less,equal,error){return(function(i,j){try{var a=values[i];var b=values[j];var bIsNum=false;var nCompareResult;if(isNaN(a)&&isNaN(b)){a=a.toLocaleLowerCase();b=b.toLocaleLowerCase();nCompareResult=a.localeCompare(b);}else bIsNum=true;if(!bIsNum){if(nCompareResult>0){return greater}if(nCompareResult<0){return less}return equal(i,j);}else{if(a>b){return greater}if(a<b){return less}return equal(i,j);}}catch(e){return error(i,j,e);}});}var Dialogs=new Array();var nTopDialog=-1;var nTopBubbleDialog=0;var bIsIE=(document.all!=undefined);var bIsOpera=(navigator.userAgent.indexOf("Opera")>=0);var bDraggingAndDropping=false;var g_sToolTipDialog="";var g_MouseDownGesture;var g_bMultiTransferLoaded;var g_bWebClientProActive=false;var g_bMultiTransferHidden=false;var g_PageUnloading=false;var g_bContextKeepAppletHidden=false;function SUDialog(Dialog,sName,nWidth,nHeight,sOpaqueLayer,fnOnHide){this.m_Dialog=Dialog;this.m_sName=sName;this.m_nWidth=nWidth;this.m_nHeight=nHeight;this.m_sOpaqueLayer=sOpaqueLayer;this.m_fnOnHide=fnOnHide;}function OnDialogMouseMove(e){if(bDraggingAndDropping){var Event=((bIsIE)?event:e);var SUDialog=Dialogs[nTopDialog];var Dialog=SUDialog.m_Dialog;var nLeft=(parseInt(Event.clientX)+nOffSetX);var nTop=(parseInt(Event.clientY)+nOffSetY);var nClientRight=(document.documentElement.clientWidth-1);var nClientBottom=(document.documentElement.clientHeight-1);if((nLeft+SUDialog.m_nWidth)>=nClientRight)nLeft=(nClientRight-(SUDialog.m_nWidth+1));if((nTop+SUDialog.m_nHeight)>=nClientBottom)nTop=(nClientBottom-(SUDialog.m_nHeight+1));if(nLeft<0)nLeft=0;if(nTop<0)nTop=0;Dialog.style.left=parseInt(nLeft)+"px";Dialog.style.top=parseInt(nTop)+"px";}return(!bDraggingAndDropping);}function OnDialogMouseDown(e){if(nTopDialog>=0){var TopDialog=Dialogs[nTopDialog].m_Dialog;var TitleBar=document.getElementById(TopDialog.id+"TitleBar");if(TitleBar!=undefined){var Event=((bIsIE)?event:e);if(document.getElementById(TopDialog.id+"TitleBar")){var nDialogX1=parseInt(TopDialog.style.left);var nDialogY1=parseInt(TopDialog.style.top);nOffSetX=(nDialogX1-Event.clientX);nOffSetY=(nDialogY1-Event.clientY);nScrollOffsetY=(document.all)?document.body.scrollTop:window.pageYOffset;if((nOffSetX<=0)&&(Event.clientX<=(nDialogX1+Dialogs[nTopDialog].m_nWidth))&&((nOffSetY-nScrollOffsetY)<=0)&&((Event.clientY+nScrollOffsetY)<=(nDialogY1+TitleBar.offsetHeight))){bDraggingAndDropping=true;document.onmousemove=OnDialogMouseMove;}}}}document.onmousedown=function(){return(g_MouseDownGesture);};return(!bDraggingAndDropping);}function OnDialogMouseUp(e){var bAllow=true;if(bDraggingAndDropping){bDraggingAndDropping=false;bAllow=false;}if(nTopDialog>=0){var TopDialog=document.getElementById(Dialogs[nTopDialog].m_sName+"TitleBar");if(TopDialog){TopDialog.onmousemove=function(){document.onmousedown=OnDialogMouseDown;};}}return(!bDraggingAndDropping);}function DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer,fnOnHide,objToolTip,bTopPointer,xOffset,yOffset,xPointOffSet,yPointOffSet){var nDialogTopPosition;var ToolTipPlaceHolder=document.getElementById(objToolTip);var nScrollTop=document.body.scrollTop;if(nScrollTop==0){if(window.pageYOffset)nScrollTop=window.pageYOffset;else nScrollTop=(document.body.parentElement)?document.body.parentElement.scrollTop:0;}if(ToolTipPlaceHolder!=undefined){aToolTipPos=findPos(ToolTipPlaceHolder);nToolTipLeft=aToolTipPos[0];nToolTipTop=aToolTipPos[1];if(xPointOffSet!=undefined){nToolTipLeft=(nToolTipLeft+xPointOffSet);}if(yPointOffSet!=undefined){nToolTipTop=(nToolTipTop+yPointOffSet);}if(bTopPointer){nDialogTopPosition=((nToolTipTop)+(yOffset));nToolTipLeft=((nToolTipLeft)+(xOffset));}else{nDialogTopPosition=((nToolTipTop)-(nHeight));if(bIsOpera)nDialogTopPosition=nDialogTopPosition-30;}if(nDialogTopPosition<0)nDialogTopPosition=0;Dialog.style.top=parseInt(nDialogTopPosition)+"px";Dialog.style.left=parseInt(nToolTipLeft)+"px";nTopDialogValue=--nTopBubbleDialog;}else{if(document.getElementById('container')){var nContainerHeight=parseInt(document.getElementById('container').offsetHeight);if(parseInt(document.documentElement.clientHeight)<nContainerHeight||(nContainerHeight<400))nDialogTopPosition=((document.documentElement.clientHeight/2)-(nHeight/2));else{nDialogTopPosition=((nContainerHeight/2)-(nHeight/2));if(nDialogTopPosition<0)nDialogTopPosition=((document.documentElement.clientHeight/2)-(nHeight/2));}}else nDialogTopPosition=((document.documentElement.clientHeight/2)-(nHeight/2));if(nDialogTopPosition<0)nDialogTopPosition=0;if(nScrollTop>0)nDialogTopPosition+=nScrollTop;Dialog.style.top=parseInt(nDialogTopPosition)+"px";Dialog.style.left=parseInt((document.documentElement.clientWidth/2)-(nWidth/2))+"px";nTopDialogValue=++nTopDialog;}Dialogs[nTopDialogValue]=new SUDialog(Dialog,Dialog.id,nWidth,nHeight,sOpaqueLayer,fnOnHide);}function HideDialog(sDialog,bBubbleTip,bFromApplet){var nSaveTopDialog=nTopDialog;if(bBubbleTip){nTopDialog=nTopBubbleDialog;nTopDialog=nTopBubbleDialog;}if((nTopDialog>=0)&&(Dialogs[nTopDialog]!=undefined)&&(Dialogs[nTopDialog].m_Dialog.id==sDialog)||(bBubbleTip&&nTopDialog<0)){if(Dialogs[nTopDialog].m_fnOnHide!=undefined)Dialogs[nTopDialog].m_fnOnHide(Dialogs[nTopDialog].m_sName);Dialogs[nTopDialog].m_Dialog.style.left="-5000px";Dialogs[nTopDialog].m_Dialog.style.top="-5000px";HideOpaqueLayer(Dialogs[nTopDialog].m_sOpaqueLayer,bFromApplet);if(bBubbleTip){Dialogs[nTopDialog]=undefined;nTopBubbleDialog++;nTopDialog=nSaveTopDialog;}else Dialogs[nTopDialog--]=undefined;setTimeout(function(){try{if(g_nShowList!=0&&g_nShowList!=undefined){FilesList.element().focus();}}catch(e){}},500);}}function HideOpaqueLayer(sOpaqueLayer,bFromApplet){if(sOpaqueLayer!=undefined){var OpaqueLayer=document.getElementById(sOpaqueLayer);if(OpaqueLayer!=undefined)OpaqueLayer.style.display="none";ShowApplet(bFromApplet);}}function FindUniqueOpaqueLayer(Dialog,sOpaqueLayer){var nDialog=nTopDialog;var OpaqueLayer=document.getElementById(sOpaqueLayer);while(nDialog>0){--nDialog;if(Dialogs[nDialog].m_sOpaqueLayer==sOpaqueLayer){sOpaqueLayer=(Dialogs[nDialog].m_Dialog.id+"OpaqueLayer");Dialog.m_sOpaqueLayer=sOpaqueLayer;break;}}return(sOpaqueLayer);}function ShowDialog(sDialog,bHideBackground,fnOnHide,bFromApplet){HideDialog(g_sToolTipDialog);var Dialog=document.getElementById(sDialog);var DialogBody=document.getElementById(sDialog+"Body");var nWidth=parseInt(Dialog.style.width);var nHeight=parseInt(Dialog.style.height);if(DialogBody!=undefined){DialogBody.style.width=parseInt(nWidth)+"px";}if(Dialog!=undefined){var nOpaqueZIndex=(8000+(nTopDialog*2));var sOpaqueLayer=(sDialog+"OpaqueLayer");nHeight=(Dialog.style.pixelHeight)?Dialog.style.pixelHeight:Dialog.offsetHeight;DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer,fnOnHide);Dialog.style.zIndex=(nOpaqueZIndex+1);if((bHideBackground==undefined)||(bHideBackground)){sOpaqueLayer=FindUniqueOpaqueLayer(Dialogs[nTopDialog],sOpaqueLayer);ShowOpaqueLayer(sOpaqueLayer,nOpaqueZIndex,bFromApplet);}var TitleBar=document.getElementById(sDialog+"TitleBar");if(TitleBar!=undefined)TitleBar.style.cursor="move";g_MouseDownGesture=document.onmousedown;document.onmousedown=OnDialogMouseDown;if(document.addEventListener){document.addEventListener("mouseup",OnDialogMouseUp,true);}else if(document.attachEvent){document.attachEvent("onmouseup",OnDialogMouseUp);}if(TitleBar!=undefined){TitleBar.onmouseover=function(){document.onmousedown=OnDialogMouseDown;};}}}function ShowOpaqueLayer(sOpaqueLayerID,nOpaqueZIndex,bFromApplet,bBubbleTip){var OpaqueLayer;if(document.getElementById(sOpaqueLayerID)==undefined){CreateOpaqueLayerDiv(sOpaqueLayerID,bBubbleTip);}OpaqueLayer=document.getElementById(sOpaqueLayerID);if(OpaqueLayer!=undefined){OpaqueLayer.style.zIndex=nOpaqueZIndex;HideApplet(bFromApplet);OpaqueLayer.style.display="block";}}function ShowToolTipDialog(sDialog,bHideBackground,fnOnHide,objToolTip,nBubbleWidth,nBubbleHeight,bTopPointer,xOffset,yOffset,sAltDialog,xPointOffSet,yPointOffSet){var Dialog;if(sAltDialog!=undefined){g_sToolTipDialog=sAltDialog;Dialog=document.getElementById(sAltDialog);}else{g_sToolTipDialog=sDialog;Dialog=document.getElementById(sDialog);}var DialogBody=document.getElementById(sDialog+"Body");var nWidth,nHeight=0;if(Dialog!=undefined){if(nBubbleWidth==undefined)nWidth=parseInt(Dialog.style.width);else nWidth=parseInt(nBubbleWidth);if(nBubbleHeight==undefined)nHeight=parseInt(Dialog.style.height);else nHeight=parseInt(nBubbleHeight);if(DialogBody!=undefined){DialogBody.style.width=parseInt(nWidth-2)+"px";DialogBody.style.height=parseInt((nHeight-102)-2)+"px";}var nOpaqueZIndex=(7000+(nTopBubbleDialog*-2));var sOpaqueLayer=(sDialog+"OpaqueLayer");DialogInit(Dialog,nWidth,nHeight,sOpaqueLayer,fnOnHide,objToolTip,bTopPointer,xOffset,yOffset,xPointOffSet,yPointOffSet);ShowOpaqueLayer(sOpaqueLayer,nOpaqueZIndex,undefined,true);Dialog.style.zIndex=((7000+(nTopBubbleDialog*-2))-1);var objSaveMouseDown=document.onmousedown;Dialog.onmouseover=function(){document.onmousedown=function(){return(objSaveMouseDown);};};Dialog.onmouseout=function(){document.getElementById(sDialog+"OpaqueLayer").onmousedown=function(){HideDialog(sDialog,true);return(objSaveMouseDown);};};Dialog.onmousedown=function(){return(false);};document.getElementById(sDialog+"OpaqueLayer").onmousedown=function(){HideDialog(sDialog,true);return(objSaveMouseDown);};}}function ReplaceDialog(sOldDialog,sNewDialog,fnOnHide){var sOpaqueLayer="",sNewOpaqueLayer="";var OldOpaqueLayer,NewOpaqueLayer,bHideBackground;if((nTopDialog>=0)&&(Dialogs[nTopDialog].m_Dialog.id==sOldDialog)){if(Dialogs[nTopDialog].m_fnOnHide!=undefined)Dialogs[nTopDialog].m_fnOnHide(sOldDialog);Dialogs[nTopDialog].m_Dialog.style.left="-5000px";Dialogs[nTopDialog].m_Dialog.style.top="-5000px";sOpaqueLayer=Dialogs[nTopDialog].m_sOpaqueLayer;Dialogs[nTopDialog--]=undefined;}if(sOpaqueLayer!=""){bHideBackground=false;OldOpaqueLayer=document.getElementById(sOpaqueLayer);}ShowDialog(sNewDialog,bHideBackground,fnOnHide);NewOpaqueLayer=document.getElementById(sNewOpaqueLayer=FindUniqueOpaqueLayer(Dialogs[nTopDialog],sNewDialog+"OpaqueLayer"));if((OldOpaqueLayer!=undefined)&&(NewOpaqueLayer!=undefined)){OldOpaqueLayer.style.display="none";NewOpaqueLayer.style.zIndex=OldOpaqueLayer.style.zIndex;NewOpaqueLayer.style.display="block";Dialogs[nTopDialog].m_sOpaqueLayer=sNewOpaqueLayer;}}if(g_bIsDemo)AddOnloadEvent(SWIDemoFrame);var m_aTable=[["\u00AA","A"],["\u00B2","2"],["\u00B3","3"],["\u00B9","1"],["\u00BA","O"],["\u00C0","A"],["\u00C1","A"],["\u00C2","A"],["\u00C3","A"],["\u00C4","A"],["\u00C5","A"],["\u00C6","AE"],["\u00C7","C"],["\u00C8","E"],["\u00C9","E"],["\u00CA","E"],["\u00CB","E"],["\u00CC","I"],["\u00CD","I"],["\u00CE","I"],["\u00CF","I"],["\u00D0","D"],["\u00D1","N"],["\u00D2","O"],["\u00D3","O"],["\u00D4","O"],["\u00D5","O"],["\u00D6","O"],["\u00D8","O"],["\u00D9","U"],["\u00DA","U"],["\u00DB","U"],["\u00DC","U"],["\u00DD","Y"],["\u00DF","ss"],["\u00E0","A"],["\u00E1","a"],["\u00E2","a"],["\u00E3","a"],["\u00E4","a"],["\u00E5","a"],["\u00E6","ae"],["\u00E7","c"],["\u00E8","e"],["\u00E9","e"],["\u00EA","e"],["\u00EB","e"],["\u00EC","i"],["\u00ED","i"],["\u00EE","i"],["\u00EF","i"],["\u00F0","d"],["\u00F1","n"],["\u00F2","o"],["\u00F3","o"],["\u00F4","o"],["\u00F5","o"],["\u00F6","o"],["\u00F8","o"],["\u00F9","u"],["\u00FA","u"],["\u00FB","u"],["\u00FC","u"],["\u00FD","y"],["\u00FF","y"],["\u0100","A"],["\u0101","a"],["\u0102","A"],["\u0103","a"],["\u0104","A"],["\u0105","a"],["\u0106","C"],["\u0107","c"],["\u0108","C"],["\u0109","c"],["\u010A","C"],["\u010B","c"],["\u010C","C"],["\u010D","c"],["\u010E","D"],["\u010F","d"],["\u0110","D"],["\u0111","d"],["\u0112","E"],["\u0113","e"],["\u0114","E"],["\u0115","e"],["\u0116","E"],["\u0117","e"],["\u0118","E"],["\u0119","e"],["\u011A","E"],["\u011B","e"],["\u011C","G"],["\u011D","g"],["\u011E","G"],["\u011F","g"],["\u0120","G"],["\u0121","g"],["\u0122","G"],["\u0123","g"],["\u0124","H"],["\u0125","h"],["\u0126","H"],["\u0127","h"],["\u0128","I"],["\u0129","i"],["\u012A","I"],["\u012B","i"],["\u012C","I"],["\u012D","i"],["\u012E","I"],["\u012F","i"],["\u0130","I"],["\u0131","i"],["\u0132","IJ"],["\u0133","ij"],["\u0134","j"],["\u0135","j"],["\u0136","K"],["\u0137","k"],["\u0138","K"],["\u0139","L"],["\u013A","l"],["\u013B","L"],["\u013C","l"],["\u013D","L"],["\u013E","L"],["\u013F","L"],["\u0140","l"],["\u0141","L"],["\u0142","l"],["\u0143","N"],["\u0144","n"],["\u0145","N"],["\u0146","n"],["\u0147","N"],["\u0148","n"],["\u0149","n"],["\u014A","N"],["\u014B","n"],["\u014C","O"],["\u014D","o"],["\u014E","O"],["\u014F","o"],["\u0150","O"],["\u0151","o"],["\u0152","OE"],["\u0153","oe"],["\u0154","R"],["\u0155","r"],["\u0156","R"],["\u0157","r"],["\u0158","R"],["\u0159","r"],["\u015A","S"],["\u015B","s"],["\u015C","S"],["\u015D","s"],["\u015E","S"],["\u015F","s"],["\u0160","S"],["\u0161","s"],["\u0162","T"],["\u0163","t"],["\u0164","T"],["\u0165","t"],["\u0166","T"],["\u0167","t"],["\u0168","T"],["\u0169","U"],["\u016A","u"],["\u016B","U"],["\u016C","u"],["\u016D","U"],["\u016E","u"],["\u016F","U"],["\u0170","u"],["\u0171","U"],["\u0172","u"],["\u0173","U"],["\u0174","W"],["\u0175","w"],["\u0176","Y"],["\u0177","y"],["\u0178","Y"],["\u0179","Z"],["\u017A","z"],["\u017B","Z"],["\u017C","z"],["\u017D","Z"],["\u017E","z"],["\u017F","T"],["\u0180","b"],["\u0181","B"],["\u0182","b"],["\u0183","B"],["\u0184","b"],["\u0185","B"],["\u0186","C"],["\u0187","C"],["\u0188","C"],["\u0189","D"],["\u018A","D"],["\u018B","a"],["\u018C","D"],["\u018D","D"],["\u018E","E"],["\u018F","E"],["\u0190","E"],["\u0191","F"],["\u0192","F"],["\u0193","G"],["\u0194","H"],["\u0195","HZ"],["\u0196","I"],["\u0197","I"],["\u0198","K"],["\u0199","K"],["\u019A","L"],["\u019B","L"],["\u019C","M"],["\u019D","N"],["\u019E","n"],["\u019F","O"],["\u01A0","O"],["\u01A1","O"],["\u01A2","P"],["\u01A3","p"],["\u01A4","P"],["\u01A5","Q"],["\u01A6","R"],["\u01A7","S"],["\u01A8","s"],["\u01A9","S"],["\u01AA","S"],["\u01AB","T"],["\u01AC","T"],["\u01AD","T"],["\u01AE","T"],["\u01AF","U"],["\u01B0","u"],["\u01B1","U"],["\u01B2","V"],["\u01B3","Y"],["\u01B4","y"],["\u01B5","Z"],["\u01B6","z"],["\u01B7","Z"],["\u01B8","Z"],["\u01B9","z"],["\u01BA","Z"],["\u01BB","2"],["\u01BC","5"],["\u01BD","5"],["\u01BF","W"],["\u01C3","!"],["\u01C4","DZ"],["\u01C5","Dz"],["\u01C6","dz"],["\u01C7","LJ"],["\u01C8","Lj"],["\u01C9","lj"],["\u01CA","NJ"],["\u01CB","Nj"],["\u01CC","nj"],["\u01CD","A"],["\u01CE","a"],["\u01CF","I"],["\u01D0","i"],["\u01D1","O"],["\u01D2","o"],["\u01D3","U"],["\u01D4","u"],["\u01D5","U"],["\u01D6","u"],["\u01D7","U"],["\u01D8","u"],["\u01D9","U"],["\u01DA","u"],["\u01DB","U"],["\u01DC","u"],["\u01DD","E"],["\u01DE","A"],["\u01DF","a"],["\u01E0","A"],["\u01E1","a"],["\u01E2","AE"],["\u01E3","ae"],["\u01E4","G"],["\u01E5","g"],["\u01E6","G"],["\u01E7","g"],["\u01E8","K"],["\u01E9","k"],["\u01EA","O"],["\u01EB","o"],["\u01EC","O"],["\u01ED","z"],["\u01EE","Z"],["\u01EF","z"],["\u01F0","J"],["\u01F1","DZ"],["\u01F2","Dz"],["\u01F3","dz"],["\u01F4","G"],["\u01F5","g"],["\u01F6","I"],["\u01F7","V"],["\u01F8","N"],["\u01F9","n"],["\u01FA","A"],["\u01FB","a"],["\u01FC","AE"],["\u01FD","ae"],["\u01FE","O"],["\u01FF","o"],["\u0200","A"],["\u0201","a"],["\u0202","A"],["\u0203","a"],["\u0204","E"],["\u0205","e"],["\u0206","E"],["\u0207","e"],["\u0208","I"],["\u0209","i"],["\u020A","I"],["\u020B","i"],["\u020C","O"],["\u020D","o"],["\u020E","O"],["\u020F","o"],["\u0210","R"],["\u0211","r"],["\u0212","R"],["\u0213","r"],["\u0214","U"],["\u0215","u"],["\u0216","U"],["\u0217","u"],["\u0218","S"],["\u0219","s"],["\u021A","T"],["\u021B","t"],["\u021C","E"],["\u021D","e"],["\u021E","H"],["\u021F","h"],["\u0220","N"],["\u0221","D"],["\u0222","O"],["\u0223","o"],["\u0224","Z"],["\u0225","z"],["\u0226","A"],["\u0227","a"],["\u0228","E"],["\u0229","e"],["\u022A","O"],["\u022B","o"],["\u022C","O"],["\u022D","o"],["\u022E","O"],["\u022F","o"],["\u0230","O"],["\u0231","o"],["\u0232","Y"],["\u0233","y"],["\u0234","L"],["\u0235","n"],["\u0236","t"],["\u0237","J"],["\u0238","db"],["\u0239","qp"],["\u023A","A"],["\u023B","C"],["\u023C","c"],["\u023D","L"],["\u023E","T"],["\u023F","s"],["\u0240","z"],["\u0241","Z"],["\u0242","z"],["\u0243","B"],["\u0244","U"],["\u0245","V"],["\u0246","E"],["\u0247","e"],["\u0248","J"],["\u0249","j"],["\u024A","Q"],["\u024B","q"],["\u024C","R"],["\u024D","r"],["\u024E","Y"],["\u024F","y"],["\u0250","a"],["\u0251","a"],["\u0252","a"],["\u0253","b"],["\u0254","c"],["\u0255","c"],["\u0256","d"],["\u0257","d"],["\u0258","e"],["\u0259","e"],["\u025A","e"],["\u025B","e"],["\u025C","e"],["\u025D","e"],["\u025E","e"],["\u025F","f"],["\u0260","G"],["\u0261","g"],["\u0262","g"],["\u0263","G"],["\u0264","g"],["\u0265","h"],["\u0266","H"],["\u0267","h"],["\u0268","i"],["\u0269","i"],["\u026A","i"],["\u026B","i"],["\u026C","l"],["\u026D","L"],["\u026E","L"],["\u026F","M"],["\u0270","M"],["\u0271","M"],["\u0272","N"],["\u0273","N"],["\u0274","N"],["\u0275","O"],["\u0276","OE"],["\u0277","oe"],["\u0278","P"],["\u0279","r"],["\u027A","R"],["\u027B","r"],["\u027C","R"],["\u027D","R"],["\u027E","R"],["\u027F","R"],["\u0280","R"],["\u0281","R"],["\u0282","S"],["\u0283","S"],["\u0284","S"],["\u0285","S"],["\u0286","S"],["\u0287","S"],["\u0288","T"],["\u0289","U"],["\u028A","U"],["\u028B","V"],["\u028C","v"],["\u028D","w"],["\u028E","y"],["\u028F","z"],["\u0290","Z"],["\u0291","Z"],["\u0292","Z"],["\u0293","Z"],["\u0294","Z"],["\u0295","Z"],["\u0296","Z"],["\u0297","C"],["\u029A","E"],["\u029B","G"],["\u029C","H"],["\u029D","J"],["\u029E","K"],["\u029F","L"],["\u02A0","Q"],["\u02A3","DZ"],["\u02A4","Dz"],["\u02A5","dz"],["\u02A6","TS"],["\u02A7","Ts"],["\u02A8","ts"],["\u02A9","FN"],["\u02AA","ls"],["\u02AB","lz"],["\u02AE","H"],["\u02AF","h"],["\u02B0","H"],["\u02B1","h"],["\u02B2","j"],["\u02B3","r"],["\u02B4","r"],["\u02B5","r"],["\u02B6","r"],["\u02B7","w"],["\u02B8","y"],["\u02E0","g"],["\u02E1","l"],["\u02E2","s"],["\u02E3","x"],["\u1D00","A"],["\u1D01","AE"],["\u1D02","ae"],["\u1D03","B"],["\u1D04","C"],["\u1D05","D"],["\u1D06","d"],["\u1D07","E"],["\u1D08","e"],["\u1D09","K"],["\u1D0A","J"],["\u1D0B","K"],["\u1D0C","L"],["\u1D0D","M"],["\u1D0E","N"],["\u1D0F","O"],["\u1D10","C"],["\u1D11","O"],["\u1D12","C"],["\u1D13","O"],["\u1D14","OE"],["\u1D15","O"],["\u1D16","O"],["\u1D17","O"],["\u1D18","P"],["\u1D19","R"],["\u1D1A","R"],["\u1D1B","T"],["\u1D1C","U"],["\u1D1D","N"],["\u1D1E","N"],["\u1D1F","M"],["\u1D20","V"],["\u1D21","W"],["\u1D22","Z"],["\u1D23","Z"],["\u1D24","Z"],["\u1D25","A"],["\u1D2C","A"],["\u1D2D","AE"],["\u1D2E","B"],["\u1D2F","b"],["\u1D30","D"],["\u1D31","E"],["\u1D32","E"],["\u1D33","G"],["\u1D34","H"],["\u1D35","I"],["\u1D36","J"],["\u1D37","K"],["\u1D38","L"],["\u1D39","M"],["\u1D3A","N"],["\u1D3B","N"],["\u1D3C","O"],["\u1D3D","O"],["\u1D3E","P"],["\u1D3F","R"],["\u1D40","T"],["\u1D41","U"],["\u1D42","W"],["\u1D43","a"],["\u1D44","a"],["\u1D45","a"],["\u1D46","ae"],["\u1D47","b"],["\u1D48","d"],["\u1D49","e"],["\u1D4A","e"],["\u1D4B","e"],["\u1D4C","e"],["\u1D4D","g"],["\u1D4E","i"],["\u1D4F","k"],["\u1D50","M"],["\u1D51","N"],["\u1D52","O"],["\u1D53","C"],["\u1D54","O"],["\u1D55","O"],["\u1D56","P"],["\u1D57","T"],["\u1D58","U"],["\u1D59","N"],["\u1D5A","M"],["\u1D5B","V"],["\u1D5C","A"],["\u1D5D","S"],["\u1D5E","Y"],["\u1D5F","R"],["\u1D62","I"],["\u1D63","R"],["\u1D64","U"],["\u1D65","V"],["\u1D66","S"],["\u1D67","Y"],["\u1D6B","UE"],["\u1D6C","B"],["\u1D6D","D"],["\u1D6E","F"],["\u1D6F","M"],["\u1D70","N"],["\u1D71","P"],["\u1D72","R"],["\u1D73","r"],["\u1D74","S"],["\u1D75","T"],["\u1D76","Z"],["\u1D79","G"],["\u1D7A","th"],["\u1D7B","I"],["\u1D7C","I"],["\u1D7D","p"],["\u1D7E","u"],["\u1D7F","u"],["\u1E00","A"],["\u1E01","a"],["\u1E02","B"],["\u1E03","b"],["\u1E04","B"],["\u1E05","b"],["\u1E06","B"],["\u1E07","b"],["\u1E08","C"],["\u1E09","c"],["\u1E0A","D"],["\u1E0B","d"],["\u1E0C","D"],["\u1E0D","d"],["\u1E0E","D"],["\u1E0F","d"],["\u1E10","D"],["\u1E11","d"],["\u1E12","D"],["\u1E13","d"],["\u1E14","E"],["\u1E15","e"],["\u1E16","E"],["\u1E17","e"],["\u1E18","E"],["\u1E19","e"],["\u1E1A","E"],["\u1E1B","e"],["\u1E1C","E"],["\u1E1D","e"],["\u1E1E","F"],["\u1E1F","f"],["\u1E20","G"],["\u1E21","g"],["\u1E22","H"],["\u1E23","h"],["\u1E24","H"],["\u1E25","h"],["\u1E26","H"],["\u1E27","h"],["\u1E28","H"],["\u1E29","h"],["\u1E2A","H"],["\u1E2B","h"],["\u1E2C","I"],["\u1E2D","i"],["\u1E2E","I"],["\u1E2F","i"],["\u1E30","K"],["\u1E31","k"],["\u1E32","K"],["\u1E33","k"],["\u1E34","K"],["\u1E35","k"],["\u1E36","L"],["\u1E37","l"],["\u1E38","L"],["\u1E39","l"],["\u1E3A","L"],["\u1E3B","l"],["\u1E3C","L"],["\u1E3D","l"],["\u1E3E","M"],["\u1E3F","m"],["\u1E40","M"],["\u1E41","m"],["\u1E42","M"],["\u1E43","m"],["\u1E44","N"],["\u1E45","n"],["\u1E46","N"],["\u1E47","n"],["\u1E48","N"],["\u1E49","n"],["\u1E4A","N"],["\u1E4B","n"],["\u1E4C","O"],["\u1E4D","o"],["\u1E4E","O"],["\u1E4F","o"],["\u1E50","O"],["\u1E51","o"],["\u1E52","O"],["\u1E53","o"],["\u1E54","P"],["\u1E55","p"],["\u1E56","P"],["\u1E57","p"],["\u1E58","R"],["\u1E59","r"],["\u1E5A","R"],["\u1E5B","r"],["\u1E5C","R"],["\u1E5D","r"],["\u1E5E","R"],["\u1E5F","r"],["\u1E60","S"],["\u1E61","s"],["\u1E62","S"],["\u1E63","s"],["\u1E64","S"],["\u1E65","s"],["\u1E66","S"],["\u1E67","s"],["\u1E68","S"],["\u1E69","s"],["\u1E6A","T"],["\u1E6B","t"],["\u1E6C","T"],["\u1E6D","t"],["\u1E6E","T"],["\u1E6F","t"],["\u1E70","T"],["\u1E71","t"],["\u1E72","U"],["\u1E73","u"],["\u1E74","U"],["\u1E75","u"],["\u1E76","U"],["\u1E77","u"],["\u1E78","U"],["\u1E79","u"],["\u1E7A","U"],["\u1E7B","u"],["\u1E7C","V"],["\u1E7D","v"],["\u1E7E","V"],["\u1E7F","v"],["\u1E80","W"],["\u1E81","w"],["\u1E82","W"],["\u1E83","w"],["\u1E84","W"],["\u1E85","w"],["\u1E86","W"],["\u1E87","w"],["\u1E88","W"],["\u1E89","w"],["\u1E8A","X"],["\u1E8B","x"],["\u1E8C","X"],["\u1E8D","x"],["\u1E8E","Y"],["\u1E8F","y"],["\u1E90","Z"],["\u1E91","z"],["\u1E92","Z"],["\u1E93","z"],["\u1E94","Z"],["\u1E95","z"],["\u1E96","h"],["\u1E97","t"],["\u1E98","w"],["\u1E99","y"],["\u1E9A","a"],["\u1E9B","s"],["\u1E9E","s"],["\u1E9F","d"],["\u1EA0","A"],["\u1EA1","a"],["\u1EA2","A"],["\u1EA3","a"],["\u1EA4","A"],["\u1EA5","a"],["\u1EA6","A"],["\u1EA7","a"],["\u1EA8","A"],["\u1EA9","a"],["\u1EAA","A"],["\u1EAB","a"],["\u1EAC","A"],["\u1EAD","a"],["\u1EAE","A"],["\u1EAF","a"],["\u1EB0","A"],["\u1EB1","a"],["\u1EB2","A"],["\u1EB3","a"],["\u1EB4","A"],["\u1EB5","a"],["\u1EB6","A"],["\u1EB7","a"],["\u1EB8","E"],["\u1EB9","e"],["\u1EBA","E"],["\u1EBB","e"],["\u1EBC","E"],["\u1EBD","e"],["\u1EBE","E"],["\u1EBF","e"],["\u1EC0","E"],["\u1EC1","e"],["\u1EC2","E"],["\u1EC3","e"],["\u1EC4","E"],["\u1EC5","e"],["\u1EC6","E"],["\u1EC7","e"],["\u1EC8","I"],["\u1EC9","i"],["\u1ECA","I"],["\u1ECB","i"],["\u1ECC","O"],["\u1ECD","o"],["\u1ECE","O"],["\u1ECF","o"],["\u1ED0","O"],["\u1ED1","o"],["\u1ED2","O"],["\u1ED3","o"],["\u1ED4","O"],["\u1ED5","o"],["\u1ED6","O"],["\u1ED7","o"],["\u1ED8","O"],["\u1ED9","o"],["\u1EDA","O"],["\u1EDB","o"],["\u1EDC","O"],["\u1EDD","o"],["\u1EDE","O"],["\u1EDF","o"],["\u1EE0","O"],["\u1EE1","o"],["\u1EE2","O"],["\u1EE3","o"],["\u1EE4","U"],["\u1EE5","u"],["\u1EE6","U"],["\u1EE7","u"],["\u1EE8","U"],["\u1EE9","u"],["\u1EEA","U"],["\u1EEB","u"],["\u1EEC","U"],["\u1EED","u"],["\u1EEE","U"],["\u1EEF","u"],["\u1EF0","U"],["\u1EF1","u"],["\u1EF2","Y"],["\u1EF3","y"],["\u1EF4","Y"],["\u1EF5","y"],["\u1EF6","Y"],["\u1EF7","y"],["\u1EF8","Y"],["\u1EF9","y"],["\u2031","0"],["\u203C","!!"],["\u203D","!?"],["\u2047","??"],["\u2048","?!"],["\u2049","!?"],["\u2070","0"],["\u2074","4"],["\u2075","5"],["\u2076","6"],["\u2077","7"],["\u2078","8"],["\u2079","9"],["\u2080","0"],["\u2081","1"],["\u2082","2"],["\u2083","3"],["\u2084","4"],["\u2085","5"],["\u2086","6"],["\u2087","7"],["\u2088","8"],["\u2089","9"],["\u2090","a"],["\u2091","e"],["\u2092","o"],["\u2093","x"],["\u2094","e"],["\u215F","1"],["\u2460","1"],["\u2461","2"],["\u2462","3"],["\u2463","4"],["\u2464","5"],["\u2465","6"],["\u2466","7"],["\u2467","8"],["\u2468","9"],["\u2469","10"],["\u246A","11"],["\u246B","12"],["\u246C","13"],["\u246D","14"],["\u246E","15"],["\u246F","16"],["\u2470","17"],["\u2471","18"],["\u2472","19"],["\u2473","20"],["\u2474","1"],["\u2475","2"],["\u2476","3"],["\u2477","4"],["\u2478","5"],["\u2479","6"],["\u247A","7"],["\u247B","8"],["\u247C","9"],["\u247D","10"],["\u247E","11"],["\u247F","12"],["\u2480","13"],["\u2481","14"],["\u2482","15"],["\u2483","16"],["\u2484","17"],["\u2485","18"],["\u2486","19"],["\u2487","20"],["\u2488","1."],["\u2489","2."],["\u248A","3."],["\u248B","4."],["\u248C","5."],["\u248D","6."],["\u248E","7."],["\u248F","8."],["\u2490","9."],["\u2491","10."],["\u2492","11."],["\u2493","12."],["\u2494","13."],["\u2495","14."],["\u2496","15."],["\u2497","16."],["\u2498","17."],["\u2499","18."],["\u249A","19."],["\u249B","20."],["\u249C","a"],["\u249D","b"],["\u249E","c"],["\u249F","d"],["\u24A0","e"],["\u24A1","f"],["\u24A2","g"],["\u24A3","h"],["\u24A4","i"],["\u24A5","j"],["\u24A6","k"],["\u24A7","l"],["\u24A8","m"],["\u24A9","n"],["\u24AA","o"],["\u24AB","p"],["\u24AC","q"],["\u24AD","r"],["\u24AE","s"],["\u24AF","t"],["\u24B0","u"],["\u24B1","v"],["\u24B2","w"],["\u24B3","x"],["\u24B4","y"],["\u24B5","z"],["\u24B6","A"],["\u24B7","B"],["\u24B8","C"],["\u24B9","D"],["\u24BA","E"],["\u24BB","F"],["\u24BC","G"],["\u24BD","H"],["\u24BE","I"],["\u24BF","J"],["\u24C0","K"],["\u24C1","L"],["\u24C2","M"],["\u24C3","N"],["\u24C4","O"],["\u24C5","P"],["\u24C6","Q"],["\u24C7","R"],["\u24C8","S"],["\u24C9","T"],["\u24CA","U"],["\u24CB","V"],["\u24CC","W"],["\u24CD","X"],["\u24CE","Y"],["\u24CF","Z"],["\u24D0","a"],["\u24D1","b"],["\u24D2","c"],["\u24D3","d"],["\u24D4","e"],["\u24D5","f"],["\u24D6","g"],["\u24D7","h"],["\u24D8","i"],["\u24D9","j"],["\u24DA","k"],["\u24DB","l"],["\u24DC","m"],["\u24DD","n"],["\u24DE","o"],["\u24DF","p"],
["\u24E0","q"],["\u24E1","r"],["\u24E2","s"],["\u24E3","t"],["\u24E4","u"],["\u24E5","v"],["\u24E6","w"],["\u24E7","x"],["\u24E8","y"],["\u24E9","z"],["\u24EA","0"],["\u24EB","11"],["\u24EC","12"],["\u24ED","13"],["\u24EE","14"],["\u24EF","15"],["\u24F0","16"],["\u24F1","17"],["\u24F2","18"],["\u24F3","19"],["\u24F4","20"],["\u24F5","1"],["\u24F6","2"],["\u24F7","3"],["\u24F8","4"],["\u24F9","5"],["\u24FA","6"],["\u24FB","7"],["\u24FC","8"],["\u24FD","9"],["\u24FE","10"],["\u2776","1"],["\u2777","2"],["\u2778","3"],["\u2779","4"],["\u277A","5"],["\u277B","6"],["\u277C","7"],["\u277D","8"],["\u277E","9"],["\u277F","10"],["\u2780","1"],["\u2781","2"],["\u2782","3"],["\u2783","4"],["\u2784","5"],["\u2785","6"],["\u2786","7"],["\u2787","8"],["\u2788","9"],["\u2789","0"],["\u278A","1"],["\u278B","2"],["\u278C","3"],["\u278D","4"],["\u278E","5"],["\u278F","6"],["\u2790","7"],["\u2791","8"],["\u2792","9"],["\u2793","10"],["\uFF10","0"],["\uFF11","1"],["\uFF12","2"],["\uFF13","3"],["\uFF14","4"],["\uFF15","5"],["\uFF16","6"],["\uFF17","7"],["\uFF18","8"],["\uFF19","9"],["\uFF21","A"],["\uFF22","B"],["\uFF23","C"],["\uFF24","D"],["\uFF25","E"],["\uFF26","F"],["\uFF27","G"],["\uFF28","H"],["\uFF29","I"],["\uFF2A","J"],["\uFF2B","K"],["\uFF2C","L"],["\uFF2D","M"],["\uFF2E","N"],["\uFF2F","O"],["\uFF30","P"],["\uFF31","Q"],["\uFF32","R"],["\uFF33","S"],["\uFF34","T"],["\uFF35","U"],["\uFF36","V"],["\uFF37","W"],["\uFF38","X"],["\uFF39","Y"],["\uFF3A","Z"],["\uFF41","a"],["\uFF42","b"],["\uFF43","c"],["\uFF44","d"],["\uFF45","e"],["\uFF46","f"],["\uFF47","g"],["\uFF48","h"],["\uFF49","i"],["\uFF4A","j"],["\uFF4B","k"],["\uFF4C","l"],["\uFF4D","m"],["\uFF4E","n"],["\uFF4F","o"],["\uFF50","p"],["\uFF51","q"],["\uFF52","r"],["\uFF53","s"],["\uFF54","t"],["\uFF55","u"],["\uFF56","v"],["\uFF57","w"],["\uFF58","x"],["\uFF59","y"],["\uFF5A","z"],["\u0000",null]];var m_achFraction_Table=["\u00BC","\u00BD","\u00BE","\u2153","\u2154","\u2155","\u2156","\u2157","\u2158","\u2159","\u215A","\u215B","\u215C","\u215D","\u215E","\u0000"];var m_adFraction_Table=[0.25,0.5,0.75,0.3333333333333333,0.6666666666666667,0.2,0.4,0.6,0.8,0.1666666666666667,0.8333333333333333,0.125,0.375,0.625,0.875,0.0];function NaturalSort(bIsAscending,sText1,sText2,bCompareNoCase){var nRet=0;if((sText1!=null)&&(sText2!=null)){try{nRet=strnatcmp0(sText1,sText2,bCompareNoCase);}catch(e){nRet=Compare(sText1,sText2,bCompareNoCase);}}if(!bIsAscending)nRet*=-1;return(nRet);}function CharNext(anIndices,sStr){var chNext=0;if((anIndices!=null)&&(anIndices.length==2)){anIndices[0]=anIndices[1];if((sStr!=null)&&(anIndices[1]<sStr.length)){chNext=sStr.charAt(anIndices[1]);anIndices[1]=++anIndices[1];}}return(chNext);}function nat_isdigit(chTest){var bIsDigit=false;if((chTest>='0')&&(chTest<='9'))bIsDigit=true;return(bIsDigit);}function nat_isfraction(chChar){var bIsFraction=false;var bReturnVals=[];var rdValue=0;if(chChar.charCodeAt(0)>127){var nIndex=0;var nCharValue=eval(m_achFraction_Table[nIndex]);for(nIndex=0;(nCharValue!=0);nIndex++){nCharValue=eval(m_achFraction_Table[nIndex]);if(nCharValue==chChar.charCodeAt(0)){rdValue=('0'.charCodeAt(0)+m_adFraction_Table[nIndex]);bIsFraction=true;break;}}}bReturnVals[0]=bIsFraction;bReturnVals[1]=rdValue;return(bReturnVals);}function skip_leading_zeros(sTest,nIndex){var nStrMax=(sTest.length-1);while((nIndex<nStrMax)&&(sTest.charAt(nIndex)=='0')&&(nat_isdigit(sTest.charAt(nIndex+1)))){++nIndex;}return(nIndex);}function compare_right(a,nIndexA,b,nIndexB){var nRet=0;var bias=0;for(;;nIndexA++,nIndexB++){var chA="";var chB="";if(nIndexA<a.length)chA=a.charAt(nIndexA);if(nIndexB<b.length)chB=b.charAt(nIndexB);if((!nat_isdigit(chA))&&(!nat_isdigit(chB))){nRet=bias;break;}else if(!nat_isdigit(chA)){nRet=-1;break;}else if(!nat_isdigit(chB)){nRet=1;break;}else if(chA<chB){if(bias==0)bias=-1;}else if(chA>chB){if(bias==0)bias=1;}else if((chA.charCodeAt(0)==0)&&(chB.charCodeAt(0)==0)){nRet=bias;break;}}return(nRet);}function ASCIIize(pszStr){var chChar;var sStr=pszStr;for(var nNext=0;(nNext<sStr.length);nNext++){chChar=sStr.charAt(nNext);if(chChar==0)break;if(chChar>"~".charAt(0)){var nFirst=0;var nLast=(m_aTable.length-1);while(nFirst<=nLast){var nMid=Math.round((nFirst+nLast)/2);var chTableChar=m_aTable[nMid][0];if(chChar==chTableChar){sStr=(sStr.substring(0,nNext)+m_aTable[nMid][1]+sStr.substring(nNext+1));nNext=(nNext+(m_aTable[nMid][1].length-1));break;}else if(chChar>chTableChar)nFirst=(nMid+1);else if(chChar<chTableChar)nLast=(nMid-1);}}}return(sStr);}function IsPunctuation(chChar){return(!((chChar==0)||(chChar=='.')||(IsSymbol(chChar))||(IsAlphaNum(chChar))||(chChar>'~')));}function IsAlphaNum(chChar){return(((chChar>='A')&&(chChar<='Z'))||((chChar>='a')&&(chChar<='z'))||((chChar>='0')&&(chChar<='9')));}function IsSymbol(chChar){return(((chChar>='[')&&(chChar<='`'))||((chChar>='{')&&(chChar<="\u00BF")));}function SymbolCheck(chPotentialSymbol,chPotentialAlphaNum){return((IsSymbol(chPotentialSymbol))&&(IsAlphaNum(chPotentialAlphaNum)));}function strnatcmp0(a,b,bIgnoreCase){var sStrA,sStrB;var ca,cb;var pAStart=0;var pA=1;var pBStart=0;var pB=1;var anIndicesA=[0,0];var anIndicesB=[0,0];sStrA=ASCIIize(a);sStrB=ASCIIize(b);while(true){ca=CharNext(anIndicesA,sStrA);cb=CharNext(anIndicesB,sStrB);while((IsPunctuation(ca))&&(anIndicesA[pAStart]<(sStrA.length-1)))ca=CharNext(anIndicesA,sStrA);while((IsPunctuation(cb))&&(anIndicesB[pBStart]<(sStrB.length-1)))cb=CharNext(anIndicesB,sStrB);anIndicesA[pAStart]=skip_leading_zeros(sStrA,anIndicesA[pAStart]);anIndicesA[pA]=anIndicesA[pAStart];ca=CharNext(anIndicesA,sStrA);anIndicesB[pBStart]=skip_leading_zeros(sStrB,anIndicesB[pBStart]);anIndicesB[pB]=anIndicesB[pBStart];cb=CharNext(anIndicesB,sStrB);var bIsNumberA=nat_isdigit(ca);var bIsNumberB=nat_isdigit(cb);if((bIsNumberA)&&(bIsNumberB)){var nResult=compare_right(sStrA,anIndicesA[pAStart],sStrB,anIndicesB[pBStart]);if(nResult!=0)return(nResult);}else{var aReturnValsA=nat_isfraction(ca);var aReturnValsB=nat_isfraction(cb);bIsNumberA=aReturnValsA[0];bIsNumberB=aReturnValsB[0];var dValueA=aReturnValsA[1];var dValueB=aReturnValsB[1];if((bIsNumberA)&&(bIsNumberB)){if(dValueA<dValueB)return(-1);else if(dValueA>dValueB)return(1);}else if((bIsNumberA)&&(cb!=0)){if(dValueA<cb)return(-1);else if(dValueA>cb)return(1);}else if((bIsNumberB)&&(ca!=0)){if(dValueB<ca)return(1);else if(dValueB>ca)return(-1);}}if((anIndicesA[pAStart]+1>=sStrA.length)&&(anIndicesB[pBStart]+1>=sStrB.length)){return(Compare(a,b,bIgnoreCase));}if(SymbolCheck(ca,cb)){return(-1);}else if(SymbolCheck(cb,ca)){return(1);}if(bIgnoreCase){ca=ca.toUpperCase();cb=cb.toUpperCase();}if(ca<cb)return(-1);else if(ca>cb)return(1);anIndicesA[pAStart]++;anIndicesB[pBStart]++;}}function Compare(sText1,sText2,bCompareNoCase){var nRet=0;if((sText1!=null)&&(sText2!=null)){if(bCompareNoCase){sText1=sText1.toLowerCase();sText2=sText2.toLowerCase();}nRet=(sText1.localeCompare(sText2));}return(nRet);}var g_nTotalDirs=0;var g_nTotalFiles=0;var g_nTotalSize=0;var g_nTotalImages=0;var g_nTotalMedia=0;var g_nTotalAudio=0;var g_bAddingRow=false;var MaxScrollTop;var RowTarget;var CellTarget;var TopRowTG;var rightScroll;var bottomScroll;var g_sMovingfile=false;var g_sFileToMove;var g_bContextMenuActive=false;AW.Formats.Filesize=AW.System.Format.subclass();AW.Formats.Filesize.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);this.m_sShortcutSize1="18446744073709551615";this.m_sShortcutSize2="18446744073709552000";};obj.dataToText=function(data){if((data.toString()==this.m_sShortcutSize1)||(data.toString()==this.m_sShortcutSize2))return(FormatFileSize(0,false));else return(FormatFileSize(data,false));};obj.dataToValue=function(data){var nVal=parseInt(data);if((isNaN(nVal))||(data==this.m_sShortcutSize1)||(data==this.m_sShortcutSize2))return(0);else return(nVal);};obj.comparator=DefaultClientCompareDir;};AW.Formats.LocaleDate=AW.System.Format.subclass();AW.Formats.LocaleDate.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;var TodaysDate=new Date();var nTimeZoneOffset=TodaysDate.getTimezoneOffset();obj.init=function(){_super.init.call(this);};obj.dataToText=function(data){if((typeof(data)=="undefined")||(data==""))return("");else{if((AW.ie)&&(parseInt(navigator.appVersion)>=4))return(VBDateFormat(data,nTimeZoneOffset));else{return(FormatFileDate(data));}}};obj.dataToValue=function(data){var nVal=parseInt(data);if(isNaN(nVal))return(0);else return(nVal);};obj.comparator=DefaultClientCompareDir;};AW.Formats.BWCFileString=AW.Formats.XMLString.subclass();AW.Formats.BWCFileString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sLabel="";data=DecodeString(data);if((Grid!=undefined)&&(Grid.getCellValue(7,nRow))&&((sLabel=decodeURIComponent(Grid.getCellData(6,nRow)))!=""))return(FormatClientString(data,true)+" ("+sLabel+")");else return(FormatClientString(data,true));};obj.comparator=CompareDir;};AW.Formats.BWCSearchFileString=AW.Formats.XMLString.subclass();AW.Formats.BWCSearchFileString.create=function(){var obj=this.prototype;var _super=this.superclass.prototype;obj.init=function(){_super.init.call(this);};obj.dataToText=function(data,Grid,nColumn,nRow){var sLabel="";data=DecodeString(data);if((Grid!=undefined)&&(Grid.getCellValue(7,nRow))&&((sLabel=decodeURIComponent(Grid.getCellData(6,nRow)))!=""))return(FormatClientString(data,true)+" ("+sLabel+")");else return(FormatClientString(data,true));};obj.dataToValue=function(data){return(data);};obj.comparator=CompareDir;};function CompareDir(values,greater,less,equal,error){return(function(i,j){try{var a=values[i];var b=values[j];var bIsNum=false;var nCompareResult;if(isNaN(a)&&isNaN(b)){a=a.toLocaleLowerCase();b=b.toLocaleLowerCase();nCompareResult=a.localeCompare(b);}else bIsNum=true;var nCompareType1=FilesList.getCellValue(4,i);var nCompareType2=FilesList.getCellValue(4,j);if(nCompareType1==nCompareType2){var ndir=NaturalSort(true,a,b,true);if(ndir>0){return greater}if(ndir<0){return less}return equal(i,j);}else{if(nCompareType1==1){return less}else{return greater}}}catch(e){return error(i,j,e);}});}function DefaultClientCompareDir(values,greater,less,equal,error){return(function(i,j){try{var a=values[i];var b=values[j];var bIsNum=false;var nCompareResult;if(isNaN(a)&&isNaN(b)){a=a.toLocaleLowerCase();b=b.toLocaleLowerCase();nCompareResult=a.localeCompare(b);}else bIsNum=true;var nCompareType1=FilesList.getCellValue(4,i);var nCompareType2=FilesList.getCellValue(4,j);if(!bIsNum){if(nCompareType1==nCompareType2){if(nCompareResult>0){return greater}if(nCompareResult<0){return less}return equal(i,j);}else{if(nCompareType1==1){return less}else{return greater}}}else{if(nCompareType1==nCompareType2){if(a>b){return greater}if(a<b){return less}return equal(i,j);}else{if(nCompareType1==1){return less}else{return greater}}}}catch(e){return error(i,j,e);}});}function GetDecodedDirPath(sDir){var sDecodedDir="";if(sDir!=undefined){sDecodedDir=sDir.replace(eval("/%2F/g"),"/");sDecodedDir=sDecodedDir.replace(eval("/%3A/g"),":");sDecodedDir=sDecodedDir.replace(eval("/%26/g"),"&");sDecodedDir=sDecodedDir.replace(eval("/%24/g"),"$");sDecodedDir=sDecodedDir.replace(eval("/%2C/g"),",");sDecodedDir=sDecodedDir.replace(eval("/%40/g"),"@");sDecodedDir=sDecodedDir.replace(eval("/%23/g"),"#");sDecodedDir=sDecodedDir.replace(eval("/%2B/g"),"+");sDecodedDir=sDecodedDir.replace(eval("/%3D/g"),"=");sDecodedDir=sDecodedDir.replace(eval("/%3B/g"),";");sDecodedDir=sDecodedDir.replace(eval("/&apos;/g"),"'");sDecodedDir=sDecodedDir.replace(eval("/&#x29;/g"),")");sDecodedDir=sDecodedDir.replace(eval("/&#x28;/g"),"(");sDecodedDir=sDecodedDir.replace(eval("/&#x22;/g"),"\"");sDecodedDir=sDecodedDir.replace(eval("/&lt;/g"),"\<");sDecodedDir=sDecodedDir.replace(eval("/&gt;/g"),"\>");try{sDecodedDir=decodeURI(sDecodedDir);}catch(e){try{sDecodedDir=sDecodedDir.replace(eval("/%/g"),"&#37;");sDecodedDir=decodeURI(sDecodedDir);sDecodedDir=sDecodedDir.replace(eval("/&#37;/g"),"%");}catch(e){console.error('e',e);AlertDialog('Operation was not completed.',undefined,undefined,bWebClientIcon);}}}return(sDecodedDir);}function GetFileImage(sFilename,nColumn,nRowIndex){var bIsDir=(parseInt(this.getCellValue(4,nRowIndex))==1||parseInt(this.getCellText(4,nRowIndex))==1)?true:false;var bIsDrive=(parseInt(this.getCellValue(7,nRowIndex))==1||parseInt(this.getCellText(7,nRowIndex))==1)?true:false;var bLowercase=false;if((bIsDir)||(bIsDrive)){if(g_bAddingRow==undefined||!g_bAddingRow)this.UpdateText("",1,nRowIndex);else this.setCellText("",1,nRowIndex);if(bIsDrive){var nDriveType=parseInt(this.getCellValue(8,nRowIndex));if(nDriveType==2){if((sFilename.toUpperCase()=="A:")||(sFilename.toUpperCase()=="B:"))return(GetDriveIcon(2));else return(GetDriveIcon(7));}else return(GetDriveIcon(nDriveType));}else return("DirExt");}else{try{if(g_bIsWebClient){bLowercase=true;}}catch(e){bLowercase=false;}return(GetFileIcon(sFilename.substr(sFilename.lastIndexOf(".")+1),bLowercase));}}function OnResetTotals(){g_nTotalFiles=0;g_nTotalDirs=0;g_nTotalSize=0;g_nTotalImages=0;g_nTotalMedia=0;g_nTotalAudio=0;document.getElementById("TotalFiles").innerHTML="0";document.getElementById("TotalDirs").innerHTML="0";document.getElementById("TotalSize").innerHTML="0";}function ScrollEvent(){FilesList.raiseEvent("adjustScrollBars");FilesList.raiseEvent("adjustScrollHeight");FilesList.setScrollTop(0);}function OnBrowseFileListContextMenu(){if(FilesList.getCellText(4,FilesList.getSelectedRows())==1)sMenuItemName="<strong>"+g_sOpen+"</strong>";else sMenuItemName="";return(sMenuItemName);}function OnBrowseFileListContextImages(){if(FilesList.getCellText(4,FilesList.getSelectedRows())==1)sImageClass="FileOpen";else sImageClass="";return(sImageClass);}function FormatFileDate(nDateinSeconds){var FileDate=new Date(parseInt(nDateinSeconds)*1000);return(FileDate.toLocaleString());}function BuildCrumbBar(sPath){var a_sPaths,sStartVal;sPath=decodeURIComponent(sPath);if(sPath.toUpperCase()=="/")a_sPaths=[""];else{if(sPath.substr(0,2)=="//"){sStartVal=sPath.substr(0,sPath.indexOf("/",2));sPath=sPath.substr(sPath.indexOf("/",2)+1);a_sPaths=sPath.split("/");a_sPaths.unshift(sStartVal);}else a_sPaths=sPath.split("/");}var sPathVal="";var sCrumbString="<div style='width:100%;'><table cellpadding='0' cellspacing='0' border='0' style='white-space:nowrap;'><tr>";var sCrumbContainer="";for(var i=0;i<a_sPaths.length;i++){sPathVal+=a_sPaths[i]+"/";var sOnGoToPath=String('OnOpenCrumb(\''+CleanPathByEscapeWithEncoding(sPathVal)+'\');');var sOnBuildCrumbListing=String('BuildCrumbListing(\''+CleanPathByEscapeWithEncoding(sPathVal)+'\', '+i+');');var sOnHideMenu=String('hideCrumbMenuSetUp('+i+')');sMenuFileMove=String('OnCrumbDropFile(\''+CleanPathByEscape(sPathVal)+'\');');var DialogElement;var bDivContainerExists=false;if(document.getElementById("crumb-container"+i)){bDivContainerExists=true;DialogElement=document.getElementById("crumb-container"+i);}else{DialogElement=document.createElement("div");DialogElement.id=("crumb-container"+i);}DialogElement.className="CrumbBarMenu";DialogElement.style.zIndex="9999";DialogElement.style.cursor="pointer";DialogElement.style.height="60px";if(a_sPaths[i]==""){a_sPaths[i]=g_sHomeStr;sFolderIco='';}else sFolderIco='<div class="crumbico foldercrumb"></div>';if(i<(a_sPaths.length-1)||(a_sPaths.length==1)){sCrumbString+='<td style="white-space:nowrap;" onmouseup="javascript:'+sMenuFileMove+'">'+sFolderIco+'<a  href="javascript:'+sOnGoToPath+'">'+SanitizeString(a_sPaths[i])+'</a><span id="crumb'+i+'" class=""><span class="crumbarrowico" onmouseup="javascript:'+sOnBuildCrumbListing+'"></span></span></td>';}else{sCrumbString+='<td style="white-space:nowrap;" onmouseup="javascript:'+sMenuFileMove+'">'+sFolderIco+'<a href="javascript:'+sOnGoToPath+'">'+SanitizeString(a_sPaths[i])+'</a><span id="crumb'+i+'" class=""><span class="crumbarrowico" onmouseup="javascript:'+sOnBuildCrumbListing+'"></span></span></td>';}sCrumbContainer='<div style="text-align:center;"><img src="'+g_sCommonPath+'Images/BusyGrid.gif" style="margin:0 auto 0 auto;"></div>';DialogElement.innerHTML=sCrumbContainer;if(!bDivContainerExists)document.getElementsByTagName("body")[0].appendChild(DialogElement);}sCrumbString+='</tr></table></div>';return(sCrumbString);}function BuildCrumbListing(sGoToPath,nID){if(parseInt(g_nActiveCrumbMenuId)!=parseInt(nID)){var sBuildCrumbListCmd="/?Command=List&DirsOnly=1&FilesOnly=0&Dir="+sGoToPath;var BuildCrumbListTable=new AW.XML.Table;var asDirNames=[],asDirPath=[],asIcons=[];var nContainerSize=0;g_bBlockCrumb=true;if(g_nActiveCrumbMenuId!=undefined)document.getElementById("crumb-container"+g_nActiveCrumbMenuId).style.visibility="hidden";document.getElementById("crumb-container"+nID).style.height="60px";document.getElementById("crumb-container"+nID).innerHTML='<div style="text-align:center;"><img src="'+g_sCommonPath+'Images/BusyGrid.gif" style="margin:0 auto 0 auto;"></div>';g_nActiveCrumbMenuId=nID;$("#crumb-container"+nID).bind('mouseenter',function(){$("body").unbind("mouseup");$(this).unbind("mouseup");});$("#crumb-container"+nID).bind("mouseleave",function(){$(this).unbind("mouseup");$("body").mouseup(function(){hideCrumbMenu(nID);$("body").unbind("mouseup");$("#crumb-container"+nID).unbind("mouseup");});});setTimeout(function(){$("body").mouseup(function(){hideCrumbMenu(nID);$("body").unbind("mouseup");$("#crumb-container"+nID).unbind("mouseup");});},0);showMenu(undefined,"crumb-container"+nID,"crumb"+nID,true);BuildCrumbListTable.setURL(sBuildCrumbListCmd);BuildCrumbListTable.setRows("//file");BuildCrumbListTable.setColumns(["FileName","FilePath","FileIsDir","FileIsDrive","FileDriveType"]);BuildCrumbListTable.response1=BuildCrumbListTable.response;BuildCrumbListTable.response=function(data){this.response1(data);var aCrumbArray=new Array();for(var nIndex=0;nIndex<this.getCount();nIndex++){var sFileName="";var sIcon="";if(parseInt(this.getData(2,nIndex))==1){sFileName=FormatClientString(this.getData(0,nIndex));asDirNames.push(sFileName);asDirPath.push(decodeURIComponent(this.getData(1,nIndex)));if(parseInt(this.getData(3,nIndex))==1){var nDriveType=parseInt(this.getData(4,nIndex));if(nDriveType==2){if((sFileName.toUpperCase()=="A:")||(sFileName.toUpperCase()=="B:")){sIcon=GetDriveIcon(2);}else{sIcon=GetDriveIcon(7);}}else{sIcon=GetDriveIcon(nDriveType);}}else{sIcon="DirShortcut";}aCrumbArray.push([sFileName,decodeURIComponent(this.getData(1,nIndex)),sIcon]);nContainerSize++}}aCrumbArray.sort(function(value1,value2){return(NaturalSort(true,value1[0],value2[0],(!g_bCaseSensitiveOS)));});setTimeout(function(){CreateCrumbMenu(aCrumbArray,nID,nContainerSize);},500);g_bBlockCrumb=false;};BuildCrumbListTable.request();}}function OnOpenCrumb(sPath,nHistory,bByPassHistory){if(g_nActiveCrumbMenuId!=undefined){$("body").unbind("mouseup");$("#crumb-container"+g_nActiveCrumbMenuId).unbind("mouseup");$("#crumb-container"+g_nActiveCrumbMenuId).unbind("mouseleave");hideCrumbMenu(g_nActiveCrumbMenuId);}if(bByPassHistory)g_bHistoryButtonUsed=true;if(nHistory!=undefined){g_HistoryPointer=nHistory;g_sLastIcon=g_aHistoryIcon[g_HistoryPointer];}OnFileOpen(true,SanitizeString(sPath),true);}function EncodeCharForXML(sPath){sRawFilePath=sPath;sRawFilePath=sRawFilePath.replace(new RegExp("'","g"),"%27");sRawFilePath=sRawFilePath.replace(new RegExp("[\(]","g"),"%28");sRawFilePath=sRawFilePath.replace(new RegExp("[\)]","g"),"%29");return(sRawFilePath);}function CreateDragandDrop(objGrid){objGrid.m_mouseCelldown=false;objGrid.m_DragStartRow=-1;objGrid.m_DropRow=-1;objGrid.m_DragCancelled=false;var g_nScrollZoneSize=0;objGrid.onControlMouseOut=function(event){this.m_mouseGridBlur=true;document.onmouseup=function(){objGrid.dragstop();};};objGrid.onControlMouseOver=function(event){this.m_mouseGridBlur=false;document.onmouseup=function(){return(false);};};objGrid.dragCancel=function(e){this.m_DragCancelled=true;objGrid.dragstop();};objGrid.onCellMouseDown=function(e,column,row){var bRightClick;var ActionEvent=(window.event)?event:e;var el=document;this.m_DragCancelled=false;if(ActionEvent.which)bRightClick=(ActionEvent.which==3);else if(ActionEvent.button)bRightClick=(ActionEvent.button==2);if(el.attachEvent){el.attachEvent("onkeydown",this.dragCancel);}else if(el.addEventListener){el.addEventListener("keydown",this.dragCancel,true);}else{el["onkeydown"]=this.dragCancel;}if(!bRightClick&&!g_bContextMenuActive){var FeedbackRow=document.getElementById('FeedbackRow');if(FeedbackRow&&(objGrid.m_DragStartRow==objGrid.getSelectedRows()))FeedbackRow.parentNode.removeChild(FeedbackRow);this.m_DragStartRow=-1;this.m_DropRow=-1;dragRowStart(row);this.dragstart(e,column,row);}else objGrid.dragstop();};objGrid.onCellMouseUp=function(event,column,row){this.dragstop(column,row);};objGrid.defineRowProperty("background",function(nRow){if(parseInt(this.getCellData(4,nRow)))return("#ebf3fd url(%COMMON_FILE%/Images/FileList-Hover.png");else return("#fff");});objGrid.onCellMouseOver=function(event,column,row){if(parseInt(this.getCellData(4,row))&&this.m_mouseCelldown)this.getRowTemplate(row).setClass("highlightit","ON");else if(!this.m_mouseCelldown)this.getRowTemplate(row).setClass("highlightit","ON");objGrid.onControlMouseUp=function(event){this.m_mouseGridBlur=false;return(false);};};objGrid.onCellMouseOut=function(event,column,row){this.getRowTemplate(row).setClass("highlightit","OFF");objGrid.onControlMouseUp=function(event){this.m_mouseGridBlur=false;objGrid.dragstop();};};objGrid.dragstart=function(e,column,row){this.m_DragStartRow=row;g_sMovingfile=true;g_sFileToMove=this.getCellText(0,row);MaxScrollTop=this.getScrollHeight()-document.getElementById(this.getId()).offsetHeight+18;};objGrid.dragstop=function(column,row,sCrumbFilePath){this.m_mouseCelldown=false;this.m_DropRow=row;if(!this.m_DragCancelled){if(sCrumbFilePath)ConfirmMoveFile(sCrumbFilePath,this.m_DragStartRow,undefined,true);else if(this.m_DragStartRow>-1&&this.m_DropRow>-1&&(this.m_DragStartRow!=this.m_DropRow))ConfirmMoveFile(this.getCellText(3,row),this.m_DragStartRow,this.m_DropRow,true);}g_sMovingfile=false;g_sFileToMove=undefined;var FeedbackRow=document.getElementById('FeedbackRow');if(FeedbackRow)FeedbackRow.parentNode.removeChild(FeedbackRow);CellTarget=undefined;this.m_DragStartRow=-1;this.m_DropRow=-1;var el=document;if(el.detachEvent){el.detachEvent("onkeydown",this.dragCancel);}else if(el.removeEventListener){el.removeEventListener("keydown",this.dragCancel,true);}else{el["onkeydown"]=null;}g_nScrollZoneSize=0;};var dragRowStart=function(row){CellTarget=document.getElementById("ListFiles-cell-0-"+row+"-box-text");if(CellTarget){var sECId=CellTarget.id;if(sECId.indexOf("-box-text")>0)RowTarget=CellTarget.parentNode.parentNode;else RowTarget=CellTarget.parentNode;rightScroll=objGrid.getScrollLeft();bottomScroll=objGrid.getScrollTop();TopRowTG=RowTarget.parentNode.firstChild;RowTarget.width=parseInt(RowTarget.offsetWidth)+"px";RowTarget.height=parseInt(RowTarget.offsetHeight)+"px";objGrid.m_mouseCelldown=true;}};var dragRowMouseMove=function(e){var NewFeedbackRowTop=0;var NewFeedbackRowLeft=0;var Event=((AW.ie)?event:e);bottomScroll=objGrid.getScrollTop();var nScrollTop=document.body.scrollTop;if(nScrollTop==0){if(window.pageYOffset)nScrollTop=window.pageYOffset;else nScrollTop=(document.body.parentElement)?document.body.parentElement.scrollTop:0;}if(!AW.ie){var x=Event.pageX;var y=Event.pageY;}else{var x=Event.clientX;var y=Event.clientY;}var FeedbackRow=document.getElementById('FeedbackRow');if(FeedbackRow&&objGrid.m_mouseCelldown){if(AW.ie){if(nScrollTop>0)y+=nScrollTop;NewFeedbackRowLeft=x+8;NewFeedbackRowTop=y-3;}if(!AW.ie){if(rightScroll==0)NewFeedbackRowLeft=x+15;else NewFeedbackRowLeft=x+15;if(bottomScroll==0)NewFeedbackRowTop=y;else NewFeedbackRowTop=y;}FeedbackRow.style.top=parseInt(NewFeedbackRowTop)+"px";FeedbackRow.style.left=parseInt(NewFeedbackRowLeft)+"px";FeedbackRow.style.display="";}else if(objGrid.m_mouseCelldown){var FeedbackRow=RowTarget.cloneNode(true);FeedbackRow.id="FeedbackRow";FeedbackRow.style.position="absolute";FeedbackRow.style.width=RowTarget.width;FeedbackRow.style.height=RowTarget.height;FeedbackRow.style.zIndex=1000000;FeedbackRow.style.MozOpacity=0.7;FeedbackRow.style.filter="alpha(opacity=70)";FeedbackRow.style.whiteSpace="nowrap";FeedbackRow.style.textOverflow="ellipsis";FeedbackRow.style.overflow="visible";FeedbackRow.style.display="none";FeedbackRow.firstChild.style.overflow="visible";document.getElementsByTagName("body")[0].appendChild(FeedbackRow);}if(objGrid.m_mouseCelldown){var GridHeight=parseInt(document.getElementById(objGrid.getId()).style.height)<=200?200:parseInt(document.getElementById(objGrid.getId()).style.height);var ScrollZoneSize=g_nScrollZoneSize;var NewScrollTop;var nHeadHeight=$("#ListFilesContainer").offset().top;if((NewFeedbackRowTop)<(nHeadHeight+((ScrollZoneSize*2)))&&(objGrid.getScrollTop()>0)){NewScrollTop=(objGrid.getScrollTop()-ScrollZoneSize);if(NewScrollTop<0)NewScrollTop=0;objGrid.setScrollTop(NewScrollTop);}if(NewFeedbackRowTop>((GridHeight+nHeadHeight)-ScrollZoneSize)){NewScrollTop=objGrid.getScrollTop()+ScrollZoneSize;if(objGrid.getScrollTop()<(MaxScrollTop-18)){objGrid.raiseEvent("adjustScrollBars");objGrid.raiseEvent("adjustScrollHeight");objGrid.setScrollTop(NewScrollTop);objGrid.element().focus();}}g_nScrollZoneSize=18;}};document.onmousemove=dragRowMouseMove;}function OnCrumbDropFile(sToFilePath){if(g_sMovingfile)FilesList.dragstop(undefined,undefined,sToFilePath);}function ConfirmMoveFile(sToFilePath,nMoveRow,nDropRow,bWebClientIcon){var bIsDir=true;var bIsDrive=false;var sNewPath=sToFilePath+"/"+g_sFileToMove;var sOriginalPath=decodeURIComponent(g_sCurrentDir)+"/"+g_sFileToMove;var bMoveFile=(sNewPath!=sOriginalPath)?true:false;if(nDropRow!=undefined)bIsDir=parseInt(FilesList.getCellValue(4,nDropRow))?true:false;if(nMoveRow!=undefined)bIsDrive=parseInt(FilesList.getCellValue(7,nMoveRow))?true:false;if(bIsDir&&!bIsDrive&&bMoveFile)ConfirmDialog(g_sConfirmMoveFileFrom+"\""+g_sFileToMove+"\""+g_sTo+"\""+sToFilePath+"\""+"?",MoveFile,undefined,[sToFilePath,g_sFileToMove,nMoveRow,nDropRow],500,undefined,undefined,bWebClientIcon);else if(!bMoveFile)AlertDialog(g_sCannotMoveFile,undefined,undefined,bWebClientIcon);}function MoveFile(asFileMovePaths){var sMoveCmd="/?Command=Rename&Dir="+g_sCurrentDir;var sToFilePath=asFileMovePaths[0];var sFileMoving=asFileMovePaths[1];var nDragRow=asFileMovePaths[2];var nDropRow=asFileMovePaths[3];var MoveRequest=CreatePostRequest(sMoveCmd);var sNewPath=GetDecodedDirPath(sToFilePath)+"/"+GetDecodedDirPath(sFileMoving);var sOriginalPath=GetDecodedDirPath(g_sCurrentDir)+"/"+GetDecodedDirPath(sFileMoving);sNewPath=sNewPath.replace(new RegExp("&amp;","g"),"&");sOriginalPath=sOriginalPath.replace(new RegExp("&amp;","g"),"&");MoveRequest.setParameter("new_path",sNewPath);MoveRequest.setParameter("original_path",sOriginalPath);MoveRequest.setAsync(true);MoveRequest.request();MoveRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay){AlertDialog(GetResultText(nResult,"",sResultText));}else{if(nDropRow!=undefined)FilesList.setSelectedRows([nDropRow]);if(nDragRow!=undefined)FilesList.deleteRow(nDragRow);}};}function OnHistoryDelay(){HistoryDelayId=setTimeout(function(){OnShowHistory();},1500);}function OnHistoryDelayCancel(){clearTimeout(HistoryDelayId);}