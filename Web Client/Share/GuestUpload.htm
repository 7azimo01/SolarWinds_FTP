%PAGE_CHANGE%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Result.strings"-->
%PRIV_GUEST%<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"/><meta name="viewport" content="width=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><title>%LOGIN_PAGE_TITLE%</title><!--FILE:		ShareMacros.htmPURPOSE:	Provides the FileShare framework with some global macros.CREATED:	05/15/2013 - #dlb--><script type="text/javascript" language="JavaScript">var g_nSessionOkay=0;var g_sUnknownError="$UNKNOWN_ERROR$";var g_nSessionNotFound=6;var g_nSessionPending=9;var g_nSessionAborted=10;var g_sAdminPath="%ADMIN_FILE%";var g_sCommonPath="%COMMON_FILE%";var g_sAbsFilePath="%FILE%";var g_sFilePath=g_sAbsFilePath;var g_sWebFilePath=g_sAbsFilePath;var g_sAdminImagePath="%FILE%Images";var g_sAbsSharePath="%FILE%Share";var g_sAbsShareImagePath="%FILE%Share/Images";var g_sAdminXMLPath="$ADMIN_XML$";var g_sHomeStr="$HOME$";var g_LoginStr="%LOGIN%";var g_sHelpPath="%HELP_BASE_URL%";var g_bInvalidSession=(isNaN(parseInt("%USER_ID%"))||parseInt("%USER_ID%")<1);var g_bIsDemo=(parseInt("%IS_DEMO%")==1);var g_sFontOverride="";var g_sGB="$FS_ABBREV_GIGABYTE$";var g_sMB="$FS_ABBREV_MEGABYTE$";var g_sKB="$FS_ABBREV_KILOBYTE$";var g_sBytes="$FS_BYTES$";var g_sAjaxNotSupported="$ERR_AJAX_NOT_SUPPORTED$";var g_sFailedCmdNOOP="$ADHOC_FAILED_CMD_NOOP$";var g_sSearchAction="$SEARCH_ACTION$";var g_sSearchInTxt="$SEARCH_IN$";var g_sSentFiles="$ADHOC_CONSOLE_OUTGOING$";var g_sRequestFiles="$ADHOC_CONSOLE_INCOMING$";var g_sBothFiles="$ADHOC_CONSOLE_BOTH_SEARCH$";var SHARE_TYPE_INCOMING=0;var SHARE_TYPE_OUTGOING=1;var IDS_EXPIRED="$EXPIRED$";var IDS_FMT_TIMESTAMP_FOR_DATE_TIME="$FORMAT_TIMESTAMP_FOR_DATE_TIME$";var IDS_DOWNLOAD="$DOWNLOAD$";var IDS_DELETE="$DELETE$";var IDS_EMAIL_SUBJECT_HEAD="$ADHOC_FMT_EMAIL_SUBJECT$";var IDS_EXPIRES="$EXPIRES$";var IDS_NEVER="$NEVER$";var IDS_NEVER_EXPIRES="$NEVER_EXPIRES$";var IDS_FILE_SHARE_DOES_NOT_EXPIRE="$IDS_FILE_SHARE_DOES_NOT_EXPIRE$";var IDS_UNDISCLOSED_RECIPIENTS="$UNDISCLOSED_RECIPIENTS$";var DELETE_FILE_SHARE_DLG_WIDTH=300;var DELETE_FILE_SHARE_DLG_HEIGHT=200;var g_bAllowFVJV=(%ALLOW_FTP_VOYAGER_JV%==1);var g_bAdmin=(%IS_ADMIN%==1);var NOOP_INTERVAL_IN_MILLIS=55000;var TOOLTIP_SHOW_DELAY_IN_MILLIS=500;var TOOLTIP_SHOW_DURATION_IN_MILLIS=10;var TOOLTIP_HIDE_DELAY_IN_MILLIS=10;var TOOLTIP_HIDE_DURATION_IN_MILLIS=250;var g_nRequirePasswordForGuests=parseInt("%CUser.%USER_ID%.RequirePasswordForGuests%");var g_nInsertPasswordInEmailInvite=parseInt("%CUser.%USER_ID%.InsertPasswordInEmailInvite%");var g_ullMaxGuestUploadFileSize=parseInt("%CUser.%USER_ID%.MaxGuestUploadFileSize%");var g_bAllowUserDefinedGuestAccess=("%CUser.%USER_ID%.AllowUserDefinedGuestAccess%"=="1")?true:false;var g_ullRestrictGuestAccessDays=parseInt("%CUser.%USER_ID%.RestrictGuestAccessDays%");var g_nNotifyAfterGuestDownload=parseInt("%CUser.%USER_ID%.NotifyAfterGuestDownload%");var g_nNotifyAfterGuestUpload=parseInt("%CUser.%USER_ID%.NotifyAfterGuestUpload%");var g_nSendAccessLinkToRecipients=parseInt("%CUser.%USER_ID%.SendAccessLinkToRecipients%");var g_nSendAccessLinkToSender=parseInt("%CUser.%USER_ID%.SendAccessLinkToSender%");var g_bAllowCustomContactInfo=parseInt("%CUser.%USER_ID%.AllowCustomContactInfo%");var g_nMaxNumOfFilesInSentShare=parseInt("%CUser.%USER_ID%.AdHocMaxNumOfFilesInSentShare%");var g_nMaxNumOfFilesInRequestedShare=parseInt("%CUser.%USER_ID%.AdHocMaxNumOfFilesInRequestedShare%");var g_bDisablePasswordGenerators=("%CUser.%USER_ID%.DisablePasswordGenerators%"=="1")?true:false;var DATE_MAX=parseInt("0x7FFFFFFF",16);var DATE_MAX_MILLIS=(DATE_MAX*1000);var NUM_OF_DAYS_TO_EXPIRE_GUEST_ACCESS=7;var g_sEncXsrfToken="%ENC_CSRF_TOKEN%";</script><script type="text/javascript" language="JavaScript">var g_HTTPTitle="%LOGIN_PAGE_TITLE%";if(g_HTTPTitle=="")document.title="$GUEST_LOGIN_TITLE$";var g_nPage=0;var g_bOutgoingWiz=false;var g_nOutgoingSource=0;var PAGE_MAX=2;var g_bNoFilesToUpload=false;var asPreloadImgs=["%COMMON_FILE%Images/Busy.gif","%COMMON_FILE%Images/Check16.png","%FILE%Share/Images/Serv-U-Logo-Text-small.png","%FILE%Share/Images/icon_uploading_folder.png","%FILE%Share/Images/icon_add_more_files_button.png","%FILE%Share/Images/icon_delete_file_uploaded.png","%FILE%Share/Images/icon_red_stop.png","%FILE%Share/Images/ProgressBar.png","%FILE%Share/Images/ProgressFill.png"];for(var nIndex=0;(nIndex<asPreloadImgs.length);nIndex++){LoadingImg=new Image();LoadingImg.src=asPreloadImgs[nIndex];}var g_bDisableBranding=false;var g_bHasCustomLogo=false;if(%DISABLE_BRANDING%){g_bDisableBranding=true;}if(%HAS_CUSTOM_LOGO%){g_bHasCustomLogo=true;}</script><!--FILE:		MultiUploadMacros.htmPURPOSE:	Provides the FileShare framework with some global macros regarding multiple uploads.CREATED:	05/30/2013 - #dlb--><script type="text/javascript" language="JavaScript">var TRANSFER_FILE_NAME="FileName";var TRANSFER_ID="TransferID";var TRANSFER_ROW_NUMBER="RowNumber";var TRANSFER_FILE_SIZE="FileSize";var TRANSFER_STATUS="Status";var TRANSFER_RESULT="Result";var TRANSFER_RESULT_TEXT="ResultText";var TRANSFER_VIRTUAL="Virtual";var TRANSFER_STATUS_EMPTY=0;var TRANSFER_STATUS_HAS_FILENAME=1;var TRANSFER_STATUS_DUPLICATE=2;var TRANSFER_STATUS_PENDING=3;var TRANSFER_STATUS_FAILURE=4;var TRANSFER_STATUS_SUCCESS=5;var m_nTrackProgressIteration=-1;var m_nTrackFileSize=0;var g_aTransfersMappedToRowNum=new Object();var m_nNumOfTransfers=0;var m_bMoveToNextPageAfterProgressStats=false;var g_fnOnStateChangeMultiUploadForm=function(){OnStateChangeMultiUploadForm();};function ResetProgressCounters(bResetProgBar){m_nTrackProgressIteration=-1;m_nTrackFileSize=0;if(bResetProgBar!=undefined&&bResetProgBar)ResetProgressBar();}function GetTransferObjByRow(nRow){for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var nRowNum=rTransferObj[TRANSFER_ROW_NUMBER];if(nRowNum==nRow)return(rTransferObj);}}}return(null);}function GetTransferObjByID(nTransferID){for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var nID=rTransferObj[TRANSFER_ID];if(nID==nTransferID)return(rTransferObj);}}}return(null);}</script><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-ui.css" rel="stylesheet" /><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-ui.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jqueryfunctions.js"></script><link type="text/css" href="%COMMON_FILE%/Style/Common.css" rel="stylesheet" /><link type="text/css" href="%FILE%Share/Style/Common.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonHeader.css" rel="stylesheet" /><!--[if lt IE 8]><link rel="stylesheet" type="text/css" href="%FILE%Share/Style/Common(-IE8).css" /><![endif]--><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/XMLHTTPRequest.js"></script><script type="text/javascript" language="JavaScript" src="%FILE%Share/Scripts/ShortDateUtility.js"></script><script type="text/javascript" language="JavaScript" src="%FILE%Share/Scripts/Common.js"></script><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--><style type="text/css">.expireWarningImg{top: 0px;}.ShareBottomBox{border: 1px solid lightgrey;border-radius: 4px;background-color: #E8E9E7;clear: left;height: 26px;padding: 10px;width: 540px;display: none;}.ShareBottomBoxTxt{width: auto;color: #000000;}.ShareBottomBoxBtn{float: right;width: auto;margin: 10px 0px 0px 0px;}</style></head><body><div id="AlertDialog"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px;float:left;"><span id="AlertDialogText"></span></div><script type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var sTitleHTML="<img src='%COMMON_FILE%Images/su16x16.png' width='16' height='16' border='0' class='dialogtitle' />%PRODUCT%";InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";$("#AlertDialog").dialog({"autoOpen":false,"modal":true,"resizable":false,"title":sTitleHTML });function AlertDialogEx(sText,bWarn,fnOKCallback,sExtraButtonText,fnExtraCallback,sExtraButtonImageClass,bIncludeBtnIcons){var aoButtons=[{"text":"$OK_BUTTON$","click":OnAlertDialogOkay}];var $dialog=$("#AlertDialog");if((sExtraButtonText!=undefined)&&(fnExtraCallback!=undefined))aoButtons.push({"text":sExtraButtonText,"click":fnExtraCallback});$dialog.dialog("option","buttons",aoButtons);if(bIncludeBtnIcons!=undefined&&bIncludeBtnIcons!=null&&bIncludeBtnIcons)AddButtonsTojQueryDialog($dialog,["ui-icon-check",sExtraButtonImageClass]);var rCloseBtn=$("#AlertDialog").parent().find(".ui-dialog-titlebar button");if(rCloseBtn!=null&&rCloseBtn!=undefined){rCloseBtn.mouseover(function(){$(rCloseBtn).removeClass("ui-state-hover");});}var arBtns=$("#AlertDialog").parent().find(".ui-dialog-buttonpane button");if(arBtns!=null){$(arBtns[0]).mouseover(function(){$(arBtns[0]).removeClass("ui-state-hover");});$(arBtns[0]).addClass("button_blue confirmBtns");}if(fnOKCallback!=undefined)g_fnAlertOKCallback=fnOKCallback;if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;$("#AlertImage").attr("src",sImage);if(sText!=undefined)$("#AlertDialogText").html(sText);$dialog.dialog("open");}function AlertDialog(sText,bWarn,fnOKCallback,sExtraButtonText,fnExtraCallback,sExtraButtonImageClass){AlertDialogEx(sText,bWarn,fnOKCallback,sExtraButtonText,fnExtraCallback,sExtraButtonImageClass,true);}function WarnDialog(sText){AlertDialog(sText,true,undefined);}function OnAlertDialogOkay(){if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();$("#AlertDialog").dialog("close");$("#AlertImage").attr("src",BlankImg.src);g_fnAlertOKCallback=undefined;}</script><div id="ConfirmDialog"><div id="ConfirmDialogImg"></div><div id="ConfirmDialogText" style="overflow:hidden;text-overflow:ellipsis;"></div></div><script type="text/javascript" language="JavaScript">var g_fnYes=undefined,g_fnNo=undefined;var g_objYesNoData=undefined;$("#ConfirmDialog").dialog({"autoOpen":false,"modal":true,"resizable":false,"buttons":{"$YES_BUTTON$":OnConfirmDialogYes,"$NO_BUTTON$":OnConfirmDialogNo }});function ConfirmDialogEx(sTitleImgPath,sTitle,sTextImgPath,sText,fnYes,fnNo,objYesNoData,nWidth,nHeight,bFocusOnNoBttn){var objDialog=$("#ConfirmDialog");var sTitleHTML="";if(sTitleImgPath!=null&&sTitleImgPath!=undefined&&sTitleImgPath!="")sTitleHTML+="<img src='"+sTitleImgPath+"' width='16' height='16' border='0' class='dialogtitle' />";if(sTitle!=null&&sTitle!=undefined&&sTitle!="")sTitleHTML+=sTitle;else sTitleHTML+="%PRODUCT%";objDialog.dialog("option","title",sTitleHTML);if(sTextImgPath!=null&&sTextImgPath!=undefined&&sTextImgPath!=""){var sTextImgHTML="<img src='"+sTextImgPath+"' border='0' width='32' height='32' style='margin-right:8px;float:left;'>";$("#ConfirmDialogImg").html(sTextImgHTML);}if(sText!=undefined)$("#ConfirmDialogText").html(sText);if(nWidth!=undefined)objDialog.dialog("option","width",nWidth);if(nHeight!=undefined)objDialog.dialog("option","height",nHeight);if(typeof g_bIncludeConfirmIcons!="undefined"&&g_bIncludeConfirmIcons)AddButtonsTojQueryDialog($("#ConfirmDialog"),["ui-icon-check","ui-icon-cancel"]);var rCloseBtn=$("#ConfirmDialog").parent().find(".ui-dialog-titlebar button");if(rCloseBtn!=null&&rCloseBtn!=undefined){rCloseBtn.mouseover(function(){$(rCloseBtn).removeClass("ui-state-hover");});}var arBtns=$("#ConfirmDialog").parent().find(".ui-dialog-buttonpane button");if(arBtns!=null){$(arBtns[0]).mouseover(function(){$(arBtns[0]).removeClass("ui-state-hover");});$(arBtns[1]).mouseover(function(){$(arBtns[1]).removeClass("ui-state-hover");});$(arBtns[0]).addClass("button_blue confirmBtns");$(arBtns[1]).addClass("button_gray confirmBtns");}g_fnYes=fnYes;g_fnNo=fnNo;g_objYesNoData=objYesNoData;$(document).bind("keydown",function(event){var code=(event.keyCode||event.which);if(code==9){var objFocusElement=objDialog.parent().find(".ui-state-focus");if(objFocusElement.next().length)objFocusElement.next().focus(1);else objFocusElement.parent().children().first().focus(1);return(false);}else{var fnButtonCallback=undefined;var sKey=String.fromCharCode(code).toLowerCase();$.each(objDialog.dialog("option","buttons"),function(sButtonText,value){if(sButtonText.charAt(0).toLowerCase()==sKey){if(fnButtonCallback==undefined)fnButtonCallback=value;else{fnButtonCallback=undefined;return(false);}}});if(fnButtonCallback!=undefined){fnButtonCallback();return(false);}}return(true);});if(bFocusOnNoBttn)$("#ConfirmDialog").next(".ui-dialog-buttonpane").find(":button").eq(1).focus(1);objDialog.dialog("open");}function ConfirmDialog(sText,fnYes,fnNo,objYesNoData,nWidth,nHeight,bFocusOnNoBttn){ConfirmDialogEx("%COMMON_FILE%Images/su16x16.png","%PRODUCT%","%COMMON_FILE%Images/Information.png",sText,fnYes,fnNo,objYesNoData,nWidth,nHeight,bFocusOnNoBttn);}function CloseConfirmDialog(){g_fnYes=g_fnNo=g_objYesNoData=undefined;$(document).unbind("keydown");$("#ConfirmDialog").dialog("close");}function OnConfirmDialogYes(){if(g_fnYes!=undefined)g_fnYes(g_objYesNoData);CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined)g_fnNo(g_objYesNoData);CloseConfirmDialog();}</script><!--File:			UploadProgressDlg.htmPurpose:		Provides a widget that you can embed in a webpage that allows multiple files to be uploaded to the server concurrently.References:jQueryUI-Dialog: http://docs.jquery.com/UI/Dialog--><div id="ProgressDialog" style="display:none;"><div id="UploadInfo" class="uploadStats"><div id="progressDesc"></div><div id="progressblock"><table cellpadding="0" cellspacing="0"><tr><td><div class="progresscontainer"><div id="ProgressDiv" class="progressbar"></div></div></td><td class="colPercentComplete"><span id="percentcomplete">&nbsp;</span></td></tr></table></div></div></div><script type="text/javascript" language="JavaScript">$("#ProgressDialog").dialog({"autoOpen":false,"modal":true,"resizable":false,"buttons":{"$CANCEL$":OnCancelProgressDialog },"closeOnEscape":false });var m_Timer=null;var g_bCancelUpload=false;var g_sTransferIDsForStats="";var g_nUploadTimeout=0;var MAX_UPLOAD_TIMEOUT=10;var MIN_WIDTH=360;var MIN_HEIGHT=210;function StartTimer(fnCallback,nNumOfMillis){StopTimer();m_Timer=setTimeout(fnCallback,nNumOfMillis);}function StopTimer(){clearTimeout(m_Timer);}function CancelMultiTransferStatsResponse(objRequest){if((objRequest!=undefined)&&(objRequest.readyState==4)){if(objRequest.status==200){var XMLDoc=objRequest.responseXML;var arFiles=XMLDoc.getElementsByTagName('file');if(arFiles!=null&&arFiles!=undefined){var nNumOfFiles=arFiles.length;if(nNumOfFiles>0){var bContinueToPollForCancel=false;var rFile=null;var nResult=-1;var sResultText="";var nTransferID=-1;for(var nIdx=0;nIdx<nNumOfFiles;nIdx++){rFile=null;nResult=-1;sResultText="";nTransferID=-1;rFile=arFiles[nIdx];nResult=GetXMLValueInt(rFile,"Result");sResultText=GetXMLValue(rFile,"ResultText");nTransferID=GetXMLValueInt(rFile,"TransferID");if((!isNaN(nTransferID))&&(nTransferID>0)&&(!isNaN(nResult))&&(nResult>-1)){var rTransferObj=GetTransferObjByID(nTransferID);if(rTransferObj!=null&&rTransferObj!=undefined){if(nResult==g_nSessionPending)bContinueToPollForCancel=true;else if(nResult>g_nSessionOkay){rTransferObj[TRANSFER_FILE_SIZE]=0;rTransferObj[TRANSFER_RESULT]=nResult;rTransferObj[TRANSFER_RESULT_TEXT]=sResultText;SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_FAILURE);}else ASSERT_CONSOLE("PollForCancel: Don't cancel this file, it has already been successfully uploaded!");}else ASSERT_CONSOLE("PollForCancel: Programming error, Transfer object could not be found from Transfer ID ("+nTransferID+")");}else ASSERT_CONSOLE("PollForCancel: Programming error, TransferID or Result is an invalid number.");}if(bContinueToPollForCancel){StartTimer(function(){CancelUploads();},1000);}else{StartTimer(function(){CloseProgressDialog();},250);}}}}else ASSERT("UploadProgressDlg.CancelMultiTransferStatsResponse - HTTPCode is something other than 200 OK!");}}function CancelUploads(){g_bCancelUpload=true;if(g_sTransferIDsForStats!=null&&g_sTransferIDsForStats!=undefined&&g_sTransferIDsForStats!=""){var sCmd="%FILE%Share/MultiTransferStats.xml%MULTI_TRANSFER_STATS_REF%"+g_sTransferIDsForStats+"&Cancel=1";var CancelMultiTransferStats=createXMLHttpRequest("POST",sCmd,CancelMultiTransferStatsResponse);CancelMultiTransferStats.send(null);}else ASSERT("PollForStats: Programming error, there are no files to poll for cancelling.");}function OnCancelProgressDialog(){CancelUploads();}function CloseProgressDialog(){$(document).unbind("keydown");$("#ProgressDialog").dialog("close");if(m_bMoveToNextPageAfterProgressStats){ChangePage(g_nPage+1);}}function GetTransferIDsForStats(){var nNumOfRows=GetNumOfRows();var sTransferIDs="";for(var nRow=0;nRow<nNumOfRows;nRow++){var sInput="MultiUploadFileInput_"+nRow;var rFileInput=document.getElementById(sInput);var sFileInputName=rFileInput.value;var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){var sFileName=decodeURIComponent(rTransferObj[TRANSFER_FILE_NAME]);var nStatus=rTransferObj[TRANSFER_STATUS];if(nStatus!=TRANSFER_STATUS_SUCCESS){var bIsVirtual=rTransferObj[TRANSFER_VIRTUAL];if((sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!="")||bIsVirtual==1){if((sFileInputName==sFileName)||bIsVirtual){sTransferIDs+=rTransferObj[TRANSFER_ID].toString()+",";}else{ASSERT("Cannot poll for stats because the transfer object does not match the form input.");}}else{if(sFileInputName!=sFileName)ASSERT("Cannot poll for stats because the transfer object does not match the form input.");}}}else ASSERT("Cannot poll for stats because the transfer object could not be found for this row.");}return(sTransferIDs);}function MultiTransferStatsResponse(objRequest){if((objRequest!=undefined)&&(objRequest.readyState==4)){if(objRequest.status==200){var XMLDoc=objRequest.responseXML;var nTotalBytesWritten=0;var arFiles=XMLDoc.getElementsByTagName('file');if(arFiles!=null&&arFiles!=undefined){var nNumOfFiles=arFiles.length;if(nNumOfFiles>0){var nNumOfCompletedFiles=0;var nNumOfLegitResultCodes=0;var bCanBeginProgress=true;var nTotalBytesWritten=0;var rFile=null;var nResult=-1;var sResultText="";var nTransferID=-1;var sFileName=null;var nFileSize=0;var nBytesWritten=0;var nBytesRemaining=0;var nStalledConnectionCounter=0;for(var nIdx=0;nIdx<nNumOfFiles;nIdx++){rFile=null;nResult=-1;sResultText="";nTransferID=-1;sFileName=null;nFileSize=0;nBytesWritten=0;nBytesRemaining=0;rFile=arFiles[nIdx];nResult=GetXMLValueInt(rFile,"Result");sResultText=GetXMLValue(rFile,"ResultText");nTransferID=GetXMLValueInt(rFile,"TransferID");sFileName=GetXMLValue(rFile,"FileName");nFileSize=GetXMLValueInt(rFile,"FileSize");nBytesWritten=GetXMLValueInt(rFile,"BytesWritten");nBytesRemaining=GetXMLValueInt(rFile,"BytesRemaining");if((!isNaN(nTransferID))&&(nTransferID>0)&&(!isNaN(nResult))&&(nResult>-1)){var rTransferObj=GetTransferObjByID(nTransferID);if(rTransferObj!=null&&rTransferObj!=undefined){if(!g_bCancelUpload){rTransferObj[TRANSFER_RESULT]=nResult;rTransferObj[TRANSFER_RESULT_TEXT]=sResultText;if(nResult!=g_nSessionPending)nStalledConnectionCounter++;if(nResult==g_nSessionPending){if(m_nTrackProgressIteration>-1){if(m_nTrackProgressIteration==0)m_nTrackFileSize+=nFileSize;nTotalBytesWritten+=nBytesWritten;}rTransferObj[TRANSFER_FILE_SIZE]=nFileSize;SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_PENDING);}else if(nResult==g_nSessionOkay){nNumOfCompletedFiles++;nNumOfLegitResultCodes++;OnReceiveUploadResponse(rTransferObj);nTotalBytesWritten+=rTransferObj[TRANSFER_FILE_SIZE];}else{bCanBeginProgress=false;if(nResult!=g_nSessionNotFound){SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_FAILURE);nNumOfLegitResultCodes++;}}}}else ASSERT_CONSOLE("PollForStats: Programming error, Transfer object could not be found from Transfer ID ("+nTransferID+")");}else ASSERT_CONSOLE("PollForStats: Programming error, TransferID or Result is an invalid number.");}if(nStalledConnectionCounter==nNumOfFiles){g_nUploadTimeout++;}if(!g_bCancelUpload){if(bCanBeginProgress){m_nTrackProgressIteration++;}if(m_nTrackProgressIteration>0)IncrementProgress(nTotalBytesWritten,m_nTrackFileSize);if(nNumOfFiles==nNumOfCompletedFiles){document.getElementById("ProgressDiv").style.backgroundPosition="0% 0px";document.getElementById("percentcomplete").innerHTML="100%";ResetProgressCounters();m_bMoveToNextPageAfterProgressStats=true;StartTimer(function(){CloseProgressDialog();},750);}else if(g_nUploadTimeout<MAX_UPLOAD_TIMEOUT&&nNumOfLegitResultCodes<nNumOfFiles){StartTimer(function(){PollForStats(false);},1000);}else{ResetProgressCounters();StartTimer(function(){OnCancelProgressDialog();},250);}}else{ResetProgressCounters();StartTimer(function(){OnCancelProgressDialog();},1000);}}else ASSERT("PollForStats: Programming error, could not find any <file> elements.");}else ASSERT("PollForStats: Programming error, XMLDoc could not find any <file> elements.");}else ASSERT("UploadProgressDlg.MultiTransferStatsResponse - HTTPCode is something other than 200 OK!");}}function PollForStats(bStartingFresh){if(bStartingFresh){g_nUploadTimeout=0;m_bMoveToNextPageAfterProgressStats=false;var sDesc="";if(m_nNumOfTransfers>1){sDesc="$ADHOC_FILE_UPLOAD_PROGRESS_DESC_MULTI$";sDesc=sDesc.replace("$NumOfFilesUploading",m_nNumOfTransfers);}else if(m_nNumOfTransfers==1)sDesc="$ADHOC_FILE_UPLOAD_PROGRESS_DESC_SINGLE$";$('#progressDesc').html(sDesc);g_sTransferIDsForStats=GetTransferIDsForStats();ResetProgressCounters(true);}if(g_sTransferIDsForStats!=null&&g_sTransferIDsForStats!=undefined&&g_sTransferIDsForStats!=""){var sCmd="%FILE%Share/MultiTransferStats.xml%MULTI_TRANSFER_STATS_REF%"+g_sTransferIDsForStats;var MultiTransferStats=createXMLHttpRequest("POST",sCmd,MultiTransferStatsResponse);MultiTransferStats.send(null);}else ASSERT("PollForStats: Programming error, there are no files to poll for.");}function ResetProgressBar(){IncrementProgress(0,0);}function IncrementProgress(nNumOfBytesWritten,nTotalNumOfBytes){var nPercent=0;if(nTotalNumOfBytes>0)nPercent=(nNumOfBytesWritten/nTotalNumOfBytes)*100;nPercent=parseInt(nPercent,10);if(nPercent>100)nPercent=0;var nFillPercentage=(100-nPercent);var sPercentage=nFillPercentage.toString();document.getElementById("ProgressDiv").style.backgroundPosition=sPercentage+"% 0px";document.getElementById("percentcomplete").innerHTML=nPercent+"%";}function ShowProgressDialog(nWidth,nHeight){g_bCancelUpload=false;g_nUploadTimeout=0;var objDialog=$("#ProgressDialog");var sTitleHTML="$ADHOC_FILE_UPLOAD_PROGRESS_TITLE$";objDialog.dialog("option","title",sTitleHTML);if(nWidth==undefined||nWidth==null)nWidth=MIN_WIDTH;if(nHeight==undefined||nHeight==null)nHeight=MIN_HEIGHT;if(nWidth!=undefined&&nWidth!=null)objDialog.dialog("option","width",nWidth);if(nHeight!=undefined&&nHeight!=undefined)objDialog.dialog("option","height",nHeight);var rCloseBtn=$("#ProgressDialog").parent().find(".ui-dialog-titlebar button");if(rCloseBtn!=null&&rCloseBtn!=undefined){rCloseBtn.mouseover(function(){$(rCloseBtn).removeClass("ui-state-hover");});}var arBtns=$("#ProgressDialog").parent().find(".ui-dialog-buttonpane button");if(arBtns!=null){$(arBtns[0]).mouseover(function(){$(arBtns[0]).removeClass("ui-state-hover");});$(arBtns[0]).addClass("button_blue confirmBtns");$(arBtns[0]).attr("tabindex","1");}$(document).bind("keydown",function(event){var code=(event.keyCode||event.which);if(code==9){var objFocusElement=objDialog.parent().find(".ui-state-focus");if(objFocusElement.next().length)objFocusElement.next().focus(1);else objFocusElement.parent().children().first().focus(1);return(false);}else if(code==27){return(false);}else{var fnButtonCallback=undefined;var sKey=String.fromCharCode(code).toLowerCase();$.each(objDialog.dialog("option","buttons"),function(sButtonText,value){if(sButtonText.charAt(0).toLowerCase()==sKey){if(fnButtonCallback==undefined)fnButtonCallback=value;else{fnButtonCallback=undefined;return(false);}}});if(fnButtonCallback!=undefined){fnButtonCallback();return(false);}}return(true);});var objCloseBttnElement=objDialog.parent().find(".ui-dialog-titlebar-close");if(objCloseBttnElement!=undefined&&objCloseBttnElement!=null)objCloseBttnElement.remove();ResetProgressCounters(true);objDialog.dialog("open");}</script><script type="text/javascript" language="javascript">if(parseInt(GetURLParameter("LocalAdmin"))==1)g_bIsLocalAdmin=true;clearSessionCookies('domainid');clearSessionCookies('domainodbc');function CheckDynamicAttr(sValue,sAttrClassname,sAttrName,sDefVal){if((sValue==undefined)||(sValue==null)||(sAttrClassname!=undefined&&sAttrClassname!=null&&sValue.toLowerCase().indexOf(sAttrClassname.toLowerCase())>=0)){sValue=sDefVal;ASSERT("GuestUpload.htm - Programming error, failed to parse the dynamic attr for a "+sAttrClassname+"."+sAttrName+" attr.");}return(sValue);}function IsShareTokenValid(){return(g_sShareToken!=undefined&&g_sShareToken!=null&&g_sShareToken!="");}var g_sFileShareUsername=CheckDynamicAttr("%CAdHocShare.%ID%.FromName%","CAdHocShare","FromName","");var g_sFileShareComments=CheckDynamicAttr("%CAdHocShare.%ID%.MsgBody%","CAdHocShare","MsgBody","");var g_sFileShareExpires=CheckDynamicAttr("%CAdHocShare.%ID%.DateExpiration%","CAdHocShare","DateExpiration","0");var g_nFileShareSizeLimit=parseInt(CheckDynamicAttr("%CAdHocShare.%ID%.MaxFileSize%","CAdHocShare","MaxFileSize","0"));var g_sFileShareEmail=decodeURIComponent("%CAdHocShare.%ID%.FromAddress%");var g_nIEMaxUploadSize=4294967296;if((navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.toLowerCase().indexOf('trident')!=-1)&&(g_nFileShareSizeLimit>g_nIEMaxUploadSize))g_nFileShareSizeLimit=g_nIEMaxUploadSize;g_sFileShareUsername=decodeURIComponent(g_sFileShareUsername);g_sFileShareComments=decodeURIComponent(SanitizeString(g_sFileShareComments));var g_sShareToken=CheckDynamicAttr("%CAdHocShare.%ID%.ShareToken%","CAdHocShare","ShareToken","");if(!IsShareTokenValid())g_sShareToken=GetURLParameter("ShareToken",true);</script><div id="container"><div class="AdhocHeaderGuest" id="AdhocHeaderGuest"><div class="Adhocsulogo"><img class="AdhocHeadLogo" id="GuestCustomLogo" src="/%25LOGO_FILE%25%FILE%Share/Images/Serv-U-Logo-Text-small.png" alt="$PRODUCT_FILE_SHARE_NAME$" border="0" /></div><div class="AdhocHeadGuestTxt">&nbsp;$FILE_SHARING$</div><div class="AdhocHeadGuestLinks"><a target="_blank" rel="noopener noreferrer" href="http://www.Serv-U.com/GuestHelp/?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP">$HELP$</a> <span>|</span> <a target="_blank" rel="noopener noreferrer" href="http://www.Serv-U.com/secure-file-sharing.asp?CMP=PRD-TAD-SW-MFT_INPRD-MFT-PP">$ABOUT_PRODUCT$</a></div></div><script type="text/javascript">$(document).ready(function(){var sCustomBackground="%HTML_WEB_CLIENT_BACKGROUND%";if(sCustomBackground!=""){var sBackground=sCustomBackground;$("#AdhocHeaderGuest").css("background",sBackground);}});</script><noscript><center><p>$NO_SCRIPT_TEXT$</p></center></noscript><div id="BodyMain" class="bodyMarginOuter" style="display:none;"><div class="titleDescBlock"><div style="border-bottom: 1px solid #e3e3e3;"><div class="columnTitle"><span id="topTitle"></span><span id="topTitleStep"></span></div></div><div id="topTitleDesc"></div></div><div id="CommentDiv" style="display: none;"><div id="CommentTitle" class="commentsfrom darktextbold"></div><div id="CommentDesc" class="commentsBox"></div></div><div class="bodyMarginInner"><div id="Page1" class="wizardPageContent" style="display: block;"><div class="section justifyLeft" style="vertical-align: middle; line-height: 26px; height: 36px;"><img id="TitleLogo" src="%FILE%Share/Images/icon_uploading_folder.png" width="30" height="26" alt="$PRODUCT_FILE_SHARE_NAME$" border="0" style="float: left; padding-right: 10px;" /><div style="float: left;">$ADHOC_SELECT_FILES_TO_UPLOAD$ <span id="FileSizeContstrainTxt" style="font-size:10pt;"></span></div></div><div style="clear: both;"></div><!--FILE:		MultipleFileUpload.htmPURPOSE:	Provides a form where multiple files on the local machine can be uploaded to Serv-U.HISTORY:- 04/25/2013 - #dlb - CreatedNOTES:- the owner of this file should provide their own submit mechanism for the formREFERENCES:- http://viralpatel.net/blogs/ajax-style-file-uploading-using-hidden-iframe/--><div style="margin-left: 30px;"><ol class="MultiUploadList" id="MultiUploadList" name="MultiUploadList"></ol><button id="AddMoreUploadFields" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" role="button" type="button" onclick="javascript: InsertMultiUploadFields();"><img src="%FILE%Share/Images/icon_add_more_files_button.png" width="14" height="14" class="AddMoreUploadFieldsImg" alt="$ADD_MORE_FILES$" border="0" style="margin-top: 0; padding-left: 0;"/><span class="ui-button-text">$ADD_MORE_FILES$</span></button></div><ul id="AdHocRemoteLocalMenu" style="display: none; width: auto;min-width: 150px;"><li id="AdHocLocalBrowseOption"><a href="#AdHocBrowseOption" class="ActionOption" data-handler=""><span class="Action-ico"><img src="%COMMON_FILE%Images/FileShare16.png" class="SUWCActionico" alt="$LOCAL_FILE_BROWSE$" border="0" /></span>$LOCAL_FILE_BROWSE$</a></li><li id="AdHocRemoteBrowseOption"><a href="#AdHocBrowseOption" class="ActionOption" data-handler=""><span class="Action-ico"><img src="%COMMON_FILE%Images/su16x16.png" class="SUWCActionico" alt="$REMOTE_FILE_BROWSE$" border="0" /></span>$REMOTE_FILE_BROWSE$</a></li></ul><script type="text/javascript" language="JavaScript">var bIsMSIE=(GetIEMajorVersionNumber()>0);var g_nNextTransferID=1;var MAX_UPLOAD_ROWS=20;
var g_nMaxUploadRows=MAX_UPLOAD_ROWS;function SetMaxUploadRows(nMaxUploadRows){if(nMaxUploadRows>0&&nMaxUploadRows<MAX_UPLOAD_ROWS)g_nMaxUploadRows=nMaxUploadRows;else g_nMaxUploadRows=MAX_UPLOAD_ROWS;}function OnLocalFileBrowse(nRow){document.getElementById(GetFileInputID(nRow)).click();}function SetRemoteFilePath(sInputVal,nRow,nSize){OnChangeFile(document.getElementById(GetRemoteInputID(nRow)),nRow,1,nSize);document.getElementById("fakePath-"+GetFileInputID(nRow)).innerHTML=GetFileName(sInputVal,true);}function OnRemoteFileBrowse(nRow){LoadDynamicContentAndRun(["$BROWSE_DIR_PATH$","BrowseDialogDiv",String("OnBrowse("),[GetRemoteInputID(nRow),true,0,0,SetRemoteFilePath,false,nRow]]);}function GetNumOfRows(){var nNumOfRows=0;var rListObj=document.getElementById('MultiUploadList');if(rListObj!=undefined&&rListObj!=null){var arListItems=$("#MultiUploadList li");if(arListItems!=null&&arListItems!=undefined)nNumOfRows=arListItems.length;if(nNumOfRows<0)nNumOfRows=0;}return(nNumOfRows);}function GetListItemID(nRow){return("MultiUploadRow_"+nRow);}function GetFileInputID(nRow){return("MultiUploadFileInput_"+nRow);}function GetRemoteInputID(nRow){return("MultiUploadRemoteFileInput_"+nRow);}function GetFormElements(nRow){var sHTML="";if(nRow>-1){var sInput=GetFileInputID(nRow);sHTML='<input class="multiUploadFileInputHidden" id="'+sInput+'" name="'+sInput+'" type="file"/>';sHTML+='<input id="'+GetRemoteInputID(nRow)+'" type="hidden"/>';}return(sHTML);}function GetFormElement_RemoveBtn(nRow,sSrc,bIncludeOnClick){var sHTML="";if(nRow>-1&&sSrc!=undefined&&sSrc!=null&&sSrc!=""){if(bIncludeOnClick)sHTML='<img class="uploadColFormResetImg showHandCursor" width="16" height="16" src="'+sSrc+'" onclick="ClearInputFile('+nRow+');" />';else sHTML='<img class="uploadColFormResetImg" width="16" height="16" src="'+sSrc+'" />';}return(sHTML);}function InsertMultiUploadFields(){SetElementDisabledState(["AddMoreUploadFields"],false);$("#AddMoreUploadFields").show();var rListObj=document.getElementById('MultiUploadList');if(rListObj!=undefined&&rListObj!=null){var nNumOfRows=GetNumOfRows();if(nNumOfRows<g_nMaxUploadRows){var nNumOfRowsToAdd=5;if(g_nMaxUploadRows<(nNumOfRowsToAdd+nNumOfRows))nNumOfRowsToAdd=(g_nMaxUploadRows-nNumOfRows);for(var nRow=nNumOfRows;nRow<(nNumOfRows+nNumOfRowsToAdd);nRow++){var sLi=GetListItemID(nRow);var sForm="MultiUploadForm_"+nRow;var sFrame="MultiUploadHiddenResponseForm_"+nRow;var fakeFileUpload=document.createElement('div');fakeFileUpload.className='fakefile';fakeFileUpload.id='fakefile';sinput=document.createElement('div');sinput.className='fakefileinput';sinput.id='fakefileinput';fakeFileUpload.appendChild(sinput);var rLI=document.createElement("li");rLI.id=sLi;var sInnerHTML;sInnerHTML='<div class="uploadColLeft">'+(nRow+1)+'.</div>'+'<div class="uploadColRight">'+'<div class="uploadColForm">'+'<div class="multiUploadFileInput multiUploadFileInputBorder" >'+'<span id="fakePath-'+GetFileInputID(nRow)+'">$NO_FILE_SELECTED$</span>'+'<div class="uploadColFormResetDiv"></div>'+'</div>'+'<button id="fake-'+GetFileInputID(nRow)+'" style="margin:1px 0 0 10px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="RemoteLocalButton" type="button" role="button">'+'<span class="ui-button-text">$BROWSE$...</span>'+'</button>'+'<form class="uploadForm" id="'+sForm+'" method="post" enctype="multipart/form-data" encoding="multipart/form-data" target="'+sFrame+'">';sInnerHTML+=GetFormElements(nRow);sInnerHTML+='</form>'+'<iframe id="'+sFrame+'" name="'+sFrame+'" width="0" height="0" border="0" frameborder="0" scrolling="no"></iframe>'+'</div>'+'<div style="clear: both;"></div>'+'<div class="uploadRowStatus">'+'<img class="uploadRowStatusImg" width="16" height="16" src="%COMMON_FILE%Images/blank.gif" />'+'<div class="uploadRowStatusTxt"></div>'+'<div style="clear: both;"></div>'+'</div>'+'</div><div style="clear: both;"></div>';rLI.innerHTML=sInnerHTML;rListObj.appendChild(rLI);document.getElementById(GetFileInputID(nRow)).onchange=(function(nCurrRow){var nThisRow=nCurrRow;return function(){var sInputVal=this.value;$("#fakePath-"+GetFileInputID(nThisRow)).html(GetFileName(sInputVal,true));$("#"+GetRemoteInputID(nThisRow)).val("");if(bIsMSIE){$(".ui-contextmenu").hide();ShowHideLocalInput(nThisRow,false);}OnChangeFile(this,nThisRow,0);};}(nRow));if(g_bOutgoingWiz){$("#fake-"+GetFileInputID(nRow)).contextMenu({"menu":"AdHocRemoteLocalMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":(function(nCurrRow){var nThisRow=nCurrRow;return function(){$("#AdHocLocalBrowseOption a").attr("data-handler","javascript:OnLocalFileBrowse("+nThisRow+");");$("#AdHocRemoteBrowseOption a").attr("data-handler","javascript:OnRemoteFileBrowse("+nThisRow+");");if(bIsMSIE){ShowHideLocalInput(nThisRow,true);}$("#AdHocRemoteLocalMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});if(bIsMSIE){$("#"+GetFileInputID(nThisRow)).bind('mouseenter',function(){$("body").unbind("mouseup");$(document).unbind('click');$("#AdHocLocalBrowseOption").find('A').trigger("mouseover");});}if(bIsMSIE){$("#"+GetFileInputID(nThisRow)).bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});$("#AdHocLocalBrowseOption").find('A').trigger("mouseout");});}$("#AdHocRemoteLocalMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide();if(bIsMSIE)ShowHideLocalInput(nThisRow,false);});});};}(nRow)),"beforehide":(function(nCurrRow){var nThisRow=nCurrRow;return function(){$("body").unbind("mouseup");if(bIsMSIE)ShowHideLocalInput(nThisRow,false);};}(nRow))});}else{if(bIsMSIE)ShowHideLocalInput(nRow,true,bIsMSIE);else{$("#fake-"+GetFileInputID(nRow)).bind('click',(function(nCurrRow){var nThisRow=nCurrRow;return function(){OnLocalFileBrowse(nThisRow);};}(nRow)));}}var sTransferObjTxt='{"'+TRANSFER_FILE_NAME+'":""';sTransferObjTxt+=',"'+TRANSFER_ROW_NUMBER+'":'+nRow;sTransferObjTxt+=',"'+TRANSFER_ID+'":-1';sTransferObjTxt+=',"'+TRANSFER_FILE_SIZE+'":0';sTransferObjTxt+=',"'+TRANSFER_STATUS+'":'+TRANSFER_STATUS_EMPTY;sTransferObjTxt+=',"'+TRANSFER_RESULT+'":-1';sTransferObjTxt+=',"'+TRANSFER_RESULT_TEXT+'":""';sTransferObjTxt+=',"'+TRANSFER_VIRTUAL+'":-1';sTransferObjTxt+='}';var rTransferObj=jQuery.parseJSON(sTransferObjTxt);if(rTransferObj!=null&&rTransferObj!=undefined&&g_aTransfersMappedToRowNum!=undefined)g_aTransfersMappedToRowNum[nRow]=rTransferObj;}nNumOfRows+=nNumOfRowsToAdd;}if(nNumOfRows>=g_nMaxUploadRows){SetElementDisabledState(["AddMoreUploadFields"],true);$("#AddMoreUploadFields").hide();}}}function ShowHideLocalInput(nRow,bShow,bIsMSIE){if(bShow&&g_nOutgoingSource!=2){$("#"+GetFileInputID(nRow)).css("position","absolute");$("#"+GetFileInputID(nRow)).zIndex(($("#AdHocRemoteLocalMenu").zIndex()+1));$("#"+GetFileInputID(nRow)).css("left",$("#fake-"+GetFileInputID(nRow)).offset().left+"px");if(!g_bOutgoingWiz&&bIsMSIE){$("#"+GetFileInputID(nRow)).css("top",($("#fake-"+GetFileInputID(nRow)).offset().top+$("#fake-"+GetFileInputID(nRow)).innerHeight()-3)+"px");$("#"+GetFileInputID(nRow)).css("width",($("#fake-"+GetFileInputID(nRow)).outerWidth())+"px");$("#"+GetFileInputID(nRow)).css("height",($("#fake-"+GetFileInputID(nRow)).outerHeight())+"px");$("#"+GetFileInputID(nRow)).css("cursor","pointer");$("#"+GetFileInputID(nRow)).bind('mouseenter',function(){$("#fake-"+GetFileInputID(nRow)).addClass("hovered");});$("#"+GetFileInputID(nRow)).bind('mouseleave',function(){$("#fake-"+GetFileInputID(nRow)).removeClass("hovered");});}else{$("#"+GetFileInputID(nRow)).css("top",($("#fake-"+GetFileInputID(nRow)).offset().top+$("#fake-"+GetFileInputID(nRow)).outerHeight())+"px");$("#"+GetFileInputID(nRow)).css("width","157px");$("#"+GetFileInputID(nRow)).css("height","26px");$("#"+GetFileInputID(nRow)).css("cursor","pointer");}$("#"+GetFileInputID(nRow)).css("font-size","118px");$("#"+GetFileInputID(nRow)).css("overflow","hidden");}else{$("#"+GetFileInputID(nRow)).css("position","relative");$("#"+GetFileInputID(nRow)).css("width","2px");$("#"+GetFileInputID(nRow)).css("height","2px");}}function GetNextTransferID(){return(g_nNextTransferID++);}function GetElementID_RightCol(nRow){return("$NAME_OF_MULTI_UPLOAD_STATUS_MSG$_"+nRow);}function GetForm(rTransferObj){return(GetFormByRow(rTransferObj[TRANSFER_ROW_NUMBER]));}function GetFormByRow(nRow){return(document.getElementById("MultiUploadForm_"+nRow));}function GetInputField(rTransferObj){return(GetInputFieldByRow(rTransferObj[TRANSFER_ROW_NUMBER]));}function GetInputFieldByRow(nRow){return(document.getElementById(GetFileInputID(nRow)));}function GetRemoteInputField(rTransferObj){return(GetRemoteInputFieldByRow(rTransferObj[TRANSFER_ROW_NUMBER]));}function GetRemoteInputFieldByRow(nRow){return(document.getElementById(GetRemoteInputID(nRow)));}function GetHiddenIFrame(rTransferObj){return(document.getElementById("MultiUploadHiddenResponseForm_"+rTransferObj[TRANSFER_ROW_NUMBER]));}function ResetTransferObj(rTransferObj){if(rTransferObj!=null&&rTransferObj!=undefined){rTransferObj[TRANSFER_FILE_NAME]="";rTransferObj[TRANSFER_ID]=-1;rTransferObj[TRANSFER_VIRTUAL]=-1;SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_EMPTY);rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";}else ASSERT("ResetTransferObj: Programming error, invalid source or transfer obj.");}function OnChangeFile(eventSource,nRow,bIsVirtual,nSize){var rTransferObj=GetTransferObjByRow(nRow);if(eventSource!=undefined&&rTransferObj!=null&&rTransferObj!=undefined&&bIsVirtual!=undefined){var sFileName=eventSource.value;if(sFileName!=undefined&&sFileName!=null&&sFileName!=""){sFileName=encodeURIComponent(sFileName);rTransferObj[TRANSFER_FILE_NAME]=sFileName;rTransferObj[TRANSFER_ID]=-1;SetRowState(nRow,TRANSFER_STATUS_HAS_FILENAME);rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";rTransferObj[TRANSFER_VIRTUAL]=bIsVirtual;if(bIsVirtual)rTransferObj[TRANSFER_FILE_SIZE]=nSize;}else ResetTransferObj(rTransferObj);}else ASSERT("OnChangeFile: Programming error, invalid source or transfer obj.");CheckForDuplicateFileNames(null,nRow,bIsVirtual);}function OnSubmitFiles(){m_nNumOfTransfers=0;var rListObj=document.getElementById('MultiUploadList');if(rListObj!=undefined){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){var rForm=GetForm(rTransferObj);var rFormsTargetFrame=GetHiddenIFrame(rTransferObj);var rFileInput=GetInputField(rTransferObj);var sFileInputName=rFileInput.value;var sFileName=decodeURIComponent(rTransferObj[TRANSFER_FILE_NAME]);var nStatus=rTransferObj[TRANSFER_STATUS];if(nStatus!=TRANSFER_STATUS_SUCCESS){rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";var bCanSubmitForm=false;if(rTransferObj[TRANSFER_VIRTUAL]==1){if(sFileName!=undefined&&sFileName!=null&&sFileName!=""){bCanSubmitForm=true;}}else{rTransferObj[TRANSFER_FILE_SIZE]=0;if(sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!=""){if(sFileInputName==sFileName){bCanSubmitForm=true;}else{ASSERT("Cannot submit form because the transfer object does not match the form input.");}}else{if(sFileInputName!=sFileName)ASSERT("Cannot submit form data because the transfer object does not match the form input.");}}if(bCanSubmitForm){rTransferObj[TRANSFER_ID]=GetNextTransferID();m_nNumOfTransfers++;if(SubmitForm(rForm,rFormsTargetFrame,sFileName,rTransferObj[TRANSFER_ID],rTransferObj[TRANSFER_VIRTUAL]))SetRowState(nRow,TRANSFER_STATUS_PENDING);else SetRowState(nRow,TRANSFER_STATUS_FAILURE);}}}else ASSERT("Cannot submit form because the transfer object could not be found for this row.");}}else ASSERT("Cannot submit upload request(s) because no rows exist.");}}function SubmitForm(rForm,rFormsTargetFrame,sFileName,nTransferID,bIsVirtual){var bSubmitted=false;if(rForm!=null&&rForm!=undefined&&rFormsTargetFrame!=null&&rFormsTargetFrame!=undefined&&sFileName!=undefined&&sFileName!=null&&sFileName!=""&&nTransferID>0){if(bIsVirtual==undefined||bIsVirtual==null)bIsVirtual=0;var sAction="%FILE%Share/MultipleFileUploadResult.htm?Command=UploadFileShare&TransferID="+nTransferID+"&File="+encodeURIComponent(sFileName)+"&ShareToken="+g_sShareToken+"&IsVirtual="+bIsVirtual+'&CsrfToken='+"%ENC_CSRF_TOKEN%";rForm.setAttribute("action",sAction);rFormsTargetFrame.onload=null;rFormsTargetFrame.src="%FILE%Share/MultipleFileUploadResetFrame.htm";rForm.submit();bSubmitted=true;}else ASSERT("Cannot submit form because function parameters are invalid.");return(bSubmitted);}function OnReceiveUploadResponse(rTransferObj){if(rTransferObj!=undefined&&rTransferObj!=null){var nRowNum=rTransferObj[TRANSFER_ROW_NUMBER];if(nRowNum>-1){SetRowState(nRowNum,TRANSFER_STATUS_SUCCESS);var iFrameObj=GetHiddenIFrame(rTransferObj);var rDoc=(iFrameObj.contentWindow||iFrameObj.contentDocument);try{if(rDoc.document)rDoc=rDoc.document;}catch(e){rDoc=null;}if(rDoc!=undefined&&rDoc!=null){var rResultDiv=rDoc.getElementById("Result");var rSizeDiv=rDoc.getElementById("StoredFileSize");var rNameDiv=rDoc.getElementById("StoredFileName");if(rResultDiv!=undefined&&rResultDiv!=null&&rSizeDiv!=undefined&&rSizeDiv!=null&&rNameDiv!=undefined&&rNameDiv!=null){var nResult=rResultDiv.innerHTML;var nSize=rSizeDiv.innerHTML;var nName=rNameDiv.innerHTML;if(nResult==undefined||nResult==null||nResult==0){if(nSize!=null&&nSize!=undefined){nSize=parseInt(nSize);if(!isNaN(nSize))rTransferObj[TRANSFER_FILE_SIZE]=nSize;else if(rTransferObj[TRANSFER_VIRTUAL]==0)ASSERT("OnReceiveUploadResponse: Programming error, file size is not a number.");}else ASSERT("OnReceiveUploadResponse: Programming error, could not parse out file size from XML doc.");}}else{ASSERT("OnReceiveUploadResponse: Programming error, cannot handle the upload response because we couldn't find the row that corresponds to this transfer ID.  Is a timer is needed?");}}}else ASSERT("OnReceiveUploadResponse: Programming error, cannot handle the upload response because we couldn't find the row that corresponds to this transfer ID.");}}function UnlockAllRows(){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){rTransferObj[TRANSFER_ID]=-1;rTransferObj[TRANSFER_VIRTUAL]=-1;var sFileName=rTransferObj[TRANSFER_FILE_NAME];if(sFileName!=undefined&&sFileName!=null&&sFileName!="")SetRowState(nRow,TRANSFER_STATUS_HAS_FILENAME);else SetRowState(nRow,TRANSFER_STATUS_EMPTY);rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";}else ASSERT("ClearInputFile: Programming error, no object resides at this row!");}}}function ClearInputFile(nRow){if(nRow>-1){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){var rForm=GetFormByRow(nRow);var sFormElements=GetFormElements(nRow);rForm.innerHTML=sFormElements;ResetTransferObj(rTransferObj);$('#fakePath-'+GetFileInputID(nRow)).html("$NO_FILE_SELECTED$");$('#'+GetRemoteInputID(nRow)).val("");}else ASSERT("ClearInputFile: Programming error, no object resides at this row!");}else ASSERT("ClearInputFile: Programming error, invalid row number of span element!");CheckForDuplicateFileNames();}function IsFormValid(){var anNumOfFiles=new Array();var bDuplicatesFound=CheckForDuplicateFileNames(anNumOfFiles);g_bNoFilesToUpload=(anNumOfFiles[0]<1);return((!g_bNoFilesToUpload)&&(!bDuplicatesFound));}function IsDuplicateFileName(sCheckFileName,nExcludeRow,anFoundAt){var rListObj=document.getElementById('MultiUploadList');if(rListObj!=null&&rListObj!=undefined){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){if(nRow!=nExcludeRow){var sFileInputName=undefined;var rFileInput=GetInputFieldByRow(nRow);var rRemoteFileInput=GetRemoteInputFieldByRow(nRow);if(rFileInput.value!="")sFileInputName=rFileInput.value;else if(rRemoteFileInput.value!="")sFileInputName=rRemoteFileInput.value;if(sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!=""){sFileInputName=GetFileName(sFileInputName,true);if(sFileInputName==sCheckFileName){if(typeof(anFoundAt)!="undefined"&&anFoundAt!=undefined&&anFoundAt!=null&&anFoundAt.length>0)anFoundAt[0]=nRow;return(true);}}}}}}return(false);}function CheckForDuplicateFileNames(anNumOfFiles,nCallingRow,bIsVirtual){var bHasDuplicates=false;var nNumOfFilesToTransfer=0;var rListObj=document.getElementById('MultiUploadList');if(rListObj!=null&&rListObj!=undefined){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){var sFileInputName=undefined;var rFileInput=GetInputFieldByRow(nRow);var rRemoteFileInput=GetRemoteInputFieldByRow(nRow);if(rFileInput.value!="")sFileInputName=rFileInput.value;else if(rRemoteFileInput.value!="")sFileInputName=rRemoteFileInput.value;if(sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!=""){++nNumOfFilesToTransfer;sFileInputName=GetFileName(sFileInputName,true);if(IsDuplicateFileName(sFileInputName,nRow)){bHasDuplicates=true;if(typeof(nCallingRow)!="undefined"&&nCallingRow!=undefined&&nCallingRow!=null){if(nCallingRow==nRow)SetRowState(nRow,TRANSFER_STATUS_DUPLICATE);}else SetRowState(nRow,TRANSFER_STATUS_DUPLICATE);}else RemoveDuplicateState(nRow);}}}}if(typeof(anNumOfFiles)!="undefined"&&anNumOfFiles!=null&&anNumOfFiles!=undefined)anNumOfFiles[0]=nNumOfFilesToTransfer;if(typeof(g_fnOnStateChangeMultiUploadForm)!="undefined"&&g_fnOnStateChangeMultiUploadForm!=undefined&&g_fnOnStateChangeMultiUploadForm!=null)g_fnOnStateChangeMultiUploadForm();return(bHasDuplicates);}function RemoveDuplicateState(nRow){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=undefined&&rTransferObj!=null){var nStatus=rTransferObj[TRANSFER_STATUS];if(nStatus==TRANSFER_STATUS_DUPLICATE)SetRowState(nRow,TRANSFER_STATUS_HAS_FILENAME);}}function SetRowState(nRow,nState){var nCurObjState=-1;var sResultText="";var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=undefined&&rTransferObj!=null){nCurObjState=rTransferObj[TRANSFER_STATUS];if(nCurObjState!=nState)rTransferObj[TRANSFER_STATUS]=nState;sResultText=rTransferObj[TRANSFER_RESULT_TEXT];}if(nCurObjState!=nState){var sListItemID=GetListItemID(nRow);var sFileInputID=GetFileInputID(nRow);var sStatusMsg="";var sStatusImg="%COMMON_FILE%Images/blank.gif";var sStatusBorder="multiUploadFileInputBorder";var sResetImg=GetFormElement_RemoveBtn(nRow,"%FILE%Share/Images/icon_delete_file_uploaded.png",true);var bLockRow=false;var sDisableButton="";switch(nState){case TRANSFER_STATUS_HAS_FILENAME:{}break;case TRANSFER_STATUS_PENDING:{}break;case TRANSFER_STATUS_DUPLICATE:{sStatusMsg="$ADHOC_FILE_UPLOAD_DUPLICATE_FOUND$";sStatusImg="%FILE%Share/Images/icon_red_stop.png";sStatusBorder="multiUploadFileInputError";}break;case TRANSFER_STATUS_FAILURE:{sStatusMsg=sResultText;sStatusImg="%COMMON_FILE%Java/Images/Error16.png";sStatusBorder="multiUploadFileInputError";}break;case TRANSFER_STATUS_SUCCESS:{sResetImg=GetFormElement_RemoveBtn(nRow,"%COMMON_FILE%Images/Check16.png",false);bLockRow=true;sDisableButton="ui-state-disabled";}break;case TRANSFER_STATUS_EMPTY:default:{sResetImg="";}break;}var rFileInputResetDiv=$("#"+sListItemID).find(".uploadColFormResetDiv");if(rFileInputResetDiv!=undefined&&rFileInputResetDiv!=null)$(rFileInputResetDiv).html(sResetImg);var rRowStatusMsgDiv=$("#"+sListItemID).find(".uploadRowStatusTxt");if(rRowStatusMsgDiv!=undefined&&rRowStatusMsgDiv!=null)$(rRowStatusMsgDiv).text(sStatusMsg);var rRowStatusImg=$("#"+sListItemID).find(".uploadRowStatusImg");if(rRowStatusImg!=undefined&&rRowStatusImg!=null)$(rRowStatusImg).attr("src",sStatusImg);$("#"+sFileInputID).attr("disabled",bLockRow);$("#fake-"+GetFileInputID(nRow)).attr("disabled",bLockRow);$("#fake-"+GetFileInputID(nRow)).addClass(sDisableButton);document.getElementById(sFileInputID).onchange=(function(nCurrRow){var nThisRow=nCurrRow;return function(){var sInputVal=this.value;document.getElementById("fakePath-"+GetFileInputID(nThisRow)).innerHTML=GetFileName(sInputVal,true);if(bIsMSIE){$(".ui-contextmenu").hide();ShowHideLocalInput(nThisRow,false);}OnChangeFile(this,nThisRow,0);};}(nRow));}}function AreUploadsComplete(anInfo){var nNumOfFilesToUpload=0;var nNumOfFilesSuccessfullyUploaded=0;for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var sFileName=rTransferObj[TRANSFER_FILE_NAME];var nStatus=rTransferObj[TRANSFER_STATUS];if(sFileName!=null&&sFileName!=undefined&&sFileName!=""){++nNumOfFilesToUpload;if(nStatus==TRANSFER_STATUS_SUCCESS)++nNumOfFilesSuccessfullyUploaded;}}}}if(anInfo!=null&&anInfo!=undefined){anInfo[0]=nNumOfFilesToUpload;anInfo[1]=nNumOfFilesSuccessfullyUploaded;}return(nNumOfFilesToUpload>0&&nNumOfFilesToUpload==nNumOfFilesSuccessfullyUploaded);}</script><div class="ShareBottomBox"><div class="expireWarningDiv"><img src="%FILE%Share/Images/icon_warning.png" width="30" height="27" class="expireWarningImg" alt="$EXPIRES$" border="0" /></div><div class="ShareBottomBoxTxt"><div style="line-height: 14px;padding-top: 7px;" id="ShareDeleteInfo"></div></div></div></div><div id="Page2" style="display: none;"><div id="ulFileShareTable"></div><div style="width: auto;"><div id="AdhocSendMoreFilesInfo">$ADHOC_GUEST_UPLOAD_SEND_MORE_FILES_INFO$</div><button class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_blue" role="button" type="button" onclick="javascript: OnSendMoreFiles();" style="margin-left: 0px;"><span class="ui-button-text" style="color: white;">$ADHOC_GUEST_UPLOAD_SEND_MORE_FILES$&nbsp;&gt;&gt;</span></button><div style="margin-top: 18px;color:#B6B6B6">$ADHOC_GUEST_UPLOAD_OK_TO_CLOSE$</div></div></div><div class="justifyLeft" id="wizardBtmBttnFooter"><div class="wizardBtmBttns"><button id="wizBtnBack" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_gray" style="display: none;" autocomplete="off" role="button" type="button" onclick="javascript: OnPreviousPage();"><span class="ui-button-text" style="color: white;">&lt;&lt;&nbsp;<span id="wizBtnBackTxt">$ADHOC_WIZ_BTN_BACK$</span></span></button><button id="wizBtnNext" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_blue" role="button" type="button" autocomplete="off" onclick="javascript: OnNextPage();"><span class="ui-button-text" style="color: white;"><span id="wizBtnNextTxt">$ADHOC_WIZ_BTN_NEXT$</span><span id="wizBtnNextTxt2">&nbsp;&gt;&gt;</span></span></button><button id="wizBtnCancel" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_gray" role="button" autocomplete="off" type="button" onclick="javascript: OnCancelWizard();"><span id="wizBtnCancelTxt" class="ui-button-text" style="color: white;">$CANCEL$</span></button></div><div style="clear: both;"></div></div></div> </div> <div id="CommonFooter" class="AdhocFooter"><div class="copyright" id="FooterCopyright"><div class="footerDiv1"><a href="%PRODUCT_HOME%" target="_blank" rel="noopener noreferrer">%PRODUCT%</a> <span id="SUVersionNumber">%VERSION%</span> &copy; 1995 - %COPYRIGHT_END_YEAR% <a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer">%COMPANY_NAME_FORMAL%</a>&nbsp;$ALL_RIGHTS_RESERVED$</div></div></div></div><script type="text/javascript" language="JavaScript">function ChangePage(nPage){if(nPage>(PAGE_MAX-1))nPage=(PAGE_MAX-1);else if(nPage<0)nPage=0;g_nPage=nPage;switch(nPage){case 1:{document.getElementById("Page1").style.display="none";document.getElementById("Page2").style.display="block";}break;case 0:default:{document.getElementById("Page2").style.display="none";document.getElementById("Page1").style.display="block";}break;}LoadPageEx(nPage);}function ValidatePage(nPage){var bIsValid=IsShareTokenValid();if(bIsValid)bIsValid=IsFormValid();return(bIsValid);}function OnNextPage(){g_bNoFilesToUpload=false;if(ValidatePage(g_nPage)){var bCanChangePage=true;if(g_nPage==0){if(!AreUploadsComplete()){ShowProgressDialog();OnSubmitFiles();PollForStats(true);bCanChangePage=false;}}if(bCanChangePage)ChangePage(g_nPage+1);}else{if(g_bNoFilesToUpload)AlertDialog("$PLEASE_SELECT_FILE_UPLOAD_MOBILE$",true);else if(!IsShareTokenValid())AlertDialog("$ADHOC_INVALID_SHARE_TOKEN$");else AlertDialog("$ADHOC_WIZARD_ERR_GENERIC$");}}function OnPreviousPage(){ChangePage(g_nPage-1);}function OnCancelWizard(){ASSERT("OnCancelWizard - Programming error, we should never reach this b/c there's no CANCEL button shown to the user");}function OnSendMoreFiles(){OnPreviousPage();}function OnStateChangeMultiUploadForm(){var bChangeToContinue=false;var anInfo=new Array(2);AreUploadsComplete(anInfo);if(anInfo!=undefined&&anInfo!=null&&anInfo.length>=2){var nNumOfFilesToUpload=anInfo[0];var nNumOfFilesSuccessfullyUploaded=anInfo[1];bChangeToContinue=(nNumOfFilesToUpload>0&&nNumOfFilesToUpload==nNumOfFilesSuccessfullyUploaded);}var sNextBtnTxt="$ADHOC_WIZ_BTN_UPLOAD$";if(bChangeToContinue)sNextBtnTxt="$CONTINUE$";$('#wizBtnNextTxt').text(sNextBtnTxt);}function LoadPageEx(nPage){$('#wizBtnBack').css("display","none");$('#wizBtnCancel').css("display","none");SetElementDisabledState(["wizBtnBack"],true);SetElementDisabledState(["wizBtnCancel"],true);OnStateChangeMultiUploadForm();$('#wizBtnNext').css("display","inline");$('#wizardBtmBttnFooter').css("display","block");$("#topTitleDesc").removeClass("guestUploadSummaryBox");$("#CommentDiv").css("display","none");$(".titleDescBlock").css("margin-bottom","");var sTopTitle="";var sTopTitleStep="";var sTopTitleDesc="";var sSelectFileConstraintTxt="4GB";var nIEMaxUploadSize=4294967296;var bHaveFileSizeConstraint=false;switch(nPage){case 1:{$("#CommentDiv").css("display","none");$('#wizardBtmBttnFooter').css("display","none");sTopTitle="$ADHOC_UPLOAD_CONFIRM_TITLE$";$('#ulFileShareTable').empty();var nNumOfTransfers=0;for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var sFileName=rTransferObj[TRANSFER_FILE_NAME];if(sFileName!=null&&sFileName!=undefined&&sFileName!=""){++nNumOfTransfers;AddFileToUploadedList(rTransferObj,nNumOfTransfers);}}}}if(nNumOfTransfers>1){sTopTitleDesc="$ADHOC_CONFIRM_UPLOAD_OF_FILES_GUEST$";sTopTitleDesc=sTopTitleDesc.replace("$AdhocNumOfFiles",nNumOfTransfers);}else if(m_nNumOfTransfers==1)sTopTitleDesc="$ADHOC_CONFIRM_UPLOAD_OF_ONE_FILE_GUEST$";var dtNow=new Date();sTopTitleDesc=sTopTitleDesc.replace("$CurDate",toLocaleShortDateString(dtNow.getTime()));sTopTitleDesc=sTopTitleDesc.replace("$CurTime",toLocaleShortTimeString(dtNow.getTime()));var sSendMoreFilesInfo="$ADHOC_GUEST_UPLOAD_SEND_MORE_FILES_INFO$";sSendMoreFilesInfo=sSendMoreFilesInfo.replace("$AdhocSender",g_sFileShareUsername);$("#AdhocSendMoreFilesInfo").html(sSendMoreFilesInfo);$("#topTitleDesc").addClass("guestUploadSummaryBox");$(".titleDescBlock").css("margin-bottom","0px");}break;case 0:default:{sTopTitle="$ADHOC_GUEST_UPLOAD_TITLE$";sTopTitleDesc="$ADHOC_GUEST_UPLOAD_DESC$";var nMillis=SecsToMillis(g_sFileShareExpires);if(nMillis!=SecsToMillis(DATE_MAX)){sTopTitleDesc=sTopTitleDesc.replace("$AdhocExpiresDate",toLocaleShortDateString(nMillis));sTopTitleDesc=sTopTitleDesc.replace("$AdhocExpiresTime",toLocaleShortTimeString(nMillis));if(new Date().getTime()>=nMillis)$(".ShareBottomBox").css("display","block");}else sTopTitleDesc="$ADHOC_GUEST_UPLOAD_DESC_NO_EXPIRE$";if(g_nFileShareSizeLimit>0){var sFileSizeLimit="$ADHOC_GUEST_UPLOAD_FILE_SIZE_LIMIT$";var nSizeLimit=FormatFileSize(g_nFileShareSizeLimit);sFileSizeLimit=sFileSizeLimit.replace("$MaxFileSize",nSizeLimit);sTopTitleDesc+=" "+sFileSizeLimit;sSelectFileConstraintTxt=nSizeLimit;bHaveFileSizeConstraint=true;}if(g_sFileShareComments!=""){var sCommentTitle="$ADHOC_COMMENTS_FROM_SENDER$";var sComment=decodeURIComponent(g_sFileShareComments.replace(eval("/\\%/g"),"%25"));sCommentTitle=sCommentTitle.replace("$AdhocSender",g_sFileShareUsername);$('#CommentTitle').html(sCommentTitle);$("#CommentDesc").text(sComment.replace(eval("/\\&#x25/g"),"%"));$('#CommentDiv').css("display","block");}}break;}$("#topTitle").html(sTopTitle);$("#topTitleStep").html(sTopTitleStep);$("#topTitleDesc").html(sTopTitleDesc);$("#ShareDeleteInfo").html("$ADHOC_GUEST_EXPIRED_OWNER_NOTICE$");if(g_sFileShareEmail!=""){$(".AdhocSender").html("<a href='mailto:"+g_sFileShareEmail+"'>"+g_sFileShareUsername+"</a>");}else $(".AdhocSender").html(g_sFileShareUsername);if(bHaveFileSizeConstraint||((navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.toLowerCase().indexOf('trident')!=-1)))$("#FileSizeContstrainTxt").html("($ADHOC_EACH_FILE_UP_TO$ "+sSelectFileConstraintTxt+" $ADHOC_IN_SIZE$)");}function LoadPage(){SetMaxUploadRows(g_nMaxNumOfFilesInRequestedShare);InsertMultiUploadFields();setTimeout("SendXMLHTTPNOOP()",NOOP_INTERVAL_IN_MILLIS);LoadPageEx(0);}if(document.getElementById("GuestCustomLogo"))LoadGuestCustomImage(g_bDisableBranding,g_bHasCustomLogo);$(document).ready(LoadPage);$("#BodyMain").css("display","block");</script></body></html>