var ONE_KB=(1024);var ONE_MB=(ONE_KB*ONE_KB);var ONE_GB=(ONE_MB*ONE_KB);var MAX_DAYS=30;var MAX_HOURS=24;var MIN_PWORD_LEN=8;var NUM_OF_MILLIS_IN_ONE_SEC=1000;var NUM_OF_MILLIS_IN_ONE_MIN=(NUM_OF_MILLIS_IN_ONE_SEC*60);var NUM_OF_MILLIS_IN_ONE_HOUR=(NUM_OF_MILLIS_IN_ONE_MIN*60);var NUM_OF_MILLIS_IN_ONE_DAY=(NUM_OF_MILLIS_IN_ONE_HOUR*24);var ZIP_TOKEN="";if(g_bInvalidSession)window.location.href=g_LoginStr+"&placement=3";var m_sBrowserTargetClass="";var nIEMajorVersionNum=GetIEMajorVersionNumber();if(nIEMajorVersionNum>-1){if(nIEMajorVersionNum<=7)m_sBrowserTargetClass="ua-msie7";else if(nIEMajorVersionNum<=8)m_sBrowserTargetClass="ua-msie8";else if(nIEMajorVersionNum<=9)m_sBrowserTargetClass="ua-msie9";else m_sBrowserTargetClass="ua-msie10";}if(m_sBrowserTargetClass!=null&&m_sBrowserTargetClass!=undefined&&m_sBrowserTargetClass!="")$("html").addClass(m_sBrowserTargetClass);function MillisToSecs(nMillis){if(typeof nMillis==='string')nMillis=parseInt(nMillis);return(nMillis/NUM_OF_MILLIS_IN_ONE_SEC);}function SecsToMillis(nSecs){if(typeof nSecs==='string')nSecs=parseInt(nSecs);return(nSecs*NUM_OF_MILLIS_IN_ONE_SEC);}function NumberOfDaysToMillis(nNumberOfDays){return(nNumberOfDays*NUM_OF_MILLIS_IN_ONE_DAY);}function NumberOfHoursToMillis(nNumberOfHours){return(nNumberOfHours*NUM_OF_MILLIS_IN_ONE_HOUR);}function GetNodesByXPath(XMLDoc,sXPath){var aNodes;if(XMLDoc){if(typeof(document.createNSResolver)!='undefined')aNodes=SelectNodesByXPath(XMLDoc,XMLDoc,sXPath);else aNodes=XMLDoc.selectNodes(sXPath);}return(aNodes);}function SelectNodesByXPath(XMLDoc,oNode,sXPath){var aNodes=new Array();var oNSResolver=XMLDoc.createNSResolver(XMLDoc.documentElement);var aItems=XMLDoc.evaluate(sXPath,oNode,oNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var i=0;i<aItems.snapshotLength;i++)aNodes[i]=aItems.snapshotItem(i);return(aNodes);}function GetXMLNodeValue(XMLDoc,sNodeXPath,sValueName){var oNodes=GetNodesByXPath(XMLDoc,sNodeXPath);if((oNodes)&&(oNodes.length))return(GetXMLValueByNode(XMLDoc,oNodes[0],sValueName));else return("");}function GetXMLNodeValueInt(XMLDoc,sNodeXPath,sValueName){return(parseInt(GetXMLNodeValue(XMLDoc,sNodeXPath,sValueName)));}function GetXMLValueByNode(XMLDoc,oNode,sValueName){var sValueXPath=("./@"+sValueName),sValue="";if(typeof(document.createNSResolver)!='undefined'){var aNodes=SelectNodesByXPath(XMLDoc,oNode,sValueXPath);if(aNodes.length)sValue=aNodes[0].textContent;else sValue=undefined;}else{var SelectedNode=oNode.selectSingleNode(sValueXPath);if(SelectedNode)sValue=SelectedNode.text;else sValue=undefined;}return(sValue);}function ASSERT(sMsg){}function ASSERT_CONSOLE(sMsg){}function GetCheckedState(sElementID){var sState=GetCheckedStateAsString(sElementID);return((sState=="0")?false:true);}function GetCheckedStateAsString(sElementID){var sIsChecked=document.getElementById(sElementID).checked;var sRetVal="1";if((sIsChecked==null)||(sIsChecked==undefined)||(sIsChecked=="false")||(sIsChecked==0)||(sIsChecked=="0"))sRetVal="0";return(sRetVal);}function ExtractEmailAddresses(sExtractFrom){return(sExtractFrom.match(/([a-zA-Z0-9/'._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi));}function IsValidEmailAddressString(sEmailAddress){var bIsValid=true;var sEmailFilter=eval("/^([A-Za-z0-9_\\s\\-\\.\\'])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,63})$/");if(!sEmailFilter.test(sEmailAddress))bIsValid=false;return(bIsValid);}function IsEmptyValue(objSelector){var bIsEmpty=true;if(objSelector!=undefined){var sText=objSelector.val();if(sText!=undefined&&sText!=null&&sText!=""&&sText.length>0)bIsEmpty=false;}return(bIsEmpty);}function TurnOnErrorStates(arElements){if(arElements!=undefined&&arElements!=null){for(var nIdx=0;nIdx<arElements.length;nIdx++){TurnOnErrorState(arElements[nIdx]);}}}function TurnOffErrorStates(arElements){if(arElements!=undefined&&arElements!=null){for(var nIdx=0;nIdx<arElements.length;nIdx++){TurnOffErrorState(arElements[nIdx]);}}}function TurnOnErrorState(objDomElement){if(objDomElement!=undefined){if(objDomElement.is('input')||objDomElement.is('ul'))objDomElement.css("border","1px solid #B03232");else objDomElement.css("color","#B03232");}}function TurnOffErrorState(objDomElement){if(objDomElement!=undefined){if(objDomElement.is('input')||objDomElement.is('ul'))objDomElement.css("border","1px solid #E9E9E9");else objDomElement.css("color","#666666");}}function SetElementDisabledState(aElements,bDisable){if(aElements!=undefined&&aElements!=null){for(var nPos=0;nPos<aElements.length;nPos++){if(bDisable)$("#"+aElements[nPos]).attr('disabled','disabled');else $("#"+aElements[nPos]).removeAttr('disabled','');}}}function AddFileToUploadedList(rTransferObj,nRowNum){var rElement=$('#ulFileShareTable');if(rElement!=undefined&&rElement!=null&&rTransferObj!=null&&rTransferObj!=undefined){var sFileName=rTransferObj[TRANSFER_FILE_NAME];var nFileSize=rTransferObj[TRANSFER_FILE_SIZE];sFileName=GetFileName(sFileName,true);var sClassName="aw-image-";sClassName+=GetFileIcon(sFileName.substr(sFileName.lastIndexOf(".")+1));var sRowClass="fileRow";if(((nRowNum-1)% 2)==0)sRowClass+=" rowShareEven";else sRowClass+=" rowShareOdd";var rDiv='<div class="'+sRowClass+'">'+'<div class="fileColNum">'+nRowNum+'</div>'+'<div class="fileColImg '+sClassName+'"></div>'+'<div class="fileColName">'+sFileName+'</div>'+'<div class="fileColSize">'+FormatFileSize(nFileSize,true)+'</div>'+'</div>';rElement.html(rElement.html()+rDiv);}else ASSERT("AddFileToUploadedList: Programming error, invalid parameters.");}function FormatTimestampForDate(nTimestampInSecs){return(toLocaleShortDateString(SecsToMillis(nTimestampInSecs)));}function FormatTimestampForTime(nTimestampInSecs){return(toLocaleShortTimeString(SecsToMillis(nTimestampInSecs)));}function FormatTimestampForDateTime(nTimestampInSecs){var sReturn=IDS_FMT_TIMESTAMP_FOR_DATE_TIME;sReturn=sReturn.replace("$Date",FormatTimestampForDate(nTimestampInSecs));sReturn=sReturn.replace("$Time",FormatTimestampForTime(nTimestampInSecs));return(sReturn);}function SendToConsolePage(){window.location.href=(g_sAbsSharePath+"/Console.htm");}function SendToOutgoingWizardPage(){window.location.href=(g_sAbsSharePath+"/OutgoingWizard.htm");}function SendToIncomingWizardPage(){window.location.href=(g_sAbsSharePath+"/IncomingWizard.htm");}function DeleteFileShare(sReqFilePath,sShareToken,fnOnResponse,objResponseData){var bSentReq=false;if(sReqFilePath!=null&&sReqFilePath!=undefined&&sReqFilePath!=""&&sShareToken!=null&&sShareToken!=undefined&&sShareToken!=""){var DeleteFileShareRequest=createXMLHttpRequest("POST",(sReqFilePath+"?Command=DeleteFileShare&ShareToken="+sShareToken),fnOnResponse,objResponseData);DeleteFileShareRequest.send(null);bSentReq=true;}else ASSERT("Common.DeleteFileShare - Programming error, invalid parameters.");return(bSentReq);}function OnDeleteFileShare(sShareToken,fnCallback,objCallbackData){return(DeleteFileShare((g_sAbsFilePath+"Result.xml"),sShareToken,fnCallback,objCallbackData));}function EmailFileShareURL(sReqFilePath,sShareToken,sPassword,sIncludePasswordInEmail,fnOnResponse){var bSentReq=false;if(sReqFilePath!=null&&sReqFilePath!=undefined&&sReqFilePath!=""&&sShareToken!=null&&sShareToken!=undefined&&sShareToken!=""){var request=new AjaxRequest();request.SetUrlParameter("Command","SendFileShareInvitation");request.SetPostParameter("ShareToken",sShareToken);request.SetPostParameter("IncludePasswordInEmail",sIncludePasswordInEmail);request.SetPostParameter("Password",sPassword);request.Post("/",fnOnResponse);bSentReq=true;}return(bSentReq);}function FillSelectorWithOptions(nMaxValue,objSelector){if(objSelector!=null&&objSelector!=undefined){var asOptions=[];for(var nNextOpt=1;nNextOpt<=nMaxValue;nNextOpt++){asOptions.push('<option value="',nNextOpt,'">',nNextOpt,'</option>');}objSelector.html(asOptions.join(""));}}function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href=g_sAbsFilePath+"ListDir.htm";break;case(2):location.href=g_sCommonPath+"FVJVLoggedIn.htm";break;}}function OnDownloadFileShare(sShareToken,nShareSize,nNumFiles,sFileIndices){var sDownloadCommand="?Command=DownloadFileShare&ShareToken="+sShareToken+"&CsrfToken="+g_sEncXsrfToken;if(typeof sFileIndices!=="undefined")sDownloadCommand+="&FileToken="+sFileIndices;if(nNumFiles>1){PreparingDLDialog(true);ZIP_TOKEN=sShareToken;setTimeout(CheckZIPToken,200);}window.location.href=sDownloadCommand;}function CheckZIPToken(){if(readCookie("ZIPToken")==ZIP_TOKEN){ZIP_TOKEN="";createCookie("ZIPToken","",false,true);PreparingDLDialog(false);}else setTimeout(CheckZIPToken,200);}function CreateMailtoLink(sRecipients,sEmailSubject,sEmailBody,sShareURL,sUserName,sUserEmail,bCarbonCopyUser,sComments,sExpires,sPassword){var sMailtoLink="";if(sRecipients==null||sRecipients==undefined||sRecipients==IDS_UNDISCLOSED_RECIPIENTS)sRecipients="";if(sEmailSubject!=null&&sEmailSubject!=undefined&&sEmailSubject!=""&&sEmailBody!=null&&sEmailBody!=undefined&&sEmailBody!=""&&sShareURL!=null&&sShareURL!=undefined&&sShareURL!=""&&sExpires!=null&&sExpires!=undefined&&sExpires!=""){if(sUserName==null||sUserName==undefined)sUserName="";if(sComments==null||sComments==undefined)sComments="";if(sPassword==null||sPassword==undefined)sPassword="";sEmailSubject=encodeURIComponent(sEmailSubject);var regex=new RegExp("\\$FullName",'g');sEmailBody=sEmailBody.replace(regex,sUserName);regex=new RegExp("\\$FileShareExpires",'g');sEmailBody=sEmailBody.replace(regex,sExpires);var sInsertTxt=sShareURL;if(sPassword!=null&&sPassword!=undefined&&sPassword!=""){sInsertTxt=g_sFileShareUrlWithPwordText;regex=new RegExp("\\$AdhocShareURL",'g');sInsertTxt=sInsertTxt.replace(regex,sShareURL);regex=new RegExp("\\$AdhocSharePword",'g');sInsertTxt=sInsertTxt.replace(regex,encodeURIComponent(sPassword));}regex=new RegExp("\\$FileShareTokenURL",'g');sEmailBody=sEmailBody.replace(regex,sInsertTxt);regex=new RegExp("\\$FileShareComments",'g');sEmailBody=sEmailBody.replace(regex,sComments);regex=new RegExp('\r\n','g');sEmailBody=sEmailBody.replace(regex,'\n');regex=new RegExp('\n','g');sEmailBody=sEmailBody.replace(regex,'\r\n');sEmailBody=encodeURIComponent(sEmailBody);if(bCarbonCopyUser&&sUserEmail!=null&&sUserEmail!=undefined&&sUserEmail!="")sMailtoLink="mailto:"+sRecipients+"?subject="+sEmailSubject+"&body="+sEmailBody+"&bcc="+sUserEmail;else sMailtoLink="mailto:"+sRecipients+"?subject="+sEmailSubject+"&body="+sEmailBody;}else ASSERT("CreateMailtoLink:  Programming error, invalid args.");return(sMailtoLink);}function EnableButtonEx(rBtn,bEnable){if(!bEnable){rBtn.attr("disabled",true);rBtn.addClass("button_disabled");}else{rBtn.removeAttr("disabled");rBtn.removeClass("button_disabled");}}function EnableButton(rBtn){EnableButtonEx(rBtn,true);}function DisableButton(rBtn){EnableButtonEx(rBtn,false);}function LoadGuestCustomImage(bDisableBranding,bHasCustomLogo){var CustomImg=new Image();var sCustomImgSrc="/%25LOGO_FILE%25"+g_sWebFilePath+"Share/Images/Serv-U-Logo-Text-small.png"+SyncRequestParameter();var nWidth="200";var nHeight="50";if(!bHasCustomLogo){nWidth="160";nHeight="40";}CustomImg.src=sCustomImgSrc;document.getElementById("GuestCustomLogo").src=CustomImg.src;document.getElementById("GuestCustomLogo").width=nWidth;document.getElementById("GuestCustomLogo").height=nHeight;}function UpdatePwordControls(){var bIsChecked=GetCheckedState("addPwordToFileShare");if(g_nRequirePasswordForGuests==0){var aDisabledElements=["FileSharePword","GeneratePword"];SetElementDisabledState(aDisabledElements,(!bIsChecked));}if(g_nInsertPasswordInEmailInvite==0){aDisabledElements=["addPwordToEmail"];SetElementDisabledState(aDisabledElements,(!bIsChecked));}if(g_bDisablePasswordGenerators){var aDisabledElements=["GeneratePword"];SetElementDisabledState(aDisabledElements,true);$("#GeneratePword").hide();$("#PwordBtnHint").hide();}if(!bIsChecked)TurnOffErrorState($("#FileSharePword"));}function IsValidPword(){var bIsValid=true;var bIsChecked=GetCheckedState("addPwordToFileShare");if(bIsChecked)bIsValid=(!IsEmptyValue($("#FileSharePword")));if(!bIsValid)TurnOnErrorState($("#FileSharePword"));else TurnOffErrorState($("#FileSharePword"));return(bIsValid);}function OnPwordProtectFile(){UpdatePwordControls();}function OnGeneratePword(){if(!g_bDisablePasswordGenerators){var sPassword=PasswordGen(MIN_PWORD_LEN);$("#FileSharePword").val(sPassword);}TurnOffErrorState($("#FileSharePword"));}function OnChangedSearchOpt(nOpt){var nRadioOpt=0;switch(nOpt){case(10):nRadioOpt=0;break;case(0):nRadioOpt=2;break;case(1):nRadioOpt=1;break;}$('input:radio[name=searchoptionradio]:nth('+nRadioOpt+')').prop('checked',true);var sTitle=g_sSearchInTxt+" ";if(nOpt==1)sTitle+=g_sSentFiles;else if(nOpt==0)sTitle+=g_sRequestFiles;else sTitle+=g_sBothFiles;$("#searchinput").attr("title",sTitle);}function SendSearch(){var sSearchString=$("#searchinput").val();var sSearchType=$("input:radio[name=searchoptionradio]:checked").val();if(sSearchString!="")location.href=g_sAbsSharePath+"/SearchShares.htm?Search="+sSearchString+"&ShareType="+sSearchType;}function SearchSetup(){$("#FSSearchOptionDrop").contextMenu({"menu":"FSSearchOptionMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#FSSearchOptionMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#FSSearchOptionMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});$("#searchinput").focus(function(){if($("#searchinput").val()==g_sSearchAction){$("#searchinput").val("");}$("#searchinput").css("color","#000000");});$("#searchinput").blur(function(){if($("#searchinput").val()==""){$("#searchinput").val(g_sSearchAction);$("#searchinput").css("color","#959595");}});$("#searchinput").css("color","#959595");}String.prototype.escapeSpecialChars=function(){return(this.replace(/[\\]/g,'\\\\').replace(/[\/]/g,'\\/').replace(/[\"]/g,'\\"').replace(/[\b]/g,'\\b').replace(/[\f]/g,'\\f').replace(/[\n]/g,'\\n').replace(/[\r]/g,'\\r').replace(/[\t]/g,'\\t'));};if(g_bIsDemo)AddOnloadEvent(SWIDemoFrame);if(navigator.userAgent.toLowerCase().indexOf('safari')!=-1){$(document).ready(function(){$("#IncomingSharesList, #OutgoingSharesList").css("width","100%");});}