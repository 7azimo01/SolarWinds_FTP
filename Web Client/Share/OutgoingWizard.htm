%PAGE_CHANGE%
<!--#include "..\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Strings.strings"-->
<!--#include "..\..\Common\Strings\Result.strings"-->
%PRIV_NORMAL%<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="ROBOTS" content="NOINDEX,NOFOLLOW"/><meta name="viewport" content="width=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/><meta name="mobileoptimized" content="0"/><meta name="format-detection" content="telephone=no"/><!-- PURPOSE:	Provides the Serv-U user with a way to create an "outgoing" file share for guests.Guests will then be able to download the files that the Serv-U user has shared with them. --><title>%LOGIN_PAGE_TITLE%</title><!--FILE:		ShareMacros.htmPURPOSE:	Provides the FileShare framework with some global macros.CREATED:	05/15/2013 - #dlb--><script type="text/javascript" language="JavaScript">var g_nSessionOkay=0;var g_sUnknownError="$UNKNOWN_ERROR$";var g_nSessionNotFound=6;var g_nSessionPending=9;var g_nSessionAborted=10;var g_sAdminPath="%ADMIN_FILE%";var g_sCommonPath="%COMMON_FILE%";var g_sAbsFilePath="%FILE%";var g_sFilePath=g_sAbsFilePath;var g_sWebFilePath=g_sAbsFilePath;var g_sAdminImagePath="%FILE%Images";var g_sAbsSharePath="%FILE%Share";var g_sAbsShareImagePath="%FILE%Share/Images";var g_sAdminXMLPath="%ADMIN_FILE%XML/";var g_sHomeStr="$HOME$";var g_LoginStr="%LOGIN%";var g_sHelpPath="%HELP_BASE_URL%";var g_bInvalidSession=(isNaN(parseInt("%USER_ID%"))||parseInt("%USER_ID%")<1);var g_bIsDemo=(parseInt("%IS_DEMO%")==1);var g_sFontOverride="";var g_sGB="$FS_ABBREV_GIGABYTE$";var g_sMB="$FS_ABBREV_MEGABYTE$";var g_sKB="$FS_ABBREV_KILOBYTE$";var g_sBytes="$FS_BYTES$";var g_sAjaxNotSupported="$ERR_AJAX_NOT_SUPPORTED$";var g_sFailedCmdNOOP="$ADHOC_FAILED_CMD_NOOP$";var g_sSearchAction="$SEARCH_ACTION$";var g_sSearchInTxt="$SEARCH_IN$";var g_sSentFiles="$ADHOC_CONSOLE_OUTGOING$";var g_sRequestFiles="$ADHOC_CONSOLE_INCOMING$";var g_sBothFiles="$ADHOC_CONSOLE_BOTH_SEARCH$";var SHARE_TYPE_INCOMING=0;var SHARE_TYPE_OUTGOING=1;var IDS_EXPIRED="$EXPIRED$";var IDS_FMT_TIMESTAMP_FOR_DATE_TIME="$FORMAT_TIMESTAMP_FOR_DATE_TIME$";var IDS_DOWNLOAD="$DOWNLOAD$";var IDS_DELETE="$DELETE$";var IDS_EMAIL_SUBJECT_HEAD="$ADHOC_FMT_EMAIL_SUBJECT$";var IDS_EXPIRES="$EXPIRES$";var IDS_NEVER="$NEVER$";var IDS_NEVER_EXPIRES="$NEVER_EXPIRES$";var IDS_FILE_SHARE_DOES_NOT_EXPIRE="$IDS_FILE_SHARE_DOES_NOT_EXPIRE$";var IDS_UNDISCLOSED_RECIPIENTS="$UNDISCLOSED_RECIPIENTS$";var DELETE_FILE_SHARE_DLG_WIDTH=300;var DELETE_FILE_SHARE_DLG_HEIGHT=200;var g_bAllowFVJV=(%ALLOW_FTP_VOYAGER_JV%==1);var g_bAdmin=(%IS_ADMIN%==1);var NOOP_INTERVAL_IN_MILLIS=55000;var TOOLTIP_SHOW_DELAY_IN_MILLIS=500;var TOOLTIP_SHOW_DURATION_IN_MILLIS=10;var TOOLTIP_HIDE_DELAY_IN_MILLIS=10;var TOOLTIP_HIDE_DURATION_IN_MILLIS=250;var g_nRequirePasswordForGuests=parseInt("%CUser.%USER_ID%.RequirePasswordForGuests%");var g_nInsertPasswordInEmailInvite=parseInt("%CUser.%USER_ID%.InsertPasswordInEmailInvite%");var g_ullMaxGuestUploadFileSize=parseInt("%CUser.%USER_ID%.MaxGuestUploadFileSize%");var g_bAllowUserDefinedGuestAccess=("%CUser.%USER_ID%.AllowUserDefinedGuestAccess%"=="1")?true:false;var g_ullRestrictGuestAccessDays=parseInt("%CUser.%USER_ID%.RestrictGuestAccessDays%");var g_nNotifyAfterGuestDownload=parseInt("%CUser.%USER_ID%.NotifyAfterGuestDownload%");var g_nNotifyAfterGuestUpload=parseInt("%CUser.%USER_ID%.NotifyAfterGuestUpload%");var g_nSendAccessLinkToRecipients=parseInt("%CUser.%USER_ID%.SendAccessLinkToRecipients%");var g_nSendAccessLinkToSender=parseInt("%CUser.%USER_ID%.SendAccessLinkToSender%");var g_bAllowCustomContactInfo=parseInt("%CUser.%USER_ID%.AllowCustomContactInfo%");var g_nMaxNumOfFilesInSentShare=parseInt("%CUser.%USER_ID%.AdHocMaxNumOfFilesInSentShare%");var g_nMaxNumOfFilesInRequestedShare=parseInt("%CUser.%USER_ID%.AdHocMaxNumOfFilesInRequestedShare%");var g_bDisablePasswordGenerators=("%CUser.%USER_ID%.DisablePasswordGenerators%"=="1")?true:false;var DATE_MAX=parseInt("0x7FFFFFFF",16);var DATE_MAX_MILLIS=(DATE_MAX*1000);var NUM_OF_DAYS_TO_EXPIRE_GUEST_ACCESS=7;var g_sEncXsrfToken="%ENC_CSRF_TOKEN%";</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BrowserCheckAW.js"></script><script type="text/javascript" language="JavaScript">if((%ALLOW_ADHOC_FILE_SHARING%!=1))location.href="%FILE%DisabledInterface.htm";var g_HTTPTitle="%LOGIN_PAGE_TITLE%";if(g_HTTPTitle=="")document.title="$GUEST_LOGIN_TITLE$";var g_nPage=0;var g_bOutgoingWiz=true;var g_dtPageLoadDate=new Date();g_dtPageLoadDate.setSeconds(0,0);var PAGE_MAX=3;var g_sUserName=decodeURIComponent("%CUser.%USER_ID%.FullNameOrLoginID%");var g_sUserEmail=decodeURIComponent("%CUser.%USER_ID%.EmailAddress%");var g_nOutgoingSource=parseInt(%CUser.%USER_ID%.AdHocAllowedOutgoingSource%);var g_sEmailBody=decodeURIComponent("%ADHOC_EMAIL_BODY_TEMPLATE%");var g_sEmailSubject=decodeURIComponent("%ADHOC_EMAIL_SUBJECT_TEMPLATE%");var g_sShareToken="";var g_sShareURL="";var g_sShareDateCreated="";var g_sFileShareUrlWithPwordText="$IDS_FILE_SHARE_URL_WITH_PASSWORD$";var m_sMailtoLink="";var g_bNoFilesToUpload=false;var asPreloadImgs=["%COMMON_FILE%Images/Busy.gif","%COMMON_FILE%Images/Check16.png","%FILE%Share/Images/Serv-U-Logo-Text-small.png","%FILE%Share/Images/icon_help.png","%FILE%Share/Images/icon_user_name_dropdown.png","%FILE%Share/Images/UsernameContextMenu.png","%FILE%Share/Images/icon_incoming.png","%FILE%Share/Images/icon_outgoing.png","%FILE%Share/Images/JumpToContextMenu.png","%FILE%Share/Images/icon_view_switch.png","%FILE%Share/Images/icon_view_switch_hover.png","%FILE%Share/Images/icon_uploading_folder.png","%FILE%Share/Images/icon_calendar.png","%FILE%Share/Images/icon_blue_circle_info.png","%FILE%Share/Images/icon_lock_button.png","%FILE%Share/Images/icon_add_more_files_button.png","%FILE%Share/Images/icon_delete_file_uploaded.png","%FILE%Share/Images/icon_red_stop.png","%FILE%Share/Images/ProgressBar.png","%FILE%Share/Images/ProgressFill.png"];for(var nIndex=0;(nIndex<asPreloadImgs.length);nIndex++){LoadingImg=new Image();LoadingImg.src=asPreloadImgs[nIndex];}</script><!--FILE:		MultiUploadMacros.htmPURPOSE:	Provides the FileShare framework with some global macros regarding multiple uploads.CREATED:	05/30/2013 - #dlb--><script type="text/javascript" language="JavaScript">var TRANSFER_FILE_NAME="FileName";var TRANSFER_ID="TransferID";var TRANSFER_ROW_NUMBER="RowNumber";var TRANSFER_FILE_SIZE="FileSize";var TRANSFER_STATUS="Status";var TRANSFER_RESULT="Result";var TRANSFER_RESULT_TEXT="ResultText";var TRANSFER_VIRTUAL="Virtual";var TRANSFER_STATUS_EMPTY=0;var TRANSFER_STATUS_HAS_FILENAME=1;var TRANSFER_STATUS_DUPLICATE=2;var TRANSFER_STATUS_PENDING=3;var TRANSFER_STATUS_FAILURE=4;var TRANSFER_STATUS_SUCCESS=5;var m_nTrackProgressIteration=-1;var m_nTrackFileSize=0;var g_aTransfersMappedToRowNum=new Object();var m_nNumOfTransfers=0;var m_bMoveToNextPageAfterProgressStats=false;var g_fnOnStateChangeMultiUploadForm=function(){OnStateChangeMultiUploadForm();};function ResetProgressCounters(bResetProgBar){m_nTrackProgressIteration=-1;m_nTrackFileSize=0;if(bResetProgBar!=undefined&&bResetProgBar)ResetProgressBar();}function GetTransferObjByRow(nRow){for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var nRowNum=rTransferObj[TRANSFER_ROW_NUMBER];if(nRowNum==nRow)return(rTransferObj);}}}return(null);}function GetTransferObjByID(nTransferID){for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var nID=rTransferObj[TRANSFER_ID];if(nID==nTransferID)return(rTransferObj);}}}return(null);}</script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.js"></script><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-ui.css" rel="stylesheet" /><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-ui.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jqueryfunctions.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-de.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-it.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-es.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-fi.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-fr.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-pt-BR.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-sv.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-no.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-da.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-ru.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-zh-CN.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-zh-TW.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-ja.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery.ui.datepicker-sr-SR.js"></script><link type="text/css" href="%COMMON_FILE%Style/jquery/jquery-contextMenu.css" rel="stylesheet" /><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/jquery-contextMenu.js" charset="utf-8"></script><link type="text/css" href="%COMMON_FILE%Scripts/jquery/TagIt/jquery.tagit.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Scripts/jquery/TagIt/tagit.ui-zendesk.css" rel="stylesheet" /><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/jquery/TagIt/tag-it.js" charset="utf-8"></script><link type="text/css" href="%COMMON_FILE%Style/Common.css" rel="stylesheet" /><link type="text/css" href="%FILE%Share/Style/Common.css" rel="stylesheet" /><link type="text/css" href="%COMMON_FILE%Style/CommonHeader.css" rel="stylesheet" /><link type="text/css" href="%FILE%Share/Style/CreationWizard.css" rel="stylesheet" /><!--[if lt IE 8]><link rel="stylesheet" type="text/css" href="%FILE%Share/Style/Common(-IE8).css" /><link rel="stylesheet" type="text/css" href="%FILE%Share/Style/CreationWizard(-IE8).css" /><![endif]--><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/BasicGrid.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/FileList.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/NaturalSort.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/functions.js"></script><script type="text/javascript" language="JavaScript" src="%COMMON_FILE%Scripts/XMLHTTPRequest.js"></script><script type="text/javascript" language="JavaScript" src="%FILE%Share/Scripts/ShortDateUtility.js"></script><script type="text/javascript" language="JavaScript" src="%FILE%Share/Scripts/Common.js"></script><script type="text/javascript" language="JavaScript" src="%FILE%Share/Scripts/CreationWizard.js"></script><style type="text/css">ul.tagit{margin: 2px 0px;}</style><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="JavaScript">BlankGif=new Image();BlankGif.src="%COMMON_FILE%Images/blank.gif";</script><!--[if lt IE 7]><script %CSP_NONCE_USAGE_ATTR% type="text/javascript" language="javascript">g_bIE7 = false;</script><style type="text/css">img, .ToolTipPointerCell, .TopPointer,.ToolTipLeftCornerBottom,.ToolTipRightCornerBottom {behavior: url("%COMMON_FILE%Scripts/pngbehavior.htc");}</style><![endif]--><div id="BrowseDialogDiv" style="display:none;"></div></head><body><div id="AlertDialog"><img id="AlertImage" border="0" width="32" height="32" style="margin-right:8px;float:left;"><span id="AlertDialogText"></span></div><script type="text/javascript" language="JavaScript">var g_fnAlertOKCallback=undefined;var sTitleHTML="<img src='%COMMON_FILE%Images/su16x16.png' width='16' height='16' border='0' class='dialogtitle' />%PRODUCT%";InformationImg=new Image();InformationImg.src="%COMMON_FILE%Images/Information.png";WarnImg=new Image();WarnImg.src="%COMMON_FILE%Images/Warn.png";BlankImg=new Image();BlankImg.src="%COMMON_FILE%Images/blank.gif";$("#AlertDialog").dialog({"autoOpen":false,"modal":true,"resizable":false,"title":sTitleHTML });function AlertDialogEx(sText,bWarn,fnOKCallback,sExtraButtonText,fnExtraCallback,sExtraButtonImageClass,bIncludeBtnIcons){var aoButtons=[{"text":"$OK_BUTTON$","click":OnAlertDialogOkay}];var $dialog=$("#AlertDialog");if((sExtraButtonText!=undefined)&&(fnExtraCallback!=undefined))aoButtons.push({"text":sExtraButtonText,"click":fnExtraCallback});$dialog.dialog("option","buttons",aoButtons);if(bIncludeBtnIcons!=undefined&&bIncludeBtnIcons!=null&&bIncludeBtnIcons)AddButtonsTojQueryDialog($dialog,["ui-icon-check",sExtraButtonImageClass]);var rCloseBtn=$("#AlertDialog").parent().find(".ui-dialog-titlebar button");if(rCloseBtn!=null&&rCloseBtn!=undefined){rCloseBtn.mouseover(function(){$(rCloseBtn).removeClass("ui-state-hover");});}var arBtns=$("#AlertDialog").parent().find(".ui-dialog-buttonpane button");if(arBtns!=null){$(arBtns[0]).mouseover(function(){$(arBtns[0]).removeClass("ui-state-hover");});$(arBtns[0]).addClass("button_blue confirmBtns");}if(fnOKCallback!=undefined)g_fnAlertOKCallback=fnOKCallback;if((bWarn!=undefined)&&(bWarn))sImage=WarnImg.src;else sImage=InformationImg.src;$("#AlertImage").attr("src",sImage);if(sText!=undefined)$("#AlertDialogText").html(sText);$dialog.dialog("open");}function AlertDialog(sText,bWarn,fnOKCallback,sExtraButtonText,fnExtraCallback,sExtraButtonImageClass){AlertDialogEx(sText,bWarn,fnOKCallback,sExtraButtonText,fnExtraCallback,sExtraButtonImageClass,true);}function WarnDialog(sText){AlertDialog(sText,true,undefined);}function OnAlertDialogOkay(){if(g_fnAlertOKCallback!=undefined)g_fnAlertOKCallback();$("#AlertDialog").dialog("close");$("#AlertImage").attr("src",BlankImg.src);g_fnAlertOKCallback=undefined;}</script><div id="BusyDialog" style="display:none;"><div style="position:absolute;top:50%;height:60px;margin-top:-30px;"><img src="%COMMON_FILE%Images/Busy.gif" border="0" style="float:left;padding-right:8px;" /><span id="BusyDialogText"></span></div></div><script type="text/javascript" language="JavaScript">var sTitleHTML="<img src='%COMMON_FILE%Images/su16x16.png' width='16' height='16' border='0' class='dialogtitle' />%PRODUCT%";$("#BusyDialog").dialog({"autoOpen":false,"modal":true,"title":sTitleHTML,"closeOnEscape":false,"resizable":false,"open":function(event,ui){$(".ui-dialog-titlebar-close",$(this).parent()).hide();}});function BusyDialog(bShow,sText){var $dialog=$("#BusyDialog");if(bShow){if(typeof sText!=="undefined")$("#BusyDialogText").text(sText);$(".ui-dialog-titlebar-close").tooltip({"disabled":true});$dialog.dialog("open");}else $dialog.dialog("close");}function LoadingDialog(bShow){BusyDialog(bShow,"$LOADING_DIALOG_TITLE$");}function PreparingDLDialog(bShow){BusyDialog(bShow,"$ADHOC_DOWNLOAD_PREPARING$");}</script><div id="ConfirmDialog"><div id="ConfirmDialogImg"></div><div id="ConfirmDialogText" style="overflow:hidden;text-overflow:ellipsis;"></div></div><script type="text/javascript" language="JavaScript">var g_fnYes=undefined,g_fnNo=undefined;var g_objYesNoData=undefined;$("#ConfirmDialog").dialog({"autoOpen":false,"modal":true,"resizable":false,"buttons":{"$YES_BUTTON$":OnConfirmDialogYes,"$NO_BUTTON$":OnConfirmDialogNo }});function ConfirmDialogEx(sTitleImgPath,sTitle,sTextImgPath,sText,fnYes,fnNo,objYesNoData,nWidth,nHeight,bFocusOnNoBttn){var objDialog=$("#ConfirmDialog");var sTitleHTML="";if(sTitleImgPath!=null&&sTitleImgPath!=undefined&&sTitleImgPath!="")sTitleHTML+="<img src='"+sTitleImgPath+"' width='16' height='16' border='0' class='dialogtitle' />";if(sTitle!=null&&sTitle!=undefined&&sTitle!="")sTitleHTML+=sTitle;else sTitleHTML+="%PRODUCT%";objDialog.dialog("option","title",sTitleHTML);if(sTextImgPath!=null&&sTextImgPath!=undefined&&sTextImgPath!=""){var sTextImgHTML="<img src='"+sTextImgPath+"' border='0' width='32' height='32' style='margin-right:8px;float:left;'>";$("#ConfirmDialogImg").html(sTextImgHTML);}if(sText!=undefined)$("#ConfirmDialogText").html(sText);if(nWidth!=undefined)objDialog.dialog("option","width",nWidth);if(nHeight!=undefined)objDialog.dialog("option","height",nHeight);if(typeof g_bIncludeConfirmIcons!="undefined"&&g_bIncludeConfirmIcons)AddButtonsTojQueryDialog($("#ConfirmDialog"),["ui-icon-check","ui-icon-cancel"]);var rCloseBtn=$("#ConfirmDialog").parent().find(".ui-dialog-titlebar button");if(rCloseBtn!=null&&rCloseBtn!=undefined){rCloseBtn.mouseover(function(){$(rCloseBtn).removeClass("ui-state-hover");});}var arBtns=$("#ConfirmDialog").parent().find(".ui-dialog-buttonpane button");if(arBtns!=null){$(arBtns[0]).mouseover(function(){$(arBtns[0]).removeClass("ui-state-hover");});$(arBtns[1]).mouseover(function(){$(arBtns[1]).removeClass("ui-state-hover");});$(arBtns[0]).addClass("button_blue confirmBtns");$(arBtns[1]).addClass("button_gray confirmBtns");}g_fnYes=fnYes;g_fnNo=fnNo;g_objYesNoData=objYesNoData;$(document).bind("keydown",function(event){var code=(event.keyCode||event.which);if(code==9){var objFocusElement=objDialog.parent().find(".ui-state-focus");if(objFocusElement.next().length)objFocusElement.next().focus(1);else objFocusElement.parent().children().first().focus(1);return(false);}else{var fnButtonCallback=undefined;var sKey=String.fromCharCode(code).toLowerCase();$.each(objDialog.dialog("option","buttons"),function(sButtonText,value){if(sButtonText.charAt(0).toLowerCase()==sKey){if(fnButtonCallback==undefined)fnButtonCallback=value;else{fnButtonCallback=undefined;return(false);}}});if(fnButtonCallback!=undefined){fnButtonCallback();return(false);}}return(true);});if(bFocusOnNoBttn)$("#ConfirmDialog").next(".ui-dialog-buttonpane").find(":button").eq(1).focus(1);objDialog.dialog("open");}function ConfirmDialog(sText,fnYes,fnNo,objYesNoData,nWidth,nHeight,bFocusOnNoBttn){ConfirmDialogEx("%COMMON_FILE%Images/su16x16.png","%PRODUCT%","%COMMON_FILE%Images/Information.png",sText,fnYes,fnNo,objYesNoData,nWidth,nHeight,bFocusOnNoBttn);}function CloseConfirmDialog(){g_fnYes=g_fnNo=g_objYesNoData=undefined;$(document).unbind("keydown");$("#ConfirmDialog").dialog("close");}function OnConfirmDialogYes(){if(g_fnYes!=undefined)g_fnYes(g_objYesNoData);CloseConfirmDialog();}function OnConfirmDialogNo(){if(g_fnNo!=undefined)g_fnNo(g_objYesNoData);CloseConfirmDialog();}</script><!--File:			UploadProgressDlg.htmPurpose:		Provides a widget that you can embed in a webpage that allows multiple files to be uploaded to the server concurrently.References:jQueryUI-Dialog: http://docs.jquery.com/UI/Dialog--><div id="ProgressDialog" style="display:none;"><div id="UploadInfo" class="uploadStats"><div id="progressDesc"></div><div id="progressblock"><table cellpadding="0" cellspacing="0"><tr><td><div class="progresscontainer"><div id="ProgressDiv" class="progressbar"></div></div></td><td class="colPercentComplete"><span id="percentcomplete">&nbsp;</span></td></tr></table></div></div></div><script type="text/javascript" language="JavaScript">$("#ProgressDialog").dialog({"autoOpen":false,"modal":true,"resizable":false,"buttons":{"$CANCEL$":OnCancelProgressDialog },"closeOnEscape":false });var m_Timer=null;var g_bCancelUpload=false;var g_sTransferIDsForStats="";var g_nUploadTimeout=0;var MAX_UPLOAD_TIMEOUT=10;var MIN_WIDTH=360;var MIN_HEIGHT=210;function StartTimer(fnCallback,nNumOfMillis){StopTimer();m_Timer=setTimeout(fnCallback,nNumOfMillis);}function StopTimer(){clearTimeout(m_Timer);}function CancelMultiTransferStatsResponse(objRequest){if((objRequest!=undefined)&&(objRequest.readyState==4)){if(objRequest.status==200){var XMLDoc=objRequest.responseXML;var arFiles=XMLDoc.getElementsByTagName('file');if(arFiles!=null&&arFiles!=undefined){var nNumOfFiles=arFiles.length;if(nNumOfFiles>0){var bContinueToPollForCancel=false;var rFile=null;var nResult=-1;var sResultText="";var nTransferID=-1;for(var nIdx=0;nIdx<nNumOfFiles;nIdx++){rFile=null;nResult=-1;sResultText="";nTransferID=-1;rFile=arFiles[nIdx];nResult=GetXMLValueInt(rFile,"Result");sResultText=GetXMLValue(rFile,"ResultText");nTransferID=GetXMLValueInt(rFile,"TransferID");if((!isNaN(nTransferID))&&(nTransferID>0)&&(!isNaN(nResult))&&(nResult>-1)){var rTransferObj=GetTransferObjByID(nTransferID);if(rTransferObj!=null&&rTransferObj!=undefined){if(nResult==g_nSessionPending)bContinueToPollForCancel=true;else if(nResult>g_nSessionOkay){rTransferObj[TRANSFER_FILE_SIZE]=0;rTransferObj[TRANSFER_RESULT]=nResult;rTransferObj[TRANSFER_RESULT_TEXT]=sResultText;SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_FAILURE);}else ASSERT_CONSOLE("PollForCancel: Don't cancel this file, it has already been successfully uploaded!");}else ASSERT_CONSOLE("PollForCancel: Programming error, Transfer object could not be found from Transfer ID ("+nTransferID+")");}else ASSERT_CONSOLE("PollForCancel: Programming error, TransferID or Result is an invalid number.");}if(bContinueToPollForCancel){StartTimer(function(){CancelUploads();},1000);}else{StartTimer(function(){CloseProgressDialog();},250);}}}}else ASSERT("UploadProgressDlg.CancelMultiTransferStatsResponse - HTTPCode is something other than 200 OK!");}}function CancelUploads(){g_bCancelUpload=true;if(g_sTransferIDsForStats!=null&&g_sTransferIDsForStats!=undefined&&g_sTransferIDsForStats!=""){var sCmd="%FILE%Share/MultiTransferStats.xml%MULTI_TRANSFER_STATS_REF%"+g_sTransferIDsForStats+"&Cancel=1";var CancelMultiTransferStats=createXMLHttpRequest("POST",sCmd,CancelMultiTransferStatsResponse);CancelMultiTransferStats.send(null);}else ASSERT("PollForStats: Programming error, there are no files to poll for cancelling.");}function OnCancelProgressDialog(){CancelUploads();}function CloseProgressDialog(){$(document).unbind("keydown");$("#ProgressDialog").dialog("close");if(m_bMoveToNextPageAfterProgressStats){ChangePage(g_nPage+1);}}function GetTransferIDsForStats(){var nNumOfRows=GetNumOfRows();var sTransferIDs="";for(var nRow=0;nRow<nNumOfRows;nRow++){var sInput="MultiUploadFileInput_"+nRow;var rFileInput=document.getElementById(sInput);var sFileInputName=rFileInput.value;var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){var sFileName=decodeURIComponent(rTransferObj[TRANSFER_FILE_NAME]);var nStatus=rTransferObj[TRANSFER_STATUS];if(nStatus!=TRANSFER_STATUS_SUCCESS){var bIsVirtual=rTransferObj[TRANSFER_VIRTUAL];if((sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!="")||bIsVirtual==1){if((sFileInputName==sFileName)||bIsVirtual){sTransferIDs+=rTransferObj[TRANSFER_ID].toString()+",";}else{ASSERT("Cannot poll for stats because the transfer object does not match the form input.");}}else{if(sFileInputName!=sFileName)ASSERT("Cannot poll for stats because the transfer object does not match the form input.");}}}else ASSERT("Cannot poll for stats because the transfer object could not be found for this row.");}return(sTransferIDs);}function MultiTransferStatsResponse(objRequest){if((objRequest!=undefined)&&(objRequest.readyState==4)){if(objRequest.status==200){var XMLDoc=objRequest.responseXML;var nTotalBytesWritten=0;var arFiles=XMLDoc.getElementsByTagName('file');if(arFiles!=null&&arFiles!=undefined){var nNumOfFiles=arFiles.length;if(nNumOfFiles>0){var nNumOfCompletedFiles=0;var nNumOfLegitResultCodes=0;var bCanBeginProgress=true;var nTotalBytesWritten=0;var rFile=null;var nResult=-1;var sResultText="";var nTransferID=-1;var sFileName=null;var nFileSize=0;var nBytesWritten=0;var nBytesRemaining=0;var nStalledConnectionCounter=0;for(var nIdx=0;nIdx<nNumOfFiles;nIdx++){rFile=null;nResult=-1;sResultText="";nTransferID=-1;sFileName=null;nFileSize=0;nBytesWritten=0;nBytesRemaining=0;rFile=arFiles[nIdx];nResult=GetXMLValueInt(rFile,"Result");sResultText=GetXMLValue(rFile,"ResultText");nTransferID=GetXMLValueInt(rFile,"TransferID");sFileName=GetXMLValue(rFile,"FileName");nFileSize=GetXMLValueInt(rFile,"FileSize");nBytesWritten=GetXMLValueInt(rFile,"BytesWritten");nBytesRemaining=GetXMLValueInt(rFile,"BytesRemaining");if((!isNaN(nTransferID))&&(nTransferID>0)&&(!isNaN(nResult))&&(nResult>-1)){var rTransferObj=GetTransferObjByID(nTransferID);if(rTransferObj!=null&&rTransferObj!=undefined){if(!g_bCancelUpload){rTransferObj[TRANSFER_RESULT]=nResult;rTransferObj[TRANSFER_RESULT_TEXT]=sResultText;if(nResult!=g_nSessionPending)nStalledConnectionCounter++;if(nResult==g_nSessionPending){if(m_nTrackProgressIteration>-1){if(m_nTrackProgressIteration==0)m_nTrackFileSize+=nFileSize;nTotalBytesWritten+=nBytesWritten;}rTransferObj[TRANSFER_FILE_SIZE]=nFileSize;SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_PENDING);}else if(nResult==g_nSessionOkay){nNumOfCompletedFiles++;nNumOfLegitResultCodes++;OnReceiveUploadResponse(rTransferObj);nTotalBytesWritten+=rTransferObj[TRANSFER_FILE_SIZE];}else{bCanBeginProgress=false;if(nResult!=g_nSessionNotFound){SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_FAILURE);nNumOfLegitResultCodes++;}}}}else ASSERT_CONSOLE("PollForStats: Programming error, Transfer object could not be found from Transfer ID ("+nTransferID+")");}else ASSERT_CONSOLE("PollForStats: Programming error, TransferID or Result is an invalid number.");}if(nStalledConnectionCounter==nNumOfFiles){g_nUploadTimeout++;}if(!g_bCancelUpload){if(bCanBeginProgress){m_nTrackProgressIteration++;}if(m_nTrackProgressIteration>0)IncrementProgress(nTotalBytesWritten,m_nTrackFileSize);if(nNumOfFiles==nNumOfCompletedFiles){document.getElementById("ProgressDiv").style.backgroundPosition="0% 0px";document.getElementById("percentcomplete").innerHTML="100%";ResetProgressCounters();m_bMoveToNextPageAfterProgressStats=true;StartTimer(function(){CloseProgressDialog();},750);}else if(g_nUploadTimeout<MAX_UPLOAD_TIMEOUT&&nNumOfLegitResultCodes<nNumOfFiles){StartTimer(function(){PollForStats(false);},1000);}else{ResetProgressCounters();StartTimer(function(){OnCancelProgressDialog();},250);}}else{ResetProgressCounters();StartTimer(function(){OnCancelProgressDialog();},1000);}}else ASSERT("PollForStats: Programming error, could not find any <file> elements.");}else ASSERT("PollForStats: Programming error, XMLDoc could not find any <file> elements.");}else ASSERT("UploadProgressDlg.MultiTransferStatsResponse - HTTPCode is something other than 200 OK!");}}function PollForStats(bStartingFresh){if(bStartingFresh){g_nUploadTimeout=0;m_bMoveToNextPageAfterProgressStats=false;var sDesc="";if(m_nNumOfTransfers>1){sDesc="$ADHOC_FILE_UPLOAD_PROGRESS_DESC_MULTI$";sDesc=sDesc.replace("$NumOfFilesUploading",m_nNumOfTransfers);}else if(m_nNumOfTransfers==1)sDesc="$ADHOC_FILE_UPLOAD_PROGRESS_DESC_SINGLE$";$('#progressDesc').html(sDesc);g_sTransferIDsForStats=GetTransferIDsForStats();ResetProgressCounters(true);}if(g_sTransferIDsForStats!=null&&g_sTransferIDsForStats!=undefined&&g_sTransferIDsForStats!=""){var sCmd="%FILE%Share/MultiTransferStats.xml%MULTI_TRANSFER_STATS_REF%"+g_sTransferIDsForStats;var MultiTransferStats=createXMLHttpRequest("POST",sCmd,MultiTransferStatsResponse);MultiTransferStats.send(null);}else ASSERT("PollForStats: Programming error, there are no files to poll for.");}function ResetProgressBar(){IncrementProgress(0,0);}function IncrementProgress(nNumOfBytesWritten,nTotalNumOfBytes){var nPercent=0;if(nTotalNumOfBytes>0)nPercent=(nNumOfBytesWritten/nTotalNumOfBytes)*100;nPercent=parseInt(nPercent,10);if(nPercent>100)nPercent=0;var nFillPercentage=(100-nPercent);var sPercentage=nFillPercentage.toString();document.getElementById("ProgressDiv").style.backgroundPosition=sPercentage+"% 0px";document.getElementById("percentcomplete").innerHTML=nPercent+"%";}function ShowProgressDialog(nWidth,nHeight){g_bCancelUpload=false;g_nUploadTimeout=0;var objDialog=$("#ProgressDialog");var sTitleHTML="$ADHOC_FILE_UPLOAD_PROGRESS_TITLE$";objDialog.dialog("option","title",sTitleHTML);if(nWidth==undefined||nWidth==null)nWidth=MIN_WIDTH;if(nHeight==undefined||nHeight==null)nHeight=MIN_HEIGHT;if(nWidth!=undefined&&nWidth!=null)objDialog.dialog("option","width",nWidth);if(nHeight!=undefined&&nHeight!=undefined)objDialog.dialog("option","height",nHeight);var rCloseBtn=$("#ProgressDialog").parent().find(".ui-dialog-titlebar button");if(rCloseBtn!=null&&rCloseBtn!=undefined){rCloseBtn.mouseover(function(){$(rCloseBtn).removeClass("ui-state-hover");});}var arBtns=$("#ProgressDialog").parent().find(".ui-dialog-buttonpane button");if(arBtns!=null){$(arBtns[0]).mouseover(function(){$(arBtns[0]).removeClass("ui-state-hover");});$(arBtns[0]).addClass("button_blue confirmBtns");$(arBtns[0]).attr("tabindex","1");}$(document).bind("keydown",function(event){var code=(event.keyCode||event.which);if(code==9){var objFocusElement=objDialog.parent().find(".ui-state-focus");if(objFocusElement.next().length)objFocusElement.next().focus(1);else objFocusElement.parent().children().first().focus(1);return(false);}else if(code==27){return(false);}else{var fnButtonCallback=undefined;var sKey=String.fromCharCode(code).toLowerCase();$.each(objDialog.dialog("option","buttons"),function(sButtonText,value){if(sButtonText.charAt(0).toLowerCase()==sKey){if(fnButtonCallback==undefined)fnButtonCallback=value;else{fnButtonCallback=undefined;return(false);}}});if(fnButtonCallback!=undefined){fnButtonCallback();return(false);}}return(true);});var objCloseBttnElement=objDialog.parent().find(".ui-dialog-titlebar-close");if(objCloseBttnElement!=undefined&&objCloseBttnElement!=null)objCloseBttnElement.remove();ResetProgressCounters(true);objDialog.dialog("open");}</script><div id="ChangePasswordDialoginner" style="display:none;"><form name="login_change_password" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;"><div>$OLD_PASSWORD$:<div style="overflow:auto"><input type="password" id="OldPasswordChange"/></div></div><div>$NEW_PASSWORD$:<br />
<div style="overflow:auto"><input type="password" id="NewPasswordChange"/></div></div><div>$VERIFY_PASSWORD$:<div style="overflow:auto"><input type="password" id="VerifyNewPasswordChange"/></div></div></td><td style="text-align:right;vertical-align:top;padding-right:5px;width:100px;"><span id="ChangePasswordButton"></span><br /><span id="CancelChangePasswordButton"></span></td></tr></table></form></div><script type="text/javascript" language="JavaScript">var sCPTitleHTML="<img src='%COMMON_FILE%Images/Change_Password16.png' width='16' height='16' border='0' class='dialogtitle' />$USER_CHANGE_PASSWORD_TITLE$";$("#ChangePasswordDialoginner").dialog({"autoOpen":false,"modal":true,"resizable":false,"title":sCPTitleHTML,"buttons":{"$OK_BUTTON$":OnChangePasswordSubmit,"$CANCEL_BUTTON$":OnCancelChangePassword }});function OnChangePasswordSubmit(){var sOldPassWord=$("#OldPasswordChange").val();var sNewPassWord=$("#NewPasswordChange").val();var sVerifyPassWord=$("#VerifyNewPasswordChange").val();if(sNewPassWord==sVerifyPassWord){var request=new AjaxRequest();request.SetUrlParameter("Command","LoginChangePassword");request.SetPostParameter("old_password",sOldPassWord);request.SetPostParameter("new_password",sNewPassWord);request.Post("%FILE%Login.xml",OnChangePasswordDone);}else AlertDialog("$PASSWORDS_DONT_MATCH$",true);}function OnChangePasswordDone(data,textStatus,jqXHR,objCallbackData){var nResult=GetXMLValueInt(data,"result");var sResultText=GetXMLValue(data,"ResultText");if(nResult!=g_nSessionOkay){if(nResult==1)sResultText="$ERROR_PASSWORD_CHANGE_FAIL$";AlertDialogEx(sResultText,true,undefined,undefined,undefined,undefined,false);}else{$("#ChangePasswordDialoginner").dialog("close");AlertDialogEx("$PASSWORD_CHANGED$",true,undefined,undefined,undefined,undefined,false);}}function OnCancelChangePassword(){$("#ChangePasswordDialoginner").dialog("close");}function ClearPasswordDialog(){$("#OldPasswordChange").val("");$("#NewPasswordChange").val("");$("#VerifyNewPasswordChange").val("");}function ChangePasswordDialog(bLogin){ClearPasswordDialog();$("#ChangePasswordDialoginner").dialog("open");$("#OldPasswordChange").focus();}</script><div id="UserEmailDialoginner" style="display:none;"><form name="log_user_email" onsubmit="return (false);"><table class="DialogTable"><tr><td style="vertical-align:middle;padding-left:5px;">$EMAIL_DESCR$ <br /><div style="margin-top:5px;">$EMAIL$:<br /><div style="overflow:auto"><input type="text" id="CurrentUserEmail" autocomplete="off"/></div></div><div>$VERIFY_EMAIL$:<br /><div style="overflow:auto"><input type="text" id="UserEmail" autocomplete="off"/></div></div></td><!--td style="text-align:right;vertical-align:top;padding-right:5px; width:100px;"><span id="SaveUserEmailButton"></span><br /><span id="LogoutUserEmailButton"></span><span id="CancelUserEmailButton"></span></td--></tr></table></form></div><script type="text/javascript" language="JavaScript">var g_fnEmailSetCallback;var sCETitleHTML="<img src='%COMMON_FILE%Images/ChangeEmail.png' width='16' height='16' border='0' class='dialogtitle' />$USER_EMAIL_TITLE$";$("#UserEmailDialoginner").dialog({"autoOpen":false,"modal":true,"resizable":false,"title":sCETitleHTML,"buttons":{"$OK_BUTTON$":OnSetEmailAddressSubmit,"$CANCEL_BUTTON$":OnCancelSetEmail }});function OnSetEmailAddressSubmit(){var sSetEmailCmd="%FILE%Result.xml?Command=SetEmailAddress";var SetEmailRequest=createXMLHttpRequest("POST",sSetEmailCmd,OnSetEmailAddressDone);var sEmailAddr,sCurrentEmailAddr;sEmailAddr=$("#UserEmail").val();sCurrentEmailAddr=$("#CurrentUserEmail").val();var sPostData="emailaddress="+sEmailAddr;if(sEmailAddr.toLowerCase()==sCurrentEmailAddr.toLowerCase())SetEmailRequest.send(sPostData);else AlertDialog("$EMAIL_VALS_NO_MATCH$");SetEmailRequest.response=function(XMLDoc){var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=0){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{$("#UserEmailDialoginner").dialog("close");if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}};}function OnSetEmailAddressDone(reqObj){if((reqObj!=undefined)&&(reqObj.readyState==4)){var XMLDoc=reqObj.responseXML;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult!=g_nSessionOkay){if(nResult==908||nResult==910||nResult==911)AlertDialog(GetResultText(0,"",sResultText));else AlertDialog("$SET_EMAIL_FAILURE_ERROR$");}else{g_sUserEmail=$("#UserEmail").val();$("#UserEmailDialoginner").dialog("close");if(g_fnEmailSetCallback!=undefined)g_fnEmailSetCallback();}reqObj=undefined;}}function OnCancelSetEmail(){$("#UserEmailDialoginner").dialog("close");}function ClearSetEmailDialog(){$("#UserEmail").val("");}function OnShowSetEmailDialog(sEmail,fnCallback,bNoCloseButton){if(fnCallback!=undefined)g_fnEmailSetCallback=fnCallback;if(sEmail!=undefined)$("#CurrentUserEmail").val(sEmail);else ClearSetEmailDialog();$("#UserEmailDialoginner").dialog("open");$("#CurrentUserEmail").focus();}function OnLogoutEmailSet(){location.href="%LOGOUT%";}</script><div id="container"><div class="AdhocHeader" id="AdhocHeader"><div class="Adhocsulogo"><a href="Console.htm" id="Adhocheadlogo-home-href"><img class="AdhocHeadLogo" id="AdhocHeadLogo" src="/%25LOGO_FILE%25%FILE%Share/Images/Serv-U-Logo-Text-small.png?Width=160&Height=40&Thumbnail=1" alt="$PRODUCT_FILE_SHARE_NAME$" border="0" /></a></div><div class="Adhocheadbar"></div><div class="Adhocheadtext">$FILE_SHARING$</div><div class="Adhocheadlinks"><a href="javascript:OnContextHelp();" id="Adhochead-help-href"><span class="AdhocHeadLinkHand"><img src="%FILE%Share/Images/icon_help.png" class="helpico" alt="$HELP$" border="0" />$HELP$</span></a><span class="AdhocHeadUserField"><span class="AdhocHeadLinkHand" id="AdhocHeadUsernameMenuOwner"><span id="AdhocHeadUsername"></span><img src="%FILE%Share/Images/icon_user_name_dropdown.png" alt="" border="0" style="margin-left: 4px;" /></span></span></div><ul id="AdhocHeadUsernameContextMenu" style="display: none;width: auto;min-width: 150px;"><li id="AdhocUserOption-password" style="display: none;"><a href="#" id="AdhocUserOption-password-href" data-handler="javascript:OnShowChangePasswordDialog();" class="AdhocUserOption"><span class="AdhocUserOption-ico"><img src="%FILE%Images/change-password.png" alt="$CHANGE_PASSWORD_BUTTON$" border="0"/></span>$CHANGE_PASSWORD_BUTTON$</a></li><li id="AdhocUserOption-changeemail" style="display: none;"><a href="#" id="AdhocUserOption-changeemail-href" data-handler="javascript:OnShowChangeEmailDialog();" class="AdhocUserOption"><span class="AdhocUserOption-ico"><img src="%COMMON_FILE%Images/ChangeEmail.png" alt="$CHANGE_EMAIL_BUTTON$" border="0"/></span>$CHANGE_EMAIL_BUTTON$</a></li><li id="AdhocUserOption-logout" style=""><a href="#AdhocHeadUsername" id="AdhocUserOption-logout-href" data-handler="javascript:OnLogout();" class="AdhocUserOption"><span class="AdhocUserOption-ico"><img src="%FILE%Share/Images/UsernameContextMenu.png" alt="$LOGOUT$" border="0"/></span>$LOGOUT$</a></li></ul></div><script type="text/javascript">var g_bDisableBranding=false;var g_bHasCustomLogo=false;var g_bAllowChangePassword=%CAN_CHANGE_PASSWORD%;var g_bAllowChangeEmail=%USER_CAN_SET_EMAIL_ADDRESS%;var g_sUserEmail=HTMLDecode("%USER_EMAIL_ADDRESS%");if(%DISABLE_BRANDING%){g_bDisableBranding=true;}if(%HAS_CUSTOM_LOGO%){g_bHasCustomLogo=true;}if(g_bAllowChangePassword)$("#AdhocUserOption-password").show();if(g_bAllowChangeEmail)$("#AdhocUserOption-changeemail").show();$(document).ready(function(){var g_sHeaderUserName=decodeURIComponent("%CUser.%USER_ID%.FullNameOrLoginID%");$("#AdhocHeadUsernameMenuOwner").contextMenu({"menu":"AdhocHeadUsernameContextMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","alignleft":"1","beforeshow":function(){$("#AdhocHeadUsernameContextMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocHeadUsernameContextMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});if(g_sHeaderUserName=="")$("#AdhocHeadUsername").html("$LOCAL_ADMIN$");else $("#AdhocHeadUsername").html(g_sHeaderUserName);if(document.getElementById("AdhocHeadLogo"))ReplaceCustomHeaderImage(g_bDisableBranding,g_bHasCustomLogo);var sCustomBackground="%HTML_WEB_CLIENT_BACKGROUND%";if(sCustomBackground!=""){var sBackground=sCustomBackground;$("#AdhocHeader").css("background",sBackground);}});function OnLogout(){location.href="%LOGOUT%";}function ReplaceCustomHeaderImage(){var CustomImg=new Image();var sCustomImgSrc="/%25LOGO_FILE%25%FILE%Share/Images/Serv-U-Logo-Text-small.png?Width=160&Height=40&Thumbnail=1"+SyncRequestParameter();var nWidth="160";var nHeight="40";if(g_bDisableBranding&&!g_bHasCustomLogo){sCustomImgSrc="%COMMON_FILE%Images/blank.gif"+SyncRequestParameter();nWidth="1";nHeight="1";}CustomImg.src=sCustomImgSrc;document.getElementById("AdhocHeadLogo").src=CustomImg.src;document.getElementById("AdhocHeadLogo").width=nWidth;document.getElementById("AdhocHeadLogo").height=nHeight;if(g_bHasCustomLogo)document.getElementById("AdhocHeadLogo").style.marginRight="10px";}function OnShowChangePasswordDialog(){if(g_bAllowChangePassword){ChangePasswordDialog();}}function OnShowChangeEmailDialog(){if(g_bAllowChangeEmail){OnShowSetEmailDialog(g_sUserEmail);}}</script><div class="AdhocNavigationBar"><div class="AdhocNavBttns"><a id="AdHocHomeBtn" onclick='javascript:OnNavBtn("AdHocHomeBtn", "%FILE%Share/Console.htm");return (false);'>$HOME$</a><span class="navSeparator"></span><a id="AdHocRequestFilesBtn" onclick='javascript:OnNavBtn("AdHocRequestFilesBtn", "%FILE%Share/IncomingWizard.htm");return (false);'>$ADHOC_BTN_REQUEST_FILES$</a><span class="navSeparator"></span><a id="AdHocSendFilesBtn" onclick='javascript:OnNavBtn("AdHocSendFilesBtn", "%FILE%Share/OutgoingWizard.htm");return (false);'>$ADHOC_BTN_SEND_FILES$</a></div><div class="AdhocNavBarJumpTo"><div class="AdhocNavBarJumpToTxt" style="float:left;width:auto;">$JUMP_TO$:&nbsp;&nbsp;</div><div id="AdhocNavBarJumpToList">$FILE_SHARING$<div id="AdhocNavBarJumpToIco"> </div></div></div><div class="AdhocNavBarActivityInfo" style="display: none"><span class="AdhocActivityTxt">$DAILY_ACTIVITY$</span><img src="%FILE%Share/Images/icon_incoming.png" width="16" height="16" class="ULDLico" alt="%ADHOC_USER_DOWNLOADS%" border="0" /><span id="IncomingDailyActivityTxt"></span><img src="%FILE%Share/Images/icon_outgoing.png" width="16" height="16" class="ULDLico" alt="%ADHOC_USER_UPLOADS%" border="0" /><span id="OutgoingDailyActivityTxt"></span></div></div><script type="text/javascript">var g_JumpToPage=3;$(document).ready(function(){var sURLPath=window.location.pathname;if(sURLPath.indexOf("OutgoingWizard.htm")>=0){$("#AdHocHomeBtn").removeClass("navLinkDisabled");$("#AdHocRequestFilesBtn").removeClass("navLinkDisabled");$("#AdHocSendFilesBtn").addClass("navLinkDisabled");$("#AdHocHomeBtn").attr("disabled",false);$("#AdHocRequestFilesBtn").attr("disabled",false);$("#AdHocSendFilesBtn").attr("disabled",true);}else if(sURLPath.indexOf("IncomingWizard.htm")>=0){$("#AdHocHomeBtn").removeClass("navLinkDisabled");$("#AdHocSendFilesBtn").removeClass("navLinkDisabled");$("#AdHocRequestFilesBtn").addClass("navLinkDisabled");$("#AdHocHomeBtn").attr("disabled",false);$("#AdHocSendFilesBtn").attr("disabled",false);$("#AdHocRequestFilesBtn").attr("disabled",true);}else{$("#AdHocRequestFilesBtn").removeClass("navLinkDisabled");$("#AdHocSendFilesBtn").removeClass("navLinkDisabled");$("#AdHocRequestFilesBtn").attr("disabled",false);$("#AdHocSendFilesBtn").attr("disabled",false);if(sURLPath.indexOf("Console.htm")>=0){$("#AdHocHomeBtn").addClass("navLinkDisabled");$("#AdHocHomeBtn").attr("disabled",true);}else{$("#AdHocHomeBtn").removeClass("navLinkDisabled");$("#AdHocHomeBtn").attr("disabled",false);}}});function OnNavBtn(sElementID,sHref){if(!($("#"+sElementID).hasClass("navLinkDisabled")))window.location=sHref;}</script><ul id="AdhocNavBarJumpToMenu" style="display: none; width: auto;min-width: 160px;"><li id="MCNavOption"><a href="#AdhocHeadJumpto" id="MCNavOption-href" data-handler="javascript:OnJumpTo(0);">$MANAGEMENT_CONSOLE$</a></li><li id="WCNavOption"><a href="#AdhocHeadJumpto" id="WCNavOption-href" data-handler="javascript:OnJumpTo(1);">$BASIC_WEB_CLIENT$</a></li><li id="WCNewNavOption"><a href="#AdhocHeadJumpto" id="WCNewNavOption-href" data-handler="javascript:OnJumpTo(4);">$WEB_CLIENT_NEW$</a></li><li id="FSNewNavOption"><a href="#AdhocHeadJumpto" id="FSNewNavOption-href" data-handler="javascript:OnJumpTo(5);">$WEB_CLIENT_SHARE_NEW$</a></li><li id="FJNavOption"><a href="#AdhocHeadJumpto" id="FJNavOption-href" data-handler="javascript:OnJumpTo(2);">$FVJV$</a></li><li id="FSNavOption"><a href="#AdhocHeadJumpto" id="FSNavOption-href" data-handler="javascript:OnJumpTo(3);">$FILE_SHARING$</a></li></ul><script type="text/javascript">$(document).ready(function(){var g_bShowMC=(%IS_ADMIN%=="1")?true:false;var g_bShowWC=(%ALLOW_WEB_CLIENT%=="1")?true:false;var g_bShowFVJV=(%ALLOW_FTP_VOYAGER_JV%=="1")?true:false;var g_bShowFileSharing=(%ALLOW_ADHOC_FILE_SHARING%=="1")?true:false;$("#AdhocNavBarJumpToList").contextMenu({"menu":"AdhocNavBarJumpToMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":function(){$("#AdhocNavBarJumpToMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});$("#AdhocNavBarJumpToMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});});},"beforehide":function(){$("body").unbind("mouseup");}});var nTotalHidden=0;if(!g_bShowMC||g_JumpToPage==0){$("#MCNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==1){$("#WCNavOption").hide();nTotalHidden+=1;}if(!g_bShowFVJV||g_JumpToPage==2){$("#FJNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==3){$("#FSNavOption").hide();nTotalHidden+=1;}if(!g_bShowWC||g_JumpToPage==4){$("#WCNewNavOption").hide();nTotalHidden+=1;}if(!g_bShowFileSharing||g_JumpToPage==5){$("#FSNewNavOption").hide();nTotalHidden+=1;}if(nTotalHidden==6)$(".AdhocNavBarJumpTo").hide();else $(".AdhocNavBarJumpTo").show();});function OnJumpTo(nNavJump){switch(nNavJump){case(0):location.href="/";break;case(1):location.href="%FILE%ListDir.htm";break;case(2):location.href="%COMMON_FILE%FVJVLoggedIn.htm";break;case(3):location.href="%FILE%Share/Console.htm";break;case(4):location.href="/WebClientNew/Browser/~";break;case(5):location.href="/WebClientNew/Requested";break;}}</script><div class="bodyMarginOuter"><div class="titleDescBlock"><div style="border-bottom: 1px solid #e3e3e3;"><table class="table" id="wizardTitleTable"><tr class="row"><td class="columnImg30"><img id="TitleLogo" src="%FILE%Share/Images/icon_uploading_folder.png" width="30" height="26" alt="$PRODUCT_FILE_SHARE_NAME$" border="0" /></td><td class="columnTitle"><span id="topTitle"></span><span id="topTitleStep"></span></td></tr></table></div><div id="topTitleDesc"></div></div><div class="bodyMarginInner"><div id="Page1" class="wizardPageContent" style="display: block;"><table class="table"><tr class="row" style="vertical-align: top"><td class="column"><div class="section justifyLeft">$ADHOC_WIZARD_SECTION_SHARE_INFO$</div><div class="justifyLeft inputFieldDiv"><div class="fieldname" id="senderEmailSubjectLabel">$ADHOC_WIZARD_EMAIL_SUBJECT$</div><input id="senderEmailSubject" class="inputField" type="text" tabindex="1" autocomplete="off" /></div><div class=" justifyLeft colMarginRightDiv" style="padding-top: 10px; margin-bottom: 10px;"><label id="EmailBodyLabel" for="EmailBody">$ADHOC_WIZARD_COMMENTS$</label><span class="optional">$OPTIONAL$</span><textarea id="EmailBody" class="emailMsg" tabindex="2"></textarea><div style="clear:both;"></div></div><div class="section justifyLeft">$ADHOC_WIZARD_SECTION_CONTACT_INFO$</div><div class="justifyLeft inputFieldDiv"><div id="senderNameLabel" class="fieldname">$ADHOC_WIZARD_USER_NAME$</div><input class="inputField" type="text" id="senderName" value="" tabindex="3" autocomplete="off" /></div><div style="padding:7px 0 0 8px;"><input class="inputCheck" type="checkbox" id="NotifyUserOnGuestTransfers" value="" tabindex="4" autocomplete="off" checked="true" /><span class="inputCheckLabel"><label for="NotifyUserOnGuestTransfers">$ADHOC_WIZARD_OUTGOING_NOTIFY_USER$</label><span id="NotifyUserOnGuestTransfersLimitInfo" class="enforcedLimit" title="$ADHOC_ADMIN_SET_LIMIT_CANNOT_MODIFY$"></span></span></div><div class="justifyLeft inputFieldDiv"><div class="fieldname" id="senderEmailLabel">$ADHOC_WIZARD_USER_EMAIL$</div><input class="inputField" type="text" id="senderEmail" value="" tabindex="5" autocomplete="off" /></div><div class="section justifyLeft" style="margin-top:10px;">$ADHOC_WIZARD_SECTION_EMAIL_INFO$</div><div style="padding:7px 0 0 8px;"><input class="inputCheck" type="checkbox" id="EmailAfterUpload" value="" tabindex="6" autocomplete="off" checked="true" onClick="javascript:OnEmailAfterUpload();" /><span class="inputCheckLabel"><label for="EmailAfterUpload">$ADHOC_WIZARD_OUTGOING_AUTO_SEND_EMAIL$</label><span id="EmailAfterUploadLimitInfo" class="enforcedLimit" title="$ADHOC_ADMIN_SET_LIMIT_CANNOT_MODIFY$"></span><div class="subItemMargin" style="padding-top: 7px; padding-bottom: 7px;"><input class="inputCheck" type="checkbox" id="CCToSender" value="" tabindex="7" autocomplete="off" checked="true" /><span class="inputCheckLabel"><label for="CCToSender">$ADHOC_WIZARD_OUTGOING_COPY_EMAIL_TO_USER$</label><span id="CCToSenderLimitInfo" class="enforcedLimit" title="$ADHOC_ADMIN_SET_LIMIT_CANNOT_MODIFY$"></span></span></div></span></div><div class="justifyLeft"><div id="RcpEmailsDiv" class="colMarginRightDiv"><div id="recipientEmailsLabel" class="fieldname">$ADHOC_WIZARD_GUEST_EMAIL_ADDRESSES$</div><input id="recipientEmails" type="text" name="Name" class="inputField tagit ui-widget ui-widget-content ui-corner-all" autocomplete="off" tabindex="8" /></div></div></td><td class="columnSpacer"></td><td class="column"><div class="section justifyLeft">$ADHOC_WIZARD_SECTION_LINK_EXPIRATION$</div><div class="justifyLeft"><div class="checkBoxSpacer"><span>$ADHOC_WIZARD_OUTGOING_LINK_SHOULD_EXPIRE$</span><span id="AdhocExpireLinkOptLimitInfo" class="enforcedLimit" title="$ADHOC_ADMIN_SET_LIMIT_CANNOT_MODIFY$"></span></div></div><div class="subItemMargin"><div class="AdhocExpireLinkOpt"><input id="ExpiresOnDate" class="inputRadio" type="radio" name="linkExpires" tabindex="9" value="2" autocomplete="off" checked="true" onclick="javascript:OnClickLinkExpireRadio(this);" /><label id="ExpiresOnDateLabel" for="ExpiresOnDate">$ADHOC_WIZARD_LINK_SHOULD_EXPIRE_ON_DATE$</label><span id="DateImg"><input id="ExpiresOnDatePicker" readonly="true" style="cursor:pointer;" type="text" tabindex="10" /></span></div><div class="AdhocExpireLinkOpt"><input id="ExpiresInHours" class="inputRadio" type="radio" name="linkExpires" tabindex="11" value="1" autocomplete="off" onclick="javascript:OnClickLinkExpireRadio(this);" /><label id="ExpiresInHoursLabelIn" for="ExpiresInHours">$IN$</label><select id="ExpiresInHoursSel" tabindex="12" onchange="javascript:OnChangeExpiresInHours();"></select><label id="ExpiresInHoursLabelHours" for="ExpiresInHours">$HOURS$</label></div><div class="AdhocExpireLinkOpt"><input id="ExpiresInDays" class="inputRadio" type="radio" name="linkExpires" tabindex="13" value="0" autocomplete="off" onclick="javascript:OnClickLinkExpireRadio(this);" /><label id="ExpiresInDaysLabelIn" for="ExpiresInDays">$IN$</label><select id="ExpiresInDaysSel" tabindex="14" onchange="javascript:OnChangeExpiresInDays();"></select><label id="ExpiresInDaysLabelDays" for="ExpiresInDays">$DAYS$</label></div><div class="AdhocExpireLinkOpt"><input id="ExpiresNever" class="inputRadio" type="radio" name="linkExpires" tabindex="15" value="3" autocomplete="off" onclick="javascript:OnClickLinkExpireRadio(this);" /><label id="ExpiresNeverLabel" for="ExpiresNever">$NEVER$</label></div></div><div class="linkNoteBox justifyLeft checkBoxSpacer"><img src="%FILE%Share/Images/icon_blue_circle_info.png" width="16" height="16" border="0" /><div class="linkNoteBoxTxt">$ADHOC_WIZARD_LINK_EXPIRE_NOTE$</div><div style="clear: both;"></div></div><div class="section justifyLeft">$ADHOC_WIZARD_SECTION_OTHER_SETTINGS$<span class="optional">$OPTIONAL$</span></div><div class="justifyLeft"><div class="checkBoxSpacer"><input id="addPwordToFileShare" class="inputCheck" type="checkbox" tabindex="16" value="1" autocomplete="off" onClick="javascript:OnPwordProtectFile();" /><span class="inputCheckLabel"><label for="addPwordToFileShare">$ADHOC_WIZARD_PWORD_PROTECT_SHARE$</label><span id="addPwordToFileShareLimitInfo" class="enforcedLimit" title="$ADHOC_ADMIN_SET_LIMIT_CANNOT_MODIFY$"></span><div style="padding-left: 23px; vertical-align: text-bottom; color: #909095;" id="PwordBtnHint">$ADHOC_WIZARD_PWORD_PROTECT_HINT$</div></span></div><div class="subItemMargin password-container" style="margin-top: 10px; line-height: 11pt;"><input id="FileSharePword" type="password" tabindex="17" value="" autocomplete="off" /><button tabindex="18" class="pwordBttn ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="GeneratePword" role="button" type="button" onclick="javascript: OnGeneratePword();" style="padding: 0;"><span class="ui-button-icon-primary ui-icon ui-icon-key"></span></button><div class="checkBoxSpacer" style="clear: left;"><input id="addPwordToEmail" class="inputCheck" tabindex="19" type="checkbox" value="" autocomplete="off" /><span class="inputCheckLabel"><label for="addPwordToEmail">$ADHOC_WIZARD_INCLUDE_PWORD_IN_EMAIL$</label><span id="addPwordToEmailLimitInfo" class="enforcedLimit" title="$ADHOC_ADMIN_SET_LIMIT_CANNOT_MODIFY$"></span></span></div></div></div><div class="linkNoteBox justifyLeft checkBoxSpacer"><img src="%FILE%Share/Images/icon_blue_circle_info.png" width="16" height="16" border="0" /><div class="linkNoteBoxTxt">$ADHOC_WIZARD_PWORD_PROTECT_NOTE$</div><div style="clear: both;"></div></div></td></tr></table></div><div id="Page2" class="wizardPageContent" style="display: none;"><div class="section justifyLeft" style="margin-top: 20px;">$ADHOC_SELECT_FILES_TO_UPLOAD$</div><div style="width: 100%; border: dash 1px #DCDCDC"></div><!--FILE:		MultipleFileUpload.htmPURPOSE:	Provides a form where multiple files on the local machine can be uploaded to Serv-U.HISTORY:- 04/25/2013 - #dlb - CreatedNOTES:- the owner of this file should provide their own submit mechanism for the formREFERENCES:- http://viralpatel.net/blogs/ajax-style-file-uploading-using-hidden-iframe/--><div style="margin-left: 30px;"><ol class="MultiUploadList" id="MultiUploadList" name="MultiUploadList"></ol><button id="AddMoreUploadFields" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" role="button" type="button" onclick="javascript: InsertMultiUploadFields();"><img src="%FILE%Share/Images/icon_add_more_files_button.png" width="14" height="14" class="AddMoreUploadFieldsImg" alt="$ADD_MORE_FILES$" border="0" style="margin-top: 0; padding-left: 0;"/><span class="ui-button-text">$ADD_MORE_FILES$</span></button></div><ul id="AdHocRemoteLocalMenu" style="display: none; width: auto;min-width: 150px;"><li id="AdHocLocalBrowseOption"><a href="#AdHocBrowseOption" class="ActionOption" data-handler=""><span class="Action-ico"><img src="%COMMON_FILE%Images/FileShare16.png" class="SUWCActionico" alt="$LOCAL_FILE_BROWSE$" border="0" /></span>$LOCAL_FILE_BROWSE$</a></li><li id="AdHocRemoteBrowseOption"><a href="#AdHocBrowseOption" class="ActionOption" data-handler=""><span class="Action-ico"><img src="%COMMON_FILE%Images/su16x16.png" class="SUWCActionico" alt="$REMOTE_FILE_BROWSE$" border="0" /></span>$REMOTE_FILE_BROWSE$</a></li></ul><script type="text/javascript" language="JavaScript">var bIsMSIE=(GetIEMajorVersionNumber()>0);var g_nNextTransferID=1;var MAX_UPLOAD_ROWS=20;var g_nMaxUploadRows=MAX_UPLOAD_ROWS;function SetMaxUploadRows(nMaxUploadRows){if(nMaxUploadRows>0&&nMaxUploadRows<MAX_UPLOAD_ROWS)g_nMaxUploadRows=nMaxUploadRows;else g_nMaxUploadRows=MAX_UPLOAD_ROWS;}function OnLocalFileBrowse(nRow){document.getElementById(GetFileInputID(nRow)).click();}function SetRemoteFilePath(sInputVal,nRow,nSize){OnChangeFile(document.getElementById(GetRemoteInputID(nRow)),nRow,1,nSize);document.getElementById("fakePath-"+GetFileInputID(nRow)).innerHTML=GetFileName(sInputVal,true);}function OnRemoteFileBrowse(nRow){LoadDynamicContentAndRun(["%FILE%Share/Include/BrowseDialog.htm?ID=%ID%","BrowseDialogDiv",String("OnBrowse("),[GetRemoteInputID(nRow),true,0,0,SetRemoteFilePath,false,nRow]]);}function GetNumOfRows(){var nNumOfRows=0;var rListObj=document.getElementById('MultiUploadList');if(rListObj!=undefined&&rListObj!=null){var arListItems=$("#MultiUploadList li");if(arListItems!=null&&arListItems!=undefined)nNumOfRows=arListItems.length;if(nNumOfRows<0)nNumOfRows=0;}return(nNumOfRows);}function GetListItemID(nRow){return("MultiUploadRow_"+nRow);}function GetFileInputID(nRow){return("MultiUploadFileInput_"+nRow);}function GetRemoteInputID(nRow){return("MultiUploadRemoteFileInput_"+nRow);}function GetFormElements(nRow){var sHTML="";if(nRow>-1){var sInput=GetFileInputID(nRow);sHTML='<input class="multiUploadFileInputHidden" id="'+sInput+'" name="'+sInput+'" type="file"/>';sHTML+='<input id="'+GetRemoteInputID(nRow)+'" type="hidden"/>';}return(sHTML);}function GetFormElement_RemoveBtn(nRow,sSrc,bIncludeOnClick){var sHTML="";if(nRow>-1&&sSrc!=undefined&&sSrc!=null&&sSrc!=""){if(bIncludeOnClick)sHTML='<img class="uploadColFormResetImg showHandCursor" width="16" height="16" src="'+sSrc+'" onclick="ClearInputFile('+nRow+');" />';else sHTML='<img class="uploadColFormResetImg" width="16" height="16" src="'+sSrc+'" />';}return(sHTML);}function InsertMultiUploadFields(){SetElementDisabledState(["AddMoreUploadFields"],false);$("#AddMoreUploadFields").show();var rListObj=document.getElementById('MultiUploadList');if(rListObj!=undefined&&rListObj!=null){var nNumOfRows=GetNumOfRows();if(nNumOfRows<g_nMaxUploadRows){var nNumOfRowsToAdd=5;if(g_nMaxUploadRows<(nNumOfRowsToAdd+nNumOfRows))nNumOfRowsToAdd=(g_nMaxUploadRows-nNumOfRows);for(var nRow=nNumOfRows;nRow<(nNumOfRows+nNumOfRowsToAdd);nRow++){var sLi=GetListItemID(nRow);var sForm="MultiUploadForm_"+nRow;var sFrame="MultiUploadHiddenResponseForm_"+nRow;var fakeFileUpload=document.createElement('div');fakeFileUpload.className='fakefile';fakeFileUpload.id='fakefile';sinput=document.createElement('div');sinput.className='fakefileinput';sinput.id='fakefileinput';fakeFileUpload.appendChild(sinput);var rLI=document.createElement("li");rLI.id=sLi;var sInnerHTML;sInnerHTML='<div class="uploadColLeft">'+(nRow+1)+'.</div>'+'<div class="uploadColRight">'+'<div class="uploadColForm">'+'<div class="multiUploadFileInput multiUploadFileInputBorder" >'+'<span id="fakePath-'+GetFileInputID(nRow)+'">$NO_FILE_SELECTED$</span>'+'<div class="uploadColFormResetDiv"></div>'+'</div>'+'<button id="fake-'+GetFileInputID(nRow)+'" style="margin:1px 0 0 10px;" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_ltgray" name="RemoteLocalButton" type="button" role="button">'+'<span class="ui-button-text">$BROWSE$...</span>'+'</button>'+'<form class="uploadForm" id="'+sForm+'" method="post" enctype="multipart/form-data" encoding="multipart/form-data" target="'+sFrame+'">';sInnerHTML+=GetFormElements(nRow);sInnerHTML+='</form>'+'<iframe id="'+sFrame+'" name="'+sFrame+'" width="0" height="0" border="0" frameborder="0" scrolling="no"></iframe>'+'</div>'+'<div style="clear: both;"></div>'+'<div class="uploadRowStatus">'+'<img class="uploadRowStatusImg" width="16" height="16" src="%COMMON_FILE%Images/blank.gif" />'+'<div class="uploadRowStatusTxt"></div>'+'<div style="clear: both;"></div>'+'</div>'+'</div><div style="clear: both;"></div>';rLI.innerHTML=sInnerHTML;rListObj.appendChild(rLI);document.getElementById(GetFileInputID(nRow)).onchange=(function(nCurrRow){var nThisRow=nCurrRow;return function(){var sInputVal=this.value;$("#fakePath-"+GetFileInputID(nThisRow)).html(GetFileName(sInputVal,true));$("#"+GetRemoteInputID(nThisRow)).val("");if(bIsMSIE){$(".ui-contextmenu").hide();ShowHideLocalInput(nThisRow,false);}OnChangeFile(this,nThisRow,0);};}(nRow));if(g_bOutgoingWiz){$("#fake-"+GetFileInputID(nRow)).contextMenu({"menu":"AdHocRemoteLocalMenu","allowLeftClick":"1","showBelow":"1","alignToTargetElement":"1","beforeshow":(function(nCurrRow){var nThisRow=nCurrRow;return function(){$("#AdHocLocalBrowseOption a").attr("data-handler","javascript:OnLocalFileBrowse("+nThisRow+");");$("#AdHocRemoteBrowseOption a").attr("data-handler","javascript:OnRemoteFileBrowse("+nThisRow+");");if(bIsMSIE){ShowHideLocalInput(nThisRow,true);}$("#AdHocRemoteLocalMenu").bind('mouseenter',function(){$("body").unbind("mouseup");});if(bIsMSIE){$("#"+GetFileInputID(nThisRow)).bind('mouseenter',function(){$("body").unbind("mouseup");$(document).unbind('click');$("#AdHocLocalBrowseOption").find('A').trigger("mouseover");});}if(bIsMSIE){$("#"+GetFileInputID(nThisRow)).bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide()});$("#AdHocLocalBrowseOption").find('A').trigger("mouseout");});}$("#AdHocRemoteLocalMenu").bind("mouseleave",function(){$("body").mouseup(function(){$(".ui-contextmenu").hide();if(bIsMSIE)ShowHideLocalInput(nThisRow,false);});});};}(nRow)),"beforehide":(function(nCurrRow){var nThisRow=nCurrRow;return function(){$("body").unbind("mouseup");if(bIsMSIE)ShowHideLocalInput(nThisRow,false);};}(nRow))});}else{if(bIsMSIE)ShowHideLocalInput(nRow,true,bIsMSIE);else{$("#fake-"+GetFileInputID(nRow)).bind('click',(function(nCurrRow){var nThisRow=nCurrRow;return function(){OnLocalFileBrowse(nThisRow);};}(nRow)));}}var sTransferObjTxt='{"'+TRANSFER_FILE_NAME+'":""';sTransferObjTxt+=',"'+TRANSFER_ROW_NUMBER+'":'+nRow;sTransferObjTxt+=',"'+TRANSFER_ID+'":-1';sTransferObjTxt+=',"'+TRANSFER_FILE_SIZE+'":0';sTransferObjTxt+=',"'+TRANSFER_STATUS+'":'+TRANSFER_STATUS_EMPTY;sTransferObjTxt+=',"'+TRANSFER_RESULT+'":-1';sTransferObjTxt+=',"'+TRANSFER_RESULT_TEXT+'":""';sTransferObjTxt+=',"'+TRANSFER_VIRTUAL+'":-1';sTransferObjTxt+='}';var rTransferObj=jQuery.parseJSON(sTransferObjTxt);if(rTransferObj!=null&&rTransferObj!=undefined&&g_aTransfersMappedToRowNum!=undefined)g_aTransfersMappedToRowNum[nRow]=rTransferObj;}nNumOfRows+=nNumOfRowsToAdd;}if(nNumOfRows>=g_nMaxUploadRows){SetElementDisabledState(["AddMoreUploadFields"],true);
$("#AddMoreUploadFields").hide();}}}function ShowHideLocalInput(nRow,bShow,bIsMSIE){if(bShow&&g_nOutgoingSource!=2){$("#"+GetFileInputID(nRow)).css("position","absolute");$("#"+GetFileInputID(nRow)).zIndex(($("#AdHocRemoteLocalMenu").zIndex()+1));$("#"+GetFileInputID(nRow)).css("left",$("#fake-"+GetFileInputID(nRow)).offset().left+"px");if(!g_bOutgoingWiz&&bIsMSIE){$("#"+GetFileInputID(nRow)).css("top",($("#fake-"+GetFileInputID(nRow)).offset().top+$("#fake-"+GetFileInputID(nRow)).innerHeight()-3)+"px");$("#"+GetFileInputID(nRow)).css("width",($("#fake-"+GetFileInputID(nRow)).outerWidth())+"px");$("#"+GetFileInputID(nRow)).css("height",($("#fake-"+GetFileInputID(nRow)).outerHeight())+"px");$("#"+GetFileInputID(nRow)).css("cursor","pointer");$("#"+GetFileInputID(nRow)).bind('mouseenter',function(){$("#fake-"+GetFileInputID(nRow)).addClass("hovered");});$("#"+GetFileInputID(nRow)).bind('mouseleave',function(){$("#fake-"+GetFileInputID(nRow)).removeClass("hovered");});}else{$("#"+GetFileInputID(nRow)).css("top",($("#fake-"+GetFileInputID(nRow)).offset().top+$("#fake-"+GetFileInputID(nRow)).outerHeight())+"px");$("#"+GetFileInputID(nRow)).css("width","157px");$("#"+GetFileInputID(nRow)).css("height","26px");$("#"+GetFileInputID(nRow)).css("cursor","pointer");}$("#"+GetFileInputID(nRow)).css("font-size","118px");$("#"+GetFileInputID(nRow)).css("overflow","hidden");}else{$("#"+GetFileInputID(nRow)).css("position","relative");$("#"+GetFileInputID(nRow)).css("width","2px");$("#"+GetFileInputID(nRow)).css("height","2px");}}function GetNextTransferID(){return(g_nNextTransferID++);}function GetElementID_RightCol(nRow){return("$NAME_OF_MULTI_UPLOAD_STATUS_MSG$_"+nRow);}function GetForm(rTransferObj){return(GetFormByRow(rTransferObj[TRANSFER_ROW_NUMBER]));}function GetFormByRow(nRow){return(document.getElementById("MultiUploadForm_"+nRow));}function GetInputField(rTransferObj){return(GetInputFieldByRow(rTransferObj[TRANSFER_ROW_NUMBER]));}function GetInputFieldByRow(nRow){return(document.getElementById(GetFileInputID(nRow)));}function GetRemoteInputField(rTransferObj){return(GetRemoteInputFieldByRow(rTransferObj[TRANSFER_ROW_NUMBER]));}function GetRemoteInputFieldByRow(nRow){return(document.getElementById(GetRemoteInputID(nRow)));}function GetHiddenIFrame(rTransferObj){return(document.getElementById("MultiUploadHiddenResponseForm_"+rTransferObj[TRANSFER_ROW_NUMBER]));}function ResetTransferObj(rTransferObj){if(rTransferObj!=null&&rTransferObj!=undefined){rTransferObj[TRANSFER_FILE_NAME]="";rTransferObj[TRANSFER_ID]=-1;rTransferObj[TRANSFER_VIRTUAL]=-1;SetRowState(rTransferObj[TRANSFER_ROW_NUMBER],TRANSFER_STATUS_EMPTY);rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";}else ASSERT("ResetTransferObj: Programming error, invalid source or transfer obj.");}function OnChangeFile(eventSource,nRow,bIsVirtual,nSize){var rTransferObj=GetTransferObjByRow(nRow);if(eventSource!=undefined&&rTransferObj!=null&&rTransferObj!=undefined&&bIsVirtual!=undefined){var sFileName=eventSource.value;if(sFileName!=undefined&&sFileName!=null&&sFileName!=""){sFileName=encodeURIComponent(sFileName);rTransferObj[TRANSFER_FILE_NAME]=sFileName;rTransferObj[TRANSFER_ID]=-1;SetRowState(nRow,TRANSFER_STATUS_HAS_FILENAME);rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";rTransferObj[TRANSFER_VIRTUAL]=bIsVirtual;if(bIsVirtual)rTransferObj[TRANSFER_FILE_SIZE]=nSize;}else ResetTransferObj(rTransferObj);}else ASSERT("OnChangeFile: Programming error, invalid source or transfer obj.");CheckForDuplicateFileNames(null,nRow,bIsVirtual);}function OnSubmitFiles(){m_nNumOfTransfers=0;var rListObj=document.getElementById('MultiUploadList');if(rListObj!=undefined){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){var rForm=GetForm(rTransferObj);var rFormsTargetFrame=GetHiddenIFrame(rTransferObj);var rFileInput=GetInputField(rTransferObj);var sFileInputName=rFileInput.value;var sFileName=decodeURIComponent(rTransferObj[TRANSFER_FILE_NAME]);var nStatus=rTransferObj[TRANSFER_STATUS];if(nStatus!=TRANSFER_STATUS_SUCCESS){rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";var bCanSubmitForm=false;if(rTransferObj[TRANSFER_VIRTUAL]==1){if(sFileName!=undefined&&sFileName!=null&&sFileName!=""){bCanSubmitForm=true;}}else{rTransferObj[TRANSFER_FILE_SIZE]=0;if(sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!=""){if(sFileInputName==sFileName){bCanSubmitForm=true;}else{ASSERT("Cannot submit form because the transfer object does not match the form input.");}}else{if(sFileInputName!=sFileName)ASSERT("Cannot submit form data because the transfer object does not match the form input.");}}if(bCanSubmitForm){rTransferObj[TRANSFER_ID]=GetNextTransferID();m_nNumOfTransfers++;if(SubmitForm(rForm,rFormsTargetFrame,sFileName,rTransferObj[TRANSFER_ID],rTransferObj[TRANSFER_VIRTUAL]))SetRowState(nRow,TRANSFER_STATUS_PENDING);else SetRowState(nRow,TRANSFER_STATUS_FAILURE);}}}else ASSERT("Cannot submit form because the transfer object could not be found for this row.");}}else ASSERT("Cannot submit upload request(s) because no rows exist.");}}function SubmitForm(rForm,rFormsTargetFrame,sFileName,nTransferID,bIsVirtual){var bSubmitted=false;if(rForm!=null&&rForm!=undefined&&rFormsTargetFrame!=null&&rFormsTargetFrame!=undefined&&sFileName!=undefined&&sFileName!=null&&sFileName!=""&&nTransferID>0){if(bIsVirtual==undefined||bIsVirtual==null)bIsVirtual=0;var sAction="%FILE%Share/MultipleFileUploadResult.htm?Command=UploadFileShare&TransferID="+nTransferID+"&File="+encodeURIComponent(sFileName)+"&ShareToken="+g_sShareToken+"&IsVirtual="+bIsVirtual+'&CsrfToken='+"%ENC_CSRF_TOKEN%";rForm.setAttribute("action",sAction);rFormsTargetFrame.onload=null;rFormsTargetFrame.src="%FILE%Share/MultipleFileUploadResetFrame.htm";rForm.submit();bSubmitted=true;}else ASSERT("Cannot submit form because function parameters are invalid.");return(bSubmitted);}function OnReceiveUploadResponse(rTransferObj){if(rTransferObj!=undefined&&rTransferObj!=null){var nRowNum=rTransferObj[TRANSFER_ROW_NUMBER];if(nRowNum>-1){SetRowState(nRowNum,TRANSFER_STATUS_SUCCESS);var iFrameObj=GetHiddenIFrame(rTransferObj);var rDoc=(iFrameObj.contentWindow||iFrameObj.contentDocument);try{if(rDoc.document)rDoc=rDoc.document;}catch(e){rDoc=null;}if(rDoc!=undefined&&rDoc!=null){var rResultDiv=rDoc.getElementById("Result");var rSizeDiv=rDoc.getElementById("StoredFileSize");var rNameDiv=rDoc.getElementById("StoredFileName");if(rResultDiv!=undefined&&rResultDiv!=null&&rSizeDiv!=undefined&&rSizeDiv!=null&&rNameDiv!=undefined&&rNameDiv!=null){var nResult=rResultDiv.innerHTML;var nSize=rSizeDiv.innerHTML;var nName=rNameDiv.innerHTML;if(nResult==undefined||nResult==null||nResult==0){if(nSize!=null&&nSize!=undefined){nSize=parseInt(nSize);if(!isNaN(nSize))rTransferObj[TRANSFER_FILE_SIZE]=nSize;else if(rTransferObj[TRANSFER_VIRTUAL]==0)ASSERT("OnReceiveUploadResponse: Programming error, file size is not a number.");}else ASSERT("OnReceiveUploadResponse: Programming error, could not parse out file size from XML doc.");}}else{ASSERT("OnReceiveUploadResponse: Programming error, cannot handle the upload response because we couldn't find the row that corresponds to this transfer ID.  Is a timer is needed?");}}}else ASSERT("OnReceiveUploadResponse: Programming error, cannot handle the upload response because we couldn't find the row that corresponds to this transfer ID.");}}function UnlockAllRows(){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){rTransferObj[TRANSFER_ID]=-1;rTransferObj[TRANSFER_VIRTUAL]=-1;var sFileName=rTransferObj[TRANSFER_FILE_NAME];if(sFileName!=undefined&&sFileName!=null&&sFileName!="")SetRowState(nRow,TRANSFER_STATUS_HAS_FILENAME);else SetRowState(nRow,TRANSFER_STATUS_EMPTY);rTransferObj[TRANSFER_RESULT]=-1;rTransferObj[TRANSFER_RESULT_TEXT]="";}else ASSERT("ClearInputFile: Programming error, no object resides at this row!");}}}function ClearInputFile(nRow){if(nRow>-1){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=null&&rTransferObj!=undefined){var rForm=GetFormByRow(nRow);var sFormElements=GetFormElements(nRow);rForm.innerHTML=sFormElements;ResetTransferObj(rTransferObj);$('#fakePath-'+GetFileInputID(nRow)).html("$NO_FILE_SELECTED$");$('#'+GetRemoteInputID(nRow)).val("");}else ASSERT("ClearInputFile: Programming error, no object resides at this row!");}else ASSERT("ClearInputFile: Programming error, invalid row number of span element!");CheckForDuplicateFileNames();}function IsFormValid(){var anNumOfFiles=new Array();var bDuplicatesFound=CheckForDuplicateFileNames(anNumOfFiles);g_bNoFilesToUpload=(anNumOfFiles[0]<1);return((!g_bNoFilesToUpload)&&(!bDuplicatesFound));}function IsDuplicateFileName(sCheckFileName,nExcludeRow,anFoundAt){var rListObj=document.getElementById('MultiUploadList');if(rListObj!=null&&rListObj!=undefined){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){if(nRow!=nExcludeRow){var sFileInputName=undefined;var rFileInput=GetInputFieldByRow(nRow);var rRemoteFileInput=GetRemoteInputFieldByRow(nRow);if(rFileInput.value!="")sFileInputName=rFileInput.value;else if(rRemoteFileInput.value!="")sFileInputName=rRemoteFileInput.value;if(sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!=""){sFileInputName=GetFileName(sFileInputName,true);if(sFileInputName==sCheckFileName){if(typeof(anFoundAt)!="undefined"&&anFoundAt!=undefined&&anFoundAt!=null&&anFoundAt.length>0)anFoundAt[0]=nRow;return(true);}}}}}}return(false);}function CheckForDuplicateFileNames(anNumOfFiles,nCallingRow,bIsVirtual){var bHasDuplicates=false;var nNumOfFilesToTransfer=0;var rListObj=document.getElementById('MultiUploadList');if(rListObj!=null&&rListObj!=undefined){var nNumOfRows=GetNumOfRows();if(nNumOfRows>0){for(var nRow=0;nRow<nNumOfRows;nRow++){var sFileInputName=undefined;var rFileInput=GetInputFieldByRow(nRow);var rRemoteFileInput=GetRemoteInputFieldByRow(nRow);if(rFileInput.value!="")sFileInputName=rFileInput.value;else if(rRemoteFileInput.value!="")sFileInputName=rRemoteFileInput.value;if(sFileInputName!=undefined&&sFileInputName!=null&&sFileInputName!=""){++nNumOfFilesToTransfer;sFileInputName=GetFileName(sFileInputName,true);if(IsDuplicateFileName(sFileInputName,nRow)){bHasDuplicates=true;if(typeof(nCallingRow)!="undefined"&&nCallingRow!=undefined&&nCallingRow!=null){if(nCallingRow==nRow)SetRowState(nRow,TRANSFER_STATUS_DUPLICATE);}else SetRowState(nRow,TRANSFER_STATUS_DUPLICATE);}else RemoveDuplicateState(nRow);}}}}if(typeof(anNumOfFiles)!="undefined"&&anNumOfFiles!=null&&anNumOfFiles!=undefined)anNumOfFiles[0]=nNumOfFilesToTransfer;if(typeof(g_fnOnStateChangeMultiUploadForm)!="undefined"&&g_fnOnStateChangeMultiUploadForm!=undefined&&g_fnOnStateChangeMultiUploadForm!=null)g_fnOnStateChangeMultiUploadForm();return(bHasDuplicates);}function RemoveDuplicateState(nRow){var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=undefined&&rTransferObj!=null){var nStatus=rTransferObj[TRANSFER_STATUS];if(nStatus==TRANSFER_STATUS_DUPLICATE)SetRowState(nRow,TRANSFER_STATUS_HAS_FILENAME);}}function SetRowState(nRow,nState){var nCurObjState=-1;var sResultText="";var rTransferObj=GetTransferObjByRow(nRow);if(rTransferObj!=undefined&&rTransferObj!=null){nCurObjState=rTransferObj[TRANSFER_STATUS];if(nCurObjState!=nState)rTransferObj[TRANSFER_STATUS]=nState;sResultText=rTransferObj[TRANSFER_RESULT_TEXT];}if(nCurObjState!=nState){var sListItemID=GetListItemID(nRow);var sFileInputID=GetFileInputID(nRow);var sStatusMsg="";var sStatusImg="%COMMON_FILE%Images/blank.gif";var sStatusBorder="multiUploadFileInputBorder";var sResetImg=GetFormElement_RemoveBtn(nRow,"%FILE%Share/Images/icon_delete_file_uploaded.png",true);var bLockRow=false;var sDisableButton="";switch(nState){case TRANSFER_STATUS_HAS_FILENAME:{}break;case TRANSFER_STATUS_PENDING:{}break;case TRANSFER_STATUS_DUPLICATE:{sStatusMsg="$ADHOC_FILE_UPLOAD_DUPLICATE_FOUND$";sStatusImg="%FILE%Share/Images/icon_red_stop.png";sStatusBorder="multiUploadFileInputError";}break;case TRANSFER_STATUS_FAILURE:{sStatusMsg=sResultText;sStatusImg="%COMMON_FILE%Java/Images/Error16.png";sStatusBorder="multiUploadFileInputError";}break;case TRANSFER_STATUS_SUCCESS:{sResetImg=GetFormElement_RemoveBtn(nRow,"%COMMON_FILE%Images/Check16.png",false);bLockRow=true;sDisableButton="ui-state-disabled";}break;case TRANSFER_STATUS_EMPTY:default:{sResetImg="";}break;}var rFileInputResetDiv=$("#"+sListItemID).find(".uploadColFormResetDiv");if(rFileInputResetDiv!=undefined&&rFileInputResetDiv!=null)$(rFileInputResetDiv).html(sResetImg);var rRowStatusMsgDiv=$("#"+sListItemID).find(".uploadRowStatusTxt");if(rRowStatusMsgDiv!=undefined&&rRowStatusMsgDiv!=null)$(rRowStatusMsgDiv).text(sStatusMsg);var rRowStatusImg=$("#"+sListItemID).find(".uploadRowStatusImg");if(rRowStatusImg!=undefined&&rRowStatusImg!=null)$(rRowStatusImg).attr("src",sStatusImg);$("#"+sFileInputID).attr("disabled",bLockRow);$("#fake-"+GetFileInputID(nRow)).attr("disabled",bLockRow);$("#fake-"+GetFileInputID(nRow)).addClass(sDisableButton);document.getElementById(sFileInputID).onchange=(function(nCurrRow){var nThisRow=nCurrRow;return function(){var sInputVal=this.value;document.getElementById("fakePath-"+GetFileInputID(nThisRow)).innerHTML=GetFileName(sInputVal,true);if(bIsMSIE){$(".ui-contextmenu").hide();ShowHideLocalInput(nThisRow,false);}OnChangeFile(this,nThisRow,0);};}(nRow));}}function AreUploadsComplete(anInfo){var nNumOfFilesToUpload=0;var nNumOfFilesSuccessfullyUploaded=0;for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var sFileName=rTransferObj[TRANSFER_FILE_NAME];var nStatus=rTransferObj[TRANSFER_STATUS];if(sFileName!=null&&sFileName!=undefined&&sFileName!=""){++nNumOfFilesToUpload;if(nStatus==TRANSFER_STATUS_SUCCESS)++nNumOfFilesSuccessfullyUploaded;}}}}if(anInfo!=null&&anInfo!=undefined){anInfo[0]=nNumOfFilesToUpload;anInfo[1]=nNumOfFilesSuccessfullyUploaded;}return(nNumOfFilesToUpload>0&&nNumOfFilesToUpload==nNumOfFilesSuccessfullyUploaded);}</script></div><div id="Page3" style="display: none;"><div style="margin-top: 10px;" id="SummaryDesc">$ADHOC_WIZARD_OUTGOING_CONFIRM_SHARE_MANUAL_DESC$</div><div style="margin: 30px 0px 6px 0px; font-weight: bold; font-size: 10pt;">$ADHOC_WIZARD_OUTGOING_CONFIRM_SHARE_URL_DESC$</div><div id="accessLinkFieldID" style="margin-bottom: 30px; color: #669933; font-size: 10pt;"></div><div class="rowHeaderShares"><div id="FileListDesc"></div></div><div id="ulFileShareTable"></div><table class="tableSummarySteps" style="width: 100%"><tr><td class="colSummaryStepsLeft" style="50%"><div class="colSummaryHeaderLeft">$ADHOC_NEXT_STEPS_SECTION$</div><ul id="OptionalNextStepsList"><li class="ListItemFile">$ADHOC_NEXT_STEPS_MANUAL_EMAIL_DESC$</li><li class="ListItemFile" id="NextStepsManualEmail">$ADHOC_NEXT_STEPS_GENERATE_EMAIL_DESC$</li><li class="ListItemFile" id="NextStepsCancelShare">$ADHOC_NEXT_STEPS_CANCEL_SHARE_DESC$</li></ul></td><td class="colSummaryStepsRight" style="50%"><div class="colSummaryHeaderRight">$ADHOC_SUMMARY_SECTION$</div><ul id="UploadConfirmNotes"></ul></td></tr></table><button id="wizBtnDone" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_blue" role="button" type="button" onclick="javascript: OnBtnDone();"><span class="ui-button-text" style="color: white;">$ADHOC_WIZ_BTN_DONE$</span></button><div style="clear: both;"></div></div><div class="justifyLeft" id="wizardBtmBttnFooter"><div class="wizardBtmBttns"><button id="wizBtnBack" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_gray" style="display: none;" autocomplete="off" role="button" type="button" onclick="javascript: OnPreviousPage();"><span class="ui-button-text" style="color: white;">&lt;&lt;&nbsp;<span id="wizBtnBackTxt">$ADHOC_WIZ_BTN_BACK$</span></span></button><button id="wizBtnNext" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_blue" role="button" type="button" autocomplete="off" onclick="javascript: OnNextPage();"><span class="ui-button-text" style="color: white;"><span id="wizBtnNextTxt">$ADHOC_WIZ_BTN_NEXT$</span><span id="wizBtnNextTxt2">&nbsp;&gt;&gt;</span></span></button><button id="wizBtnCancel" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only button_gray" role="button" autocomplete="off" type="button" onclick="javascript: OnCancelWizard();"><span id="wizBtnCancelTxt" class="ui-button-text" style="color: white;">$CANCEL$</span></button></div><div style="clear: both;"></div></div></div> </div> <div id="CommonFooter" class="AdhocFooter"><div class="copyright" id="FooterCopyright"><div class="footerDiv1"><a href="%PRODUCT_HOME%" target="_blank" rel="noopener noreferrer">%PRODUCT%</a> <span id="SUVersionNumber">%VERSION%</span> &copy; 1995 - %COPYRIGHT_END_YEAR% <a href="%COMPANY_URL_HOME%" TARGET="_blank" rel="noopener noreferrer">%COMPANY_NAME_FORMAL%</a>&nbsp;$ALL_RIGHTS_RESERVED$</div></div></div></div><script type="text/javascript" language="JavaScript">var UID_NEW_RECPTS_INPUT_FIELD="NewRcptsInputField";var m_bSkipAdds=false;var passwordContainers=$(".password-container");passwordContainers.each(function(i,pswdCont){initNativePasswordTypeToggler(pswdCont);});function ChangePage(nPage){if(nPage>(PAGE_MAX-1))nPage=(PAGE_MAX-1);else if(nPage<0)nPage=0;g_nPage=nPage;switch(nPage){case 1:{document.getElementById("Page1").style.display="none";document.getElementById("Page3").style.display="none";document.getElementById("Page2").style.display="block";}break;case 2:{document.getElementById("Page1").style.display="none";document.getElementById("Page2").style.display="none";document.getElementById("Page3").style.display="block";}break;case 0:default:{document.getElementById("Page2").style.display="none";document.getElementById("Page3").style.display="none";document.getElementById("Page1").style.display="block";}break;}LoadPageEx(nPage);}function ValidatePage(nPage){var bIsValid=true;m_nWizardError=WIZARD_ERR_GENERIC;switch(nPage){case 0:{bIsValid=ValidatePage1();}break;case 1:{bIsValid=ValidatePage2();}break;case 2:{bIsValid=ValidatePage3();}break;case 0:default:break;}return(bIsValid);}function ValidatePage1(){var bOkay=true;bOkay=(AreValidRecipients(GetCheckedState("EmailAfterUpload"))&&bOkay);bOkay=(IsValidSenderName(true)&&bOkay);bOkay=(IsValidSenderEmail(true)&&bOkay);bOkay=(IsValidEmailSubject(true)&&bOkay);bOkay=(IsValidExpirationDate()&&bOkay);bOkay=(IsValidPword()&&bOkay);return(bOkay);}function ValidatePage2(){return(IsFormValid());}function ValidatePage3(){var bOkay=true;return(bOkay);}function GetWizardErrorTxt(nWizardError){var sRet="$ADHOC_WIZARD_ERR_GENERIC$";switch(nWizardError){case WIZARD_ERR_EMAIL_LINK_IS_ON_WITH_NO_GUESTS:{sRet="$ADHOC_WIZARD_ERR_EMAIL_LINK_IS_ON_WITH_NO_GUESTS$";sRet=sRet.replace("$AutoSendListLabel","$ADHOC_WIZARD_OUTGOING_AUTO_SEND_EMAIL$");}break;case WIZARD_ERR_GENERIC:default:sRet="$ADHOC_WIZARD_ERR_GENERIC$";break;}return(sRet);}function OnNextPage(){g_bNoFilesToUpload=false;if(ValidatePage(g_nPage)){var bCanChangePage=true;if(g_nPage==1){if(g_sShareToken==""){OnCreateFileShare();bCanChangePage=false;}else if(!AreUploadsComplete()){ShowProgressDialog();OnSubmitFiles();PollForStats(true);bCanChangePage=false;}}if(bCanChangePage)ChangePage(g_nPage+1);}else{switch(g_nPage){case 1:{if(g_bNoFilesToUpload)AlertDialogEx("$PLEASE_SELECT_FILE_UPLOAD_MOBILE$",true,undefined,undefined,undefined,undefined,false);else AlertDialogEx(GetWizardErrorTxt(m_nWizardError),true,undefined,undefined,undefined,undefined,false);}break;default:{AlertDialogEx(GetWizardErrorTxt(m_nWizardError),true,undefined,undefined,undefined,undefined,false);}break;}}}function OnPreviousPage(){ChangePage(g_nPage-1);}function InitMailtoLink(){var sRecipients=$("#recipientEmails").val();var sSenderName=$("#senderName").val();var sSenderEmail=$("#senderEmail").val();var sSubject=$("#senderEmailSubject").val().replace(eval("/\\%/g"),"%25");var sEmailSubject=decodeURIComponent(sSubject);var sBody=$("#EmailBody").val().replace(eval("/\\%/g"),"%25");var sComments=decodeURIComponent(sBody);var sExpires=IDS_FILE_SHARE_DOES_NOT_EXPIRE;var sLinkExpirationDate=GetLinkExpirationDateIfEnabled();if(sLinkExpirationDate!=null&&sLinkExpirationDate!=undefined)sExpires=sLinkExpirationDate;var bSenderCarbonCopy=GetCheckedState("CCToSender");var sPassword="";if((g_nRequirePasswordForGuests==1||g_nRequirePasswordForGuests==0&&GetCheckedState("addPwordToFileShare"))&&(g_nInsertPasswordInEmailInvite==1||g_nInsertPasswordInEmailInvite==0&&GetCheckedState("addPwordToEmail"))){sPassword=$("#FileSharePword").val();}m_sMailtoLink=CreateMailtoLink(sRecipients,sEmailSubject,g_sEmailBody,g_sShareURL,sSenderName,sSenderEmail,bSenderCarbonCopy,sComments,sExpires,sPassword);}function OnGenerateEmail(){if(m_sMailtoLink!=null&&m_sMailtoLink!=undefined&&m_sMailtoLink!="")window.location.href=m_sMailtoLink;else ASSERT("OnGenerateEmail:  Programming error, could not create mailto link.");}function OnCreateFileShare(){var sRecipientEmailAddresses=$("#recipientEmails").val();var sSenderName=$("#senderName").val();var sSenderEmail=$("#senderEmail").val();var sNotifyUserOnGuestTransfer=GetCheckedStateAsString("NotifyUserOnGuestTransfers");var sSenderCarbonCopy=(CanEmailAfterUpload())?GetCheckedStateAsString("CCToSender"):"0";var sSubject=$("#senderEmailSubject").val().replace(eval("/\\%/g"),"%25");var sEmailSubject=decodeURIComponent(sSubject);var sBody=$("#EmailBody").val().replace(eval("/\\%/g"),"%25");var sEmailBody=decodeURIComponent(sBody);var sExpirationTimestamp="";var dtDate=GetLinkExpirationDate(false);if(dtDate!=null&&dtDate!=undefined){if(dtDate instanceof Date)sExpirationTimestamp=parseInt(dtDate.getTime()/1000);}var sPasswordIsSet=GetCheckedStateAsString("addPwordToFileShare");var sPassword=$("#FileSharePword").val();var sIncludePasswordInEmail=GetCheckedStateAsString("addPwordToEmail");CreateFileShare("%FILE%Share/CreateFileShare.xml","1",sRecipientEmailAddresses,sSenderName,sSenderEmail,sNotifyUserOnGuestTransfer,sSenderCarbonCopy,sEmailSubject,sEmailBody,sExpirationTimestamp,sPasswordIsSet,sPassword,sIncludePasswordInEmail,"0",OnCreateFileShareResponse);}function OnCreateFileShareResponse(data,textStatus,jqXHR,objCallbackData){if(jqXHR.status==200){var XMLDoc=data;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult==0){g_sShareToken=GetXMLValue(XMLDoc,"ShareToken");g_sShareURL=GetXMLValue(XMLDoc,"ShareURL");$("#accessLinkFieldID").html(g_sShareURL);g_sShareDateCreated=GetXMLValue(XMLDoc,"ShareDateCreated");OnNextPage();}else{AlertDialogEx(GetResultText(0,"",sResultText),true,undefined,undefined,undefined,undefined,false);}}else{var sErr="$ADHOC_FAILED_TO_CREATE_SHARE$";sErr=sErr.replace("$HttpCode",objRequest.status);AlertDialogEx(sErr,true,undefined,undefined,undefined,undefined,false);}}function OnEmailFileShareURL(){var sPassword="";if(GetCheckedState("addPwordToFileShare"))sPassword=$("#FileSharePword").val();var sIncludePasswordInEmail=GetCheckedStateAsString("addPwordToEmail");if(!EmailFileShareURL("%FILE%Result.xml",g_sShareToken,sPassword,sIncludePasswordInEmail,OnEmailFileShareURLResponse))ASSERT("Programming error, please specify a share token that we can email.");}function OnEmailFileShareURLResponse(data,textStatus,jqXHR,objCallbackData){if(jqXHR.status==200){var XMLDoc=data;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if(nResult==0||nResult==2){UpdateEmailStatus(true);}else{AlertDialogEx(GetResultText(0,"",sResultText),true,undefined,undefined,undefined,undefined,false);UpdateEmailStatus(false);}}else{var sErr="$ADHOC_FAILED_TO_AUTO_EMAIL_SHARE$";sErr=sErr.replace("$HttpCode",jqXHR.status);AlertDialogEx(sErr,true,undefined,undefined,undefined,undefined,false);UpdateEmailStatus(false);}}function OnCancelWizard(){if(g_sShareToken!=null&&g_sShareToken!=undefined&&g_sShareToken!="")OnConfirmDeleteShare(g_sShareToken);else SendToConsolePage();}function OnStateChangeMultiUploadForm(){var bChangeToContinue=false;var anInfo=new Array(2);AreUploadsComplete(anInfo);if(anInfo!=undefined&&anInfo!=null&&anInfo.length>=2){var nNumOfFilesToUpload=anInfo[0];var nNumOfFilesSuccessfullyUploaded=anInfo[1];bChangeToContinue=(nNumOfFilesToUpload>0&&nNumOfFilesToUpload==nNumOfFilesSuccessfullyUploaded);}var sNextBtnTxt="$ADHOC_WIZ_BTN_UPLOAD$";if(bChangeToContinue)sNextBtnTxt="$CONTINUE$";$('#wizBtnNextTxt').text(sNextBtnTxt);}function LoadPageEx(nPage){var sTopTitle="";var sTopTitleStep="";var sTopTitleDesc="";$("#dialogBar").css("display","block");$("#wizardTitleTable").css("display","block");$("#columnImg48").css("display","block");$('#wizBtnBackTxt').text("$ADHOC_WIZ_BTN_BACK$");$('#wizBtnNextTxt').text("$ADHOC_WIZ_BTN_NEXT$");SetElementDisabledState(["wizBtnBack"],false);$('#wizBtnBack').css("display","none");$('#wizBtnNext').css("display","inline");$('#wizBtnCancel').css("display","inline");$('#wizardBtmBttnFooter').css("display","block");switch(g_nOutgoingSource){case 1:{$("#AdHocLocalBrowseOption").show();$("#AdHocRemoteBrowseOption").hide();}break;case 2:{$("#AdHocLocalBrowseOption").hide();$("#AdHocRemoteBrowseOption").show();}break;case 0:default:{$("#AdHocLocalBrowseOption").show();$("#AdHocRemoteBrowseOption").show();}break;}switch(nPage){case 1:{sTopTitle="$ADHOC_WIZARD_OUTGOING_TITLE_2$";sTopTitleStep="$STEP_2_OF_2$";if(navigator.userAgent.indexOf("MSIE")!=-1||navigator.userAgent.toLowerCase().indexOf('trident')!=-1)sTopTitleDesc="$ADHOC_WIZARD_OUTGOING_DESC_2$ $ADHOC_WIZARD_OUTGOING_DESC_2_IE$";else sTopTitleDesc="$ADHOC_WIZARD_OUTGOING_DESC_2$";if(g_nMaxNumOfFilesInSentShare>0&&g_nMaxNumOfFilesInSentShare<MAX_UPLOAD_ROWS)sTopTitleDesc=sTopTitleDesc.replace("$MaxNumOfFiles",g_nMaxNumOfFilesInSentShare);else sTopTitleDesc=sTopTitleDesc.replace("$MaxNumOfFiles",MAX_UPLOAD_ROWS);$('#wizBtnBack').css("display","inline");OnStateChangeMultiUploadForm();}break;case 2:{$('#wizardBtmBttnFooter').css("display","none");sTopTitle="$ADHOC_UPLOAD_CONFIRM_TITLE$";var sFileDate=FormatTimestampForDateTime(g_sShareDateCreated);sTopTitleDesc="$ADHOC_WIZ_SUMMARY_DESC$";sTopTitleDesc=sTopTitleDesc.replace("$AdhocCreatedShare","<strong>"+sFileDate+"</strong>");var sGenEmailTxt="$ADHOC_NEXT_STEPS_GENERATE_EMAIL_DESC$";sGenEmailTxt=sGenEmailTxt.replace("$GenEmailLink",'<a href="javascript:OnGenerateEmail();">'+"$ADHOC_NEXT_STEPS_GENERATE_EMAIL_LINK$"+'</a>');sGenEmailTxt=sGenEmailTxt.replace("$GenEmailNote",'<span style="font-style: italic;">'+"$ADHOC_NEXT_STEPS_GENERATE_EMAIL_NOTE$"+'</span>');$('#NextStepsManualEmail').html(sGenEmailTxt);var sCancelShareTxt="$ADHOC_NEXT_STEPS_CANCEL_SHARE_DESC$";sCancelShareTxt=sCancelShareTxt.replace("$CancelShare",'<a href="javascript:OnCancelWizard();">'+"$ADHOC_NEXT_STEPS_CANCEL_SHARE_LINK$"+'</a>');$('#NextStepsCancelShare').html(sCancelShareTxt);UpdateEmailStatus(false);if(CanEmailAfterUpload())OnEmailFileShareURL();$("#columnImg48").css("display","none");$('#ulFileShareTable').html("");var nNumOfTransfers=0;for(var rKey in g_aTransfersMappedToRowNum){if(rKey!=undefined&&rKey!=null){var rTransferObj=g_aTransfersMappedToRowNum[rKey];if(rTransferObj!=undefined&&rTransferObj!=null){var sFileName=rTransferObj[TRANSFER_FILE_NAME];if(sFileName!=null&&sFileName!=undefined&&sFileName!=""){++nNumOfTransfers;AddFileToUploadedList(rTransferObj,nNumOfTransfers);}}}}var sDesc="";if(nNumOfTransfers>1){sDesc="$ADHOC_CONFIRM_UPLOAD_OF_FILES$";sDesc=sDesc.replace("$AdhocNumOfFiles",nNumOfTransfers);}else if(m_nNumOfTransfers==1)sDesc="$ADHOC_CONFIRM_UPLOAD_OF_ONE_FILE$";$('#FileListDesc').html(sDesc);UpdateSummaryNotes();InitMailtoLink();}break;case 0:default:{sTopTitle="$ADHOC_WIZARD_OUTGOING_TITLE_1$";sTopTitleStep="$STEP_1_OF_2$";sTopTitleDesc="$ADHOC_WIZARD_OUTGOING_DESC_1$";SetElementDisabledState(["wizBtnBack"],true);}break;}$("#topTitle").html(sTopTitle);$("#topTitleStep").html(sTopTitleStep);$("#topTitleDesc").html(sTopTitleDesc);}function GetSummaryDesc(bEmailWasSent){return(GetSummaryDescEx(bEmailWasSent,"$UNDISCLOSED_RECIPIENTS$","$ADHOC_WIZARD_OUTGOING_CONFIRM_SHARE_DESC$","$ADHOC_WIZ_SUMMARY_DESC_NO_RECIPIENTS$","$ADHOC_WIZ_SUMMARY_DESC_NO_RECIPIENTS2$","$ADHOC_WIZARD_OUTGOING_CONFIRM_SHARE_MANUAL_DESC$","$ADHOC_WIZARD_OUTGOING_CONFIRM_SHARE_MANUAL_DESC2$"));}function UpdateEmailStatus(bEmailWasSent){var sSummaryDesc=GetSummaryDesc(bEmailWasSent);$('#SummaryDesc').html(sSummaryDesc);}function UpdateSummaryNotes(){$('#UploadConfirmNotes').empty();if(!GetCheckedState("NotifyUserOnGuestTransfers"))AddSummaryNote("$ADHOC_SUMMARY_SEND_NOTIFY_ON_DL_IS_OFF$");if(GetCheckedState("EmailAfterUpload")&&(!GetCheckedState("CCToSender")))AddSummaryNote("$ADHOC_SUMMARY_SEND_EMAIL_COPY_IS_OFF$");if(!GetCheckedState("addPwordToFileShare"))AddSummaryNote("$ADHOC_SUMMARY_URL_PWORD_IS_OFF$");else if(!GetCheckedState("addPwordToEmail"))AddSummaryNote("$ADHOC_SUMMARY_PUT_PWORD_IN_EMAIL_IS_OFF$");var sEmailBody=$("#EmailBody").val();if(sEmailBody==null||sEmailBody==undefined||sEmailBody=="")AddSummaryNote("$ADHOC_SUMMARY_EMAIL_COMMENTS_ARE_EMPTY$");}function OnLogout(){location.href="%LOGOUT%";}function OnBtnDone(){SendToConsolePage();}function OnDeleteFileShareResponse(objRequest){if((objRequest!=undefined)&&(objRequest.readyState==4)){if(objRequest.status==200){var XMLDoc=objRequest.responseXML;var nResult=GetXMLValueInt(XMLDoc,"result");var sResultText=GetXMLValue(XMLDoc,"ResultText");if((nResult==0)||(nResult==g_nSessionNotFound)){g_sShareToken="";g_sShareURL="";g_sShareDateCreated="";m_nTrackProgressIteration=-1;m_nTrackFileSize=0;m_bMoveToNextPageAfterProgressStats=false;UnlockAllRows();SendToConsolePage();}else{AlertDialogEx(GetResultText(0,"",sResultText),true,undefined,undefined,undefined,undefined,false);}}else{var sErr="$ADHOC_FAILED_TO_DELETE_SHARE$";sErr=sErr.replace("$HttpCode",objRequest.status);AlertDialogEx(sErr,true,undefined,undefined,undefined,undefined,false);}}}function OnConfirmDeleteShareYesOpt(objData){if(objData!=undefined&&objData!=null&&(typeof objData==="string")&&objData!="")OnDeleteFileShare(objData,OnDeleteFileShareResponse,objData);else ASSERT("Console.OnConfirmDeleteShareYesOpt - Programming error, invalid share token.");}function GetDeleteShareDesc(){var sDesc="$ADHOC_CONFIRM_DELETE_SHARE_DESC$";
var sSubject=$("#senderEmailSubject").val().replace(eval("/\\%/g"),"%25");sDesc=sDesc.replace("$Subject",decodeURIComponent(sSubject));var sRecipients=GetRecipients("$UNDISCLOSED_RECIPIENTS$");if(sRecipients!=null&&sRecipients!=undefined){var asEmailArray=sRecipients.split(';');if(asEmailArray!=null&&asEmailArray!=undefined&&asEmailArray.length>0){var nNumOfRecipients=(asEmailArray.length-1);if(nNumOfRecipients>1)sDesc=sDesc.replace("$Recipients",asEmailArray[0]+" (+"+nNumOfRecipients+")");else sDesc=sDesc.replace("$Recipients",asEmailArray[0]);}}return(sDesc);}function OnConfirmDeleteShare(sShareToken){var sDesc=GetDeleteShareDesc();ConfirmDialogEx(null,"$ADHOC_CONFIRM_DELETE_SHARE_TITLE$",null,sDesc,OnConfirmDeleteShareYesOpt,null,sShareToken,DELETE_FILE_SHARE_DLG_WIDTH,DELETE_FILE_SHARE_DLG_HEIGHT);var objBtn=$("#ConfirmDialog").parent().find(".ui-button-text:contains('$YES_BUTTON$')");if(objBtn!=null&&objBtn!=undefined)objBtn.text("$CONTINUE$");var objBtn=$("#ConfirmDialog").parent().find(".ui-button-text:contains('$NO_BUTTON$')");if(objBtn!=null&&objBtn!=undefined)objBtn.text("$CANCEL$");}function OnContextHelp(){LaunchClientHelp("Help-FileShare-OutgoingWizard.htm","Item4_4");}function LoadPage(){$("#recipientEmails").tagit({singleField:true,singleFieldDelimiter:";",tabIndex:8,allowSpaces:false,beforeTagAdded:function(event,ui){var bAddTag=true;if(!ui.duringInitialization){var asEmails=ExtractEmailAddresses(ui.tagLabel);if(asEmails!=undefined&&asEmails!=null&&asEmails.length>0){if(!m_bSkipAdds){m_bSkipAdds=true;var nIdx=0;for(nIdx=0;nIdx<asEmails.length;nIdx++){$("#recipientEmails").tagit("createTag",asEmails[nIdx]);}bAddTag=false;m_bSkipAdds=false;}}}return(bAddTag);},afterTagAdded:function(event,ui){var bRet=true;if(!ui.duringInitialization){if(!IsValidEmailAddressString(ui.tagLabel)){var label=ui.tag.find(".tagit-label");if(label!=undefined)label.css("color","red");}}},afterTagRemoved:function(event,ui){if(!ui.duringInitialization){}}});var TagItInput=$("#RcpEmailsDiv").find(".ui-autocomplete-input");if(TagItInput!=undefined){TagItInput.attr("id",UID_NEW_RECPTS_INPUT_FIELD);TagItInput.focusin(function(){TurnOffErrorForRecipients();});}var nMaxDaysToExpireLink=GetMaximumDaysToExpireLink();$("#ExpiresOnDatePicker").datepicker({"buttonImage":"%FILE%Share/Images/icon_calendar.png","buttonImageOnly":true,"buttonText":"$CHOOSE_DATE_BUTTON$","onSelect":OnChangeExpiresDateTime,"selectOtherMonths":true,"showButtonPanel":true,"showOn":"both","minDate":"+1 D","maxDate":"+"+nMaxDaysToExpireLink+" D","dateFormat":"mm/dd/yy","showOtherMonths":true});$(function(){$.datepicker.setDefaults($.datepicker.regional[""]);});if(!g_bAllowUserDefinedGuestAccess){var asDisableIDs=["ExpiresOnDate","ExpiresOnDatePicker","ExpiresInHours","ExpiresInHoursSel","ExpiresInDays","ExpiresInDaysSel","ExpiresNever"];SetElementDisabledState(asDisableIDs,true);$(".ui-datepicker-trigger").hide();$("#AdhocExpireLinkOptLimitInfo").css("display","inline-block");}$("#senderName").focusout(function(){IsValidSenderName();});$("#senderEmail").focusout(function(){IsValidSenderEmail();});$("#senderEmailSubject").focusout(function(){IsValidEmailSubject();});$("#EmailBody").focusout(function(){IsValidEmailMsg();});$("#senderName").focusin(function(){TurnOffErrorForName();});$("#senderEmail").focusin(function(){TurnOffErrorForEmailAddr();});$("#senderEmailSubject").focusin(function(){TurnOffErrorForEmailSubject();});$("#EmailBody").focusin(function(){TurnOffErrorForEmailBody();});$("#ExpiresOnDatePicker").focusin(function(){TurnOffErrorState($("#ExpiresOnDateLabel"));});$("#FileSharePword").focusin(function(){TurnOffErrorState($(this));TurnOffErrorState($("#FileSharePword"));});if(GetIEMajorVersionNumber()>0){var aIDs=["#DateImg","#ExpiresInHoursSel","#ExpiresInDaysSel"];for(var nIdx=0;nIdx<aIDs.length;nIdx++){$(aIDs[nIdx]).css("margin","0px 10px");}}var nDaysToExpireLink=GetDefaultDaysToExpireLink(nMaxDaysToExpireLink);var dtSpan=new Date(NumberOfDaysToMillis(nDaysToExpireLink));$("#ExpiresOnDatePicker").datepicker("setDate",new Date(g_dtPageLoadDate.getTime()+dtSpan.getTime()));var nMaxDays=GetMaxDaysDefaultForExpireCombo();FillSelectorWithDays(nMaxDays);FillSelectorWithHours();$("#ExpiresNever").show();$("#ExpiresNeverLabel").show();if(g_ullRestrictGuestAccessDays==0){if(!g_bAllowUserDefinedGuestAccess)$("#ExpiresNever").prop("checked",true);}else{$("#ExpiresNever").hide();$("#ExpiresNeverLabel").hide();}CheckOptionalLimit(g_nNotifyAfterGuestDownload,["NotifyUserOnGuestTransfers"],"NotifyUserOnGuestTransfers","NotifyUserOnGuestTransfersLimitInfo");CheckOptionalLimit(g_nSendAccessLinkToRecipients,["EmailAfterUpload"],"EmailAfterUpload","EmailAfterUploadLimitInfo");CheckOptionalLimit(g_nSendAccessLinkToSender,["CCToSender"],"CCToSender","CCToSenderLimitInfo");CheckOptionalLimit(g_nRequirePasswordForGuests,["addPwordToFileShare"],"addPwordToFileShare","addPwordToFileShareLimitInfo");if(g_nRequirePasswordForGuests==1){$("#addPwordToFileShareLimitInfo").attr("title","$ADHOC_ADMIN_SET_LIMIT_PWORD_REQUIRED$");}else{asDisableIDs=["FileSharePword","GeneratePword"];SetElementDisabledState(asDisableIDs,true);if(g_nRequirePasswordForGuests==2){$("#GeneratePword").hide();$("#PwordBtnHint").hide();}}CheckOptionalLimit(g_nInsertPasswordInEmailInvite,["addPwordToEmail"],"addPwordToEmail","addPwordToEmailLimitInfo");UpdateEmailAfterUploadControls();UpdatePwordControls();$("#senderName").val(HTMLDecode(g_sUserName));$("#senderEmail").val(g_sUserEmail);UpdateEmailSubject();$(document).tooltip({"tooltipClass":"customTooltip","show":{"effect":"fade","duration":TOOLTIP_SHOW_DURATION_IN_MILLIS,"delay":TOOLTIP_SHOW_DELAY_IN_MILLIS },"hide":{"effect":"fade","duration":TOOLTIP_HIDE_DURATION_IN_MILLIS,"delay":TOOLTIP_HIDE_DELAY_IN_MILLIS }});if(!g_bAllowCustomContactInfo)SetElementDisabledState(["senderName","senderEmail"],true);setTimeout("SendXMLHTTPNOOP()",NOOP_INTERVAL_IN_MILLIS);SetMaxUploadRows(g_nMaxNumOfFilesInSentShare);InsertMultiUploadFields();$("#wizBtnBack").attr("tabindex","20");$("#wizBtnNext").attr("tabindex","21");$("#wizBtnCancel").attr("tabindex","22");LoadPageEx(0);EnableSelectionOnFormElements();}$(document).ready(LoadPage);</script></body></html>